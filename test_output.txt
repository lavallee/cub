1..1160
ok 1 criteria: extract checkbox items
ok 2 criteria: extract from 'Acceptance criteria:' section
ok 3 criteria: extract from 'Done when:' section
ok 4 criteria: combine checkbox and section criteria
ok 5 criteria: case-insensitive section matching
ok 6 criteria: avoid duplicates when extracting
ok 7 criteria: empty content returns empty array
ok 8 criteria: extract from multiple sections
ok 9 criteria: extract numbered items from section
ok 10 criteria: stop at next section header
ok 11 criteria: handle whitespace in items
ok 12 criteria: complex markdown with mixed formats
ok 13 criteria: output is valid JSON
ok 14 criteria: each item is a string
ok 15 criteria: works with markdown parser
ok 16 artifacts_get_run_dir: fails when session not initialized
ok 17 artifacts_get_run_dir: returns correct path format
ok 18 artifacts_get_task_dir: fails without task_id
ok 19 artifacts_get_task_dir: returns correct path format
ok 20 artifacts_ensure_dirs: fails without task_id
ok 21 artifacts_ensure_dirs: creates task directory
ok 22 artifacts_ensure_dirs: creates directory with 700 permissions
ok 23 artifacts_init_run: fails when session not initialized
ok 24 artifacts_init_run: creates run directory
ok 25 artifacts_init_run: creates run.json with correct schema
ok 26 artifacts_init_run: timestamps are ISO 8601 format
ok 27 artifacts_start_task: fails without task_id
ok 28 artifacts_start_task: fails without task_title
ok 29 artifacts_start_task: creates task directory
ok 30 artifacts_start_task: creates task.json with correct schema
ok 31 artifacts_start_task: defaults priority to 'normal'
ok 32 artifacts_start_task: timestamps are ISO 8601 format
ok 33 artifacts_start_task: works without artifacts_init_run
ok 34 artifacts integration: run and task creation
ok 35 artifacts_capture_plan: fails without task_id
ok 36 artifacts_capture_plan: fails without plan_content
ok 37 artifacts_capture_plan: writes plan.md
ok 38 artifacts_capture_plan: plan.md has correct content
ok 39 artifacts_capture_plan: plan.md has 600 permissions
ok 40 artifacts_capture_plan: is idempotent (overwrites)
ok 41 artifacts_capture_command: fails without task_id
ok 42 artifacts_capture_command: fails without cmd
ok 43 artifacts_capture_command: fails without exit_code
ok 44 artifacts_capture_command: creates commands.jsonl
ok 45 artifacts_capture_command: appends valid JSONL
ok 46 artifacts_capture_command: includes timestamp
ok 47 artifacts_capture_command: includes all fields
ok 48 artifacts_capture_command: handles empty output
ok 49 artifacts_capture_command: defaults duration to 0
ok 50 artifacts_capture_command: commands.jsonl has 600 permissions
ok 51 artifacts_capture_diff: fails without task_id
ok 52 artifacts_capture_diff: creates changes.patch
ok 53 artifacts_capture_diff: captures git diff output
ok 54 artifacts_capture_diff: handles empty diff gracefully
ok 55 artifacts_capture_diff: changes.patch has 600 permissions
ok 56 artifacts_capture_diff: is idempotent (overwrites)
ok 57 artifacts_capture_harness_output: fails without task_id
ok 58 artifacts_capture_harness_output: fails without output_file
ok 59 artifacts_capture_harness_output: fails if output_file doesn't exist
ok 60 artifacts_capture_harness_output: creates harness_output.log
ok 61 artifacts_capture_harness_output: content is captured correctly
ok 62 artifacts_capture_harness_output: appends with iteration header
ok 63 artifacts_capture_harness_output: harness_output.log has 600 permissions
ok 64 artifacts integration: capture all artifact types
ok 65 artifacts_get_path: fails without task_id
ok 66 artifacts_get_path: returns absolute path
ok 67 artifacts_get_path: path is actually absolute and valid
ok 68 artifacts_finalize_task: fails without task_id
ok 69 artifacts_finalize_task: fails without status
ok 70 artifacts_finalize_task: fails without exit_code
ok 71 artifacts_finalize_task: fails if task.json doesn't exist
ok 72 artifacts_finalize_task: updates task.json with final status
ok 73 artifacts_finalize_task: increments iterations
ok 74 artifacts_finalize_task: creates summary.md
ok 75 artifacts_finalize_task: summary.md contains required fields
ok 76 artifacts_finalize_task: summary.md has 600 permissions
ok 77 artifacts_finalize_task: updates run.json with tasks_completed counter
ok 78 artifacts_finalize_task: updates run.json with tasks_failed counter
ok 79 artifacts_finalize_task: increments counters correctly for multiple tasks
ok 80 artifacts_finalize_task: handles empty summary_text
ok 81 artifacts_finalize_task: calculates duration correctly
ok 82 artifacts integration: full task lifecycle with finalization
ok 83 branches_init creates branches.yaml in .beads directory
ok 84 branches_init fails if .beads directory does not exist
ok 85 branches_init creates file with empty bindings array
ok 86 branches_init is idempotent
ok 87 branches_bind creates a new binding
ok 88 branches_bind requires epic_id
ok 89 branches_bind prevents duplicate epic bindings
ok 90 branches_bind prevents duplicate branch bindings
ok 91 branches_bind sets correct metadata fields
ok 92 branches_get_branch returns branch for epic
ok 93 branches_get_branch returns empty for unknown epic
ok 94 branches_get_epic returns epic for branch
ok 95 branches_get_epic returns empty for unknown branch
ok 96 branches_list returns empty array when no bindings
ok 97 branches_list returns all bindings
ok 98 branches_unbind removes a binding
ok 99 branches_unbind handles non-existent binding gracefully
ok 100 branches_unbind requires epic_id
ok 101 branches_update_pr sets PR number
ok 102 branches_update_pr clears PR number with null
ok 103 branches_update_pr fails for non-existent binding
ok 104 branches_update_status changes status
ok 105 branches_update_status sets merged flag when status is merged
ok 106 branches_by_status filters by status
ok 107 branches reads and writes YAML correctly
ok 108 branches handles special characters in branch names
ok 109 branches handles forward slashes in branch names
ok 110 budget_init sets limit correctly
ok 111 budget_init resets usage to zero
ok 112 budget_init fails without limit parameter
ok 113 budget_init fails with non-numeric limit
ok 114 budget_init accepts zero as limit
ok 115 budget_record accumulates usage
ok 116 budget_record fails without tokens parameter
ok 117 budget_record fails with non-numeric tokens
ok 118 budget_record accepts zero tokens
ok 119 budget_check returns 0 when within budget
ok 120 budget_check returns 1 when over budget
ok 121 budget_check returns 0 when exactly at budget
ok 122 budget_check fails if budget not initialized
ok 123 budget_remaining shows correct value
ok 124 budget_remaining shows negative when over budget
ok 125 budget_remaining shows full budget when no usage
ok 126 budget_remaining fails if budget not initialized
ok 127 full budget lifecycle within budget
ok 128 full budget lifecycle exceeding budget
ok 129 budget re-initialization clears previous state
ok 130 ACCEPTANCE: budget_init sets limit correctly
ok 131 ACCEPTANCE: budget_record accumulates usage
ok 132 ACCEPTANCE: budget_check returns 1 when over
ok 133 ACCEPTANCE: budget_remaining shows correct value
ok 134 budget_check_warning returns 0 when budget not initialized
ok 135 budget_check_warning does nothing when under threshold
ok 136 budget_check_warning sets flag when at threshold
ok 137 budget_check_warning sets flag when over threshold
ok 138 budget_check_warning only warns once
ok 139 budget_check_warning uses custom threshold
ok 140 ACCEPTANCE: budget_check_warning shows only once per run
ok 141 budget_set_max_task_iterations sets limit correctly
ok 142 budget_set_max_task_iterations fails without parameter
ok 143 budget_set_max_task_iterations fails with non-numeric value
ok 144 budget_set_max_run_iterations sets limit correctly
ok 145 budget_set_max_run_iterations fails without parameter
ok 146 budget_set_max_run_iterations fails with non-numeric value
ok 147 budget_get_task_iterations returns 0 for new task
ok 148 budget_get_task_iterations fails without task_id
ok 149 budget_get_run_iterations returns 0 initially
ok 150 budget_increment_task_iterations increments counter
ok 151 budget_increment_task_iterations fails without task_id
ok 152 budget_increment_task_iterations tracks multiple tasks separately
ok 153 budget_increment_run_iterations increments counter
ok 154 budget_get_max_task_iterations returns default of 3
ok 155 budget_get_max_run_iterations returns default of 50
ok 156 budget_check_task_iterations returns 0 when within limit
ok 157 budget_check_task_iterations returns 1 when over limit
ok 158 budget_check_task_iterations returns 0 when exactly at limit
ok 159 budget_check_task_iterations fails without task_id
ok 160 budget_check_run_iterations returns 0 when within limit
ok 161 budget_check_run_iterations returns 1 when over limit
ok 162 budget_check_run_iterations returns 0 when exactly at limit
ok 163 budget_clear resets iteration counters
ok 164 task_id with special characters is handled safely
ok 165 ACCEPTANCE: iteration counters track per-task
ok 166 ACCEPTANCE: iteration counters track per-run
ok 167 ACCEPTANCE: config options for max iterations
ok 168 ACCEPTANCE: defaults are 3 per task and 50 per run
ok 169 ACCEPTANCE: counters persist across function calls
ok 170 budget_increment_task_iteration (singular) works
ok 171 budget_increment_run_iteration (singular) works
ok 172 budget_reset_task_iterations resets counter to zero
ok 173 budget_reset_task_iterations fails without task_id
ok 174 budget_reset_task_iterations allows retry after reset
ok 175 budget_check_task_iteration_warning returns 0 when under threshold
ok 176 budget_check_task_iteration_warning returns 1 when at threshold
ok 177 budget_check_task_iteration_warning returns 1 when over threshold
ok 178 budget_check_task_iteration_warning uses custom threshold
ok 179 budget_check_task_iteration_warning fails without task_id
ok 180 budget_check_run_iteration_warning returns 0 when under threshold
ok 181 budget_check_run_iteration_warning returns 1 when at threshold
ok 182 budget_check_run_iteration_warning returns 1 when over threshold
ok 183 budget_check_run_iteration_warning uses custom threshold
ok 184 ACCEPTANCE: Increment functions update counters correctly
ok 185 ACCEPTANCE: Check functions return correct status
ok 186 ACCEPTANCE: Warning logged at 80% of limit
ok 187 ACCEPTANCE: Reset function clears task counter
ok 188 ACCEPTANCE: Functions work together correctly
ok 189 cub version subcommand works
ok 190 cub init subcommand creates project structure
ok 191 cub status subcommand shows task summary
ok 192 cub run subcommand with --once flag
ok 193 cub run subcommand with --ready flag
ok 194 cub run subcommand with --plan flag
ok 195 cub explain subcommand shows task details
ok 196 cub artifacts subcommand lists recent tasks
ok 197 cub --help shows main help
ok 198 cub help subcommand shows main help
ok 199 cub -h shows main help
ok 200 cub init --help shows init-specific help
ok 201 cub init -h shows init-specific help
ok 202 cub run --help shows run-specific help
ok 203 cub run -h shows run-specific help
ok 204 cub status --help shows status-specific help
ok 205 cub explain --help shows explain-specific help
ok 206 cub artifacts --help shows artifacts-specific help
ok 207 cub --status shows deprecation warning
ok 208 cub --ready shows deprecation warning
ok 209 cub --once shows deprecation warning
ok 210 cub --plan shows deprecation warning
ok 211 cub -s shows deprecation warning
ok 212 cub -r shows deprecation warning
ok 213 cub -1 shows deprecation warning
ok 214 cub -p shows deprecation warning
ok 215 deprecation warnings can be suppressed
ok 216 cub with unknown subcommand shows error and help
ok 217 cub with unknown subcommand does not show error for flags
ok 218 legacy --status invocation still works
ok 219 legacy --ready invocation still works
ok 220 legacy --once invocation still works
ok 221 legacy -s short flag still works
ok 222 legacy -r short flag still works
ok 223 legacy --status --json combination still works
ok 224 cub run accepts --once flag
ok 225 cub run accepts --ready flag
ok 226 cub run accepts --plan flag
ok 227 cub run accepts --model flag
ok 228 cub run accepts --budget flag
ok 229 cub run accepts --epic flag
ok 230 cub run accepts --label flag
ok 231 cub run accepts --require-clean flag
ok 232 cub run accepts --no-require-clean flag
ok 233 cub run accepts --name flag
ok 234 cub status accepts --json flag
ok 235 cub accepts --debug flag globally
ok 236 cub accepts -d flag globally
ok 237 cub accepts --stream flag globally
ok 238 cub accepts --harness flag globally
ok 239 cub accepts --backend flag globally
ok 240 cub with no args defaults to run loop
ok 241 cub run with no flags defaults to continuous loop
ok 242 cub status with invalid flag shows error
ok 243 cub explain without task-id shows error
ok 244 cub init followed by cub status works
ok 245 mixing global and subcommand flags works
ok 246 multiple flags to run subcommand work
ok 247 config_get returns empty for nonexistent key
ok 248 config_get returns simple string value
ok 249 config_get returns number value
ok 250 config_get returns array value
ok 251 config_get returns boolean value
ok 252 config_get returns nested object value
ok 253 config_get_or returns value when key exists
ok 254 config_get_or returns fallback when key does not exist
ok 255 config_get_or returns fallback for empty config
ok 256 config_get_or works with numeric fallback
ok 257 project config overrides user config
ok 258 config_load works with only user config
ok 259 config_load works with only project config
ok 260 config_load works with no config files
ok 261 config is cached after first load
ok 262 config_clear_cache forces reload
ok 263 config_get handles invalid JSON gracefully
ok 264 config_get handles null values
ok 265 config_get handles deeply nested keys
ok 266 config_dump returns full config JSON
ok 267 acceptance: config_get 'harness.priority' returns array
ok 268 acceptance: config_get 'budget.default' returns number
ok 269 acceptance: config_get 'nonexistent' returns empty
ok 270 acceptance: config_get_or 'nonexistent' 'fallback' returns 'fallback'
ok 271 CUB_BUDGET env var overrides config budget
ok 272 CUB_BUDGET env var overrides project config budget
ok 273 CUB_BUDGET env var creates budget structure if not present
ok 274 config without CUB_BUDGET env var uses file values
ok 275 cub-init creates project structure
ok 276 cub-init creates valid prd.json
ok 277 cub-init can be run in custom directory
ok 278 cub --status shows task summary
ok 279 cub status shows task summary (subcommand)
ok 280 cub status --json outputs valid JSON
ok 281 cub --status --json outputs valid JSON (legacy)
ok 282 cub --ready lists ready tasks
ok 283 cub fails gracefully when no prd.json exists
ok 284 cub detects backend correctly
ok 285 cub selects highest priority ready task
ok 286 cub skips blocked tasks
ok 287 cub generates system prompt from .cub/prompt.md
ok 288 cub generates task prompt with all required fields
ok 289 cub updates task status correctly
ok 290 cub adds notes to tasks
ok 291 cub detects when all tasks are complete
ok 292 cub detects incomplete tasks
ok 293 cub --debug flag is recognized
ok 294 cub --once flag is recognized
ok 295 cub respects CUB_BACKEND environment variable
ok 296 cub --backend flag overrides auto-detection
ok 297 cub handles corrupted prd.json gracefully
ok 298 cub handles missing harness gracefully
ok 299 detect_dependencies_from_content detects 'depends on' pattern
ok 300 detect_dependencies_from_content detects 'depends on' with task ID
ok 301 detect_dependencies_from_content detects 'blocked by' pattern
ok 302 detect_dependencies_from_content detects 'requires' pattern
ok 303 detect_dependencies_from_content detects 'after' pattern
ok 304 detect_dependencies_from_content detects 'once' pattern
ok 305 detect_dependencies_from_content detects 'before' pattern
ok 306 detect_dependencies_from_content detects multiple dependencies
ok 307 detect_dependencies_from_content is case-insensitive
ok 308 detect_dependencies_from_content returns 1 when no dependencies found
ok 309 detect_dependencies_from_content returns 1 for empty content
ok 310 detect_dependencies_from_content detects numbered sequence dependencies
ok 311 detect_dependencies_from_content extracts task names from numbered list
ok 312 infer_blocking_relationships detects blocking from 'depends on'
ok 313 infer_blocking_relationships detects blocking from 'blocked by'
ok 314 infer_blocking_relationships returns empty for independent task
ok 315 _has_dependency_signals detects 'depends on' signal
ok 316 _has_dependency_signals detects 'blocked by' signal
ok 317 _has_dependency_signals detects 'requires' signal
ok 318 _has_dependency_signals returns 1 when no signals
ok 319 _has_dependency_signals is case-insensitive
ok 320 _has_numbered_sequence detects numbered list
ok 321 _has_numbered_sequence detects alternative format
ok 322 _has_numbered_sequence returns 1 for non-numbered content
ok 323 get_dependency_description formats blocks relationship
ok 324 get_dependency_description formats requires relationship
ok 325 get_dependency_description formats precedes relationship
ok 326 validate_dependency_references accepts valid dependencies
ok 327 validate_dependency_references rejects invalid dependencies
ok 328 validate_dependency_references accepts empty dependencies
ok 329 validate_dependency_references handles arrow syntax
ok 330 extract_task_names identifies task-like identifiers
ok 331 extract_task_names filters short identifiers
ok 332 detect_dependencies handles complex task description
ok 333 detect_dependencies handles GitHub issue format
ok 334 detect_dependencies handles feature request format
ok 335 detect_dependencies ignores content without dependencies
ok 336 detect_dependencies handles hyphenated and underscored identifiers
ok 337 git_categorize_file returns 'session' for progress.txt
ok 338 git_categorize_file returns 'session' for fix_plan.md
ok 339 git_categorize_file returns 'cruft' for .DS_Store
ok 340 git_categorize_file returns 'cruft' for .bak files
ok 341 git_categorize_file returns 'cruft' for .tmp files
ok 342 git_categorize_file returns 'cruft' for __pycache__
ok 343 git_categorize_file returns 'source' for .ts files
ok 344 git_categorize_file returns 'source' for .py files
ok 345 git_categorize_file returns 'source' for .sh files
ok 346 git_categorize_file returns 'source' for .md files (not session)
ok 347 git_categorize_file returns 'config' for .env files
ok 348 git_categorize_file returns 'config' for .env.local
ok 349 git_categorize_file returns 'unknown' for unrecognized files
ok 350 git_categorize_changes returns empty categories when repo is clean
ok 351 git_categorize_changes categorizes session files correctly
ok 352 git_categorize_changes categorizes source files correctly
ok 353 git_categorize_changes categorizes cruft files correctly
ok 354 git_categorize_changes handles multiple files in different categories
ok 355 git_categorize_changes excludes .cub directory
ok 356 git_categorize_changes excludes .beads directory
ok 357 git_list_changes_with_status returns empty for clean repo
ok 358 git_list_changes_with_status includes modified files
ok 359 git_list_changes_with_status includes untracked files
ok 360 _doctor_validate_json accepts valid JSON
ok 361 _doctor_validate_json rejects invalid JSON
ok 362 _doctor_validate_json accepts empty object
ok 363 _doctor_validate_json accepts arrays
ok 364 _doctor_check_deprecated_options detects deprecated fields
ok 365 _doctor_check_deprecated_options passes clean config
ok 366 _doctor_check_deprecated_options finds single deprecated option
ok 367 _doctor_check_required_fields detects missing fields
ok 368 _doctor_check_required_fields passes with all required fields
ok 369 _doctor_check_symlinks detects valid symlink CLAUDE.md
ok 370 _doctor_check_symlinks detects broken symlink
ok 371 _doctor_check_symlinks detects regular file instead of symlink
ok 372 _doctor_check_symlinks validates all required symlinks
ok 373 _doctor_check_gitignore detects missing .gitignore
ok 374 _doctor_check_gitignore detects missing patterns
ok 375 _doctor_check_gitignore validates complete gitignore
ok 376 _doctor_check_gitignore handles patterns with leading whitespace
ok 377 e2e test script exists and is executable
ok 378 e2e test project has required files
ok 379 e2e test hooks are executable
ok 380 e2e prd.json is valid JSON
ok 381 e2e prd.json contains test tasks
ok 382 e2e config enables hooks
ok 383 e2e README exists and contains usage instructions
ok 384 e2e test runs in simulation mode without API key
ok 385 e2e test cleanup removes generated files
ok 386 AC: e2e test verifies full loop execution
ok 387 AC: e2e test can run in CI without API key
ok 388 AC: e2e test verifies budget enforcement
ok 389 AC: e2e test verifies all hook types
ok 390 AC: e2e test includes documentation
ok 391 json_get_ready_tasks handles missing prd.json gracefully
ok 392 json_get_task handles missing prd.json gracefully
ok 393 validate_prd handles missing file
ok 394 validate_prd handles malformed JSON
ok 395 json_update_task_status handles read-only directory
ok 396 json_get_task handles empty task ID
ok 397 json_update_task_status handles nonexistent task ID
ok 398 json_add_task_note handles special characters in note
ok 399 json_create_task handles malformed JSON input
ok 400 json_get_ready_tasks handles circular dependencies
ok 401 json_get_blocked_tasks identifies all tasks in circular dependency
ok 402 harness_invoke returns error when harness command fails
ok 403 claude_parse_stream handles invalid JSON gracefully
ok 404 claude_parse_stream handles partial JSON stream
ok 405 harness_detect handles no harness installed
ok 406 json_get_ready_tasks handles empty tasks array
ok 407 json_get_ready_tasks handles tasks with empty dependsOn array
ok 408 json_get_task_counts handles missing status field
ok 409 generate_task_id handles missing prefix field
ok 410 json_update_task_status is atomic
ok 411 json_get_ready_tasks handles large task lists
ok 412 validate_prd handles deeply nested dependencies
ok 413 failure_get_mode returns default mode when not configured
ok 414 failure_get_mode returns configured mode from config
ok 415 failure_get_mode returns stop mode
ok 416 failure_get_mode returns move-on mode
ok 417 failure_get_mode returns retry mode
ok 418 failure_get_mode returns triage mode
ok 419 failure_set_mode sets stop mode
ok 420 failure_set_mode sets move-on mode
ok 421 failure_set_mode sets retry mode
ok 422 failure_set_mode sets triage mode
ok 423 failure_set_mode rejects invalid mode
ok 424 failure_set_mode requires mode parameter
ok 425 failure_set_mode validates allowed modes
ok 426 failure_handle_stop returns exit code 2 (halt signal)
ok 427 failure_handle_stop requires task_id parameter
ok 428 failure_handle_stop requires exit_code parameter
ok 429 failure_handle_stop accepts optional output parameter
ok 430 failure_handle_stop stores failure info
ok 431 failure_handle_stop stores correct failure mode in JSON
ok 432 failure_handle_move_on returns exit code 0 (continue signal)
ok 433 failure_handle_move_on requires task_id parameter
ok 434 failure_handle_move_on requires exit_code parameter
ok 435 failure_handle_move_on accepts optional output parameter
ok 436 failure_handle_move_on stores failure info
ok 437 failure_handle_move_on stores correct failure mode in JSON
ok 438 failure_store_info creates failure.json in task directory
ok 439 failure_store_info stores all required fields in JSON
ok 440 failure_store_info requires task_id parameter
ok 441 failure_store_info requires exit_code parameter
ok 442 failure_store_info handles missing artifacts directory gracefully
ok 443 failure_store_info handles missing task directory gracefully
ok 444 failure_store_info uses default mode 'unknown' when not specified
ok 445 failure_store_info timestamp is in ISO 8601 format
ok 446 stop mode creates failure.json with exit code 2
ok 447 move-on mode creates failure.json with exit code 0
ok 448 failure info includes task exit code correctly
ok 449 failure info includes output message
ok 450 AC: Stop mode halts run immediately (returns exit code 2)
ok 451 AC: Move-on mode marks task failed and continues (returns exit code 0)
ok 452 AC: Failure info stored for retrieval
ok 453 AC: Task artifacts updated with failure details
ok 454 AC: Exit codes distinguish stop vs continue
ok 455 failure_handle_retry returns exit code 3 (retry signal) when under limit
ok 456 failure_handle_retry increments task iteration counter
ok 458 failure_handle_retry requires task_id parameter
ok 459 failure_handle_retry requires exit_code parameter
ok 460 failure_handle_retry accepts optional output parameter
ok 461 failure_handle_retry stores failure info with retry mode
ok 463 failure_get_context returns formatted context with output
ok 464 failure_get_context returns formatted context without output
ok 465 failure_get_context requires task_id parameter
ok 466 failure_get_context handles missing artifacts directory gracefully
ok 467 failure_get_context handles missing task directory gracefully
ok 468 failure_get_context handles missing failure.json gracefully
ok 469 failure_get_context handles empty output correctly
ok 470 AC: Retry increments task iteration counter
ok 471 AC: Failure context available for prompt augmentation
ok 473 AC: Context format helpful for agent
ok 476 failure_handle_retry accepts task_title parameter
ok 477 git_in_repo returns 0 when in a git repository
ok 478 git_in_repo returns non-zero when not in a git repository
ok 479 git_get_current_branch returns current branch name
ok 480 git_get_current_branch returns new branch after checkout
ok 481 git_get_current_branch returns 1 when not in git repo
ok 482 git_is_clean returns 0 when repository is clean
ok 483 git_is_clean returns 1 when working tree has changes
ok 484 git_is_clean returns 1 when there are staged changes
ok 485 git_is_clean returns 1 when there are untracked files
ok 486 git_is_clean ignores .gitignore'd files
ok 487 git_init_run_branch creates branch with correct naming convention
ok 488 git_init_run_branch checks out the new branch
ok 489 git_init_run_branch stores branch name in global variable
ok 490 git_init_run_branch returns error when session_name is empty
ok 491 git_init_run_branch returns error when not in git repo
ok 492 git_init_run_branch handles existing branch gracefully
ok 493 git_init_run_branch works from any starting branch
ok 494 git_init_run_branch uses current timestamp
ok 495 git_get_run_branch returns branch name after initialization
ok 496 git_get_run_branch returns error when not initialized
ok 497 git_get_run_branch returns same branch as initialized
ok 498 INTEGRATION: Complete workflow - init branch, get branch, verify checkout
ok 499 INTEGRATION: Multiple sessions create different branches
ok 500 ACCEPTANCE: Branch created with correct naming convention
ok 501 ACCEPTANCE: Branch checked out after creation
ok 502 ACCEPTANCE: Handles existing branch gracefully
ok 503 ACCEPTANCE: git_get_run_branch returns current run branch
ok 504 ACCEPTANCE: Works from any starting branch
ok 505 git_commit_task creates commit with structured message
ok 506 git_commit_task includes summary in commit message
ok 507 git_commit_task stages all changes before committing
ok 508 git_commit_task returns success when nothing to commit
ok 509 git_commit_task returns error when task_id is missing
ok 510 git_commit_task returns error when task_title is missing
ok 511 git_commit_task returns error when not in git repo
ok 512 git_commit_task handles multiline summary
ok 513 git_commit_task commit message is parseable
ok 514 git_commit_task works with special characters in title
ok 515 git_commit_task works with special characters in summary
ok 516 ACCEPTANCE: Commit created with structured message format
ok 517 ACCEPTANCE: Task ID in commit title and trailer
ok 518 ACCEPTANCE: All changes staged before commit
ok 519 ACCEPTANCE: No-op if nothing to commit (not an error)
ok 520 ACCEPTANCE: Commit message parseable for task extraction
ok 521 git_has_changes returns 0 when there are uncommitted changes
ok 522 git_has_changes returns 1 when repository is clean
ok 523 git_has_changes detects new untracked files
ok 524 git_has_changes detects staged changes
ok 525 git_has_changes detects deleted files
ok 526 git_has_changes returns 1 when not in git repo
ok 527 git_stash_changes stashes working tree changes
ok 528 git_stash_changes stashes modified tracked files
ok 529 git_stash_changes handles clean repository gracefully
ok 530 git_stash_changes returns error when not in git repo
ok 531 git_stash_changes saves state for restoration
ok 532 git_unstash_changes restores stashed changes
ok 533 git_unstash_changes restores new files
ok 534 git_unstash_changes handles no stash gracefully
ok 535 git_unstash_changes returns error when not in git repo
ok 536 INTEGRATION: Stash and unstash workflow
ok 537 git_set_base_branch stores branch name
ok 538 git_get_base_branch returns stored branch name
ok 539 git_set_base_branch returns error when branch_name is empty
ok 540 git_get_base_branch returns error when not set
ok 541 git_set_base_branch allows any branch name
ok 542 INTEGRATION: Base branch tracking for PR workflow
ok 543 ACCEPTANCE: git_has_changes correctly detects changes
ok 544 ACCEPTANCE: git_stash_changes and git_unstash_changes work for temporary storage
ok 545 ACCEPTANCE: git_get_base_branch returns stored branch for PR creation
ok 546 ACCEPTANCE: Base branch tracked across run session
ok 547 git_push_branch returns error when not in git repo
ok 548 git_push_branch returns error when no remote configured
ok 549 git_push_branch returns error when cannot determine current branch
ok 550 git_push_branch pushes to origin when remote is configured
ok 551 git_push_branch sets upstream tracking
ok 552 git_push_branch --force requires confirmation
ok 553 git_push_branch --force succeeds with yes confirmation
ok 554 git_push_branch --force uses force-with-lease
ok 555 git_push_branch displays informative messages
ok 556 INTEGRATION: Complete push workflow
ok 557 ACCEPTANCE: git_push_branch pushes current branch to origin
ok 558 ACCEPTANCE: git_push_branch sets upstream tracking relationship
ok 559 ACCEPTANCE: git_push_branch --force requires explicit confirmation
ok 560 git_commit_session_files returns 0 when no session files exist
ok 561 git_commit_session_files returns 0 when session files are unchanged
ok 562 git_commit_session_files commits modified progress.txt
ok 563 git_commit_session_files commits modified fix_plan.md
ok 564 git_commit_session_files commits untracked progress.txt
ok 565 git_commit_session_files commits multiple session files
ok 566 git_commit_session_files ignores non-session files
ok 567 git_commit_session_files works without task_id
ok 568 ACCEPTANCE: Session files left behind by agent are auto-committed
ok 569 git_commit_remaining_changes returns 0 when no changes exist
ok 570 git_commit_remaining_changes commits modified files
ok 571 git_commit_remaining_changes commits untracked files
ok 572 git_commit_remaining_changes uses task_id and task_title in commit message
ok 573 git_commit_remaining_changes uses task_id only when no title
ok 574 git_commit_remaining_changes excludes .cub/ directory
ok 575 git_commit_remaining_changes excludes .beads/ directory
ok 576 git_commit_remaining_changes commits multiple files
ok 577 ACCEPTANCE: Agent completes task but forgets to commit - cub auto-commits
ok 578 guardrails_exists returns 1 when file doesn't exist
ok 579 guardrails_exists returns 0 when file exists
ok 580 guardrails_init creates .cub directory if missing
ok 581 guardrails_init creates guardrails file with template structure
ok 582 guardrails_init is idempotent
ok 583 guardrails_read returns empty string when file doesn't exist
ok 584 guardrails_read returns file content when it exists
ok 585 guardrails_add creates file if it doesn't exist
ok 586 guardrails_add appends lesson with timestamp
ok 587 guardrails_add appends lesson with task_id when provided
ok 588 guardrails_add returns 1 if lesson text is empty
ok 589 guardrails_add_from_failure formats error information
ok 590 guardrails_add_from_failure uses error_summary as lesson if not provided
ok 591 guardrails_size_kb returns 0 if file doesn't exist
ok 592 guardrails_size_kb returns positive KB value for existing file
ok 593 guardrails_count returns 0 if file doesn't exist
ok 594 guardrails_count counts dated lesson entries
ok 595 guardrails_check_size returns 0 when under limit
ok 596 guardrails_check_size returns 1 when over limit
ok 597 guardrails_clear creates backup before clearing
ok 598 guardrails_clear reinitializes with empty content
ok 599 guardrails_import requires source file
ok 600 guardrails_import fails if source doesn't exist
ok 601 guardrails_import adds lessons from source file
ok 602 guardrails_export copies file to destination
ok 603 guardrails_export fails without source file
ok 604 guardrails_for_prompt returns empty if file doesn't exist
ok 605 guardrails_for_prompt includes header and content
ok 606 guardrails_get_file returns correct path
ok 607 guardrails_search finds matching content
ok 608 guardrails_search is case-insensitive
ok 609 guardrails_search returns empty for no matches
ok 610 guardrails_list_json returns empty array if file doesn't exist
ok 611 guardrails_list_json parses lessons to JSON array
ok 612 guardrails_list_json extracts date from lesson header
ok 613 guardrails_list_json extracts task_id when present
ok 614 guardrails_list_json sets task_id to null when not present
ok 615 guardrails works with custom project directory
ok 616 guardrails respects PROJECT_DIR environment variable
ok 617 guardrails_extract_lesson_ai requires task_id
ok 618 guardrails_extract_lesson_ai requires task_title
ok 619 guardrails_extract_lesson_ai requires error_summary
ok 620 guardrails_extract_lesson_ai returns fallback when claude unavailable
ok 621 guardrails_learn_from_failure requires task_id
ok 622 guardrails_learn_from_failure requires task_title
ok 623 guardrails_learn_from_failure requires exit_code
ok 624 guardrails_learn_from_failure requires error_summary
ok 625 guardrails_learn_from_failure adds lesson to file
ok 626 guardrails_learn_from_failure creates lesson with timestamp
ok 627 guardrails_warn_size_if_exceeded outputs nothing when under limit
ok 628 guardrails_warn_size_if_exceeded warns when over limit
ok 629 guardrails_warn_size_if_exceeded shows lesson count
ok 630 guardrails_add calls warn function after adding
ok 631 guardrails_add_from_failure calls warn function after adding
ok 632 harness_detect respects explicit HARNESS setting
ok 633 harness_detect ignores HARNESS=auto
ok 634 harness_get caches detected harness
ok 635 harness_available returns true when specified harness exists
ok 636 harness_available returns false when specified harness missing
ok 637 harness_version returns value for installed harness
ok 638 claude_parse_stream extracts text from assistant message
ok 639 claude_parse_stream handles content_block_delta text
ok 640 claude_parse_stream skips empty lines gracefully
ok 641 claude_parse_stream handles result messages
ok 642 claude_parse_stream shows tool use in content_block_start
ok 643 harness_invoke dispatches to correct harness
ok 644 harness_invoke_streaming fails gracefully for unknown harness
ok 645 CLAUDE_FLAGS environment variable is accessible
ok 646 CODEX_FLAGS environment variable is accessible
ok 647 harness_detect finds claude when installed
ok 648 harness_available returns true for any installed harness
ok 649 harness_clear_usage clears all usage state
ok 650 harness_get_usage returns JSON with correct structure
ok 651 harness_get_usage handles no usage data gracefully
ok 652 harness_get_total_tokens returns sum of input and output
ok 653 claude_parse_stream extracts usage from message events
ok 654 claude_parse_stream captures cost from result events
ok 655 claude_parse_stream accumulates usage from multiple messages
ok 656 harness_get_usage estimates tokens from cost when usage unavailable
ok 657 ACCEPTANCE: Token count extracted from Claude streaming output
ok 658 ACCEPTANCE: Tokens returned in structured format
ok 659 ACCEPTANCE: Fallback to estimate if not available
ok 660 ACCEPTANCE: Works with streaming mode via claude_parse_stream
ok 661 harness_supports returns success for supported capability
ok 663 harness_supports requires capability argument
ok 664 harness_supports uses current harness when not specified
ok 665 _harness_get_capabilities returns correct capabilities for claude
ok 666 _harness_get_capabilities returns correct capabilities for opencode
ok 667 _harness_get_capabilities returns correct capabilities for codex
ok 668 _harness_get_capabilities returns correct capabilities for gemini
ok 669 _harness_get_capabilities returns empty for unknown harness
ok 670 harness_get_capabilities_json returns valid JSON for claude
ok 672 capability constants are defined
ok 674 ACCEPTANCE: Can query if harness reports tokens
ok 675 ACCEPTANCE: All known harnesses have auto_mode capability
ok 677 harness_detect respects config harness.priority array
ok 678 harness_detect tries each priority in order until found
ok 679 harness_detect falls back to default order if no config priority
ok 680 harness_detect falls back to default if all priorities unavailable
ok 681 harness_detect prefers explicit HARNESS over config priority
ok 682 harness_detect accepts HARNESS=auto and ignores to use config/default
ok 683 config priority can specify gemini, opencode, codex, claude
ok 684 ACCEPTANCE: Config priority respected - can configure preferred harness order
ok 685 ACCEPTANCE: Falls through list until one is available
ok 686 ACCEPTANCE: Default priority if not configured
ok 687 _get_stdbuf_cmd returns stdbuf if available
ok 688 _get_stdbuf_cmd returns gstdbuf if stdbuf not available
ok 689 _get_stdbuf_cmd returns empty if neither available
ok 690 ACCEPTANCE: Streaming uses stdbuf when available for output buffering
ok 691 hooks_run with no scripts returns success
ok 692 hooks_run executes script in global directory
ok 693 hooks_run executes script in project directory
ok 694 hooks_run executes scripts in sorted order
ok 695 hooks_run exports CUB_HOOK_NAME
ok 696 hooks_run exports CUB_PROJECT_DIR
ok 697 hooks_set_task_context exports task variables
ok 698 hooks_set_task_context exports exit code
ok 699 hooks_set_session_context exports session variables
ok 700 hooks_run passes arguments to scripts
ok 701 hook failure logged but doesn't stop execution when fail_fast is false
ok 702 hook failure stops execution when fail_fast is true
ok 703 hooks_run requires hook_name parameter
ok 704 non-executable files are skipped
ok 705 both global and project hooks are executed
ok 706 hook output captured and displayed
ok 707 hooks_clear_context clears environment variables
ok 708 hooks_find with no scripts returns empty
ok 709 hooks_find finds scripts in global directory
ok 710 hooks_find finds scripts in project directory
ok 711 hooks_find returns scripts in sorted order
ok 712 hooks_find only returns executable files
ok 713 hooks_find returns both global and project scripts
ok 714 hooks_find merges global and project hooks in sorted order (global first)
ok 715 hooks_find requires hook_name parameter
ok 716 AC: hooks_run executes all scripts in pre-task.d/
ok 717 AC: scripts receive context via environment vars
ok 718 AC: hook failure logged but doesn't stop loop when configurable
ok 719 AC: scripts run in sorted order (01-first.sh before 02-second.sh)
ok 720 AC: hooks_find finds hooks in global directory
ok 721 AC: hooks_find finds hooks in project directory
ok 722 AC: hooks_find merges both global and project (global first)
ok 723 AC: hooks_find only returns executable files
ok 724 claude can respond to simple prompt
ok 725 claude_invoke handles authentication errors gracefully
ok 726 claude_parse_stream handles real Claude stream-json output
ok 727 harness_invoke handles network errors
ok 728 harness_invoke handles command not found
ok 729 harness_invoke handles very long prompts
ok 730 harness can be retried after failure
ok 731 harness respects CLAUDE_FLAGS from environment
ok 732 claude_parse_stream preserves line breaks in output
ok 733 claude_parse_stream handles UTF-8 characters
ok 734 multiple harness invocations can run concurrently
ok 735 interview_filter_questions filters by task type
ok 736 interview_filter_questions filters by task labels
ok 737 interview_filter_questions filters out questions without matching labels
ok 738 interview_detect_tech_stack detects bash projects
ok 739 interview_detect_tech_stack detects nodejs projects
ok 740 interview_detect_tech_stack detects python projects
ok 741 interview_should_skip_question returns 1 when no skip condition
ok 742 interview_should_skip_question skips when condition matches
ok 743 interview_should_skip_question does not skip when condition does not match
ok 744 interview_should_skip_question handles case-insensitive matching
ok 745 interview_load_questions returns valid JSON
ok 746 interview_load_questions has required fields
ok 747 interview filtering combines task type and labels correctly
ok 748 interview_gather_codebase_context detects bash project
ok 749 interview_gather_codebase_context detects nodejs project
ok 750 interview_gather_codebase_context detects test directory
ok 751 interview_gather_codebase_context detects docker compose
ok 752 interview_gather_codebase_context limits file list
ok 753 interview_generate_spec includes mode in output
ok 754 interview_generate_spec defaults to interactive mode
ok 755 interview_extract_acceptance_criteria extracts from success criteria
ok 756 interview_extract_acceptance_criteria extracts from testing questions
ok 757 interview_extract_acceptance_criteria extracts from error handling
ok 758 interview_extract_acceptance_criteria extracts from validation rules
ok 759 interview_extract_acceptance_criteria extracts from output requirements
ok 760 interview_extract_acceptance_criteria handles bulleted lists
ok 761 interview_extract_acceptance_criteria handles numbered lists
ok 762 interview_extract_acceptance_criteria skips N/A answers
ok 763 interview_extract_acceptance_criteria combines multiple sources
ok 764 interview_extract_acceptance_criteria provides fallback criteria
ok 765 interview_extract_acceptance_criteria uses primary goal as fallback
ok 766 interview_load_custom_questions returns empty array when no config exists
ok 767 interview_load_custom_questions loads custom questions from .cub.json
ok 768 interview_merge_questions combines built-in and custom questions
ok 769 interview_merge_questions handles empty custom questions
ok 770 custom questions are included in filtering by task type
ok 771 custom questions support requires_labels filtering
ok 772 interview_load_skip_categories returns empty string when no config
ok 773 interview_load_skip_categories loads from .cub.json
ok 774 interview_load_skip_categories returns empty when skip_categories is empty array
ok 775 interview_load_skip_categories handles missing interview section
ok 776 skip_categories filter excludes specified categories
ok 777 skip_categories filter handles multiple categories
ok 778 skip_categories filter preserves non-skipped categories
ok 779 parse_json_file with simple array format - basic task
ok 780 parse_json_file with simple array format - multiple tasks
ok 781 parse_json_file with simple array format - tasks with dependencies
ok 782 parse_json_file with simple array format - optional fields
ok 783 parse_json_file with simple array format - auto-generated IDs
ok 784 parse_json_file with simple array format - default status
ok 785 parse_json_file with structured PRD format - single feature
ok 786 parse_json_file with structured PRD format - features with tasks
ok 787 parse_json_file with structured PRD format - feature dependencies
ok 788 parse_json_file with structured PRD format - auto-generated feature IDs
ok 789 parse_json_file with structured PRD format - feature with optional fields
ok 790 parse_json_file returns error for missing file
ok 791 parse_json_file returns error for invalid JSON
ok 792 parse_json_file returns error for missing tasks and features
ok 793 parse_json_file returns error for non-array tasks
ok 794 parse_json_file returns error for duplicate task IDs
ok 795 parse_json_file detects circular dependencies
ok 796 extract_tasks returns only tasks array
ok 797 count_items returns correct count
ok 798 format_parsed_json produces formatted output
ok 799 json parser output compatible with markdown parser structure
ok 800 complex PRD import scenario
ok 801 logger_init creates log directory structure
ok 802 logger_init creates log file
ok 803 logger_init sets _LOG_FILE variable
ok 804 logger_init fails without project_name
ok 805 logger_init fails without session_id
ok 806 logger_init creates nested project directories
ok 807 logger_write silently skips if logger not initialized
ok 808 logger_write fails without event_type
ok 809 logger_write creates valid JSON line
ok 810 logger_write includes timestamp in ISO 8601 format
ok 811 logger_write includes event_type field
ok 812 logger_write includes data field
ok 813 logger_write handles empty data (defaults to {})
ok 814 logger_write appends multiple entries
ok 815 logger_write preserves existing log entries
ok 816 logger_write handles complex nested JSON data
ok 817 logger_get_file returns empty string when not initialized
ok 818 logger_get_file returns correct path after init
ok 819 logger_clear resets logger state
ok 820 full logger workflow: init, write multiple events, verify output
ok 821 acceptance: log file created at correct XDG path
ok 822 acceptance: each line is valid JSON
ok 823 acceptance: timestamps in ISO 8601 format
ok 824 acceptance: log file is append-only
ok 825 log_task_start creates task_start event with all metadata
ok 826 log_task_start fails without task_id
ok 827 log_task_start fails without task_title
ok 828 log_task_start fails without harness
ok 829 log_task_start handles special characters in title
ok 830 log_task_end creates task_end event with all metadata
ok 831 log_task_end captures current git SHA
ok 832 log_task_end defaults tokens_used to 0 when omitted
ok 833 log_task_end fails without task_id
ok 834 log_task_end fails without exit_code
ok 835 log_task_end fails without duration_sec
ok 836 log_task_end handles non-zero exit codes
ok 837 log_error creates error event with message
ok 838 log_error includes context when provided
ok 839 log_error fails without message
ok 840 log_error fails with invalid JSON context
ok 841 log_error handles complex context objects
ok 842 integration: full task lifecycle logging
ok 843 integration: task with error logging
ok 844 acceptance: task_start event logged with task_id, title, harness
ok 845 acceptance: task_end event logged with duration, exit_code, tokens, git_sha
ok 846 acceptance: errors logged with context
ok 847 logger_redact redacts api_key values
ok 848 logger_redact redacts API_KEY (uppercase) values
ok 849 logger_redact redacts token values
ok 850 logger_redact redacts secret values
ok 851 logger_redact redacts password values
ok 852 logger_redact redacts Bearer tokens
ok 853 logger_redact redacts private_key values
ok 854 logger_redact redacts access_token values
ok 855 logger_redact redacts client_secret values
ok 856 logger_redact preserves key names for context
ok 857 logger_redact handles multiple secrets in one string
ok 858 logger_redact handles different separators (equals, colon, space)
ok 859 logger_redact does not redact common words
ok 860 logger_redact returns original string if no secrets found
ok 861 logger_redact handles empty string
ok 862 logger_write automatically redacts secrets
ok 863 logger_write redacts secrets in nested JSON
ok 864 logger_redact uses custom patterns from config
ok 865 acceptance: common secret patterns detected and redacted
ok 866 acceptance: redaction replaces value with [REDACTED]
ok 867 acceptance: logger_write applies redaction automatically
ok 868 acceptance: no false positives on common words
ok 869 acceptance: no false positives on JSON field names
ok 870 logger_stream outputs message with timestamp to stdout
ok 871 logger_stream applies secret redaction
ok 872 logger_stream supports custom timestamp format
ok 873 logger_stream returns 0 on success
ok 874 logger_stream handles empty message gracefully
ok 875 logger_stream outputs to stdout not stderr
ok 876 logger_stream works with special characters
ok 877 logger_stream multiple secrets redacted
ok 878 logger_stream with Bearer token redaction
ok 879 acceptance: logger_stream outputs with timestamp prefix
ok 880 acceptance: logger_stream applies secret redaction before output
ok 881 acceptance: logger_stream outputs to stdout
ok 882 acceptance: logger_stream timestamp format HH:MM:SS
ok 883 markdown: parse H1 heading as epic
ok 884 markdown: parse multiple H1 headings as epics
ok 885 markdown: parse H2 subheading as task group
ok 886 markdown: parse checkbox as task
ok 887 markdown: parse bullets as acceptance criteria
ok 888 markdown: parse complex nested structure
ok 889 markdown: return error for non-existent file
ok 890 markdown: handle empty markdown file
ok 891 markdown: handle file with no markdown structure
ok 892 markdown: extract_epics returns only epics
ok 893 markdown: extract_tasks returns all tasks and features
ok 894 markdown: count_items returns total count
ok 895 markdown: parse checkboxes with different formats
ok 896 markdown: preserve line numbers for source references
ok 897 markdown: handle mixed content correctly
ok 898 markdown: output valid JSON
ok 899 markdown: multiple checkboxes under one feature
ok 900 markdown: acceptance criteria only on checkbox tasks, not features
ok 901 migrate-layout shows help with --help
ok 902 migrate-layout shows help with -h
ok 903 migrate-layout shows help with help
ok 904 migrate-layout handles unknown options
ok 905 migrate-layout --dry-run shows files to migrate without making changes
ok 906 migrate-layout --dry-run with no legacy files
ok 907 migrate-layout migrates PROMPT.md
ok 908 migrate-layout migrates AGENT.md
ok 909 migrate-layout migrates CLAUDE.md to agent.md
ok 910 migrate-layout prefers AGENT.md over CLAUDE.md
ok 911 migrate-layout migrates progress.txt
ok 912 migrate-layout prefers progress.txt over @progress.txt
ok 913 migrate-layout migrates @progress.txt when progress.txt missing
ok 914 migrate-layout migrates fix_plan.md
ok 915 migrate-layout migrates prd.json
ok 916 migrate-layout migrates .cub.json
ok 917 migrate-layout creates backwards-compatibility symlinks
ok 918 migrate-layout handles symlinks in source layout
ok 919 migrate-layout with no legacy files returns success
ok 920 migrate-layout migrates all files at once
ok 921 migrate-layout idempotent - run twice without error
ok 922 migrate-layout preserves file contents
ok 923 pipeline: new_session_id generates valid session ID format
ok 924 pipeline: new_session_id uses provided project name
ok 928 pipeline: session_exists returns false for non-existing session
ok 936 pipeline: find_vision finds explicit path
ok 937 pipeline: find_vision finds VISION.md in project root
ok 938 pipeline: find_vision finds docs/PRD.md
ok 939 pipeline: find_vision falls back to README.md
ok 940 pipeline: find_vision returns error when no document found
ok 941 pipeline: find_vision priority: VISION.md over docs/PRD.md
ok 942 pipeline: triage --help shows usage
ok 945 pipeline: architect --help shows usage
ok 947 pipeline: plan --help shows usage
ok 950 pipeline: bootstrap --help shows usage
ok 953 pipeline: sessions list shows no sessions when empty
ok 956 pipeline: sessions delete fails for non-existent session
ok 957 pipeline: validate --help shows usage
ok 958 pipeline: validate fails without .beads directory
ok 961 session_random_name returns a valid animal name
ok 962 session_random_name returns different names (high probability)
ok 963 session_random_name only returns values from ANIMAL_NAMES
ok 964 session_init with no args initializes with random name
ok 965 session_init with no args generates valid session ID format
ok 966 session_init --name custom sets custom name
ok 967 session_init --name creates ID with custom name
ok 968 session_init sets ISO 8601 timestamp in UTC
ok 969 session_init fails with invalid option
ok 970 session_init can be called multiple times (overwrites state)
ok 971 session_get_name returns the session name after init
ok 972 session_get_name fails before initialization
ok 973 session_get_name returns random name after init without --name
ok 974 session_get_id returns the session ID after init
ok 975 session_get_id fails before initialization
ok 976 session_get_id contains timestamp in YYYYMMDD-HHMMSS format
ok 977 session_get_run_id returns same as session_get_id
ok 978 session_get_run_id fails before initialization
ok 979 session_is_initialized returns false before init
ok 980 session_is_initialized returns true after init
ok 981 session_is_initialized returns true after init with --name
ok 982 session_is_initialized returns false after manual reset
ok 983 integration: full session lifecycle
ok 984 integration: custom named session
ok 985 integration: session isolation between inits
ok 986 error: calling getters before init produces consistent errors
ok 987 error: multiple --name options (last one wins)
ok 988 acceptance: session_random_name returns valid animal
ok 989 acceptance: session_init with no args works
ok 990 acceptance: session_init --name custom works
ok 991 acceptance: session_get_* functions return expected formats
ok 992 acceptance: calling getters before init fails
ok 993 acceptance: session timestamp is in ISO 8601 UTC format
ok 994 acceptance: session ID includes timestamp
ok 995 state_is_clean returns 0 when repository is clean
ok 996 state_is_clean returns 1 when working tree has changes
ok 997 state_is_clean returns 1 when there are staged changes
ok 998 state_is_clean returns 1 when there are untracked files
ok 999 state_is_clean returns 0 after committing changes
ok 1000 state_is_clean ignores .gitignore'd files
ok 1001 state_is_clean detects deleted files
ok 1002 state_ensure_clean returns 0 when clean and require_commit=true
ok 1003 state_ensure_clean returns 1 when dirty and require_commit=true
ok 1004 state_ensure_clean shows error message when dirty and require_commit=true
ok 1005 state_ensure_clean returns 0 when clean and require_commit=false
ok 1006 state_ensure_clean shows warning when dirty and require_commit=false
ok 1007 state_ensure_clean defaults to require_commit=true when config missing
ok 1008 ACCEPTANCE: Detects uncommitted changes after harness run
ok 1009 ACCEPTANCE: Respects clean_state.require_commit config
ok 1010 ACCEPTANCE: Clear error message pointing to uncommitted files
ok 1011 state_ensure_clean handles multiple types of changes
ok 1012 state_ensure_clean provides helpful guidance in error message
ok 1013 state_detect_test_command detects npm test from package.json
ok 1014 state_detect_test_command prefers yarn when yarn.lock exists
ok 1015 state_detect_test_command returns 1 when package.json has no test script
ok 1016 state_detect_test_command detects make test from Makefile
ok 1017 state_detect_test_command detects pytest from pytest.ini
ok 1018 state_detect_test_command detects pytest from tests directory
ok 1019 state_detect_test_command detects go test from go.mod
ok 1020 state_detect_test_command detects cargo test from Cargo.toml
ok 1021 state_detect_test_command returns 1 when no test command detected
ok 1022 state_run_tests returns 0 when require_tests=false
ok 1023 state_run_tests returns 0 when config missing (defaults to false)
ok 1024 state_run_tests runs tests when require_tests=true and package.json exists
ok 1025 state_run_tests fails when tests fail and require_tests=true
ok 1026 state_run_tests warns when no test command detected and require_tests=true
ok 1027 state_run_tests detects and runs make test
ok 1028 state_run_tests provides helpful error message on test failure
ok 1029 ACCEPTANCE: Detects test command for npm projects
ok 1030 ACCEPTANCE: Detects test command for yarn projects
ok 1031 ACCEPTANCE: Detects test command for make projects
ok 1032 ACCEPTANCE: Detects test command for pytest projects
ok 1033 ACCEPTANCE: Only runs tests if require_tests is true
ok 1034 ACCEPTANCE: Test failures logged clearly
ok 1035 ACCEPTANCE: Test output captured in logs
ok 1036 detect_backend returns json when prd.json exists
ok 1037 detect_backend defaults to json when no backend exists
ok 1038 detect_backend respects CUB_BACKEND=json
ok 1039 validate_prd succeeds with valid prd.json
ok 1040 validate_prd fails when tasks array is missing
ok 1041 validate_prd fails when tasks have missing required fields
ok 1042 validate_prd fails when duplicate task IDs exist
ok 1043 validate_prd fails when dependency references invalid task
ok 1044 json_get_ready_tasks returns open tasks without dependencies
ok 1045 json_get_ready_tasks excludes tasks with unsatisfied dependencies
ok 1046 json_get_ready_tasks returns tasks sorted by priority
ok 1047 json_get_ready_tasks returns empty array when all tasks closed
ok 1048 json_get_task returns task by ID
ok 1049 json_get_task returns empty for non-existent ID
ok 1050 json_update_task_status changes task status
ok 1051 json_update_task_status does not affect other tasks
ok 1052 json_add_task_note adds timestamped note
ok 1053 json_create_task adds new task to prd.json
ok 1054 json_get_task_counts returns correct counts
ok 1055 json_all_tasks_complete returns false when open tasks exist
ok 1056 json_all_tasks_complete returns true when all tasks closed
ok 1057 json_get_blocked_tasks returns tasks with unsatisfied dependencies
ok 1058 json_get_blocked_tasks returns empty when no blocked tasks
ok 1059 generate_task_id creates ID with prefix from prd.json
ok 1060 generate_task_id creates unique IDs
ok 1061 claim_task requires task_id parameter
ok 1062 claim_task requires session_name parameter
ok 1063 claim_task updates task status to in_progress for JSON backend
ok 1064 claim_task works with multiple tasks
ok 1065 verify_task_closed requires task_id parameter
ok 1066 verify_task_closed returns success for closed task
ok 1067 verify_task_closed returns failure for open task
ok 1068 verify_task_closed returns failure for in_progress task
ok 1069 verify_task_closed fails for non-existent prd file
ok 1070 auto_close_task requires task_id parameter
ok 1071 auto_close_task closes an open task
ok 1072 auto_close_task closes an in_progress task
ok 1073 auto_close_task succeeds silently for already closed task
ok 1074 auto_close_task only affects specified task
ok 1075 validate_task_completeness requires task_id parameter
ok 1076 validate_task_completeness returns error for non-existent task
ok 1077 validate_task_completeness reports missing title
ok 1078 validate_task_completeness reports title too short
ok 1079 validate_task_completeness accepts title with 10+ characters
ok 1080 validate_task_completeness reports missing description
ok 1081 validate_task_completeness reports missing acceptance criteria
ok 1082 validate_task_completeness accepts markdown checkboxes in description
ok 1083 validate_task_completeness accepts acceptanceCriteria field
ok 1084 validate_task_completeness returns all issues together
ok 1085 validate_task_completeness returns valid JSON
ok 1086 validate_all_tasks_completeness returns empty array for empty prd
ok 1087 validate_all_tasks_completeness validates all tasks
ok 1088 validate_all_tasks_completeness handles missing file
ok 1089 get_completeness_summary reports all complete
ok 1090 get_completeness_summary reports incomplete tasks
ok 1091 get_completeness_summary includes specific issues
ok 1092 validate_task_feasibility requires task_id parameter
ok 1093 validate_task_feasibility returns error for nonexistent task
ok 1094 validate_task_feasibility returns valid JSON structure
ok 1095 validate_task_feasibility marks task feasible with no issues
ok 1096 validate_task_feasibility detects closed dependency
ok 1097 validate_task_feasibility detects unclosed dependency
ok 1098 validate_task_feasibility detects multiple unclosed dependencies
ok 1099 validate_task_feasibility detects missing referenced file
ok 1100 validate_task_feasibility accepts existing referenced file (absolute path)
ok 1101 validate_task_feasibility handles relative paths with ./
ok 1102 validate_task_feasibility detects mixed issues
ok 1103 validate_all_tasks_feasibility returns empty array for empty prd
ok 1104 validate_all_tasks_feasibility validates all tasks
ok 1105 validate_all_tasks_feasibility handles missing file
ok 1106 get_feasibility_summary reports all feasible
ok 1107 get_feasibility_summary reports infeasible tasks
ok 1108 get_feasibility_summary includes specific issues
ok 1109 validate_task_feasibility handles task with no dependencies
ok 1110 validate_task_feasibility handles task with empty description
ok 1111 validate_task_feasibility ignores issues if all deps are closed
ok 1112 validate_task_feasibility special characters in dependency id
ok 1113 validate_task_dependencies returns error for missing task_id
ok 1114 validate_task_dependencies returns error for nonexistent task
ok 1115 validate_task_dependencies marks valid task as valid
ok 1116 validate_task_dependencies detects missing dependency
ok 1117 validate_task_dependencies handles task with no dependencies
ok 1118 validate_task_dependencies returns valid JSON structure
ok 1119 validate_task_dependencies detects dependency order issues
ok 1120 validate_all_dependencies returns empty array for empty prd
ok 1121 validate_all_dependencies validates all tasks
ok 1122 validate_all_dependencies detects multiple invalid tasks
ok 1123 get_dependency_order returns list of task ids
ok 1124 get_dependency_order handles empty prd
ok 1125 get_blocked_tasks_report shows blocked tasks
ok 1126 get_blocked_tasks_report shows no blocked tasks when all ready
ok 1127 get_blocked_tasks_report handles empty prd
ok 1128 get_dependency_summary reports no issues when all valid
ok 1129 get_dependency_summary reports issues when dependencies invalid
ok 1130 validate_task_dependencies handles multiple dependencies
ok 1131 validate_task_dependencies detects multiple missing dependencies
ok 1132 validate_all_dependencies handles file not found
ok 1133 validate_task_architecture requires task_id
ok 1134 validate_task_architecture handles task not found
ok 1135 validate_task_architecture returns valid JSON structure
ok 1136 validate_task_architecture handles AI unavailable gracefully
ok 1137 validate_task_architecture handles non-JSON AI response
ok 1138 validate_task_architecture handles missing prd.json
ok 1139 validate_task_architecture parses AI issues and suggestions
ok 1140 validate_all_architecture validates multiple tasks
ok 1141 validate_all_architecture handles empty task list
ok 1142 validate_all_architecture handles file not found
ok 1143 get_architecture_summary shows pass with no issues
ok 1144 get_architecture_summary shows concerns with issues
ok 1145 get_architecture_summary handles empty prd
ok 1146 validate_task_architecture extracts task fields correctly
ok 1147 xdg_config_home returns ~/.config by default
ok 1148 xdg_config_home respects XDG_CONFIG_HOME
ok 1149 xdg_data_home returns ~/.local/share by default
ok 1150 xdg_data_home respects XDG_DATA_HOME
ok 1151 xdg_cache_home returns ~/.cache by default
ok 1152 xdg_cache_home respects XDG_CACHE_HOME
ok 1153 cub_config_dir returns correct path
ok 1154 cub_data_dir returns correct path
ok 1155 cub_logs_dir returns correct path
ok 1156 cub_cache_dir returns correct path
ok 1157 cub_ensure_dirs creates config directory
ok 1158 cub_ensure_dirs creates data directory
ok 1159 cub_ensure_dirs creates logs directory
ok 1160 cub_ensure_dirs creates cache directory
# bats warning: Executed 1130 instead of expected 1160 tests
