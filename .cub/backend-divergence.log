{"timestamp": "2026-01-28T12:13:22.051198", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": "[]", "difference_summary": "List length mismatch: 30 != 0"}
{"timestamp": "2026-01-28T12:14:48.866353", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": "[]", "difference_summary": "List length mismatch: 30 != 0"}
{"timestamp": "2026-01-28T12:22:42.641606", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": "[]", "difference_summary": "List length mismatch: 30 != 0"}
{"timestamp": "2026-01-28T12:22:51.798269", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": "[]", "difference_summary": "List length mismatch: 30 != 0"}
{"timestamp": "2026-01-28T12:23:02.855417", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": "[]", "difference_summary": "List length mismatch: 30 != 0"}
{"timestamp": "2026-01-28T12:30:53.187377", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": "[]", "difference_summary": "List length mismatch: 30 != 0"}
{"timestamp": "2026-01-28T12:42:17.685184", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": "[]", "difference_summary": "List length mismatch: 30 != 0"}
{"timestamp": "2026-01-28T12:54:31.893245", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": "[]", "difference_summary": "List length mismatch: 12 != 0"}
{"timestamp": "2026-01-28T16:40:11.451009", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": "[]", "difference_summary": "List length mismatch: 30 != 0"}
{"timestamp": "2026-01-28T17:56:01.693547", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 59, "open": 59, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 29, "in_progress": 0, "closed": 0}, "difference_summary": "total: 59 != 29; open: 59 != 29"}
{"timestamp": "2026-01-28T17:56:01.737724", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "open", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": null, "labels": ["blocking", "complexity:high", "core", "epic:cub-b1a", "model:opus", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409049Z", "updated_at": "2026-01-28T17:54:44.598534Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}], "secondary_result": [{"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "open", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T17:54:46.169149", "closed_at": null, "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "open", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T17:54:46.169251", "closed_at": null, "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "open", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T17:54:46.169289", "closed_at": null, "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "open", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T17:54:46.169329", "closed_at": null, "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "open", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T17:54:46.169369", "closed_at": null, "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 1 != 5"}
{"timestamp": "2026-01-28T17:56:01.789427", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "open", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": null, "labels": ["blocking", "complexity:high", "core", "epic:cub-b1a", "model:opus", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409049Z", "updated_at": "2026-01-28T17:54:44.598534Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}], "secondary_result": [{"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "open", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T17:54:46.169149", "closed_at": null, "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "open", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T17:54:46.169251", "closed_at": null, "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "open", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T17:54:46.169289", "closed_at": null, "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "open", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T17:54:46.169329", "closed_at": null, "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "open", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T17:54:46.169369", "closed_at": null, "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 1 != 5"}
{"timestamp": "2026-01-28T17:56:01.926994", "operation": "update_task", "task_id": "cub-b1a.1", "primary_result": {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "in_progress", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["blocking", "complexity:high", "core", "epic:cub-b1a", "model:opus", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:44.409049Z", "updated_at": "2026-01-28T17:56:01.856607Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "in_progress", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T17:56:01.925032", "closed_at": null, "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['blocking', 'complexity:high', 'core', 'epic:cub-b1a', 'model:opus', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:opus', 'complexity:high', 'blocking']"}
{"timestamp": "2026-01-28T18:04:02.243523", "operation": "close_task", "task_id": "cub-b1a.1", "primary_result": {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["blocking", "complexity:high", "core", "epic:cub-b1a", "model:opus", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:44.409049Z", "updated_at": "2026-01-28T18:04:02.171447Z", "closed_at": "2026-01-28T18:04:02.171447Z", "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['blocking', 'complexity:high', 'core', 'epic:cub-b1a', 'model:opus', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:opus', 'complexity:high', 'blocking']"}
{"timestamp": "2026-01-28T18:04:02.315551", "operation": "get_task", "task_id": "cub-b1a.1", "primary_result": {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["blocking", "complexity:high", "core", "epic:cub-b1a", "model:opus", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:44.409049Z", "updated_at": "2026-01-28T18:04:02.171447Z", "closed_at": "2026-01-28T18:04:02.171447Z", "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['blocking', 'complexity:high', 'core', 'epic:cub-b1a', 'model:opus', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:opus', 'complexity:high', 'blocking']"}
{"timestamp": "2026-01-28T18:04:13.080001", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 58, "open": 58, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 28, "in_progress": 0, "closed": 1}, "difference_summary": "total: 58 != 29; open: 58 != 28; closed: 0 != 1"}
{"timestamp": "2026-01-28T18:04:15.144435", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "open", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409166Z", "updated_at": "2026-01-28T17:54:44.599809Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "open", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": null, "labels": ["complexity:high", "core", "epic:cub-b1a", "model:opus", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409206Z", "updated_at": "2026-01-28T17:54:44.600239Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "open", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409236Z", "updated_at": "2026-01-28T17:54:44.600672Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "open", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409259Z", "updated_at": "2026-01-28T17:54:44.601026Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "open", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T17:54:46.169251", "closed_at": null, "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "open", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T17:54:46.169289", "closed_at": null, "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "open", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T17:54:46.169329", "closed_at": null, "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "open", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T17:54:46.169369", "closed_at": null, "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1a.2): labels: ['complexity:medium', 'core', 'epic:cub-b1a', 'model:sonnet', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1a; Task 1 (cub-b1a.3): labels: ['complexity:high', 'core', 'epic:cub-b1a', 'model:opus', 'phase-1', 'refactor', 'risk:high'] != ['phase-1', 'core', 'refactor', 'model:opus', 'complexity:high', 'risk:high']; parent: None != cub-b1a; Task 2 (cub-b1a.4): labels: ['complexity:medium', 'core', 'epic:cub-b1a', 'model:sonnet', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1a; Task 3 (cub-b1a.5): labels: ['complexity:medium', 'core', 'epic:cub-b1a', 'model:sonnet', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1a"}
{"timestamp": "2026-01-28T18:04:15.309261", "operation": "update_task", "task_id": "cub-b1a.2", "primary_result": {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "in_progress", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:44.409166Z", "updated_at": "2026-01-28T18:04:15.219118Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "in_progress", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:04:15.307723", "closed_at": null, "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:medium', 'core', 'epic:cub-b1a', 'model:sonnet', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T18:09:17.084049", "operation": "close_task", "task_id": "cub-b1a.2", "primary_result": {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:44.409166Z", "updated_at": "2026-01-28T18:09:17.031081Z", "closed_at": "2026-01-28T18:09:17.031081Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:medium', 'core', 'epic:cub-b1a', 'model:sonnet', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T18:09:17.160908", "operation": "get_task", "task_id": "cub-b1a.2", "primary_result": {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:44.409166Z", "updated_at": "2026-01-28T18:09:17.031081Z", "closed_at": "2026-01-28T18:09:17.031081Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:medium', 'core', 'epic:cub-b1a', 'model:sonnet', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T18:09:25.155207", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 57, "open": 57, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 27, "in_progress": 0, "closed": 2}, "difference_summary": "total: 57 != 29; open: 57 != 27; closed: 0 != 2"}
{"timestamp": "2026-01-28T18:09:27.233152", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "open", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": null, "labels": ["complexity:high", "core", "epic:cub-b1a", "model:opus", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409206Z", "updated_at": "2026-01-28T17:54:44.600239Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "open", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409236Z", "updated_at": "2026-01-28T17:54:44.600672Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "open", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409259Z", "updated_at": "2026-01-28T17:54:44.601026Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "open", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T17:54:46.169289", "closed_at": null, "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "open", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T17:54:46.169329", "closed_at": null, "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "open", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T17:54:46.169369", "closed_at": null, "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1a.3): labels: ['complexity:high', 'core', 'epic:cub-b1a', 'model:opus', 'phase-1', 'refactor', 'risk:high'] != ['phase-1', 'core', 'refactor', 'model:opus', 'complexity:high', 'risk:high']; parent: None != cub-b1a; Task 1 (cub-b1a.4): labels: ['complexity:medium', 'core', 'epic:cub-b1a', 'model:sonnet', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1a; Task 2 (cub-b1a.5): labels: ['complexity:medium', 'core', 'epic:cub-b1a', 'model:sonnet', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1a"}
{"timestamp": "2026-01-28T18:09:27.426285", "operation": "update_task", "task_id": "cub-b1a.3", "primary_result": {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "in_progress", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-175601", "labels": ["complexity:high", "core", "epic:cub-b1a", "model:opus", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:44.409206Z", "updated_at": "2026-01-28T18:09:27.325121Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "in_progress", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:09:27.424174", "closed_at": null, "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:high', 'core', 'epic:cub-b1a', 'model:opus', 'phase-1', 'refactor', 'risk:high'] != ['phase-1', 'core', 'refactor', 'model:opus', 'complexity:high', 'risk:high']"}
{"timestamp": "2026-01-28T18:39:43.802963", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 57, "open": 56, "in_progress": 1, "closed": 0}, "secondary_result": {"total": 29, "open": 26, "in_progress": 1, "closed": 2}, "difference_summary": "total: 57 != 29; open: 56 != 26; closed: 0 != 2"}
{"timestamp": "2026-01-28T18:39:43.865454", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "in_progress", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-175601", "labels": ["complexity:high", "core", "epic:cub-b1a", "model:opus", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409206Z", "updated_at": "2026-01-28T18:09:37.984900Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "open", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409236Z", "updated_at": "2026-01-28T17:54:44.600672Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "open", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409259Z", "updated_at": "2026-01-28T17:54:44.601026Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "open", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T17:54:46.169329", "closed_at": null, "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "open", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T17:54:46.169369", "closed_at": null, "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 3 != 2"}
{"timestamp": "2026-01-28T18:39:43.946747", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "in_progress", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-175601", "labels": ["complexity:high", "core", "epic:cub-b1a", "model:opus", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409206Z", "updated_at": "2026-01-28T18:09:37.984900Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "open", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409236Z", "updated_at": "2026-01-28T17:54:44.600672Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "open", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409259Z", "updated_at": "2026-01-28T17:54:44.601026Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "open", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T17:54:46.169329", "closed_at": null, "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "open", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T17:54:46.169369", "closed_at": null, "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 3 != 2"}
{"timestamp": "2026-01-28T18:39:44.020967", "operation": "get_task", "task_id": "cub-b1a.3", "primary_result": {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "in_progress", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-175601", "labels": ["complexity:high", "core", "epic:cub-b1a", "model:opus", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:44.409206Z", "updated_at": "2026-01-28T18:09:37.984900Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "in_progress", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:09:27.424174", "closed_at": null, "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:high', 'core', 'epic:cub-b1a', 'model:opus', 'phase-1', 'refactor', 'risk:high'] != ['phase-1', 'core', 'refactor', 'model:opus', 'complexity:high', 'risk:high']"}
{"timestamp": "2026-01-28T18:39:44.156197", "operation": "update_task", "task_id": "cub-b1a.3", "primary_result": {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "in_progress", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["complexity:high", "core", "epic:cub-b1a", "model:opus", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:44.409206Z", "updated_at": "2026-01-28T18:39:44.094849Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "in_progress", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:39:44.154676", "closed_at": null, "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:high', 'core', 'epic:cub-b1a', 'model:opus', 'phase-1', 'refactor', 'risk:high'] != ['phase-1', 'core', 'refactor', 'model:opus', 'complexity:high', 'risk:high']"}
{"timestamp": "2026-01-28T18:41:42.478897", "operation": "get_task", "task_id": "cub-b1a.3", "primary_result": {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["complexity:high", "core", "epic:cub-b1a", "model:opus", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:44.409206Z", "updated_at": "2026-01-28T18:41:17.671009Z", "closed_at": "2026-01-28T18:41:17.671009Z", "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "in_progress", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:39:44.154676", "closed_at": null, "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['complexity:high', 'core', 'epic:cub-b1a', 'model:opus', 'phase-1', 'refactor', 'risk:high'] != ['phase-1', 'core', 'refactor', 'model:opus', 'complexity:high', 'risk:high']"}
{"timestamp": "2026-01-28T18:41:42.557243", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 56, "open": 56, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 26, "in_progress": 1, "closed": 2}, "difference_summary": "total: 56 != 29; open: 56 != 26; in_progress: 0 != 1; closed: 0 != 2"}
{"timestamp": "2026-01-28T18:41:42.746247", "operation": "close_task", "task_id": "cub-b1a.3", "primary_result": {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["complexity:high", "core", "epic:cub-b1a", "model:opus", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:44.409206Z", "updated_at": "2026-01-28T18:41:42.631490Z", "closed_at": "2026-01-28T18:41:42.631490Z", "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:high', 'core', 'epic:cub-b1a', 'model:opus', 'phase-1', 'refactor', 'risk:high'] != ['phase-1', 'core', 'refactor', 'model:opus', 'complexity:high', 'risk:high']"}
{"timestamp": "2026-01-28T18:41:42.869220", "operation": "get_task", "task_id": "cub-b1a.3", "primary_result": {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["complexity:high", "core", "epic:cub-b1a", "model:opus", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:44.409206Z", "updated_at": "2026-01-28T18:41:42.631490Z", "closed_at": "2026-01-28T18:41:42.631490Z", "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:high', 'core', 'epic:cub-b1a', 'model:opus', 'phase-1', 'refactor', 'risk:high'] != ['phase-1', 'core', 'refactor', 'model:opus', 'complexity:high', 'risk:high']"}
{"timestamp": "2026-01-28T18:41:51.907101", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "open", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409236Z", "updated_at": "2026-01-28T17:54:44.600672Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "open", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409259Z", "updated_at": "2026-01-28T17:54:44.601026Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "open", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T17:54:46.169329", "closed_at": null, "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "open", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T17:54:46.169369", "closed_at": null, "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1a.4): labels: ['complexity:medium', 'core', 'epic:cub-b1a', 'model:sonnet', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1a; Task 1 (cub-b1a.5): labels: ['complexity:medium', 'core', 'epic:cub-b1a', 'model:sonnet', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1a"}
{"timestamp": "2026-01-28T18:41:51.962427", "operation": "get_task", "task_id": "cub-b1a.4", "primary_result": {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "open", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:44.409236Z", "updated_at": "2026-01-28T17:54:44.600672Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "open", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T17:54:46.169329", "closed_at": null, "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'core', 'epic:cub-b1a', 'model:sonnet', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T18:41:52.102329", "operation": "update_task", "task_id": "cub-b1a.4", "primary_result": {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "in_progress", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:44.409236Z", "updated_at": "2026-01-28T18:41:52.017847Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "in_progress", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:41:52.100544", "closed_at": null, "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'core', 'epic:cub-b1a', 'model:sonnet', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T18:47:30.475977", "operation": "get_task", "task_id": "cub-b1a.4", "primary_result": {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:44.409236Z", "updated_at": "2026-01-28T18:46:57.789762Z", "closed_at": "2026-01-28T18:46:57.789762Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "in_progress", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:41:52.100544", "closed_at": null, "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['complexity:medium', 'core', 'epic:cub-b1a', 'model:sonnet', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T18:47:30.533399", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 55, "open": 55, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 25, "in_progress": 1, "closed": 3}, "difference_summary": "total: 55 != 29; open: 55 != 25; in_progress: 0 != 1; closed: 0 != 3"}
{"timestamp": "2026-01-28T18:47:30.642380", "operation": "close_task", "task_id": "cub-b1a.4", "primary_result": {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:44.409236Z", "updated_at": "2026-01-28T18:47:30.584182Z", "closed_at": "2026-01-28T18:47:30.584182Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'core', 'epic:cub-b1a', 'model:sonnet', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T18:47:30.699345", "operation": "get_task", "task_id": "cub-b1a.4", "primary_result": {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:44.409236Z", "updated_at": "2026-01-28T18:47:30.584182Z", "closed_at": "2026-01-28T18:47:30.584182Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'core', 'epic:cub-b1a', 'model:sonnet', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T18:47:41.467395", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "open", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409259Z", "updated_at": "2026-01-28T17:54:44.601026Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "open", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T17:54:46.169369", "closed_at": null, "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1a.5): labels: ['complexity:medium', 'core', 'epic:cub-b1a', 'model:sonnet', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1a"}
{"timestamp": "2026-01-28T18:47:41.530801", "operation": "get_task", "task_id": "cub-b1a.5", "primary_result": {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "open", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:44.409259Z", "updated_at": "2026-01-28T17:54:44.601026Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "open", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": null, "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T17:54:46.169369", "closed_at": null, "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'core', 'epic:cub-b1a', 'model:sonnet', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T18:47:41.661145", "operation": "update_task", "task_id": "cub-b1a.5", "primary_result": {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "in_progress", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:44.409259Z", "updated_at": "2026-01-28T18:47:41.582832Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "in_progress", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:47:41.659876", "closed_at": null, "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'core', 'epic:cub-b1a', 'model:sonnet', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T18:57:10.667694", "operation": "get_task", "task_id": "cub-b1a.5", "primary_result": {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:44.409259Z", "updated_at": "2026-01-28T18:56:48.615534Z", "closed_at": "2026-01-28T18:56:48.615534Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "in_progress", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:47:41.659876", "closed_at": null, "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['complexity:medium', 'core', 'epic:cub-b1a', 'model:sonnet', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T18:57:10.729474", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 54, "open": 54, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 24, "in_progress": 1, "closed": 4}, "difference_summary": "total: 54 != 29; open: 54 != 24; in_progress: 0 != 1; closed: 0 != 4"}
{"timestamp": "2026-01-28T18:57:10.836512", "operation": "close_task", "task_id": "cub-b1a.5", "primary_result": {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:44.409259Z", "updated_at": "2026-01-28T18:57:10.777781Z", "closed_at": "2026-01-28T18:57:10.777781Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'core', 'epic:cub-b1a', 'model:sonnet', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T18:57:10.894924", "operation": "get_task", "task_id": "cub-b1a.5", "primary_result": {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["complexity:medium", "core", "epic:cub-b1a", "model:sonnet", "phase-1", "refactor"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:44.409259Z", "updated_at": "2026-01-28T18:57:10.777781Z", "closed_at": "2026-01-28T18:57:10.777781Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'core', 'epic:cub-b1a', 'model:sonnet', 'phase-1', 'refactor'] != ['phase-1', 'core', 'refactor', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T18:57:22.568763", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 54, "open": 54, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 24, "in_progress": 0, "closed": 5}, "difference_summary": "total: 54 != 29; open: 54 != 24; closed: 0 != 5"}
{"timestamp": "2026-01-28T18:57:26.427309", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 54, "open": 54, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 23, "in_progress": 0, "closed": 6}, "difference_summary": "total: 54 != 29; open: 54 != 23; closed: 0 != 6"}
{"timestamp": "2026-01-28T18:57:26.482813", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "open", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": null, "labels": ["cleanup", "complexity:medium", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409281Z", "updated_at": "2026-01-28T17:54:44.601443Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "open", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": null, "labels": ["cleanup", "complexity:medium", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409303Z", "updated_at": "2026-01-28T17:54:44.601815Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "open", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": null, "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409322Z", "updated_at": "2026-01-28T17:54:44.602195Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "open", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": null, "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409340Z", "updated_at": "2026-01-28T17:54:44.602580Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "open", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T17:54:46.169409", "closed_at": null, "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "open", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T17:54:46.169430", "closed_at": null, "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "open", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T17:54:46.169448", "closed_at": null, "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "", "complexity_label": "low", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "open", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T17:54:46.169467", "closed_at": null, "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "open", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T17:54:46.169492", "closed_at": null, "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 4 != 5"}
{"timestamp": "2026-01-28T18:57:26.542302", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "open", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": null, "labels": ["cleanup", "complexity:medium", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409281Z", "updated_at": "2026-01-28T17:54:44.601443Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "open", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": null, "labels": ["cleanup", "complexity:medium", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409303Z", "updated_at": "2026-01-28T17:54:44.601815Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "open", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": null, "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409322Z", "updated_at": "2026-01-28T17:54:44.602195Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "open", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": null, "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409340Z", "updated_at": "2026-01-28T17:54:44.602580Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "open", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T17:54:46.169409", "closed_at": null, "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "open", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T17:54:46.169430", "closed_at": null, "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "open", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T17:54:46.169448", "closed_at": null, "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "", "complexity_label": "low", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "open", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T17:54:46.169467", "closed_at": null, "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "open", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T17:54:46.169492", "closed_at": null, "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 4 != 5"}
{"timestamp": "2026-01-28T18:57:26.587732", "operation": "get_task", "task_id": "cub-b1b.1", "primary_result": {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "open", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": null, "labels": ["cleanup", "complexity:medium", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409281Z", "updated_at": "2026-01-28T17:54:44.601443Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "open", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T17:54:46.169409", "closed_at": null, "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "difference_summary": "labels: ['cleanup', 'complexity:medium', 'core', 'epic:cub-b1b', 'model:sonnet', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T18:57:26.709862", "operation": "update_task", "task_id": "cub-b1b.1", "primary_result": {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "in_progress", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["cleanup", "complexity:medium", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409281Z", "updated_at": "2026-01-28T18:57:26.636405Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "in_progress", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T18:57:26.708296", "closed_at": null, "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['cleanup', 'complexity:medium', 'core', 'epic:cub-b1b', 'model:sonnet', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:02:20.523509", "operation": "get_task", "task_id": "cub-b1b.1", "primary_result": {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["cleanup", "complexity:medium", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409281Z", "updated_at": "2026-01-28T19:01:49.864823Z", "closed_at": "2026-01-28T19:01:49.864823Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "in_progress", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T18:57:26.708296", "closed_at": null, "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['cleanup', 'complexity:medium', 'core', 'epic:cub-b1b', 'model:sonnet', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:02:20.583936", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 53, "open": 53, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 22, "in_progress": 1, "closed": 6}, "difference_summary": "total: 53 != 29; open: 53 != 22; in_progress: 0 != 1; closed: 0 != 6"}
{"timestamp": "2026-01-28T19:02:20.691410", "operation": "close_task", "task_id": "cub-b1b.1", "primary_result": {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["cleanup", "complexity:medium", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409281Z", "updated_at": "2026-01-28T19:02:20.632650Z", "closed_at": "2026-01-28T19:02:20.632650Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['cleanup', 'complexity:medium', 'core', 'epic:cub-b1b', 'model:sonnet', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:02:20.752319", "operation": "get_task", "task_id": "cub-b1b.1", "primary_result": {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["cleanup", "complexity:medium", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409281Z", "updated_at": "2026-01-28T19:02:20.632650Z", "closed_at": "2026-01-28T19:02:20.632650Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['cleanup', 'complexity:medium', 'core', 'epic:cub-b1b', 'model:sonnet', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:02:31.192396", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "open", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": null, "labels": ["cleanup", "complexity:medium", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409303Z", "updated_at": "2026-01-28T17:54:44.601815Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "open", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": null, "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409322Z", "updated_at": "2026-01-28T17:54:44.602195Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "open", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": null, "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409340Z", "updated_at": "2026-01-28T17:54:44.602580Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "open", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T17:54:46.169430", "closed_at": null, "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "open", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T17:54:46.169448", "closed_at": null, "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "", "complexity_label": "low", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "open", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T17:54:46.169467", "closed_at": null, "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "open", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T17:54:46.169492", "closed_at": null, "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 3 != 4"}
{"timestamp": "2026-01-28T19:02:31.295470", "operation": "get_task", "task_id": "cub-b1b.2", "primary_result": {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "open", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": null, "labels": ["cleanup", "complexity:medium", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409303Z", "updated_at": "2026-01-28T17:54:44.601815Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "open", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T17:54:46.169430", "closed_at": null, "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "difference_summary": "labels: ['cleanup', 'complexity:medium', 'core', 'epic:cub-b1b', 'model:sonnet', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:02:31.508624", "operation": "update_task", "task_id": "cub-b1b.2", "primary_result": {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "in_progress", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["cleanup", "complexity:medium", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409303Z", "updated_at": "2026-01-28T19:02:31.389786Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "in_progress", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:02:31.506291", "closed_at": null, "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['cleanup', 'complexity:medium', 'core', 'epic:cub-b1b', 'model:sonnet', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:12:49.656896", "operation": "get_task", "task_id": "cub-b1b.2", "primary_result": {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["cleanup", "complexity:medium", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409303Z", "updated_at": "2026-01-28T19:12:24.478795Z", "closed_at": "2026-01-28T19:12:24.478795Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "in_progress", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:02:31.506291", "closed_at": null, "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['cleanup', 'complexity:medium', 'core', 'epic:cub-b1b', 'model:sonnet', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:12:49.714308", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 52, "open": 52, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 21, "in_progress": 1, "closed": 7}, "difference_summary": "total: 52 != 29; open: 52 != 21; in_progress: 0 != 1; closed: 0 != 7"}
{"timestamp": "2026-01-28T19:12:49.836264", "operation": "close_task", "task_id": "cub-b1b.2", "primary_result": {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["cleanup", "complexity:medium", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409303Z", "updated_at": "2026-01-28T19:12:49.758027Z", "closed_at": "2026-01-28T19:12:49.758027Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['cleanup', 'complexity:medium', 'core', 'epic:cub-b1b', 'model:sonnet', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:12:49.910849", "operation": "get_task", "task_id": "cub-b1b.2", "primary_result": {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["cleanup", "complexity:medium", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409303Z", "updated_at": "2026-01-28T19:12:49.758027Z", "closed_at": "2026-01-28T19:12:49.758027Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['cleanup', 'complexity:medium', 'core', 'epic:cub-b1b', 'model:sonnet', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:13:00.752225", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "open", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": null, "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409322Z", "updated_at": "2026-01-28T17:54:44.602195Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "open", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": null, "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409340Z", "updated_at": "2026-01-28T17:54:44.602580Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "open", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": null, "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409364Z", "updated_at": "2026-01-28T17:54:44.602960Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "open", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T17:54:46.169448", "closed_at": null, "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "", "complexity_label": "low", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "open", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T17:54:46.169467", "closed_at": null, "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "open", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T17:54:46.169492", "closed_at": null, "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1b.3): labels: ['cleanup', 'complexity:low', 'core', 'epic:cub-b1b', 'model:sonnet', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:sonnet', 'complexity:low']; parent: None != cub-b1b; Task 1 (cub-b1b.4): labels: ['cleanup', 'complexity:low', 'core', 'epic:cub-b1b', 'model:haiku', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:haiku', 'complexity:low']; parent: None != cub-b1b; Task 2 (cub-b1b.5): labels: ['cleanup', 'complexity:low', 'core', 'epic:cub-b1b', 'model:haiku', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:haiku', 'complexity:low']; parent: None != cub-b1b"}
{"timestamp": "2026-01-28T19:13:00.832618", "operation": "get_task", "task_id": "cub-b1b.3", "primary_result": {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "open", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": null, "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409322Z", "updated_at": "2026-01-28T17:54:44.602195Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "open", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T17:54:46.169448", "closed_at": null, "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "", "complexity_label": "low", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "difference_summary": "labels: ['cleanup', 'complexity:low', 'core', 'epic:cub-b1b', 'model:sonnet', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:sonnet', 'complexity:low']"}
{"timestamp": "2026-01-28T19:13:01.014661", "operation": "update_task", "task_id": "cub-b1b.3", "primary_result": {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "in_progress", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409322Z", "updated_at": "2026-01-28T19:13:00.925367Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "in_progress", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:13:01.013273", "closed_at": null, "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['cleanup', 'complexity:low', 'core', 'epic:cub-b1b', 'model:sonnet', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:sonnet', 'complexity:low']"}
{"timestamp": "2026-01-28T19:16:59.743579", "operation": "get_task", "task_id": "cub-b1b.3", "primary_result": {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409322Z", "updated_at": "2026-01-28T19:16:32.564232Z", "closed_at": "2026-01-28T19:16:32.564232Z", "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "in_progress", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:13:01.013273", "closed_at": null, "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['cleanup', 'complexity:low', 'core', 'epic:cub-b1b', 'model:sonnet', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:sonnet', 'complexity:low']"}
{"timestamp": "2026-01-28T19:16:59.800815", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 51, "open": 51, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 20, "in_progress": 1, "closed": 8}, "difference_summary": "total: 51 != 29; open: 51 != 20; in_progress: 0 != 1; closed: 0 != 8"}
{"timestamp": "2026-01-28T19:16:59.894409", "operation": "close_task", "task_id": "cub-b1b.3", "primary_result": {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409322Z", "updated_at": "2026-01-28T19:16:59.839200Z", "closed_at": "2026-01-28T19:16:59.839200Z", "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['cleanup', 'complexity:low', 'core', 'epic:cub-b1b', 'model:sonnet', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:sonnet', 'complexity:low']"}
{"timestamp": "2026-01-28T19:16:59.952561", "operation": "get_task", "task_id": "cub-b1b.3", "primary_result": {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409322Z", "updated_at": "2026-01-28T19:16:59.839200Z", "closed_at": "2026-01-28T19:16:59.839200Z", "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['cleanup', 'complexity:low', 'core', 'epic:cub-b1b', 'model:sonnet', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:sonnet', 'complexity:low']"}
{"timestamp": "2026-01-28T19:17:09.081162", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "open", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": null, "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409340Z", "updated_at": "2026-01-28T17:54:44.602580Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "open", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": null, "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409364Z", "updated_at": "2026-01-28T17:54:44.602960Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "open", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T17:54:46.169467", "closed_at": null, "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "open", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T17:54:46.169492", "closed_at": null, "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1b.4): labels: ['cleanup', 'complexity:low', 'core', 'epic:cub-b1b', 'model:haiku', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:haiku', 'complexity:low']; parent: None != cub-b1b; Task 1 (cub-b1b.5): labels: ['cleanup', 'complexity:low', 'core', 'epic:cub-b1b', 'model:haiku', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:haiku', 'complexity:low']; parent: None != cub-b1b"}
{"timestamp": "2026-01-28T19:17:09.133709", "operation": "get_task", "task_id": "cub-b1b.4", "primary_result": {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "open", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": null, "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409340Z", "updated_at": "2026-01-28T17:54:44.602580Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "open", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T17:54:46.169467", "closed_at": null, "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, "difference_summary": "labels: ['cleanup', 'complexity:low', 'core', 'epic:cub-b1b', 'model:haiku', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:haiku', 'complexity:low']"}
{"timestamp": "2026-01-28T19:17:09.256738", "operation": "update_task", "task_id": "cub-b1b.4", "primary_result": {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "in_progress", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409340Z", "updated_at": "2026-01-28T19:17:09.187179Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "in_progress", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:17:09.255105", "closed_at": null, "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['cleanup', 'complexity:low', 'core', 'epic:cub-b1b', 'model:haiku', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:haiku', 'complexity:low']"}
{"timestamp": "2026-01-28T19:18:27.573389", "operation": "get_task", "task_id": "cub-b1b.4", "primary_result": {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409340Z", "updated_at": "2026-01-28T19:18:15.799561Z", "closed_at": "2026-01-28T19:18:15.799561Z", "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "in_progress", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:17:09.255105", "closed_at": null, "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['cleanup', 'complexity:low', 'core', 'epic:cub-b1b', 'model:haiku', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:haiku', 'complexity:low']"}
{"timestamp": "2026-01-28T19:18:27.678574", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 50, "open": 50, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 19, "in_progress": 1, "closed": 9}, "difference_summary": "total: 50 != 29; open: 50 != 19; in_progress: 0 != 1; closed: 0 != 9"}
{"timestamp": "2026-01-28T19:18:27.821734", "operation": "close_task", "task_id": "cub-b1b.4", "primary_result": {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409340Z", "updated_at": "2026-01-28T19:18:27.753324Z", "closed_at": "2026-01-28T19:18:27.753324Z", "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['cleanup', 'complexity:low', 'core', 'epic:cub-b1b', 'model:haiku', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:haiku', 'complexity:low']"}
{"timestamp": "2026-01-28T19:18:27.888980", "operation": "get_task", "task_id": "cub-b1b.4", "primary_result": {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409340Z", "updated_at": "2026-01-28T19:18:27.753324Z", "closed_at": "2026-01-28T19:18:27.753324Z", "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['cleanup', 'complexity:low', 'core', 'epic:cub-b1b', 'model:haiku', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:haiku', 'complexity:low']"}
{"timestamp": "2026-01-28T19:18:36.886633", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "open", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": null, "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409364Z", "updated_at": "2026-01-28T17:54:44.602960Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "open", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T17:54:46.169492", "closed_at": null, "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1b.5): labels: ['cleanup', 'complexity:low', 'core', 'epic:cub-b1b', 'model:haiku', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:haiku', 'complexity:low']; parent: None != cub-b1b"}
{"timestamp": "2026-01-28T19:18:36.934735", "operation": "get_task", "task_id": "cub-b1b.5", "primary_result": {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "open", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": null, "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409364Z", "updated_at": "2026-01-28T17:54:44.602960Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "open", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": null, "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T17:54:46.169492", "closed_at": null, "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, "difference_summary": "labels: ['cleanup', 'complexity:low', 'core', 'epic:cub-b1b', 'model:haiku', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:haiku', 'complexity:low']"}
{"timestamp": "2026-01-28T19:18:37.079360", "operation": "update_task", "task_id": "cub-b1b.5", "primary_result": {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "in_progress", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409364Z", "updated_at": "2026-01-28T19:18:36.992612Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "in_progress", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:18:37.077578", "closed_at": null, "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['cleanup', 'complexity:low', 'core', 'epic:cub-b1b', 'model:haiku', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:haiku', 'complexity:low']"}
{"timestamp": "2026-01-28T19:20:10.712314", "operation": "get_task", "task_id": "cub-b1b.5", "primary_result": {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409364Z", "updated_at": "2026-01-28T19:19:56.630947Z", "closed_at": "2026-01-28T19:19:56.630947Z", "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "in_progress", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:18:37.077578", "closed_at": null, "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['cleanup', 'complexity:low', 'core', 'epic:cub-b1b', 'model:haiku', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:haiku', 'complexity:low']"}
{"timestamp": "2026-01-28T19:20:10.767173", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 49, "open": 49, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 18, "in_progress": 1, "closed": 10}, "difference_summary": "total: 49 != 29; open: 49 != 18; in_progress: 0 != 1; closed: 0 != 10"}
{"timestamp": "2026-01-28T19:20:10.865356", "operation": "close_task", "task_id": "cub-b1b.5", "primary_result": {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409364Z", "updated_at": "2026-01-28T19:20:10.807663Z", "closed_at": "2026-01-28T19:20:10.807663Z", "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['cleanup', 'complexity:low', 'core', 'epic:cub-b1b', 'model:haiku', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:haiku', 'complexity:low']"}
{"timestamp": "2026-01-28T19:20:10.924503", "operation": "get_task", "task_id": "cub-b1b.5", "primary_result": {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["cleanup", "complexity:low", "core", "epic:cub-b1b", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:44.409364Z", "updated_at": "2026-01-28T19:20:10.807663Z", "closed_at": "2026-01-28T19:20:10.807663Z", "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['cleanup', 'complexity:low', 'core', 'epic:cub-b1b', 'model:haiku', 'phase-2'] != ['phase-2', 'core', 'cleanup', 'model:haiku', 'complexity:low']"}
{"timestamp": "2026-01-28T19:20:21.507074", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 49, "open": 49, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 18, "in_progress": 0, "closed": 11}, "difference_summary": "total: 49 != 29; open: 49 != 18; closed: 0 != 11"}
{"timestamp": "2026-01-28T19:20:25.336444", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 49, "open": 49, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 17, "in_progress": 0, "closed": 12}, "difference_summary": "total: 49 != 29; open: 49 != 17; closed: 0 != 12"}
{"timestamp": "2026-01-28T19:20:25.402360", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "open", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": null, "labels": ["architecture", "blocking", "complexity:high", "core", "epic:cub-b1c", "model:opus", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409427Z", "updated_at": "2026-01-28T17:54:44.603331Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "open", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": null, "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T17:54:46.169510", "closed_at": null, "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "open", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": null, "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T17:54:46.169529", "closed_at": null, "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "open", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": null, "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T17:54:46.169545", "closed_at": null, "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "open", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": null, "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T17:54:46.169561", "closed_at": null, "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 1 != 4"}
{"timestamp": "2026-01-28T19:20:25.447371", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "open", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": null, "labels": ["architecture", "blocking", "complexity:high", "core", "epic:cub-b1c", "model:opus", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409427Z", "updated_at": "2026-01-28T17:54:44.603331Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "open", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": null, "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T17:54:46.169510", "closed_at": null, "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "open", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": null, "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T17:54:46.169529", "closed_at": null, "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "open", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": null, "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T17:54:46.169545", "closed_at": null, "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "open", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": null, "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T17:54:46.169561", "closed_at": null, "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 1 != 4"}
{"timestamp": "2026-01-28T19:20:25.487355", "operation": "get_task", "task_id": "cub-b1c.1", "primary_result": {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "open", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": null, "labels": ["architecture", "blocking", "complexity:high", "core", "epic:cub-b1c", "model:opus", "phase-3"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:44.409427Z", "updated_at": "2026-01-28T17:54:44.603331Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "open", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": null, "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T17:54:46.169510", "closed_at": null, "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 1}, "difference_summary": "labels: ['architecture', 'blocking', 'complexity:high', 'core', 'epic:cub-b1c', 'model:opus', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:opus', 'complexity:high', 'blocking']"}
{"timestamp": "2026-01-28T19:20:25.592273", "operation": "update_task", "task_id": "cub-b1c.1", "primary_result": {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "in_progress", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["architecture", "blocking", "complexity:high", "core", "epic:cub-b1c", "model:opus", "phase-3"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:44.409427Z", "updated_at": "2026-01-28T19:20:25.528997Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "in_progress", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:20:25.585686", "closed_at": null, "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['architecture', 'blocking', 'complexity:high', 'core', 'epic:cub-b1c', 'model:opus', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:opus', 'complexity:high', 'blocking']"}
{"timestamp": "2026-01-28T19:30:32.719940", "operation": "get_task", "task_id": "cub-b1c.1", "primary_result": {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["architecture", "blocking", "complexity:high", "core", "epic:cub-b1c", "model:opus", "phase-3"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:44.409427Z", "updated_at": "2026-01-28T19:29:53.012655Z", "closed_at": "2026-01-28T19:29:53.012655Z", "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "in_progress", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:20:25.585686", "closed_at": null, "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['architecture', 'blocking', 'complexity:high', 'core', 'epic:cub-b1c', 'model:opus', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:opus', 'complexity:high', 'blocking']"}
{"timestamp": "2026-01-28T19:30:32.799384", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 48, "open": 48, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 16, "in_progress": 1, "closed": 12}, "difference_summary": "total: 48 != 29; open: 48 != 16; in_progress: 0 != 1; closed: 0 != 12"}
{"timestamp": "2026-01-28T19:30:32.963231", "operation": "close_task", "task_id": "cub-b1c.1", "primary_result": {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["architecture", "blocking", "complexity:high", "core", "epic:cub-b1c", "model:opus", "phase-3"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:44.409427Z", "updated_at": "2026-01-28T19:30:32.869903Z", "closed_at": "2026-01-28T19:30:32.869903Z", "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['architecture', 'blocking', 'complexity:high', 'core', 'epic:cub-b1c', 'model:opus', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:opus', 'complexity:high', 'blocking']"}
{"timestamp": "2026-01-28T19:30:33.051640", "operation": "get_task", "task_id": "cub-b1c.1", "primary_result": {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["architecture", "blocking", "complexity:high", "core", "epic:cub-b1c", "model:opus", "phase-3"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:44.409427Z", "updated_at": "2026-01-28T19:30:32.869903Z", "closed_at": "2026-01-28T19:30:32.869903Z", "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['architecture', 'blocking', 'complexity:high', 'core', 'epic:cub-b1c', 'model:opus', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:opus', 'complexity:high', 'blocking']"}
{"timestamp": "2026-01-28T19:30:43.928660", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "open", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": null, "labels": ["architecture", "complexity:medium", "core", "epic:cub-b1c", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409472Z", "updated_at": "2026-01-28T17:54:44.603736Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "open", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": null, "labels": ["architecture", "complexity:medium", "core", "epic:cub-b1c", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409515Z", "updated_at": "2026-01-28T17:54:44.604083Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "open", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": null, "labels": ["architecture", "complexity:medium", "core", "epic:cub-b1c", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409540Z", "updated_at": "2026-01-28T17:54:44.604480Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "open", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": null, "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T17:54:46.169529", "closed_at": null, "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "open", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": null, "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T17:54:46.169545", "closed_at": null, "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "open", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": null, "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T17:54:46.169561", "closed_at": null, "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1c.2): labels: ['architecture', 'complexity:medium', 'core', 'epic:cub-b1c', 'model:sonnet', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1c; Task 1 (cub-b1c.3): labels: ['architecture', 'complexity:medium', 'core', 'epic:cub-b1c', 'model:sonnet', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1c; Task 2 (cub-b1c.4): labels: ['architecture', 'complexity:medium', 'core', 'epic:cub-b1c', 'model:sonnet', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1c"}
{"timestamp": "2026-01-28T19:30:43.988610", "operation": "get_task", "task_id": "cub-b1c.2", "primary_result": {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "open", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": null, "labels": ["architecture", "complexity:medium", "core", "epic:cub-b1c", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:44.409472Z", "updated_at": "2026-01-28T17:54:44.603736Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "open", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": null, "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T17:54:46.169529", "closed_at": null, "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "difference_summary": "labels: ['architecture', 'complexity:medium', 'core', 'epic:cub-b1c', 'model:sonnet', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:30:44.116308", "operation": "update_task", "task_id": "cub-b1c.2", "primary_result": {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "in_progress", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["architecture", "complexity:medium", "core", "epic:cub-b1c", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:44.409472Z", "updated_at": "2026-01-28T19:30:44.046006Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "in_progress", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:30:44.114048", "closed_at": null, "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['architecture', 'complexity:medium', 'core', 'epic:cub-b1c', 'model:sonnet', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:43:16.737058", "operation": "get_task", "task_id": "cub-b1c.2", "primary_result": {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["architecture", "complexity:medium", "core", "epic:cub-b1c", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:44.409472Z", "updated_at": "2026-01-28T19:42:53.991257Z", "closed_at": "2026-01-28T19:42:53.991257Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "in_progress", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:30:44.114048", "closed_at": null, "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['architecture', 'complexity:medium', 'core', 'epic:cub-b1c', 'model:sonnet', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:43:16.837663", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 47, "open": 47, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 15, "in_progress": 1, "closed": 13}, "difference_summary": "total: 47 != 29; open: 47 != 15; in_progress: 0 != 1; closed: 0 != 13"}
{"timestamp": "2026-01-28T19:43:17.009621", "operation": "close_task", "task_id": "cub-b1c.2", "primary_result": {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["architecture", "complexity:medium", "core", "epic:cub-b1c", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:44.409472Z", "updated_at": "2026-01-28T19:43:16.920729Z", "closed_at": "2026-01-28T19:43:16.920729Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['architecture', 'complexity:medium', 'core', 'epic:cub-b1c', 'model:sonnet', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:43:17.090332", "operation": "get_task", "task_id": "cub-b1c.2", "primary_result": {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["architecture", "complexity:medium", "core", "epic:cub-b1c", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:44.409472Z", "updated_at": "2026-01-28T19:43:16.920729Z", "closed_at": "2026-01-28T19:43:16.920729Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['architecture', 'complexity:medium', 'core', 'epic:cub-b1c', 'model:sonnet', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:43:29.857738", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "open", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": null, "labels": ["architecture", "complexity:medium", "core", "epic:cub-b1c", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409515Z", "updated_at": "2026-01-28T17:54:44.604083Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "open", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": null, "labels": ["architecture", "complexity:medium", "core", "epic:cub-b1c", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409540Z", "updated_at": "2026-01-28T17:54:44.604480Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "open", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": null, "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T17:54:46.169545", "closed_at": null, "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "open", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": null, "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T17:54:46.169561", "closed_at": null, "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1c.3): labels: ['architecture', 'complexity:medium', 'core', 'epic:cub-b1c', 'model:sonnet', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1c; Task 1 (cub-b1c.4): labels: ['architecture', 'complexity:medium', 'core', 'epic:cub-b1c', 'model:sonnet', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1c"}
{"timestamp": "2026-01-28T19:43:29.946870", "operation": "get_task", "task_id": "cub-b1c.3", "primary_result": {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "open", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": null, "labels": ["architecture", "complexity:medium", "core", "epic:cub-b1c", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:44.409515Z", "updated_at": "2026-01-28T17:54:44.604083Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "open", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": null, "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T17:54:46.169545", "closed_at": null, "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "difference_summary": "labels: ['architecture', 'complexity:medium', 'core', 'epic:cub-b1c', 'model:sonnet', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:43:30.147105", "operation": "update_task", "task_id": "cub-b1c.3", "primary_result": {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "in_progress", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["architecture", "complexity:medium", "core", "epic:cub-b1c", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:44.409515Z", "updated_at": "2026-01-28T19:43:30.071746Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "in_progress", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:43:30.144065", "closed_at": null, "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['architecture', 'complexity:medium', 'core', 'epic:cub-b1c', 'model:sonnet', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:49:58.224399", "operation": "get_task", "task_id": "cub-b1c.3", "primary_result": {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["architecture", "complexity:medium", "core", "epic:cub-b1c", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:44.409515Z", "updated_at": "2026-01-28T19:49:24.306958Z", "closed_at": "2026-01-28T19:49:24.306958Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "in_progress", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:43:30.144065", "closed_at": null, "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['architecture', 'complexity:medium', 'core', 'epic:cub-b1c', 'model:sonnet', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:49:58.274198", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 46, "open": 46, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 14, "in_progress": 1, "closed": 14}, "difference_summary": "total: 46 != 29; open: 46 != 14; in_progress: 0 != 1; closed: 0 != 14"}
{"timestamp": "2026-01-28T19:49:58.384027", "operation": "close_task", "task_id": "cub-b1c.3", "primary_result": {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["architecture", "complexity:medium", "core", "epic:cub-b1c", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:44.409515Z", "updated_at": "2026-01-28T19:49:58.320690Z", "closed_at": "2026-01-28T19:49:58.320690Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['architecture', 'complexity:medium', 'core', 'epic:cub-b1c', 'model:sonnet', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:49:58.438619", "operation": "get_task", "task_id": "cub-b1c.3", "primary_result": {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["architecture", "complexity:medium", "core", "epic:cub-b1c", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:44.409515Z", "updated_at": "2026-01-28T19:49:58.320690Z", "closed_at": "2026-01-28T19:49:58.320690Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['architecture', 'complexity:medium', 'core', 'epic:cub-b1c', 'model:sonnet', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:50:09.257342", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "open", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": null, "labels": ["architecture", "complexity:medium", "core", "epic:cub-b1c", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409540Z", "updated_at": "2026-01-28T17:54:44.604480Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "open", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": null, "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T17:54:46.169561", "closed_at": null, "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1c.4): labels: ['architecture', 'complexity:medium', 'core', 'epic:cub-b1c', 'model:sonnet', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1c"}
{"timestamp": "2026-01-28T19:50:09.356297", "operation": "get_task", "task_id": "cub-b1c.4", "primary_result": {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "open", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": null, "labels": ["architecture", "complexity:medium", "core", "epic:cub-b1c", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:44.409540Z", "updated_at": "2026-01-28T17:54:44.604480Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "open", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": null, "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T17:54:46.169561", "closed_at": null, "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "difference_summary": "labels: ['architecture', 'complexity:medium', 'core', 'epic:cub-b1c', 'model:sonnet', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:50:09.538773", "operation": "update_task", "task_id": "cub-b1c.4", "primary_result": {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "in_progress", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["architecture", "complexity:medium", "core", "epic:cub-b1c", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:44.409540Z", "updated_at": "2026-01-28T19:50:09.444637Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "in_progress", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:50:09.536463", "closed_at": null, "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['architecture', 'complexity:medium', 'core', 'epic:cub-b1c', 'model:sonnet', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:58:57.648544", "operation": "get_task", "task_id": "cub-b1c.4", "primary_result": {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["architecture", "complexity:medium", "core", "epic:cub-b1c", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:44.409540Z", "updated_at": "2026-01-28T19:58:38.156789Z", "closed_at": "2026-01-28T19:58:38.156789Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "in_progress", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:50:09.536463", "closed_at": null, "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['architecture', 'complexity:medium', 'core', 'epic:cub-b1c', 'model:sonnet', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:58:57.711343", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 45, "open": 45, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 13, "in_progress": 1, "closed": 15}, "difference_summary": "total: 45 != 29; open: 45 != 13; in_progress: 0 != 1; closed: 0 != 15"}
{"timestamp": "2026-01-28T19:58:57.830391", "operation": "close_task", "task_id": "cub-b1c.4", "primary_result": {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["architecture", "complexity:medium", "core", "epic:cub-b1c", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:44.409540Z", "updated_at": "2026-01-28T19:58:57.761965Z", "closed_at": "2026-01-28T19:58:57.761965Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['architecture', 'complexity:medium', 'core', 'epic:cub-b1c', 'model:sonnet', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:58:57.912773", "operation": "get_task", "task_id": "cub-b1c.4", "primary_result": {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["architecture", "complexity:medium", "core", "epic:cub-b1c", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:44.409540Z", "updated_at": "2026-01-28T19:58:57.761965Z", "closed_at": "2026-01-28T19:58:57.761965Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['architecture', 'complexity:medium', 'core', 'epic:cub-b1c', 'model:sonnet', 'phase-3'] != ['phase-3', 'core', 'architecture', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T19:59:09.233441", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 45, "open": 45, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 13, "in_progress": 0, "closed": 16}, "difference_summary": "total: 45 != 29; open: 45 != 13; closed: 0 != 16"}
{"timestamp": "2026-01-28T19:59:14.170523", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 45, "open": 45, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 12, "in_progress": 0, "closed": 17}, "difference_summary": "total: 45 != 29; open: 45 != 12; closed: 0 != 17"}
{"timestamp": "2026-01-28T19:59:14.229840", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "open", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": null, "labels": ["blocking", "complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409562Z", "updated_at": "2026-01-28T17:54:44.604821Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "open", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": null, "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T17:54:46.169582", "closed_at": null, "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "open", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": null, "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T17:54:46.169599", "closed_at": null, "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "open", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": null, "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T17:54:46.169615", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 1 != 3"}
{"timestamp": "2026-01-28T19:59:14.276376", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "open", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": null, "labels": ["blocking", "complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409562Z", "updated_at": "2026-01-28T17:54:44.604821Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "open", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": null, "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T17:54:46.169582", "closed_at": null, "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "open", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": null, "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T17:54:46.169599", "closed_at": null, "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "open", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": null, "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T17:54:46.169615", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 1 != 3"}
{"timestamp": "2026-01-28T19:59:14.323720", "operation": "get_task", "task_id": "cub-b1d.1", "primary_result": {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "open", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": null, "labels": ["blocking", "complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:44.409562Z", "updated_at": "2026-01-28T17:54:44.604821Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "open", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": null, "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T17:54:46.169582", "closed_at": null, "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "difference_summary": "labels: ['blocking', 'complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium', 'blocking']"}
{"timestamp": "2026-01-28T19:59:14.468117", "operation": "update_task", "task_id": "cub-b1d.1", "primary_result": {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "in_progress", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["blocking", "complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:44.409562Z", "updated_at": "2026-01-28T19:59:14.386252Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "in_progress", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T19:59:14.466335", "closed_at": null, "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['blocking', 'complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium', 'blocking']"}
{"timestamp": "2026-01-28T20:09:46.276264", "operation": "get_task", "task_id": "cub-b1d.1", "primary_result": {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["blocking", "complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:44.409562Z", "updated_at": "2026-01-28T20:09:20.883659Z", "closed_at": "2026-01-28T20:09:20.883659Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "in_progress", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T19:59:14.466335", "closed_at": null, "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['blocking', 'complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium', 'blocking']"}
{"timestamp": "2026-01-28T20:09:46.341304", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 44, "open": 44, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 11, "in_progress": 1, "closed": 17}, "difference_summary": "total: 44 != 29; open: 44 != 11; in_progress: 0 != 1; closed: 0 != 17"}
{"timestamp": "2026-01-28T20:09:46.526240", "operation": "close_task", "task_id": "cub-b1d.1", "primary_result": {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["blocking", "complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:44.409562Z", "updated_at": "2026-01-28T20:09:46.417360Z", "closed_at": "2026-01-28T20:09:46.417360Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['blocking', 'complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium', 'blocking']"}
{"timestamp": "2026-01-28T20:09:46.621064", "operation": "get_task", "task_id": "cub-b1d.1", "primary_result": {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["blocking", "complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:44.409562Z", "updated_at": "2026-01-28T20:09:46.417360Z", "closed_at": "2026-01-28T20:09:46.417360Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['blocking', 'complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium', 'blocking']"}
{"timestamp": "2026-01-28T20:09:58.703459", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "open", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409584Z", "updated_at": "2026-01-28T17:54:44.605295Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "open", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T17:54:44.605810Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "open", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": null, "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T17:54:46.169599", "closed_at": null, "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "open", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": null, "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T17:54:46.169615", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1d.2): labels: ['complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1d; Task 1 (cub-b1d.3): labels: ['complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1d"}
{"timestamp": "2026-01-28T20:09:58.761582", "operation": "get_task", "task_id": "cub-b1d.2", "primary_result": {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "open", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:44.409584Z", "updated_at": "2026-01-28T17:54:44.605295Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "open", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": null, "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T17:54:46.169599", "closed_at": null, "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:09:58.887361", "operation": "update_task", "task_id": "cub-b1d.2", "primary_result": {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "in_progress", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:44.409584Z", "updated_at": "2026-01-28T20:09:58.816790Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "in_progress", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:09:58.885880", "closed_at": null, "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:15:09.034810", "operation": "get_task", "task_id": "cub-b1d.2", "primary_result": {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:44.409584Z", "updated_at": "2026-01-28T20:14:34.727029Z", "closed_at": "2026-01-28T20:14:34.727029Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "in_progress", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:09:58.885880", "closed_at": null, "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:15:09.094927", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 43, "open": 43, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 10, "in_progress": 1, "closed": 18}, "difference_summary": "total: 43 != 29; open: 43 != 10; in_progress: 0 != 1; closed: 0 != 18"}
{"timestamp": "2026-01-28T20:15:09.196828", "operation": "close_task", "task_id": "cub-b1d.2", "primary_result": {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:44.409584Z", "updated_at": "2026-01-28T20:15:09.135653Z", "closed_at": "2026-01-28T20:15:09.135653Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:15:09.253568", "operation": "get_task", "task_id": "cub-b1d.2", "primary_result": {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:44.409584Z", "updated_at": "2026-01-28T20:15:09.135653Z", "closed_at": "2026-01-28T20:15:09.135653Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:15:21.036101", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "open", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T17:54:44.605810Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "open", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": null, "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T17:54:46.169615", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1d.3): labels: ['complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1d"}
{"timestamp": "2026-01-28T20:15:21.087249", "operation": "get_task", "task_id": "cub-b1d.3", "primary_result": {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "open", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T17:54:44.605810Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "open", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": null, "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T17:54:46.169615", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:15:21.216881", "operation": "update_task", "task_id": "cub-b1d.3", "primary_result": {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:21.136375Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:15:21.212567", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:18:19.823408", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T17:54:44.408089", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "difference_summary": "List length mismatch: 23 != 9"}
{"timestamp": "2026-01-28T20:18:19.915930", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:15:21.212567", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1d.3): labels: ['complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1d"}
{"timestamp": "2026-01-28T20:18:20.035753", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T17:54:44.408089", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 42 != 9"}
{"timestamp": "2026-01-28T20:18:20.204520", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "closed", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["phase-1", "core", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407838", "updated_at": "2026-01-28T18:57:22.732005", "closed_at": "2026-01-28T18:57:22.732002", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T18:57:22.732007] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "closed", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["phase-2", "core", "refactor", "cleanup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407983", "updated_at": "2026-01-28T19:20:21.672421", "closed_at": "2026-01-28T19:20:21.672417", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:20:21.672422] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "closed", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["phase-3", "core", "architecture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408044", "updated_at": "2026-01-28T19:59:09.455587", "closed_at": "2026-01-28T19:59:09.455581", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:59:09.455589] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T17:54:44.408089", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:15:21.212567", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 43 != 29"}
{"timestamp": "2026-01-28T20:18:20.271096", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1e.1): labels: ['blocking', 'cli', 'complexity:high', 'epic:cub-b1e', 'feature', 'model:opus', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:opus', 'complexity:high', 'blocking']; parent: None != cub-b1e; Task 1 (cub-b1e.2): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'feature', 'model:sonnet', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e; Task 2 (cub-b1e.3): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'model:sonnet', 'phase-5', 'test'] != ['phase-5', 'cli', 'test', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e"}
{"timestamp": "2026-01-28T20:18:20.319915", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 5"}
{"timestamp": "2026-01-28T20:18:20.366567", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1e.1): labels: ['blocking', 'cli', 'complexity:high', 'epic:cub-b1e', 'feature', 'model:opus', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:opus', 'complexity:high', 'blocking']; parent: None != cub-b1e; Task 1 (cub-b1e.2): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'feature', 'model:sonnet', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e; Task 2 (cub-b1e.3): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'model:sonnet', 'phase-5', 'test'] != ['phase-5', 'cli', 'test', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e"}
{"timestamp": "2026-01-28T20:18:20.415346", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 5"}
{"timestamp": "2026-01-28T20:18:20.597186", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:15:21.212567", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 1 != 3"}
{"timestamp": "2026-01-28T20:18:20.642895", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 4"}
{"timestamp": "2026-01-28T20:18:20.694226", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 5"}
{"timestamp": "2026-01-28T20:18:20.889058", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}], "secondary_result": "[]", "difference_summary": "List length mismatch: 5 != 0"}
{"timestamp": "2026-01-28T20:18:20.981579", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "secondary_result": [{"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1f.1): labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'feature', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f; Task 1 (cub-b1f.2): labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f; Task 2 (cub-b1f.3): labels: ['complexity:medium', 'epic:cub-b1f', 'model:sonnet', 'phase-6', 'test'] != ['phase-6', 'test', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f"}
{"timestamp": "2026-01-28T20:18:21.095227", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}], "secondary_result": "[]", "difference_summary": "List length mismatch: 3 != 0"}
{"timestamp": "2026-01-28T20:18:21.146540", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}], "secondary_result": "[]", "difference_summary": "List length mismatch: 3 != 0"}
{"timestamp": "2026-01-28T20:18:21.271510", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": "[]", "difference_summary": "List length mismatch: 3 != 0"}
{"timestamp": "2026-01-28T20:18:33.314018", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T17:54:44.408089", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "difference_summary": "List length mismatch: 23 != 9"}
{"timestamp": "2026-01-28T20:18:33.365142", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:15:21.212567", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1d.3): labels: ['complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1d"}
{"timestamp": "2026-01-28T20:18:33.421812", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T17:54:44.408089", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 42 != 9"}
{"timestamp": "2026-01-28T20:18:33.550057", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "closed", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["phase-1", "core", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407838", "updated_at": "2026-01-28T18:57:22.732005", "closed_at": "2026-01-28T18:57:22.732002", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T18:57:22.732007] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "closed", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["phase-2", "core", "refactor", "cleanup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407983", "updated_at": "2026-01-28T19:20:21.672421", "closed_at": "2026-01-28T19:20:21.672417", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:20:21.672422] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "closed", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["phase-3", "core", "architecture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408044", "updated_at": "2026-01-28T19:59:09.455587", "closed_at": "2026-01-28T19:59:09.455581", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:59:09.455589] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T17:54:44.408089", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:15:21.212567", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 43 != 29"}
{"timestamp": "2026-01-28T20:18:33.606894", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1e.1): labels: ['blocking', 'cli', 'complexity:high', 'epic:cub-b1e', 'feature', 'model:opus', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:opus', 'complexity:high', 'blocking']; parent: None != cub-b1e; Task 1 (cub-b1e.2): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'feature', 'model:sonnet', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e; Task 2 (cub-b1e.3): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'model:sonnet', 'phase-5', 'test'] != ['phase-5', 'cli', 'test', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e"}
{"timestamp": "2026-01-28T20:18:33.669821", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 5"}
{"timestamp": "2026-01-28T20:18:33.722004", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1e.1): labels: ['blocking', 'cli', 'complexity:high', 'epic:cub-b1e', 'feature', 'model:opus', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:opus', 'complexity:high', 'blocking']; parent: None != cub-b1e; Task 1 (cub-b1e.2): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'feature', 'model:sonnet', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e; Task 2 (cub-b1e.3): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'model:sonnet', 'phase-5', 'test'] != ['phase-5', 'cli', 'test', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e"}
{"timestamp": "2026-01-28T20:18:33.769916", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 5"}
{"timestamp": "2026-01-28T20:18:33.976627", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:15:21.212567", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 1 != 3"}
{"timestamp": "2026-01-28T20:18:34.038887", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 4"}
{"timestamp": "2026-01-28T20:18:34.106782", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 5"}
{"timestamp": "2026-01-28T20:18:34.433745", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}], "secondary_result": "[]", "difference_summary": "List length mismatch: 5 != 0"}
{"timestamp": "2026-01-28T20:18:34.627828", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "secondary_result": [{"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1f.1): labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'feature', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f; Task 1 (cub-b1f.2): labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f; Task 2 (cub-b1f.3): labels: ['complexity:medium', 'epic:cub-b1f', 'model:sonnet', 'phase-6', 'test'] != ['phase-6', 'test', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f"}
{"timestamp": "2026-01-28T20:18:34.809326", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}], "secondary_result": "[]", "difference_summary": "List length mismatch: 3 != 0"}
{"timestamp": "2026-01-28T20:18:34.896264", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}], "secondary_result": "[]", "difference_summary": "List length mismatch: 3 != 0"}
{"timestamp": "2026-01-28T20:18:35.072741", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": "[]", "difference_summary": "List length mismatch: 3 != 0"}
{"timestamp": "2026-01-28T20:18:42.468074", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T17:54:44.408089", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "difference_summary": "List length mismatch: 23 != 9"}
{"timestamp": "2026-01-28T20:18:42.541940", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:15:21.212567", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1d.3): labels: ['complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1d"}
{"timestamp": "2026-01-28T20:18:42.643420", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T17:54:44.408089", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 42 != 9"}
{"timestamp": "2026-01-28T20:18:42.797848", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "closed", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["phase-1", "core", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407838", "updated_at": "2026-01-28T18:57:22.732005", "closed_at": "2026-01-28T18:57:22.732002", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T18:57:22.732007] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "closed", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["phase-2", "core", "refactor", "cleanup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407983", "updated_at": "2026-01-28T19:20:21.672421", "closed_at": "2026-01-28T19:20:21.672417", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:20:21.672422] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "closed", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["phase-3", "core", "architecture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408044", "updated_at": "2026-01-28T19:59:09.455587", "closed_at": "2026-01-28T19:59:09.455581", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:59:09.455589] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T17:54:44.408089", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:15:21.212567", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 43 != 29"}
{"timestamp": "2026-01-28T20:18:42.856500", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1e.1): labels: ['blocking', 'cli', 'complexity:high', 'epic:cub-b1e', 'feature', 'model:opus', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:opus', 'complexity:high', 'blocking']; parent: None != cub-b1e; Task 1 (cub-b1e.2): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'feature', 'model:sonnet', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e; Task 2 (cub-b1e.3): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'model:sonnet', 'phase-5', 'test'] != ['phase-5', 'cli', 'test', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e"}
{"timestamp": "2026-01-28T20:18:42.912408", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 5"}
{"timestamp": "2026-01-28T20:18:42.972763", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1e.1): labels: ['blocking', 'cli', 'complexity:high', 'epic:cub-b1e', 'feature', 'model:opus', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:opus', 'complexity:high', 'blocking']; parent: None != cub-b1e; Task 1 (cub-b1e.2): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'feature', 'model:sonnet', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e; Task 2 (cub-b1e.3): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'model:sonnet', 'phase-5', 'test'] != ['phase-5', 'cli', 'test', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e"}
{"timestamp": "2026-01-28T20:18:43.026846", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 5"}
{"timestamp": "2026-01-28T20:18:43.238189", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:15:21.212567", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 1 != 3"}
{"timestamp": "2026-01-28T20:18:43.287509", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 4"}
{"timestamp": "2026-01-28T20:18:43.340383", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 5"}
{"timestamp": "2026-01-28T20:18:43.532014", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}], "secondary_result": "[]", "difference_summary": "List length mismatch: 5 != 0"}
{"timestamp": "2026-01-28T20:18:43.630403", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "secondary_result": [{"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1f.1): labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'feature', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f; Task 1 (cub-b1f.2): labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f; Task 2 (cub-b1f.3): labels: ['complexity:medium', 'epic:cub-b1f', 'model:sonnet', 'phase-6', 'test'] != ['phase-6', 'test', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f"}
{"timestamp": "2026-01-28T20:18:43.736016", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}], "secondary_result": "[]", "difference_summary": "List length mismatch: 3 != 0"}
{"timestamp": "2026-01-28T20:18:43.788151", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}], "secondary_result": "[]", "difference_summary": "List length mismatch: 3 != 0"}
{"timestamp": "2026-01-28T20:18:43.893295", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": "[]", "difference_summary": "List length mismatch: 3 != 0"}
{"timestamp": "2026-01-28T20:20:35.440647", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T17:54:44.408089", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "difference_summary": "List length mismatch: 23 != 9"}
{"timestamp": "2026-01-28T20:20:35.495895", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:15:21.212567", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1d.3): labels: ['complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1d"}
{"timestamp": "2026-01-28T20:20:35.551347", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T17:54:44.408089", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 42 != 9"}
{"timestamp": "2026-01-28T20:20:35.686459", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "closed", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["phase-1", "core", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407838", "updated_at": "2026-01-28T18:57:22.732005", "closed_at": "2026-01-28T18:57:22.732002", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T18:57:22.732007] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "closed", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["phase-2", "core", "refactor", "cleanup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407983", "updated_at": "2026-01-28T19:20:21.672421", "closed_at": "2026-01-28T19:20:21.672417", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:20:21.672422] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "closed", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["phase-3", "core", "architecture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408044", "updated_at": "2026-01-28T19:59:09.455587", "closed_at": "2026-01-28T19:59:09.455581", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:59:09.455589] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T17:54:44.408089", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:15:21.212567", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 43 != 29"}
{"timestamp": "2026-01-28T20:20:35.743839", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1e.1): labels: ['blocking', 'cli', 'complexity:high', 'epic:cub-b1e', 'feature', 'model:opus', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:opus', 'complexity:high', 'blocking']; parent: None != cub-b1e; Task 1 (cub-b1e.2): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'feature', 'model:sonnet', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e; Task 2 (cub-b1e.3): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'model:sonnet', 'phase-5', 'test'] != ['phase-5', 'cli', 'test', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e"}
{"timestamp": "2026-01-28T20:20:35.803797", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 5"}
{"timestamp": "2026-01-28T20:20:35.855826", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1e.1): labels: ['blocking', 'cli', 'complexity:high', 'epic:cub-b1e', 'feature', 'model:opus', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:opus', 'complexity:high', 'blocking']; parent: None != cub-b1e; Task 1 (cub-b1e.2): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'feature', 'model:sonnet', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e; Task 2 (cub-b1e.3): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'model:sonnet', 'phase-5', 'test'] != ['phase-5', 'cli', 'test', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e"}
{"timestamp": "2026-01-28T20:20:35.907940", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 5"}
{"timestamp": "2026-01-28T20:20:36.133375", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:15:21.212567", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 1 != 3"}
{"timestamp": "2026-01-28T20:20:36.186832", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 4"}
{"timestamp": "2026-01-28T20:20:36.236261", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 5"}
{"timestamp": "2026-01-28T20:20:36.511400", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}], "secondary_result": "[]", "difference_summary": "List length mismatch: 5 != 0"}
{"timestamp": "2026-01-28T20:20:36.640255", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "secondary_result": [{"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1f.1): labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'feature', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f; Task 1 (cub-b1f.2): labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f; Task 2 (cub-b1f.3): labels: ['complexity:medium', 'epic:cub-b1f', 'model:sonnet', 'phase-6', 'test'] != ['phase-6', 'test', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f"}
{"timestamp": "2026-01-28T20:20:36.778537", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}], "secondary_result": "[]", "difference_summary": "List length mismatch: 3 != 0"}
{"timestamp": "2026-01-28T20:20:36.845916", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}], "secondary_result": "[]", "difference_summary": "List length mismatch: 3 != 0"}
{"timestamp": "2026-01-28T20:20:36.987665", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": "[]", "difference_summary": "List length mismatch: 3 != 0"}
{"timestamp": "2026-01-28T20:20:37.088620", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T17:54:44.408089", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "difference_summary": "List length mismatch: 23 != 9"}
{"timestamp": "2026-01-28T20:20:37.156236", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:15:21.212567", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1d.3): labels: ['complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1d"}
{"timestamp": "2026-01-28T20:20:37.246442", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T17:54:44.408089", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 42 != 9"}
{"timestamp": "2026-01-28T20:20:37.370842", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "closed", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["phase-1", "core", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407838", "updated_at": "2026-01-28T18:57:22.732005", "closed_at": "2026-01-28T18:57:22.732002", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T18:57:22.732007] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "closed", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["phase-2", "core", "refactor", "cleanup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407983", "updated_at": "2026-01-28T19:20:21.672421", "closed_at": "2026-01-28T19:20:21.672417", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:20:21.672422] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "closed", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["phase-3", "core", "architecture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408044", "updated_at": "2026-01-28T19:59:09.455587", "closed_at": "2026-01-28T19:59:09.455581", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:59:09.455589] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T17:54:44.408089", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:15:21.212567", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 43 != 29"}
{"timestamp": "2026-01-28T20:20:37.423246", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1e.1): labels: ['blocking', 'cli', 'complexity:high', 'epic:cub-b1e', 'feature', 'model:opus', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:opus', 'complexity:high', 'blocking']; parent: None != cub-b1e; Task 1 (cub-b1e.2): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'feature', 'model:sonnet', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e; Task 2 (cub-b1e.3): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'model:sonnet', 'phase-5', 'test'] != ['phase-5', 'cli', 'test', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e"}
{"timestamp": "2026-01-28T20:20:37.468468", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 5"}
{"timestamp": "2026-01-28T20:20:37.519703", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1e.1): labels: ['blocking', 'cli', 'complexity:high', 'epic:cub-b1e', 'feature', 'model:opus', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:opus', 'complexity:high', 'blocking']; parent: None != cub-b1e; Task 1 (cub-b1e.2): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'feature', 'model:sonnet', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e; Task 2 (cub-b1e.3): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'model:sonnet', 'phase-5', 'test'] != ['phase-5', 'cli', 'test', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e"}
{"timestamp": "2026-01-28T20:20:37.571190", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 5"}
{"timestamp": "2026-01-28T20:20:37.780572", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:15:21.212567", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 1 != 3"}
{"timestamp": "2026-01-28T20:20:37.833375", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 4"}
{"timestamp": "2026-01-28T20:20:37.889561", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 5"}
{"timestamp": "2026-01-28T20:20:38.084764", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}], "secondary_result": "[]", "difference_summary": "List length mismatch: 5 != 0"}
{"timestamp": "2026-01-28T20:20:38.176940", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "secondary_result": [{"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1f.1): labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'feature', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f; Task 1 (cub-b1f.2): labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f; Task 2 (cub-b1f.3): labels: ['complexity:medium', 'epic:cub-b1f', 'model:sonnet', 'phase-6', 'test'] != ['phase-6', 'test', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f"}
{"timestamp": "2026-01-28T20:20:38.286664", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}], "secondary_result": "[]", "difference_summary": "List length mismatch: 3 != 0"}
{"timestamp": "2026-01-28T20:20:38.333617", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}], "secondary_result": "[]", "difference_summary": "List length mismatch: 3 != 0"}
{"timestamp": "2026-01-28T20:20:38.437705", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": "[]", "difference_summary": "List length mismatch: 3 != 0"}
{"timestamp": "2026-01-28T20:20:38.492176", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T17:54:44.408089", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "difference_summary": "List length mismatch: 23 != 9"}
{"timestamp": "2026-01-28T20:20:38.540243", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:15:21.212567", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1d.3): labels: ['complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1d"}
{"timestamp": "2026-01-28T20:20:38.595363", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T17:54:44.408089", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 42 != 9"}
{"timestamp": "2026-01-28T20:20:38.723890", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "closed", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["phase-1", "core", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407838", "updated_at": "2026-01-28T18:57:22.732005", "closed_at": "2026-01-28T18:57:22.732002", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T18:57:22.732007] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "closed", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["phase-2", "core", "refactor", "cleanup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407983", "updated_at": "2026-01-28T19:20:21.672421", "closed_at": "2026-01-28T19:20:21.672417", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:20:21.672422] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "closed", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["phase-3", "core", "architecture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408044", "updated_at": "2026-01-28T19:59:09.455587", "closed_at": "2026-01-28T19:59:09.455581", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:59:09.455589] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T17:54:44.408089", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:15:21.212567", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 43 != 29"}
{"timestamp": "2026-01-28T20:20:38.774119", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1e.1): labels: ['blocking', 'cli', 'complexity:high', 'epic:cub-b1e', 'feature', 'model:opus', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:opus', 'complexity:high', 'blocking']; parent: None != cub-b1e; Task 1 (cub-b1e.2): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'feature', 'model:sonnet', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e; Task 2 (cub-b1e.3): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'model:sonnet', 'phase-5', 'test'] != ['phase-5', 'cli', 'test', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e"}
{"timestamp": "2026-01-28T20:20:38.821240", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 5"}
{"timestamp": "2026-01-28T20:20:38.861944", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1e.1): labels: ['blocking', 'cli', 'complexity:high', 'epic:cub-b1e', 'feature', 'model:opus', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:opus', 'complexity:high', 'blocking']; parent: None != cub-b1e; Task 1 (cub-b1e.2): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'feature', 'model:sonnet', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e; Task 2 (cub-b1e.3): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'model:sonnet', 'phase-5', 'test'] != ['phase-5', 'cli', 'test', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e"}
{"timestamp": "2026-01-28T20:20:38.910572", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 5"}
{"timestamp": "2026-01-28T20:20:39.199216", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:15:21.212567", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 1 != 3"}
{"timestamp": "2026-01-28T20:20:39.261118", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 4"}
{"timestamp": "2026-01-28T20:20:39.315640", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 5"}
{"timestamp": "2026-01-28T20:20:39.494194", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}], "secondary_result": "[]", "difference_summary": "List length mismatch: 5 != 0"}
{"timestamp": "2026-01-28T20:20:39.593402", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "secondary_result": [{"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1f.1): labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'feature', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f; Task 1 (cub-b1f.2): labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f; Task 2 (cub-b1f.3): labels: ['complexity:medium', 'epic:cub-b1f', 'model:sonnet', 'phase-6', 'test'] != ['phase-6', 'test', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f"}
{"timestamp": "2026-01-28T20:20:39.690410", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}], "secondary_result": "[]", "difference_summary": "List length mismatch: 3 != 0"}
{"timestamp": "2026-01-28T20:20:39.744408", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}], "secondary_result": "[]", "difference_summary": "List length mismatch: 3 != 0"}
{"timestamp": "2026-01-28T20:20:39.846794", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": "[]", "difference_summary": "List length mismatch: 3 != 0"}
{"timestamp": "2026-01-28T20:20:39.908939", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "closed", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["phase-1", "core", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407838", "updated_at": "2026-01-28T18:57:22.732005", "closed_at": "2026-01-28T18:57:22.732002", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T18:57:22.732007] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "closed", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["phase-2", "core", "refactor", "cleanup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407983", "updated_at": "2026-01-28T19:20:21.672421", "closed_at": "2026-01-28T19:20:21.672417", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:20:21.672422] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "closed", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["phase-3", "core", "architecture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408044", "updated_at": "2026-01-28T19:59:09.455587", "closed_at": "2026-01-28T19:59:09.455581", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:59:09.455589] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T17:54:44.408089", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:15:21.212567", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 43 != 29"}
{"timestamp": "2026-01-28T20:20:39.975041", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T17:54:44.408089", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 42 != 9"}
{"timestamp": "2026-01-28T20:20:40.028453", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:15:21.212567", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1d.3): labels: ['complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1d"}
{"timestamp": "2026-01-28T20:20:40.091170", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:15:28.251750Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T17:54:44.408089", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "difference_summary": "List length mismatch: 23 != 9"}
{"timestamp": "2026-01-28T20:22:31.855701", "operation": "get_task", "task_id": "cub-b1d.3", "primary_result": {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "closed", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:21:11.346326Z", "closed_at": "2026-01-28T20:21:11.346326Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "in_progress", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:15:21.212567", "closed_at": null, "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:22:31.939831", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 42, "open": 42, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 9, "in_progress": 1, "closed": 19}, "difference_summary": "total: 42 != 29; open: 42 != 9; in_progress: 0 != 1; closed: 0 != 19"}
{"timestamp": "2026-01-28T20:22:32.064946", "operation": "close_task", "task_id": "cub-b1d.3", "primary_result": {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "closed", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:22:31.989371Z", "closed_at": "2026-01-28T20:22:31.989371Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "closed", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:22:32.062910", "closed_at": "2026-01-28T20:22:32.062906", "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "[Closed: 2026-01-28T20:22:32.062912] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:22:32.125849", "operation": "get_task", "task_id": "cub-b1d.3", "primary_result": {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "closed", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["complexity:medium", "core", "epic:cub-b1d", "feature", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:44.409608Z", "updated_at": "2026-01-28T20:22:31.989371Z", "closed_at": "2026-01-28T20:22:31.989371Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "closed", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:22:32.062910", "closed_at": "2026-01-28T20:22:32.062906", "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "[Closed: 2026-01-28T20:22:32.062912] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'core', 'epic:cub-b1d', 'feature', 'model:sonnet', 'phase-4'] != ['phase-4', 'core', 'feature', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:22:41.965518", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 42, "open": 42, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 9, "in_progress": 0, "closed": 20}, "difference_summary": "total: 42 != 29; open: 42 != 9; closed: 0 != 20"}
{"timestamp": "2026-01-28T20:22:45.860330", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 42, "open": 42, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 8, "in_progress": 0, "closed": 21}, "difference_summary": "total: 42 != 29; open: 42 != 8; closed: 0 != 21"}
{"timestamp": "2026-01-28T20:22:45.912005", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}], "secondary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 1 != 3"}
{"timestamp": "2026-01-28T20:22:45.959619", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}], "secondary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 1 != 3"}
{"timestamp": "2026-01-28T20:22:46.008001", "operation": "get_task", "task_id": "cub-b1e.1", "primary_result": {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T17:54:44.606341Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, "secondary_result": {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "open", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T17:54:46.169633", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, "difference_summary": "labels: ['blocking', 'cli', 'complexity:high', 'epic:cub-b1e', 'feature', 'model:opus', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:opus', 'complexity:high', 'blocking']"}
{"timestamp": "2026-01-28T20:22:46.114251", "operation": "update_task", "task_id": "cub-b1e.1", "primary_result": {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "in_progress", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": "cub-20260128-202245", "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T20:22:46.056072Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "in_progress", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T20:22:46.112534", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['blocking', 'cli', 'complexity:high', 'epic:cub-b1e', 'feature', 'model:opus', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:opus', 'complexity:high', 'blocking']"}
{"timestamp": "2026-01-28T20:31:26.329579", "operation": "get_task", "task_id": "cub-b1e.1", "primary_result": {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "closed", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": "cub-20260128-202245", "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T20:30:50.923624Z", "closed_at": "2026-01-28T20:30:50.923624Z", "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "in_progress", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T20:22:46.112534", "closed_at": null, "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['blocking', 'cli', 'complexity:high', 'epic:cub-b1e', 'feature', 'model:opus', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:opus', 'complexity:high', 'blocking']"}
{"timestamp": "2026-01-28T20:31:26.383042", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 41, "open": 41, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 7, "in_progress": 1, "closed": 21}, "difference_summary": "total: 41 != 29; open: 41 != 7; in_progress: 0 != 1; closed: 0 != 21"}
{"timestamp": "2026-01-28T20:31:26.495095", "operation": "close_task", "task_id": "cub-b1e.1", "primary_result": {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "closed", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": "cub-20260128-202245", "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T20:31:26.430617Z", "closed_at": "2026-01-28T20:31:26.430617Z", "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "closed", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T20:31:26.493282", "closed_at": "2026-01-28T20:31:26.493257", "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "[Closed: 2026-01-28T20:31:26.493284] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['blocking', 'cli', 'complexity:high', 'epic:cub-b1e', 'feature', 'model:opus', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:opus', 'complexity:high', 'blocking']"}
{"timestamp": "2026-01-28T20:31:26.554058", "operation": "get_task", "task_id": "cub-b1e.1", "primary_result": {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "closed", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": "cub-20260128-202245", "labels": ["blocking", "cli", "complexity:high", "epic:cub-b1e", "feature", "model:opus", "phase-5"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:44.409628Z", "updated_at": "2026-01-28T20:31:26.430617Z", "closed_at": "2026-01-28T20:31:26.430617Z", "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "closed", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T20:31:26.493282", "closed_at": "2026-01-28T20:31:26.493257", "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "[Closed: 2026-01-28T20:31:26.493284] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['blocking', 'cli', 'complexity:high', 'epic:cub-b1e', 'feature', 'model:opus', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:opus', 'complexity:high', 'blocking']"}
{"timestamp": "2026-01-28T20:31:38.711464", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1e.2): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'feature', 'model:sonnet', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e; Task 1 (cub-b1e.3): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'model:sonnet', 'phase-5', 'test'] != ['phase-5', 'cli', 'test', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e"}
{"timestamp": "2026-01-28T20:31:38.781826", "operation": "get_task", "task_id": "cub-b1e.2", "primary_result": {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T17:54:44.606870Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "open", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": null, "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T17:54:46.169652", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "difference_summary": "labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'feature', 'model:sonnet', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:31:38.904441", "operation": "update_task", "task_id": "cub-b1e.2", "primary_result": {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "in_progress", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": "cub-20260128-202245", "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T20:31:38.840373Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "in_progress", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T20:31:38.903181", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'feature', 'model:sonnet', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:37:11.815809", "operation": "get_task", "task_id": "cub-b1e.2", "primary_result": {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "closed", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": "cub-20260128-202245", "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T20:36:09.869839Z", "closed_at": "2026-01-28T20:36:09.869839Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "in_progress", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T20:31:38.903181", "closed_at": null, "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'feature', 'model:sonnet', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:37:11.865169", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 40, "open": 40, "in_progress": 0, "closed": 0}, "secondary_result": {"total": 29, "open": 6, "in_progress": 1, "closed": 22}, "difference_summary": "total: 40 != 29; open: 40 != 6; in_progress: 0 != 1; closed: 0 != 22"}
{"timestamp": "2026-01-28T20:37:11.974095", "operation": "close_task", "task_id": "cub-b1e.2", "primary_result": {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "closed", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": "cub-20260128-202245", "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T20:37:11.913442Z", "closed_at": "2026-01-28T20:37:11.913442Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "closed", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T20:37:11.972618", "closed_at": "2026-01-28T20:37:11.972614", "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "[Closed: 2026-01-28T20:37:11.972622] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'feature', 'model:sonnet', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:37:12.044838", "operation": "get_task", "task_id": "cub-b1e.2", "primary_result": {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "closed", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": "cub-20260128-202245", "labels": ["cli", "complexity:medium", "epic:cub-b1e", "feature", "model:sonnet", "phase-5"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:44.409649Z", "updated_at": "2026-01-28T20:37:11.913442Z", "closed_at": "2026-01-28T20:37:11.913442Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "closed", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T20:37:11.972618", "closed_at": "2026-01-28T20:37:11.972614", "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "[Closed: 2026-01-28T20:37:11.972622] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'feature', 'model:sonnet', 'phase-5'] != ['phase-5', 'cli', 'feature', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:37:23.918049", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-b1e.3): labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'model:sonnet', 'phase-5', 'test'] != ['phase-5', 'cli', 'test', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1e"}
{"timestamp": "2026-01-28T20:37:23.970584", "operation": "get_task", "task_id": "cub-b1e.3", "primary_result": {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T17:54:44.607353Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "open", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": null, "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T17:54:46.169674", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "difference_summary": "labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'model:sonnet', 'phase-5', 'test'] != ['phase-5', 'cli', 'test', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:37:24.108869", "operation": "update_task", "task_id": "cub-b1e.3", "primary_result": {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "in_progress", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T20:37:24.031408Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "in_progress", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T20:37:24.107553", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'model:sonnet', 'phase-5', 'test'] != ['phase-5', 'cli', 'test', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:40:15.005223", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "in_progress", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T20:37:32.147989Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "closed", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["phase-1", "core", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407838", "updated_at": "2026-01-28T18:57:22.732005", "closed_at": "2026-01-28T18:57:22.732002", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T18:57:22.732007] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "closed", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["phase-2", "core", "refactor", "cleanup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407983", "updated_at": "2026-01-28T19:20:21.672421", "closed_at": "2026-01-28T19:20:21.672417", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:20:21.672422] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "closed", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["phase-3", "core", "architecture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408044", "updated_at": "2026-01-28T19:59:09.455587", "closed_at": "2026-01-28T19:59:09.455581", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:59:09.455589] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "closed", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T20:22:42.124609", "closed_at": "2026-01-28T20:22:42.124605", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T20:22:42.124610] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "closed", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:22:32.062910", "closed_at": "2026-01-28T20:22:32.062906", "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "[Closed: 2026-01-28T20:22:32.062912] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "closed", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T20:31:26.493282", "closed_at": "2026-01-28T20:31:26.493257", "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "[Closed: 2026-01-28T20:31:26.493284] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "closed", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T20:37:11.972618", "closed_at": "2026-01-28T20:37:11.972614", "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "[Closed: 2026-01-28T20:37:11.972622] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "in_progress", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T20:37:24.107553", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 40 != 29"}
{"timestamp": "2026-01-28T20:41:12.522749", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 40, "open": 39, "in_progress": 1, "closed": 0}, "secondary_result": {"total": 29, "open": 5, "in_progress": 1, "closed": 23}, "difference_summary": "total: 40 != 29; open: 39 != 5; closed: 0 != 23"}
{"timestamp": "2026-01-28T20:41:12.581664", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "in_progress", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T20:37:32.147989Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "difference_summary": "List length mismatch: 22 != 5"}
{"timestamp": "2026-01-28T20:41:12.638028", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "in_progress", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T20:37:32.147989Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "difference_summary": "List length mismatch: 22 != 5"}
{"timestamp": "2026-01-28T20:41:12.713606", "operation": "get_task", "task_id": "cub-r1a", "primary_result": {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "open", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": null, "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T03:34:52.131307Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, "secondary_result": "None", "difference_summary": "Secondary task is None, primary is not"}
{"timestamp": "2026-01-28T20:43:28.795560", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 40, "open": 38, "in_progress": 2, "closed": 0}, "secondary_result": {"total": 29, "open": 5, "in_progress": 1, "closed": 23}, "difference_summary": "total: 40 != 29; open: 38 != 5; in_progress: 2 != 1; closed: 0 != 23"}
{"timestamp": "2026-01-28T20:43:28.852811", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "in_progress", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": "cub-20260128-204112", "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T20:41:24.531384Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "in_progress", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T20:37:32.147989Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "difference_summary": "List length mismatch: 22 != 5"}
{"timestamp": "2026-01-28T20:43:28.915212", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "in_progress", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": "cub-20260128-204112", "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T20:41:24.531384Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "in_progress", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T20:37:32.147989Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "difference_summary": "List length mismatch: 22 != 5"}
{"timestamp": "2026-01-28T20:43:28.973879", "operation": "get_task", "task_id": "cub-r1a", "primary_result": {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "in_progress", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": "cub-20260128-204112", "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T20:41:24.531384Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, "secondary_result": "None", "difference_summary": "Secondary task is None, primary is not"}
{"timestamp": "2026-01-28T20:44:06.548944", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "in_progress", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": "cub-20260128-204328", "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T20:43:29.037004Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "in_progress", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T20:37:32.147989Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "closed", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["phase-1", "core", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407838", "updated_at": "2026-01-28T18:57:22.732005", "closed_at": "2026-01-28T18:57:22.732002", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T18:57:22.732007] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "closed", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["phase-2", "core", "refactor", "cleanup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407983", "updated_at": "2026-01-28T19:20:21.672421", "closed_at": "2026-01-28T19:20:21.672417", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:20:21.672422] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "closed", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["phase-3", "core", "architecture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408044", "updated_at": "2026-01-28T19:59:09.455587", "closed_at": "2026-01-28T19:59:09.455581", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:59:09.455589] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "closed", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T20:22:42.124609", "closed_at": "2026-01-28T20:22:42.124605", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T20:22:42.124610] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "closed", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:22:32.062910", "closed_at": "2026-01-28T20:22:32.062906", "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "[Closed: 2026-01-28T20:22:32.062912] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "closed", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T20:31:26.493282", "closed_at": "2026-01-28T20:31:26.493257", "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "[Closed: 2026-01-28T20:31:26.493284] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "closed", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T20:37:11.972618", "closed_at": "2026-01-28T20:37:11.972614", "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "[Closed: 2026-01-28T20:37:11.972622] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "in_progress", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T20:37:24.107553", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 40 != 29"}
{"timestamp": "2026-01-28T20:44:28.700091", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "in_progress", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": "cub-20260128-204328", "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T20:43:29.037004Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "in_progress", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T20:37:32.147989Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "closed", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["phase-1", "core", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407838", "updated_at": "2026-01-28T18:57:22.732005", "closed_at": "2026-01-28T18:57:22.732002", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T18:57:22.732007] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "closed", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["phase-2", "core", "refactor", "cleanup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407983", "updated_at": "2026-01-28T19:20:21.672421", "closed_at": "2026-01-28T19:20:21.672417", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:20:21.672422] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "closed", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["phase-3", "core", "architecture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408044", "updated_at": "2026-01-28T19:59:09.455587", "closed_at": "2026-01-28T19:59:09.455581", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:59:09.455589] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "closed", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T20:22:42.124609", "closed_at": "2026-01-28T20:22:42.124605", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T20:22:42.124610] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "closed", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:22:32.062910", "closed_at": "2026-01-28T20:22:32.062906", "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "[Closed: 2026-01-28T20:22:32.062912] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "closed", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T20:31:26.493282", "closed_at": "2026-01-28T20:31:26.493257", "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "[Closed: 2026-01-28T20:31:26.493284] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "closed", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T20:37:11.972618", "closed_at": "2026-01-28T20:37:11.972614", "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "[Closed: 2026-01-28T20:37:11.972622] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "in_progress", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T20:37:24.107553", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 40 != 29"}
{"timestamp": "2026-01-28T20:44:49.035063", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "in_progress", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": "cub-20260128-204328", "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T20:43:29.037004Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "in_progress", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T20:37:32.147989Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "closed", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["phase-1", "core", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407838", "updated_at": "2026-01-28T18:57:22.732005", "closed_at": "2026-01-28T18:57:22.732002", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T18:57:22.732007] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "closed", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["phase-2", "core", "refactor", "cleanup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407983", "updated_at": "2026-01-28T19:20:21.672421", "closed_at": "2026-01-28T19:20:21.672417", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:20:21.672422] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "closed", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["phase-3", "core", "architecture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408044", "updated_at": "2026-01-28T19:59:09.455587", "closed_at": "2026-01-28T19:59:09.455581", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:59:09.455589] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "closed", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T20:22:42.124609", "closed_at": "2026-01-28T20:22:42.124605", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T20:22:42.124610] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "closed", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:22:32.062910", "closed_at": "2026-01-28T20:22:32.062906", "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "[Closed: 2026-01-28T20:22:32.062912] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "closed", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T20:31:26.493282", "closed_at": "2026-01-28T20:31:26.493257", "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "[Closed: 2026-01-28T20:31:26.493284] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "closed", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T20:37:11.972618", "closed_at": "2026-01-28T20:37:11.972614", "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "[Closed: 2026-01-28T20:37:11.972622] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "in_progress", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T20:37:24.107553", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 40 != 29"}
{"timestamp": "2026-01-28T20:45:17.856279", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "in_progress", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": "cub-20260128-204328", "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T20:43:29.037004Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "in_progress", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T20:37:32.147989Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "closed", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["phase-1", "core", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407838", "updated_at": "2026-01-28T18:57:22.732005", "closed_at": "2026-01-28T18:57:22.732002", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T18:57:22.732007] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "closed", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["phase-2", "core", "refactor", "cleanup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407983", "updated_at": "2026-01-28T19:20:21.672421", "closed_at": "2026-01-28T19:20:21.672417", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:20:21.672422] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "closed", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["phase-3", "core", "architecture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408044", "updated_at": "2026-01-28T19:59:09.455587", "closed_at": "2026-01-28T19:59:09.455581", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:59:09.455589] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "closed", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T20:22:42.124609", "closed_at": "2026-01-28T20:22:42.124605", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T20:22:42.124610] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T17:54:44.408187", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "closed", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:22:32.062910", "closed_at": "2026-01-28T20:22:32.062906", "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "[Closed: 2026-01-28T20:22:32.062912] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "closed", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T20:31:26.493282", "closed_at": "2026-01-28T20:31:26.493257", "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "[Closed: 2026-01-28T20:31:26.493284] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "closed", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T20:37:11.972618", "closed_at": "2026-01-28T20:37:11.972614", "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "[Closed: 2026-01-28T20:37:11.972622] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "in_progress", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T20:37:24.107553", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 40 != 29"}
{"timestamp": "2026-01-28T20:46:03.584003", "operation": "get_task", "task_id": "cub-b1e.3", "primary_result": {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "closed", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T20:45:22.942118Z", "closed_at": "2026-01-28T20:45:22.942118Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "in_progress", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T20:37:24.107553", "closed_at": null, "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'model:sonnet', 'phase-5', 'test'] != ['phase-5', 'cli', 'test', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:46:03.636966", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 39, "open": 38, "in_progress": 1, "closed": 0}, "secondary_result": {"total": 29, "open": 5, "in_progress": 1, "closed": 23}, "difference_summary": "total: 39 != 29; open: 38 != 5; closed: 0 != 23"}
{"timestamp": "2026-01-28T20:46:03.747322", "operation": "close_task", "task_id": "cub-b1e.3", "primary_result": {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "closed", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T20:46:03.681855Z", "closed_at": "2026-01-28T20:46:03.681855Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "closed", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T20:46:03.745287", "closed_at": "2026-01-28T20:46:03.745282", "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "[Closed: 2026-01-28T20:46:03.745289] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'model:sonnet', 'phase-5', 'test'] != ['phase-5', 'cli', 'test', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:46:03.809350", "operation": "get_task", "task_id": "cub-b1e.3", "primary_result": {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "closed", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["cli", "complexity:medium", "epic:cub-b1e", "model:sonnet", "phase-5", "test"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:44.409669Z", "updated_at": "2026-01-28T20:46:03.681855Z", "closed_at": "2026-01-28T20:46:03.681855Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "closed", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T20:46:03.745287", "closed_at": "2026-01-28T20:46:03.745282", "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "[Closed: 2026-01-28T20:46:03.745289] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['cli', 'complexity:medium', 'epic:cub-b1e', 'model:sonnet', 'phase-5', 'test'] != ['phase-5', 'cli', 'test', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:46:13.597294", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 39, "open": 38, "in_progress": 1, "closed": 0}, "secondary_result": {"total": 29, "open": 5, "in_progress": 0, "closed": 24}, "difference_summary": "total: 39 != 29; open: 38 != 5; in_progress: 1 != 0; closed: 0 != 24"}
{"timestamp": "2026-01-28T20:46:18.011994", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 39, "open": 38, "in_progress": 1, "closed": 0}, "secondary_result": {"total": 29, "open": 4, "in_progress": 0, "closed": 25}, "difference_summary": "total: 39 != 29; open: 38 != 4; in_progress: 1 != 0; closed: 0 != 25"}
{"timestamp": "2026-01-28T20:46:18.058104", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "secondary_result": [{"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "difference_summary": "Task 0 (cub-b1f.1): labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'feature', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f; Task 1 (cub-b1f.2): labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f; Task 2 (cub-b1f.3): labels: ['complexity:medium', 'epic:cub-b1f', 'model:sonnet', 'phase-6', 'test'] != ['phase-6', 'test', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f"}
{"timestamp": "2026-01-28T20:46:18.103069", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "secondary_result": [{"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "difference_summary": "Task 0 (cub-b1f.1): labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'feature', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f; Task 1 (cub-b1f.2): labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f; Task 2 (cub-b1f.3): labels: ['complexity:medium', 'epic:cub-b1f', 'model:sonnet', 'phase-6', 'test'] != ['phase-6', 'test', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f"}
{"timestamp": "2026-01-28T20:46:18.150861", "operation": "get_task", "task_id": "cub-b1f.3", "primary_result": {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T17:54:44.608731Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "open", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": null, "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T17:54:46.169725", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-b1f', 'model:sonnet', 'phase-6', 'test'] != ['phase-6', 'test', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:46:18.267231", "operation": "update_task", "task_id": "cub-b1f.3", "primary_result": {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "in_progress", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": "cub-20260128-204617", "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T20:46:18.201985Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "in_progress", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": "cub-20260128-204617", "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T20:46:18.265207", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-b1f', 'model:sonnet', 'phase-6', 'test'] != ['phase-6', 'test', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:52:34.507551", "operation": "get_task", "task_id": "cub-b1f.3", "primary_result": {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "closed", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": "cub-20260128-204617", "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T20:51:37.069330Z", "closed_at": "2026-01-28T20:51:37.069330Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "in_progress", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": "cub-20260128-204617", "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T20:46:18.265207", "closed_at": null, "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['complexity:medium', 'epic:cub-b1f', 'model:sonnet', 'phase-6', 'test'] != ['phase-6', 'test', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:52:34.574551", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 38, "open": 37, "in_progress": 1, "closed": 0}, "secondary_result": {"total": 29, "open": 3, "in_progress": 1, "closed": 25}, "difference_summary": "total: 38 != 29; open: 37 != 3; closed: 0 != 25"}
{"timestamp": "2026-01-28T20:52:34.693083", "operation": "close_task", "task_id": "cub-b1f.3", "primary_result": {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "closed", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": "cub-20260128-204617", "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T20:52:34.623672Z", "closed_at": "2026-01-28T20:52:34.623672Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "closed", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": "cub-20260128-204617", "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T20:52:34.691040", "closed_at": "2026-01-28T20:52:34.691014", "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "[Closed: 2026-01-28T20:52:34.691043] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-b1f', 'model:sonnet', 'phase-6', 'test'] != ['phase-6', 'test', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:52:34.757561", "operation": "get_task", "task_id": "cub-b1f.3", "primary_result": {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "closed", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": "cub-20260128-204617", "labels": ["complexity:medium", "epic:cub-b1f", "model:sonnet", "phase-6", "test"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:44.409728Z", "updated_at": "2026-01-28T20:52:34.623672Z", "closed_at": "2026-01-28T20:52:34.623672Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "closed", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": "cub-20260128-204617", "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T20:52:34.691040", "closed_at": "2026-01-28T20:52:34.691014", "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "[Closed: 2026-01-28T20:52:34.691043] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-b1f', 'model:sonnet', 'phase-6', 'test'] != ['phase-6', 'test', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:52:44.161023", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "secondary_result": [{"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "difference_summary": "Task 0 (cub-b1f.1): labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'feature', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'feature', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f; Task 1 (cub-b1f.2): labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f"}
{"timestamp": "2026-01-28T20:52:44.218725", "operation": "get_task", "task_id": "cub-b1f.1", "primary_result": {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T17:54:44.607897Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, "secondary_result": {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "open", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T17:54:46.169693", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, "difference_summary": "labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'feature', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'feature', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:52:44.347488", "operation": "update_task", "task_id": "cub-b1f.1", "primary_result": {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "in_progress", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": "cub-20260128-204617", "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T20:52:44.273791Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, "secondary_result": {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "in_progress", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": "cub-20260128-204617", "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T20:52:44.345937", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, "difference_summary": "labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'feature', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'feature', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:52:52.204578", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 38, "open": 36, "in_progress": 2, "closed": 0}, "secondary_result": {"total": 29, "open": 2, "in_progress": 1, "closed": 26}, "difference_summary": "total: 38 != 29; open: 36 != 2; in_progress: 2 != 1; closed: 0 != 26"}
{"timestamp": "2026-01-28T20:52:52.287410", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "in_progress", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": "cub-20260128-204328", "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T20:43:29.037004Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "in_progress", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": "cub-20260128-204617", "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T20:52:50.388775Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "difference_summary": "List length mismatch: 20 != 2"}
{"timestamp": "2026-01-28T20:52:52.384055", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "in_progress", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": "cub-20260128-204328", "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T20:43:29.037004Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "in_progress", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": "cub-20260128-204617", "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T20:52:50.388775Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "closed", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["phase-1", "core", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407838", "updated_at": "2026-01-28T18:57:22.732005", "closed_at": "2026-01-28T18:57:22.732002", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T18:57:22.732007] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "closed", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["phase-2", "core", "refactor", "cleanup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407983", "updated_at": "2026-01-28T19:20:21.672421", "closed_at": "2026-01-28T19:20:21.672417", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:20:21.672422] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "closed", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["phase-3", "core", "architecture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408044", "updated_at": "2026-01-28T19:59:09.455587", "closed_at": "2026-01-28T19:59:09.455581", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:59:09.455589] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "closed", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T20:22:42.124609", "closed_at": "2026-01-28T20:22:42.124605", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T20:22:42.124610] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "closed", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T20:46:13.750875", "closed_at": "2026-01-28T20:46:13.750871", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T20:46:13.750876] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "closed", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:22:32.062910", "closed_at": "2026-01-28T20:22:32.062906", "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "[Closed: 2026-01-28T20:22:32.062912] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "closed", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T20:31:26.493282", "closed_at": "2026-01-28T20:31:26.493257", "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "[Closed: 2026-01-28T20:31:26.493284] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "closed", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T20:37:11.972618", "closed_at": "2026-01-28T20:37:11.972614", "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "[Closed: 2026-01-28T20:37:11.972622] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "closed", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T20:46:03.745287", "closed_at": "2026-01-28T20:46:03.745282", "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "[Closed: 2026-01-28T20:46:03.745289] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "in_progress", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": "cub-20260128-204617", "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T20:52:44.345937", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "closed", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": "cub-20260128-204617", "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T20:52:34.691040", "closed_at": "2026-01-28T20:52:34.691014", "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "[Closed: 2026-01-28T20:52:34.691043] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 38 != 29"}
{"timestamp": "2026-01-28T20:52:52.501581", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "in_progress", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": "cub-20260128-204328", "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T20:43:29.037004Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "in_progress", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": "cub-20260128-204617", "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T20:52:50.388775Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "difference_summary": "List length mismatch: 20 != 2"}
{"timestamp": "2026-01-28T20:54:38.088243", "operation": "get_task", "task_id": "cub-b1f.1", "primary_result": {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "closed", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": "cub-20260128-204617", "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T20:54:21.558447Z", "closed_at": "2026-01-28T20:54:21.558447Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, "secondary_result": {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "in_progress", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": "cub-20260128-204617", "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T20:52:44.345937", "closed_at": null, "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'feature', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'feature', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:54:38.172641", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 37, "open": 36, "in_progress": 1, "closed": 0}, "secondary_result": {"total": 29, "open": 2, "in_progress": 1, "closed": 26}, "difference_summary": "total: 37 != 29; open: 36 != 2; closed: 0 != 26"}
{"timestamp": "2026-01-28T20:54:38.294094", "operation": "close_task", "task_id": "cub-b1f.1", "primary_result": {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "closed", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": "cub-20260128-204617", "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T20:54:38.235789Z", "closed_at": "2026-01-28T20:54:38.235789Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, "secondary_result": {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "closed", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": "cub-20260128-204617", "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T20:54:38.292608", "closed_at": "2026-01-28T20:54:38.292604", "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "[Closed: 2026-01-28T20:54:38.292610] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, "difference_summary": "labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'feature', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'feature', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:54:38.354995", "operation": "get_task", "task_id": "cub-b1f.1", "primary_result": {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "closed", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": "cub-20260128-204617", "labels": ["complexity:medium", "docs", "epic:cub-b1f", "feature", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:44.409690Z", "updated_at": "2026-01-28T20:54:38.235789Z", "closed_at": "2026-01-28T20:54:38.235789Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, "secondary_result": {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "closed", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": "cub-20260128-204617", "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T20:54:38.292608", "closed_at": "2026-01-28T20:54:38.292604", "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "[Closed: 2026-01-28T20:54:38.292610] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, "difference_summary": "labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'feature', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'feature', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:54:47.412262", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "secondary_result": [{"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "difference_summary": "Task 0 (cub-b1f.2): labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'model:sonnet', 'complexity:medium']; parent: None != cub-b1f"}
{"timestamp": "2026-01-28T20:54:47.475027", "operation": "get_task", "task_id": "cub-b1f.2", "primary_result": {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T17:54:44.608321Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, "secondary_result": {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": null, "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T17:54:46.169710", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, "difference_summary": "labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T20:54:47.605499", "operation": "update_task", "task_id": "cub-b1f.2", "primary_result": {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "in_progress", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": "cub-20260128-204617", "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T20:54:47.533732Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, "secondary_result": {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "in_progress", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": "cub-20260128-204617", "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T20:54:47.603233", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, "difference_summary": "labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T21:01:34.450898", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "in_progress", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": "cub-20260128-204328", "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T20:43:29.037004Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "in_progress", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": "cub-20260128-204617", "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T20:54:53.770588Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}], "difference_summary": "List length mismatch: 19 != 1"}
{"timestamp": "2026-01-28T21:01:34.510532", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "in_progress", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": "cub-20260128-204328", "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T20:43:29.037004Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "in_progress", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": "cub-20260128-204617", "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T20:54:53.770588Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}], "secondary_result": [{"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "in_progress", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": "cub-20260128-204617", "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T20:54:47.603233", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}], "difference_summary": "List length mismatch: 2 != 1"}
{"timestamp": "2026-01-28T21:01:34.567904", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}], "difference_summary": "List length mismatch: 35 != 1"}
{"timestamp": "2026-01-28T21:01:34.681661", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "in_progress", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": "cub-20260128-204328", "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T20:43:29.037004Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "in_progress", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": "cub-20260128-204617", "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T20:54:53.770588Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "closed", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["phase-1", "core", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407838", "updated_at": "2026-01-28T18:57:22.732005", "closed_at": "2026-01-28T18:57:22.732002", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T18:57:22.732007] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "closed", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["phase-2", "core", "refactor", "cleanup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407983", "updated_at": "2026-01-28T19:20:21.672421", "closed_at": "2026-01-28T19:20:21.672417", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:20:21.672422] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "closed", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["phase-3", "core", "architecture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408044", "updated_at": "2026-01-28T19:59:09.455587", "closed_at": "2026-01-28T19:59:09.455581", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:59:09.455589] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "closed", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T20:22:42.124609", "closed_at": "2026-01-28T20:22:42.124605", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T20:22:42.124610] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "closed", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T20:46:13.750875", "closed_at": "2026-01-28T20:46:13.750871", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T20:46:13.750876] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "closed", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:22:32.062910", "closed_at": "2026-01-28T20:22:32.062906", "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "[Closed: 2026-01-28T20:22:32.062912] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "closed", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T20:31:26.493282", "closed_at": "2026-01-28T20:31:26.493257", "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "[Closed: 2026-01-28T20:31:26.493284] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "closed", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T20:37:11.972618", "closed_at": "2026-01-28T20:37:11.972614", "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "[Closed: 2026-01-28T20:37:11.972622] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "closed", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T20:46:03.745287", "closed_at": "2026-01-28T20:46:03.745282", "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "[Closed: 2026-01-28T20:46:03.745289] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "closed", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": "cub-20260128-204617", "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T20:54:38.292608", "closed_at": "2026-01-28T20:54:38.292604", "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "[Closed: 2026-01-28T20:54:38.292610] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "in_progress", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": "cub-20260128-204617", "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T20:54:47.603233", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "closed", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": "cub-20260128-204617", "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T20:52:34.691040", "closed_at": "2026-01-28T20:52:34.691014", "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "[Closed: 2026-01-28T20:52:34.691043] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 37 != 29"}
{"timestamp": "2026-01-28T21:01:34.748207", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "closed", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T20:31:26.493282", "closed_at": "2026-01-28T20:31:26.493257", "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "[Closed: 2026-01-28T20:31:26.493284] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "closed", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T20:37:11.972618", "closed_at": "2026-01-28T20:37:11.972614", "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "[Closed: 2026-01-28T20:37:11.972622] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "closed", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T20:46:03.745287", "closed_at": "2026-01-28T20:46:03.745282", "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "[Closed: 2026-01-28T20:46:03.745289] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 3"}
{"timestamp": "2026-01-28T21:01:34.802265", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 5"}
{"timestamp": "2026-01-28T21:01:34.854370", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "closed", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T20:31:26.493282", "closed_at": "2026-01-28T20:31:26.493257", "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "[Closed: 2026-01-28T20:31:26.493284] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "closed", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T20:37:11.972618", "closed_at": "2026-01-28T20:37:11.972614", "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "[Closed: 2026-01-28T20:37:11.972622] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "closed", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T20:46:03.745287", "closed_at": "2026-01-28T20:46:03.745282", "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "[Closed: 2026-01-28T20:46:03.745289] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 3"}
{"timestamp": "2026-01-28T21:01:34.904952", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 5"}
{"timestamp": "2026-01-28T21:01:35.097641", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "closed", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:22:32.062910", "closed_at": "2026-01-28T20:22:32.062906", "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "[Closed: 2026-01-28T20:22:32.062912] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 3"}
{"timestamp": "2026-01-28T21:01:35.139808", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 4"}
{"timestamp": "2026-01-28T21:01:35.183516", "operation": "list_tasks", "task_id": null, "primary_result": "[]", "secondary_result": [{"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 0 != 5"}
{"timestamp": "2026-01-28T21:01:35.364816", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}], "secondary_result": "[]", "difference_summary": "List length mismatch: 5 != 0"}
{"timestamp": "2026-01-28T21:01:35.459261", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "in_progress", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": "cub-20260128-204617", "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T20:54:53.770588Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}], "secondary_result": [{"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "closed", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": "cub-20260128-204617", "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T20:54:38.292608", "closed_at": "2026-01-28T20:54:38.292604", "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "[Closed: 2026-01-28T20:54:38.292610] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "in_progress", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": "cub-20260128-204617", "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T20:54:47.603233", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "closed", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": "cub-20260128-204617", "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T20:52:34.691040", "closed_at": "2026-01-28T20:52:34.691014", "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "[Closed: 2026-01-28T20:52:34.691043] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 1 != 3"}
{"timestamp": "2026-01-28T21:01:35.560311", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}], "secondary_result": "[]", "difference_summary": "List length mismatch: 3 != 0"}
{"timestamp": "2026-01-28T21:01:35.610224", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}], "secondary_result": "[]", "difference_summary": "List length mismatch: 3 != 0"}
{"timestamp": "2026-01-28T21:01:35.694227", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": "[]", "difference_summary": "List length mismatch: 3 != 0"}
{"timestamp": "2026-01-28T21:01:35.752413", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "in_progress", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": "cub-20260128-204328", "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T20:43:29.037004Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "in_progress", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": "cub-20260128-204617", "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T20:54:53.770588Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "closed", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["phase-1", "core", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407838", "updated_at": "2026-01-28T18:57:22.732005", "closed_at": "2026-01-28T18:57:22.732002", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T18:57:22.732007] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "closed", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["phase-2", "core", "refactor", "cleanup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407983", "updated_at": "2026-01-28T19:20:21.672421", "closed_at": "2026-01-28T19:20:21.672417", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:20:21.672422] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "closed", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["phase-3", "core", "architecture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408044", "updated_at": "2026-01-28T19:59:09.455587", "closed_at": "2026-01-28T19:59:09.455581", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:59:09.455589] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "closed", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T20:22:42.124609", "closed_at": "2026-01-28T20:22:42.124605", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T20:22:42.124610] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "closed", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T20:46:13.750875", "closed_at": "2026-01-28T20:46:13.750871", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T20:46:13.750876] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "closed", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:22:32.062910", "closed_at": "2026-01-28T20:22:32.062906", "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "[Closed: 2026-01-28T20:22:32.062912] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "closed", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T20:31:26.493282", "closed_at": "2026-01-28T20:31:26.493257", "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "[Closed: 2026-01-28T20:31:26.493284] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "closed", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T20:37:11.972618", "closed_at": "2026-01-28T20:37:11.972614", "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "[Closed: 2026-01-28T20:37:11.972622] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "closed", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T20:46:03.745287", "closed_at": "2026-01-28T20:46:03.745282", "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "[Closed: 2026-01-28T20:46:03.745289] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "closed", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": "cub-20260128-204617", "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T20:54:38.292608", "closed_at": "2026-01-28T20:54:38.292604", "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "[Closed: 2026-01-28T20:54:38.292610] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "in_progress", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": "cub-20260128-204617", "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T20:54:47.603233", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "closed", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": "cub-20260128-204617", "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T20:52:34.691040", "closed_at": "2026-01-28T20:52:34.691014", "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "[Closed: 2026-01-28T20:52:34.691043] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}], "difference_summary": "List length mismatch: 37 != 29"}
{"timestamp": "2026-01-28T21:01:35.808112", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}], "difference_summary": "List length mismatch: 35 != 1"}
{"timestamp": "2026-01-28T21:01:35.869479", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "in_progress", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": "cub-20260128-204328", "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T20:43:29.037004Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "in_progress", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": "cub-20260128-204617", "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T20:54:53.770588Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}], "secondary_result": [{"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "in_progress", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": "cub-20260128-204617", "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T20:54:47.603233", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}], "difference_summary": "List length mismatch: 2 != 1"}
{"timestamp": "2026-01-28T21:01:35.917289", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "in_progress", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": "cub-20260128-204328", "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-28T20:43:29.037004Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "in_progress", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": "cub-20260128-204617", "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T20:54:53.770588Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T17:54:44.408236", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}], "difference_summary": "List length mismatch: 19 != 1"}
{"timestamp": "2026-01-28T21:05:02.921448", "operation": "get_task", "task_id": "cub-b1f.2", "primary_result": {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "closed", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": "cub-20260128-204617", "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T21:03:36.931776Z", "closed_at": "2026-01-28T21:03:36.931776Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, "secondary_result": {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "in_progress", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": "cub-20260128-204617", "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T20:54:47.603233", "closed_at": null, "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T21:05:02.970643", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 36, "open": 35, "in_progress": 1, "closed": 0}, "secondary_result": {"total": 29, "open": 1, "in_progress": 1, "closed": 27}, "difference_summary": "total: 36 != 29; open: 35 != 1; closed: 0 != 27"}
{"timestamp": "2026-01-28T21:05:03.068692", "operation": "close_task", "task_id": "cub-b1f.2", "primary_result": {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "closed", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": "cub-20260128-204617", "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T21:05:03.012003Z", "closed_at": "2026-01-28T21:05:03.012003Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, "secondary_result": {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "closed", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": "cub-20260128-204617", "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T21:05:03.067296", "closed_at": "2026-01-28T21:05:03.067292", "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "[Closed: 2026-01-28T21:05:03.067297] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, "difference_summary": "labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T21:05:03.127836", "operation": "get_task", "task_id": "cub-b1f.2", "primary_result": {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "closed", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": "cub-20260128-204617", "labels": ["complexity:medium", "docs", "epic:cub-b1f", "model:sonnet", "phase-6"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:44.409708Z", "updated_at": "2026-01-28T21:05:03.012003Z", "closed_at": "2026-01-28T21:05:03.012003Z", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, "secondary_result": {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "closed", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": "cub-20260128-204617", "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T21:05:03.067296", "closed_at": "2026-01-28T21:05:03.067292", "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "[Closed: 2026-01-28T21:05:03.067297] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, "difference_summary": "labels: ['complexity:medium', 'docs', 'epic:cub-b1f', 'model:sonnet', 'phase-6'] != ['phase-6', 'docs', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-28T21:05:14.396889", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 36, "open": 35, "in_progress": 1, "closed": 0}, "secondary_result": {"total": 29, "open": 1, "in_progress": 0, "closed": 28}, "difference_summary": "total: 36 != 29; open: 35 != 1; in_progress: 1 != 0; closed: 0 != 28"}
{"timestamp": "2026-01-29T11:55:08.342003", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 93, "open": 92, "in_progress": 1, "closed": 0}, "secondary_result": {"total": 57, "open": 28, "in_progress": 0, "closed": 29}, "difference_summary": "total: 93 != 57; open: 92 != 28; in_progress: 1 != 0; closed: 0 != 29"}
{"timestamp": "2026-01-29T11:55:13.567585", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-p1t.1", "title": "Extend TaskBackend protocol with 7 new methods", "status": "open", "priority": "P0", "type": "task", "description": "The protocol needs 7 new methods for full lifecycle coverage. Also extend `update_task` to accept `title`, `priority`, and `notes` parameters. Create a `TaskBackendDefaults` mixin with default implementations for methods that can be derived from existing operations.\n\n**Implementation Steps:**\n1. Add 7 new method signatures to `TaskBackend` protocol in `backend.py`: `add_dependency`, `remove_dependency`, `list_blocked_tasks`, `reopen_task`, `delete_task`, `add_label`, `remove_label`\n2. Extend `update_task` signature with optional `title: str | None`, `priority: int | None`, `notes: str | None` parameters\n3. Create `TaskBackendDefaults` mixin class with default implementations:\n4. Add `blocked: int = 0` field to `TaskCounts` model\n5. Update type annotations and docstrings for all new methods\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/models.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094091Z", "updated_at": "2026-01-29T11:45:15.283945-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}], "secondary_result": [{"id": "cub-p1t.1", "title": "Extend TaskBackend protocol with 7 new methods", "status": "open", "priority": "P0", "type": "task", "description": "The protocol needs 7 new methods for full lifecycle coverage. Also extend `update_task` to accept `title`, `priority`, and `notes` parameters. Create a `TaskBackendDefaults` mixin with default implementations for methods that can be derived from existing operations.\n\n**Implementation Steps:**\n1. Add 7 new method signatures to `TaskBackend` protocol in `backend.py`: `add_dependency`, `remove_dependency`, `list_blocked_tasks`, `reopen_task`, `delete_task`, `add_label`, `remove_label`\n2. Extend `update_task` signature with optional `title: str | None`, `priority: int | None`, `notes: str | None` parameters\n3. Create `TaskBackendDefaults` mixin class with default implementations:\n4. Add `blocked: int = 0` field to `TaskCounts` model\n5. Update type annotations and docstrings for all new methods\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/models.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.2", "cub-p1t.3", "cub-p1t.4"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463297", "updated_at": "2026-01-29T11:46:17.463329", "closed_at": null, "acceptance_criteria": ["`TaskBackend` protocol has 19 methods (12 existing + 7 new)", "`update_task` accepts `title`, `priority`, `notes` optional params", "`TaskBackendDefaults` mixin has working default implementations", "`TaskCounts.blocked` field exists", "mypy passes with strict mode", "All new methods have complete docstrings"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.2", "title": "Implement new protocol methods in BeadsBackend", "status": "open", "priority": "P0", "type": "task", "description": "BeadsBackend wraps the `bd` CLI. Each new protocol method needs a corresponding `bd` command wrapper. Follow the existing `_run_bd` pattern \u2014 bd commands that don't return JSON need a follow-up `get_task()` call.\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 run `bd dep add <task_id> <depends_on>`, then `get_task(task_id)`\n2. `remove_dependency(task_id, depends_on)` \u2014 run `bd dep remove <task_id> <depends_on>`, then `get_task(task_id)`\n3. `list_blocked_tasks(parent?)` \u2014 run `bd blocked --json` (or `bd list --status open --json` and filter), parse JSON output\n4. `reopen_task(task_id)` \u2014 run `bd update <id> --status open`, then `get_task(task_id)`\n5. `delete_task(task_id)` \u2014 run `bd delete <id>`, return True on success\n6. `add_label(task_id, label)` \u2014 run `bd label add <id> <label>`, then `get_task(task_id)`\n7. `remove_label(task_id, label)` \u2014 run `bd label remove <id> <label>`, then `get_task(task_id)`\n8. Extend `update_task` to pass `--title`, `--priority`, `--notes` flags when provided\n9. Update `get_task_counts` to include blocked count\n\n**Files:** src/cub/core/tasks/beads.py, tests/test_beads_backend.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463498", "updated_at": "2026-01-29T11:46:17.463499", "closed_at": null, "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Error handling follows existing pattern (ValueError on not found)", "Unit tests pass for all new methods (mocked bd subprocess)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.3", "title": "Implement new protocol methods in JsonlBackend", "status": "open", "priority": "P0", "type": "task", "description": "JsonlBackend operates on an in-memory task list with atomic file writes. New methods manipulate task fields directly using existing Task model methods (`add_label()`, `remove_label()`, `reopen()`).\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 find task, append to `depends_on` list, save\n2. `remove_dependency(task_id, depends_on)` \u2014 find task, remove from `depends_on` list, save\n3. `list_blocked_tasks(parent?)` \u2014 filter: status=OPEN, has depends_on, not all deps closed\n4. `reopen_task(task_id)` \u2014 find task, call `task.reopen()`, save\n5. `delete_task(task_id)` \u2014 remove task from list, save, return True\n6. `add_label(task_id, label)` \u2014 find task, call `task.add_label(label)`, save\n7. `remove_label(task_id, label)` \u2014 find task, call `task.remove_label(label)`, save\n8. Extend `update_task` to handle title, priority, notes field updates\n9. Update `get_task_counts` to include blocked count\n10. All mutations use existing atomic write pattern (temp file \u2192 rename)\n\n**Files:** src/cub/core/tasks/jsonl.py, tests/test_jsonl_backend.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463520", "updated_at": "2026-01-29T11:46:17.463521", "closed_at": null, "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Atomic writes for all mutations (no partial state)", "Unit tests pass for all new methods"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "open", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": null, "labels": ["phase-1", "model:opus", "complexity:high"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463535", "updated_at": "2026-01-29T11:46:17.463536", "closed_at": null, "acceptance_criteria": ["All 6 query methods return correct results for test topologies", "Cycle detection works and doesn't cause infinite loops in other methods", "Closed tasks are correctly excluded from graph (treated as resolved)", "`would_become_ready` checks ALL deps, not just the given task", "`root_blockers` correctly ranks by transitive impact", "`chains` returns paths sorted by length descending", "mypy passes with strict mode", "Tests cover: empty graph, single node, linear chain (5 deep), diamond dependency, forest (disconnected), cycle, mixed open/closed states"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.5", "title": "Update BothBackend and write cross-backend tests", "status": "open", "priority": "P1", "type": "task", "description": "BothBackend delegates to primary and secondary backends. It needs to delegate all 7 new methods and log divergences. Also write parametrized tests that verify the same operations work identically across both backends.\n\n**Implementation Steps:**\n1. Update `BothBackend` to delegate all 7 new methods (follow existing delegation pattern)\n2. Inherit from `TaskBackendDefaults` as fallback\n3. Add divergence logging for new methods\n4. Write parametrized pytest tests that run the same test cases against BeadsBackend (mocked) and JsonlBackend (temp files)\n5. Test scenarios: add/remove dependency, list blocked, reopen, delete, add/remove label\n6. Verify `DependencyGraph` produces consistent results from both backend outputs\n\n**Files:** src/cub/core/tasks/both.py, tests/test_task_backends.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463550", "updated_at": "2026-01-29T11:46:17.463550", "closed_at": null, "acceptance_criteria": ["BothBackend delegates all 7 new methods", "Divergence logging works for new methods", "Parametrized tests pass against both backends", "DependencyGraph produces same results regardless of backend", "mypy passes"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 1 != 5"}
{"timestamp": "2026-01-29T11:55:18.774315", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-p1t.1", "title": "Extend TaskBackend protocol with 7 new methods", "status": "open", "priority": "P0", "type": "task", "description": "The protocol needs 7 new methods for full lifecycle coverage. Also extend `update_task` to accept `title`, `priority`, and `notes` parameters. Create a `TaskBackendDefaults` mixin with default implementations for methods that can be derived from existing operations.\n\n**Implementation Steps:**\n1. Add 7 new method signatures to `TaskBackend` protocol in `backend.py`: `add_dependency`, `remove_dependency`, `list_blocked_tasks`, `reopen_task`, `delete_task`, `add_label`, `remove_label`\n2. Extend `update_task` signature with optional `title: str | None`, `priority: int | None`, `notes: str | None` parameters\n3. Create `TaskBackendDefaults` mixin class with default implementations:\n4. Add `blocked: int = 0` field to `TaskCounts` model\n5. Update type annotations and docstrings for all new methods\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/models.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094091Z", "updated_at": "2026-01-29T11:45:15.283945-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}], "secondary_result": [{"id": "cub-p1t.1", "title": "Extend TaskBackend protocol with 7 new methods", "status": "open", "priority": "P0", "type": "task", "description": "The protocol needs 7 new methods for full lifecycle coverage. Also extend `update_task` to accept `title`, `priority`, and `notes` parameters. Create a `TaskBackendDefaults` mixin with default implementations for methods that can be derived from existing operations.\n\n**Implementation Steps:**\n1. Add 7 new method signatures to `TaskBackend` protocol in `backend.py`: `add_dependency`, `remove_dependency`, `list_blocked_tasks`, `reopen_task`, `delete_task`, `add_label`, `remove_label`\n2. Extend `update_task` signature with optional `title: str | None`, `priority: int | None`, `notes: str | None` parameters\n3. Create `TaskBackendDefaults` mixin class with default implementations:\n4. Add `blocked: int = 0` field to `TaskCounts` model\n5. Update type annotations and docstrings for all new methods\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/models.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.2", "cub-p1t.3", "cub-p1t.4"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463297", "updated_at": "2026-01-29T11:46:17.463329", "closed_at": null, "acceptance_criteria": ["`TaskBackend` protocol has 19 methods (12 existing + 7 new)", "`update_task` accepts `title`, `priority`, `notes` optional params", "`TaskBackendDefaults` mixin has working default implementations", "`TaskCounts.blocked` field exists", "mypy passes with strict mode", "All new methods have complete docstrings"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.2", "title": "Implement new protocol methods in BeadsBackend", "status": "open", "priority": "P0", "type": "task", "description": "BeadsBackend wraps the `bd` CLI. Each new protocol method needs a corresponding `bd` command wrapper. Follow the existing `_run_bd` pattern \u2014 bd commands that don't return JSON need a follow-up `get_task()` call.\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 run `bd dep add <task_id> <depends_on>`, then `get_task(task_id)`\n2. `remove_dependency(task_id, depends_on)` \u2014 run `bd dep remove <task_id> <depends_on>`, then `get_task(task_id)`\n3. `list_blocked_tasks(parent?)` \u2014 run `bd blocked --json` (or `bd list --status open --json` and filter), parse JSON output\n4. `reopen_task(task_id)` \u2014 run `bd update <id> --status open`, then `get_task(task_id)`\n5. `delete_task(task_id)` \u2014 run `bd delete <id>`, return True on success\n6. `add_label(task_id, label)` \u2014 run `bd label add <id> <label>`, then `get_task(task_id)`\n7. `remove_label(task_id, label)` \u2014 run `bd label remove <id> <label>`, then `get_task(task_id)`\n8. Extend `update_task` to pass `--title`, `--priority`, `--notes` flags when provided\n9. Update `get_task_counts` to include blocked count\n\n**Files:** src/cub/core/tasks/beads.py, tests/test_beads_backend.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463498", "updated_at": "2026-01-29T11:46:17.463499", "closed_at": null, "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Error handling follows existing pattern (ValueError on not found)", "Unit tests pass for all new methods (mocked bd subprocess)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.3", "title": "Implement new protocol methods in JsonlBackend", "status": "open", "priority": "P0", "type": "task", "description": "JsonlBackend operates on an in-memory task list with atomic file writes. New methods manipulate task fields directly using existing Task model methods (`add_label()`, `remove_label()`, `reopen()`).\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 find task, append to `depends_on` list, save\n2. `remove_dependency(task_id, depends_on)` \u2014 find task, remove from `depends_on` list, save\n3. `list_blocked_tasks(parent?)` \u2014 filter: status=OPEN, has depends_on, not all deps closed\n4. `reopen_task(task_id)` \u2014 find task, call `task.reopen()`, save\n5. `delete_task(task_id)` \u2014 remove task from list, save, return True\n6. `add_label(task_id, label)` \u2014 find task, call `task.add_label(label)`, save\n7. `remove_label(task_id, label)` \u2014 find task, call `task.remove_label(label)`, save\n8. Extend `update_task` to handle title, priority, notes field updates\n9. Update `get_task_counts` to include blocked count\n10. All mutations use existing atomic write pattern (temp file \u2192 rename)\n\n**Files:** src/cub/core/tasks/jsonl.py, tests/test_jsonl_backend.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463520", "updated_at": "2026-01-29T11:46:17.463521", "closed_at": null, "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Atomic writes for all mutations (no partial state)", "Unit tests pass for all new methods"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "open", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": null, "labels": ["phase-1", "model:opus", "complexity:high"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463535", "updated_at": "2026-01-29T11:46:17.463536", "closed_at": null, "acceptance_criteria": ["All 6 query methods return correct results for test topologies", "Cycle detection works and doesn't cause infinite loops in other methods", "Closed tasks are correctly excluded from graph (treated as resolved)", "`would_become_ready` checks ALL deps, not just the given task", "`root_blockers` correctly ranks by transitive impact", "`chains` returns paths sorted by length descending", "mypy passes with strict mode", "Tests cover: empty graph, single node, linear chain (5 deep), diamond dependency, forest (disconnected), cycle, mixed open/closed states"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.5", "title": "Update BothBackend and write cross-backend tests", "status": "open", "priority": "P1", "type": "task", "description": "BothBackend delegates to primary and secondary backends. It needs to delegate all 7 new methods and log divergences. Also write parametrized tests that verify the same operations work identically across both backends.\n\n**Implementation Steps:**\n1. Update `BothBackend` to delegate all 7 new methods (follow existing delegation pattern)\n2. Inherit from `TaskBackendDefaults` as fallback\n3. Add divergence logging for new methods\n4. Write parametrized pytest tests that run the same test cases against BeadsBackend (mocked) and JsonlBackend (temp files)\n5. Test scenarios: add/remove dependency, list blocked, reopen, delete, add/remove label\n6. Verify `DependencyGraph` produces consistent results from both backend outputs\n\n**Files:** src/cub/core/tasks/both.py, tests/test_task_backends.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463550", "updated_at": "2026-01-29T11:46:17.463550", "closed_at": null, "acceptance_criteria": ["BothBackend delegates all 7 new methods", "Divergence logging works for new methods", "Parametrized tests pass against both backends", "DependencyGraph produces same results regardless of backend", "mypy passes"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 1 != 5"}
{"timestamp": "2026-01-29T11:55:23.989387", "operation": "get_task", "task_id": "cub-p1t.1", "primary_result": {"id": "cub-p1t.1", "title": "Extend TaskBackend protocol with 7 new methods", "status": "open", "priority": "P0", "type": "task", "description": "The protocol needs 7 new methods for full lifecycle coverage. Also extend `update_task` to accept `title`, `priority`, and `notes` parameters. Create a `TaskBackendDefaults` mixin with default implementations for methods that can be derived from existing operations.\n\n**Implementation Steps:**\n1. Add 7 new method signatures to `TaskBackend` protocol in `backend.py`: `add_dependency`, `remove_dependency`, `list_blocked_tasks`, `reopen_task`, `delete_task`, `add_label`, `remove_label`\n2. Extend `update_task` signature with optional `title: str | None`, `priority: int | None`, `notes: str | None` parameters\n3. Create `TaskBackendDefaults` mixin class with default implementations:\n4. Add `blocked: int = 0` field to `TaskCounts` model\n5. Update type annotations and docstrings for all new methods\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/models.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094091Z", "updated_at": "2026-01-29T11:45:15.283945-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, "secondary_result": {"id": "cub-p1t.1", "title": "Extend TaskBackend protocol with 7 new methods", "status": "open", "priority": "P0", "type": "task", "description": "The protocol needs 7 new methods for full lifecycle coverage. Also extend `update_task` to accept `title`, `priority`, and `notes` parameters. Create a `TaskBackendDefaults` mixin with default implementations for methods that can be derived from existing operations.\n\n**Implementation Steps:**\n1. Add 7 new method signatures to `TaskBackend` protocol in `backend.py`: `add_dependency`, `remove_dependency`, `list_blocked_tasks`, `reopen_task`, `delete_task`, `add_label`, `remove_label`\n2. Extend `update_task` signature with optional `title: str | None`, `priority: int | None`, `notes: str | None` parameters\n3. Create `TaskBackendDefaults` mixin class with default implementations:\n4. Add `blocked: int = 0` field to `TaskCounts` model\n5. Update type annotations and docstrings for all new methods\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/models.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.2", "cub-p1t.3", "cub-p1t.4"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463297", "updated_at": "2026-01-29T11:46:17.463329", "closed_at": null, "acceptance_criteria": ["`TaskBackend` protocol has 19 methods (12 existing + 7 new)", "`update_task` accepts `title`, `priority`, `notes` optional params", "`TaskBackendDefaults` mixin has working default implementations", "`TaskCounts.blocked` field exists", "mypy passes with strict mode", "All new methods have complete docstrings"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T11:55:34.559677", "operation": "update_task", "task_id": "cub-p1t.1", "primary_result": {"id": "cub-p1t.1", "title": "Extend TaskBackend protocol with 7 new methods", "status": "in_progress", "priority": "P0", "type": "task", "description": "The protocol needs 7 new methods for full lifecycle coverage. Also extend `update_task` to accept `title`, `priority`, and `notes` parameters. Create a `TaskBackendDefaults` mixin with default implementations for methods that can be derived from existing operations.\n\n**Implementation Steps:**\n1. Add 7 new method signatures to `TaskBackend` protocol in `backend.py`: `add_dependency`, `remove_dependency`, `list_blocked_tasks`, `reopen_task`, `delete_task`, `add_label`, `remove_label`\n2. Extend `update_task` signature with optional `title: str | None`, `priority: int | None`, `notes: str | None` parameters\n3. Create `TaskBackendDefaults` mixin class with default implementations:\n4. Add `blocked: int = 0` field to `TaskCounts` model\n5. Update type annotations and docstrings for all new methods\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/models.py", "assignee": "cub-20260129-115503", "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094091Z", "updated_at": "2026-01-29T11:55:29.241461-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-p1t.1", "title": "Extend TaskBackend protocol with 7 new methods", "status": "in_progress", "priority": "P0", "type": "task", "description": "The protocol needs 7 new methods for full lifecycle coverage. Also extend `update_task` to accept `title`, `priority`, and `notes` parameters. Create a `TaskBackendDefaults` mixin with default implementations for methods that can be derived from existing operations.\n\n**Implementation Steps:**\n1. Add 7 new method signatures to `TaskBackend` protocol in `backend.py`: `add_dependency`, `remove_dependency`, `list_blocked_tasks`, `reopen_task`, `delete_task`, `add_label`, `remove_label`\n2. Extend `update_task` signature with optional `title: str | None`, `priority: int | None`, `notes: str | None` parameters\n3. Create `TaskBackendDefaults` mixin class with default implementations:\n4. Add `blocked: int = 0` field to `TaskCounts` model\n5. Update type annotations and docstrings for all new methods\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/models.py", "assignee": "cub-20260129-115503", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.2", "cub-p1t.3", "cub-p1t.4"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463297", "updated_at": "2026-01-29T11:55:34.557241", "closed_at": null, "acceptance_criteria": ["`TaskBackend` protocol has 19 methods (12 existing + 7 new)", "`update_task` accepts `title`, `priority`, `notes` optional params", "`TaskBackendDefaults` mixin has working default implementations", "`TaskCounts.blocked` field exists", "mypy passes with strict mode", "All new methods have complete docstrings"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:04:44.540972", "operation": "get_task", "task_id": "cub-p1t.1", "primary_result": {"id": "cub-p1t.1", "title": "Extend TaskBackend protocol with 7 new methods", "status": "closed", "priority": "P0", "type": "task", "description": "The protocol needs 7 new methods for full lifecycle coverage. Also extend `update_task` to accept `title`, `priority`, and `notes` parameters. Create a `TaskBackendDefaults` mixin with default implementations for methods that can be derived from existing operations.\n\n**Implementation Steps:**\n1. Add 7 new method signatures to `TaskBackend` protocol in `backend.py`: `add_dependency`, `remove_dependency`, `list_blocked_tasks`, `reopen_task`, `delete_task`, `add_label`, `remove_label`\n2. Extend `update_task` signature with optional `title: str | None`, `priority: int | None`, `notes: str | None` parameters\n3. Create `TaskBackendDefaults` mixin class with default implementations:\n4. Add `blocked: int = 0` field to `TaskCounts` model\n5. Update type annotations and docstrings for all new methods\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/models.py", "assignee": "cub-20260129-115503", "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094091Z", "updated_at": "2026-01-29T12:04:00.274282-05:00", "closed_at": "2026-01-29T12:04:00.274282-05:00", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-p1t.1", "title": "Extend TaskBackend protocol with 7 new methods", "status": "in_progress", "priority": "P0", "type": "task", "description": "The protocol needs 7 new methods for full lifecycle coverage. Also extend `update_task` to accept `title`, `priority`, and `notes` parameters. Create a `TaskBackendDefaults` mixin with default implementations for methods that can be derived from existing operations.\n\n**Implementation Steps:**\n1. Add 7 new method signatures to `TaskBackend` protocol in `backend.py`: `add_dependency`, `remove_dependency`, `list_blocked_tasks`, `reopen_task`, `delete_task`, `add_label`, `remove_label`\n2. Extend `update_task` signature with optional `title: str | None`, `priority: int | None`, `notes: str | None` parameters\n3. Create `TaskBackendDefaults` mixin class with default implementations:\n4. Add `blocked: int = 0` field to `TaskCounts` model\n5. Update type annotations and docstrings for all new methods\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/models.py", "assignee": "cub-20260129-115503", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.2", "cub-p1t.3", "cub-p1t.4"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463297", "updated_at": "2026-01-29T11:55:34.557241", "closed_at": null, "acceptance_criteria": ["`TaskBackend` protocol has 19 methods (12 existing + 7 new)", "`update_task` accepts `title`, `priority`, `notes` optional params", "`TaskBackendDefaults` mixin has working default implementations", "`TaskCounts.blocked` field exists", "mypy passes with strict mode", "All new methods have complete docstrings"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:04:49.665175", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 92, "open": 91, "in_progress": 1, "closed": 0}, "secondary_result": {"total": 57, "open": 27, "in_progress": 1, "closed": 29}, "difference_summary": "total: 92 != 57; open: 91 != 27; closed: 0 != 29"}
{"timestamp": "2026-01-29T12:04:59.975284", "operation": "close_task", "task_id": "cub-p1t.1", "primary_result": {"id": "cub-p1t.1", "title": "Extend TaskBackend protocol with 7 new methods", "status": "closed", "priority": "P0", "type": "task", "description": "The protocol needs 7 new methods for full lifecycle coverage. Also extend `update_task` to accept `title`, `priority`, and `notes` parameters. Create a `TaskBackendDefaults` mixin with default implementations for methods that can be derived from existing operations.\n\n**Implementation Steps:**\n1. Add 7 new method signatures to `TaskBackend` protocol in `backend.py`: `add_dependency`, `remove_dependency`, `list_blocked_tasks`, `reopen_task`, `delete_task`, `add_label`, `remove_label`\n2. Extend `update_task` signature with optional `title: str | None`, `priority: int | None`, `notes: str | None` parameters\n3. Create `TaskBackendDefaults` mixin class with default implementations:\n4. Add `blocked: int = 0` field to `TaskCounts` model\n5. Update type annotations and docstrings for all new methods\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/models.py", "assignee": "cub-20260129-115503", "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094091Z", "updated_at": "2026-01-29T12:04:54.825485-05:00", "closed_at": "2026-01-29T12:04:54.825485-05:00", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-p1t.1", "title": "Extend TaskBackend protocol with 7 new methods", "status": "closed", "priority": "P0", "type": "task", "description": "The protocol needs 7 new methods for full lifecycle coverage. Also extend `update_task` to accept `title`, `priority`, and `notes` parameters. Create a `TaskBackendDefaults` mixin with default implementations for methods that can be derived from existing operations.\n\n**Implementation Steps:**\n1. Add 7 new method signatures to `TaskBackend` protocol in `backend.py`: `add_dependency`, `remove_dependency`, `list_blocked_tasks`, `reopen_task`, `delete_task`, `add_label`, `remove_label`\n2. Extend `update_task` signature with optional `title: str | None`, `priority: int | None`, `notes: str | None` parameters\n3. Create `TaskBackendDefaults` mixin class with default implementations:\n4. Add `blocked: int = 0` field to `TaskCounts` model\n5. Update type annotations and docstrings for all new methods\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/models.py", "assignee": "cub-20260129-115503", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.2", "cub-p1t.3", "cub-p1t.4"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463297", "updated_at": "2026-01-29T12:04:59.972632", "closed_at": "2026-01-29T12:04:59.972586", "acceptance_criteria": ["`TaskBackend` protocol has 19 methods (12 existing + 7 new)", "`update_task` accepts `title`, `priority`, `notes` optional params", "`TaskBackendDefaults` mixin has working default implementations", "`TaskCounts.blocked` field exists", "mypy passes with strict mode", "All new methods have complete docstrings"], "notes": "[Closed: 2026-01-29T12:04:59.972635] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:05:05.187650", "operation": "get_task", "task_id": "cub-p1t.1", "primary_result": {"id": "cub-p1t.1", "title": "Extend TaskBackend protocol with 7 new methods", "status": "closed", "priority": "P0", "type": "task", "description": "The protocol needs 7 new methods for full lifecycle coverage. Also extend `update_task` to accept `title`, `priority`, and `notes` parameters. Create a `TaskBackendDefaults` mixin with default implementations for methods that can be derived from existing operations.\n\n**Implementation Steps:**\n1. Add 7 new method signatures to `TaskBackend` protocol in `backend.py`: `add_dependency`, `remove_dependency`, `list_blocked_tasks`, `reopen_task`, `delete_task`, `add_label`, `remove_label`\n2. Extend `update_task` signature with optional `title: str | None`, `priority: int | None`, `notes: str | None` parameters\n3. Create `TaskBackendDefaults` mixin class with default implementations:\n4. Add `blocked: int = 0` field to `TaskCounts` model\n5. Update type annotations and docstrings for all new methods\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/models.py", "assignee": "cub-20260129-115503", "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094091Z", "updated_at": "2026-01-29T12:04:54.825485-05:00", "closed_at": "2026-01-29T12:04:54.825485-05:00", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-p1t.1", "title": "Extend TaskBackend protocol with 7 new methods", "status": "closed", "priority": "P0", "type": "task", "description": "The protocol needs 7 new methods for full lifecycle coverage. Also extend `update_task` to accept `title`, `priority`, and `notes` parameters. Create a `TaskBackendDefaults` mixin with default implementations for methods that can be derived from existing operations.\n\n**Implementation Steps:**\n1. Add 7 new method signatures to `TaskBackend` protocol in `backend.py`: `add_dependency`, `remove_dependency`, `list_blocked_tasks`, `reopen_task`, `delete_task`, `add_label`, `remove_label`\n2. Extend `update_task` signature with optional `title: str | None`, `priority: int | None`, `notes: str | None` parameters\n3. Create `TaskBackendDefaults` mixin class with default implementations:\n4. Add `blocked: int = 0` field to `TaskCounts` model\n5. Update type annotations and docstrings for all new methods\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/models.py", "assignee": "cub-20260129-115503", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.2", "cub-p1t.3", "cub-p1t.4"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463297", "updated_at": "2026-01-29T12:04:59.972632", "closed_at": "2026-01-29T12:04:59.972586", "acceptance_criteria": ["`TaskBackend` protocol has 19 methods (12 existing + 7 new)", "`update_task` accepts `title`, `priority`, `notes` optional params", "`TaskBackendDefaults` mixin has working default implementations", "`TaskCounts.blocked` field exists", "mypy passes with strict mode", "All new methods have complete docstrings"], "notes": "[Closed: 2026-01-29T12:04:59.972635] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:05:23.131019", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-p1t.2", "title": "Implement new protocol methods in BeadsBackend", "status": "open", "priority": "P0", "type": "task", "description": "BeadsBackend wraps the `bd` CLI. Each new protocol method needs a corresponding `bd` command wrapper. Follow the existing `_run_bd` pattern \u2014 bd commands that don't return JSON need a follow-up `get_task()` call.\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 run `bd dep add <task_id> <depends_on>`, then `get_task(task_id)`\n2. `remove_dependency(task_id, depends_on)` \u2014 run `bd dep remove <task_id> <depends_on>`, then `get_task(task_id)`\n3. `list_blocked_tasks(parent?)` \u2014 run `bd blocked --json` (or `bd list --status open --json` and filter), parse JSON output\n4. `reopen_task(task_id)` \u2014 run `bd update <id> --status open`, then `get_task(task_id)`\n5. `delete_task(task_id)` \u2014 run `bd delete <id>`, return True on success\n6. `add_label(task_id, label)` \u2014 run `bd label add <id> <label>`, then `get_task(task_id)`\n7. `remove_label(task_id, label)` \u2014 run `bd label remove <id> <label>`, then `get_task(task_id)`\n8. Extend `update_task` to pass `--title`, `--priority`, `--notes` flags when provided\n9. Update `get_task_counts` to include blocked count\n\n**Files:** src/cub/core/tasks/beads.py, tests/test_beads_backend.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094128Z", "updated_at": "2026-01-29T11:45:15.284905-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.3", "title": "Implement new protocol methods in JsonlBackend", "status": "open", "priority": "P0", "type": "task", "description": "JsonlBackend operates on an in-memory task list with atomic file writes. New methods manipulate task fields directly using existing Task model methods (`add_label()`, `remove_label()`, `reopen()`).\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 find task, append to `depends_on` list, save\n2. `remove_dependency(task_id, depends_on)` \u2014 find task, remove from `depends_on` list, save\n3. `list_blocked_tasks(parent?)` \u2014 filter: status=OPEN, has depends_on, not all deps closed\n4. `reopen_task(task_id)` \u2014 find task, call `task.reopen()`, save\n5. `delete_task(task_id)` \u2014 remove task from list, save, return True\n6. `add_label(task_id, label)` \u2014 find task, call `task.add_label(label)`, save\n7. `remove_label(task_id, label)` \u2014 find task, call `task.remove_label(label)`, save\n8. Extend `update_task` to handle title, priority, notes field updates\n9. Update `get_task_counts` to include blocked count\n10. All mutations use existing atomic write pattern (temp file \u2192 rename)\n\n**Files:** src/cub/core/tasks/jsonl.py, tests/test_jsonl_backend.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094142Z", "updated_at": "2026-01-29T11:45:15.285156-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "open", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": null, "labels": ["complexity:high", "epic:cub-p1t", "model:opus", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094154Z", "updated_at": "2026-01-29T11:45:15.285348-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}], "secondary_result": [{"id": "cub-p1t.2", "title": "Implement new protocol methods in BeadsBackend", "status": "open", "priority": "P0", "type": "task", "description": "BeadsBackend wraps the `bd` CLI. Each new protocol method needs a corresponding `bd` command wrapper. Follow the existing `_run_bd` pattern \u2014 bd commands that don't return JSON need a follow-up `get_task()` call.\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 run `bd dep add <task_id> <depends_on>`, then `get_task(task_id)`\n2. `remove_dependency(task_id, depends_on)` \u2014 run `bd dep remove <task_id> <depends_on>`, then `get_task(task_id)`\n3. `list_blocked_tasks(parent?)` \u2014 run `bd blocked --json` (or `bd list --status open --json` and filter), parse JSON output\n4. `reopen_task(task_id)` \u2014 run `bd update <id> --status open`, then `get_task(task_id)`\n5. `delete_task(task_id)` \u2014 run `bd delete <id>`, return True on success\n6. `add_label(task_id, label)` \u2014 run `bd label add <id> <label>`, then `get_task(task_id)`\n7. `remove_label(task_id, label)` \u2014 run `bd label remove <id> <label>`, then `get_task(task_id)`\n8. Extend `update_task` to pass `--title`, `--priority`, `--notes` flags when provided\n9. Update `get_task_counts` to include blocked count\n\n**Files:** src/cub/core/tasks/beads.py, tests/test_beads_backend.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463498", "updated_at": "2026-01-29T11:46:17.463499", "closed_at": null, "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Error handling follows existing pattern (ValueError on not found)", "Unit tests pass for all new methods (mocked bd subprocess)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.3", "title": "Implement new protocol methods in JsonlBackend", "status": "open", "priority": "P0", "type": "task", "description": "JsonlBackend operates on an in-memory task list with atomic file writes. New methods manipulate task fields directly using existing Task model methods (`add_label()`, `remove_label()`, `reopen()`).\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 find task, append to `depends_on` list, save\n2. `remove_dependency(task_id, depends_on)` \u2014 find task, remove from `depends_on` list, save\n3. `list_blocked_tasks(parent?)` \u2014 filter: status=OPEN, has depends_on, not all deps closed\n4. `reopen_task(task_id)` \u2014 find task, call `task.reopen()`, save\n5. `delete_task(task_id)` \u2014 remove task from list, save, return True\n6. `add_label(task_id, label)` \u2014 find task, call `task.add_label(label)`, save\n7. `remove_label(task_id, label)` \u2014 find task, call `task.remove_label(label)`, save\n8. Extend `update_task` to handle title, priority, notes field updates\n9. Update `get_task_counts` to include blocked count\n10. All mutations use existing atomic write pattern (temp file \u2192 rename)\n\n**Files:** src/cub/core/tasks/jsonl.py, tests/test_jsonl_backend.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463520", "updated_at": "2026-01-29T11:46:17.463521", "closed_at": null, "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Atomic writes for all mutations (no partial state)", "Unit tests pass for all new methods"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "open", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": null, "labels": ["phase-1", "model:opus", "complexity:high"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463535", "updated_at": "2026-01-29T11:46:17.463536", "closed_at": null, "acceptance_criteria": ["All 6 query methods return correct results for test topologies", "Cycle detection works and doesn't cause infinite loops in other methods", "Closed tasks are correctly excluded from graph (treated as resolved)", "`would_become_ready` checks ALL deps, not just the given task", "`root_blockers` correctly ranks by transitive impact", "`chains` returns paths sorted by length descending", "mypy passes with strict mode", "Tests cover: empty graph, single node, linear chain (5 deep), diamond dependency, forest (disconnected), cycle, mixed open/closed states"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.5", "title": "Update BothBackend and write cross-backend tests", "status": "open", "priority": "P1", "type": "task", "description": "BothBackend delegates to primary and secondary backends. It needs to delegate all 7 new methods and log divergences. Also write parametrized tests that verify the same operations work identically across both backends.\n\n**Implementation Steps:**\n1. Update `BothBackend` to delegate all 7 new methods (follow existing delegation pattern)\n2. Inherit from `TaskBackendDefaults` as fallback\n3. Add divergence logging for new methods\n4. Write parametrized pytest tests that run the same test cases against BeadsBackend (mocked) and JsonlBackend (temp files)\n5. Test scenarios: add/remove dependency, list blocked, reopen, delete, add/remove label\n6. Verify `DependencyGraph` produces consistent results from both backend outputs\n\n**Files:** src/cub/core/tasks/both.py, tests/test_task_backends.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463550", "updated_at": "2026-01-29T11:46:17.463550", "closed_at": null, "acceptance_criteria": ["BothBackend delegates all 7 new methods", "Divergence logging works for new methods", "Parametrized tests pass against both backends", "DependencyGraph produces same results regardless of backend", "mypy passes"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 3 != 4"}
{"timestamp": "2026-01-29T12:05:28.266231", "operation": "get_task", "task_id": "cub-p1t.2", "primary_result": {"id": "cub-p1t.2", "title": "Implement new protocol methods in BeadsBackend", "status": "open", "priority": "P0", "type": "task", "description": "BeadsBackend wraps the `bd` CLI. Each new protocol method needs a corresponding `bd` command wrapper. Follow the existing `_run_bd` pattern \u2014 bd commands that don't return JSON need a follow-up `get_task()` call.\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 run `bd dep add <task_id> <depends_on>`, then `get_task(task_id)`\n2. `remove_dependency(task_id, depends_on)` \u2014 run `bd dep remove <task_id> <depends_on>`, then `get_task(task_id)`\n3. `list_blocked_tasks(parent?)` \u2014 run `bd blocked --json` (or `bd list --status open --json` and filter), parse JSON output\n4. `reopen_task(task_id)` \u2014 run `bd update <id> --status open`, then `get_task(task_id)`\n5. `delete_task(task_id)` \u2014 run `bd delete <id>`, return True on success\n6. `add_label(task_id, label)` \u2014 run `bd label add <id> <label>`, then `get_task(task_id)`\n7. `remove_label(task_id, label)` \u2014 run `bd label remove <id> <label>`, then `get_task(task_id)`\n8. Extend `update_task` to pass `--title`, `--priority`, `--notes` flags when provided\n9. Update `get_task_counts` to include blocked count\n\n**Files:** src/cub/core/tasks/beads.py, tests/test_beads_backend.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094128Z", "updated_at": "2026-01-29T11:45:15.284905-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, "secondary_result": {"id": "cub-p1t.2", "title": "Implement new protocol methods in BeadsBackend", "status": "open", "priority": "P0", "type": "task", "description": "BeadsBackend wraps the `bd` CLI. Each new protocol method needs a corresponding `bd` command wrapper. Follow the existing `_run_bd` pattern \u2014 bd commands that don't return JSON need a follow-up `get_task()` call.\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 run `bd dep add <task_id> <depends_on>`, then `get_task(task_id)`\n2. `remove_dependency(task_id, depends_on)` \u2014 run `bd dep remove <task_id> <depends_on>`, then `get_task(task_id)`\n3. `list_blocked_tasks(parent?)` \u2014 run `bd blocked --json` (or `bd list --status open --json` and filter), parse JSON output\n4. `reopen_task(task_id)` \u2014 run `bd update <id> --status open`, then `get_task(task_id)`\n5. `delete_task(task_id)` \u2014 run `bd delete <id>`, return True on success\n6. `add_label(task_id, label)` \u2014 run `bd label add <id> <label>`, then `get_task(task_id)`\n7. `remove_label(task_id, label)` \u2014 run `bd label remove <id> <label>`, then `get_task(task_id)`\n8. Extend `update_task` to pass `--title`, `--priority`, `--notes` flags when provided\n9. Update `get_task_counts` to include blocked count\n\n**Files:** src/cub/core/tasks/beads.py, tests/test_beads_backend.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463498", "updated_at": "2026-01-29T11:46:17.463499", "closed_at": null, "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Error handling follows existing pattern (ValueError on not found)", "Unit tests pass for all new methods (mocked bd subprocess)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:05:38.571822", "operation": "update_task", "task_id": "cub-p1t.2", "primary_result": {"id": "cub-p1t.2", "title": "Implement new protocol methods in BeadsBackend", "status": "in_progress", "priority": "P0", "type": "task", "description": "BeadsBackend wraps the `bd` CLI. Each new protocol method needs a corresponding `bd` command wrapper. Follow the existing `_run_bd` pattern \u2014 bd commands that don't return JSON need a follow-up `get_task()` call.\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 run `bd dep add <task_id> <depends_on>`, then `get_task(task_id)`\n2. `remove_dependency(task_id, depends_on)` \u2014 run `bd dep remove <task_id> <depends_on>`, then `get_task(task_id)`\n3. `list_blocked_tasks(parent?)` \u2014 run `bd blocked --json` (or `bd list --status open --json` and filter), parse JSON output\n4. `reopen_task(task_id)` \u2014 run `bd update <id> --status open`, then `get_task(task_id)`\n5. `delete_task(task_id)` \u2014 run `bd delete <id>`, return True on success\n6. `add_label(task_id, label)` \u2014 run `bd label add <id> <label>`, then `get_task(task_id)`\n7. `remove_label(task_id, label)` \u2014 run `bd label remove <id> <label>`, then `get_task(task_id)`\n8. Extend `update_task` to pass `--title`, `--priority`, `--notes` flags when provided\n9. Update `get_task_counts` to include blocked count\n\n**Files:** src/cub/core/tasks/beads.py, tests/test_beads_backend.py", "assignee": "cub-20260129-115503", "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094128Z", "updated_at": "2026-01-29T12:05:33.421185-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-p1t.2", "title": "Implement new protocol methods in BeadsBackend", "status": "in_progress", "priority": "P0", "type": "task", "description": "BeadsBackend wraps the `bd` CLI. Each new protocol method needs a corresponding `bd` command wrapper. Follow the existing `_run_bd` pattern \u2014 bd commands that don't return JSON need a follow-up `get_task()` call.\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 run `bd dep add <task_id> <depends_on>`, then `get_task(task_id)`\n2. `remove_dependency(task_id, depends_on)` \u2014 run `bd dep remove <task_id> <depends_on>`, then `get_task(task_id)`\n3. `list_blocked_tasks(parent?)` \u2014 run `bd blocked --json` (or `bd list --status open --json` and filter), parse JSON output\n4. `reopen_task(task_id)` \u2014 run `bd update <id> --status open`, then `get_task(task_id)`\n5. `delete_task(task_id)` \u2014 run `bd delete <id>`, return True on success\n6. `add_label(task_id, label)` \u2014 run `bd label add <id> <label>`, then `get_task(task_id)`\n7. `remove_label(task_id, label)` \u2014 run `bd label remove <id> <label>`, then `get_task(task_id)`\n8. Extend `update_task` to pass `--title`, `--priority`, `--notes` flags when provided\n9. Update `get_task_counts` to include blocked count\n\n**Files:** src/cub/core/tasks/beads.py, tests/test_beads_backend.py", "assignee": "cub-20260129-115503", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463498", "updated_at": "2026-01-29T12:05:38.569017", "closed_at": null, "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Error handling follows existing pattern (ValueError on not found)", "Unit tests pass for all new methods (mocked bd subprocess)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:20:43.458807", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 92, "open": 90, "in_progress": 2, "closed": 0}, "secondary_result": {"total": 57, "open": 26, "in_progress": 1, "closed": 30}, "difference_summary": "total: 92 != 57; open: 90 != 26; in_progress: 2 != 1; closed: 0 != 30"}
{"timestamp": "2026-01-29T12:20:48.661755", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-p1t.2", "title": "Implement new protocol methods in BeadsBackend", "status": "in_progress", "priority": "P0", "type": "task", "description": "BeadsBackend wraps the `bd` CLI. Each new protocol method needs a corresponding `bd` command wrapper. Follow the existing `_run_bd` pattern \u2014 bd commands that don't return JSON need a follow-up `get_task()` call.\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 run `bd dep add <task_id> <depends_on>`, then `get_task(task_id)`\n2. `remove_dependency(task_id, depends_on)` \u2014 run `bd dep remove <task_id> <depends_on>`, then `get_task(task_id)`\n3. `list_blocked_tasks(parent?)` \u2014 run `bd blocked --json` (or `bd list --status open --json` and filter), parse JSON output\n4. `reopen_task(task_id)` \u2014 run `bd update <id> --status open`, then `get_task(task_id)`\n5. `delete_task(task_id)` \u2014 run `bd delete <id>`, return True on success\n6. `add_label(task_id, label)` \u2014 run `bd label add <id> <label>`, then `get_task(task_id)`\n7. `remove_label(task_id, label)` \u2014 run `bd label remove <id> <label>`, then `get_task(task_id)`\n8. Extend `update_task` to pass `--title`, `--priority`, `--notes` flags when provided\n9. Update `get_task_counts` to include blocked count\n\n**Files:** src/cub/core/tasks/beads.py, tests/test_beads_backend.py", "assignee": "cub-20260129-115503", "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094128Z", "updated_at": "2026-01-29T12:05:50.285643-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-p1t.3", "title": "Implement new protocol methods in JsonlBackend", "status": "open", "priority": "P0", "type": "task", "description": "JsonlBackend operates on an in-memory task list with atomic file writes. New methods manipulate task fields directly using existing Task model methods (`add_label()`, `remove_label()`, `reopen()`).\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 find task, append to `depends_on` list, save\n2. `remove_dependency(task_id, depends_on)` \u2014 find task, remove from `depends_on` list, save\n3. `list_blocked_tasks(parent?)` \u2014 filter: status=OPEN, has depends_on, not all deps closed\n4. `reopen_task(task_id)` \u2014 find task, call `task.reopen()`, save\n5. `delete_task(task_id)` \u2014 remove task from list, save, return True\n6. `add_label(task_id, label)` \u2014 find task, call `task.add_label(label)`, save\n7. `remove_label(task_id, label)` \u2014 find task, call `task.remove_label(label)`, save\n8. Extend `update_task` to handle title, priority, notes field updates\n9. Update `get_task_counts` to include blocked count\n10. All mutations use existing atomic write pattern (temp file \u2192 rename)\n\n**Files:** src/cub/core/tasks/jsonl.py, tests/test_jsonl_backend.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094142Z", "updated_at": "2026-01-29T11:45:15.285156-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "open", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": null, "labels": ["complexity:high", "epic:cub-p1t", "model:opus", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094154Z", "updated_at": "2026-01-29T11:45:15.285348-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}], "secondary_result": [{"id": "cub-p1t.3", "title": "Implement new protocol methods in JsonlBackend", "status": "open", "priority": "P0", "type": "task", "description": "JsonlBackend operates on an in-memory task list with atomic file writes. New methods manipulate task fields directly using existing Task model methods (`add_label()`, `remove_label()`, `reopen()`).\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 find task, append to `depends_on` list, save\n2. `remove_dependency(task_id, depends_on)` \u2014 find task, remove from `depends_on` list, save\n3. `list_blocked_tasks(parent?)` \u2014 filter: status=OPEN, has depends_on, not all deps closed\n4. `reopen_task(task_id)` \u2014 find task, call `task.reopen()`, save\n5. `delete_task(task_id)` \u2014 remove task from list, save, return True\n6. `add_label(task_id, label)` \u2014 find task, call `task.add_label(label)`, save\n7. `remove_label(task_id, label)` \u2014 find task, call `task.remove_label(label)`, save\n8. Extend `update_task` to handle title, priority, notes field updates\n9. Update `get_task_counts` to include blocked count\n10. All mutations use existing atomic write pattern (temp file \u2192 rename)\n\n**Files:** src/cub/core/tasks/jsonl.py, tests/test_jsonl_backend.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463520", "updated_at": "2026-01-29T11:46:17.463521", "closed_at": null, "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Atomic writes for all mutations (no partial state)", "Unit tests pass for all new methods"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "open", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": null, "labels": ["phase-1", "model:opus", "complexity:high"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463535", "updated_at": "2026-01-29T11:46:17.463536", "closed_at": null, "acceptance_criteria": ["All 6 query methods return correct results for test topologies", "Cycle detection works and doesn't cause infinite loops in other methods", "Closed tasks are correctly excluded from graph (treated as resolved)", "`would_become_ready` checks ALL deps, not just the given task", "`root_blockers` correctly ranks by transitive impact", "`chains` returns paths sorted by length descending", "mypy passes with strict mode", "Tests cover: empty graph, single node, linear chain (5 deep), diamond dependency, forest (disconnected), cycle, mixed open/closed states"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.5", "title": "Update BothBackend and write cross-backend tests", "status": "open", "priority": "P1", "type": "task", "description": "BothBackend delegates to primary and secondary backends. It needs to delegate all 7 new methods and log divergences. Also write parametrized tests that verify the same operations work identically across both backends.\n\n**Implementation Steps:**\n1. Update `BothBackend` to delegate all 7 new methods (follow existing delegation pattern)\n2. Inherit from `TaskBackendDefaults` as fallback\n3. Add divergence logging for new methods\n4. Write parametrized pytest tests that run the same test cases against BeadsBackend (mocked) and JsonlBackend (temp files)\n5. Test scenarios: add/remove dependency, list blocked, reopen, delete, add/remove label\n6. Verify `DependencyGraph` produces consistent results from both backend outputs\n\n**Files:** src/cub/core/tasks/both.py, tests/test_task_backends.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463550", "updated_at": "2026-01-29T11:46:17.463550", "closed_at": null, "acceptance_criteria": ["BothBackend delegates all 7 new methods", "Divergence logging works for new methods", "Parametrized tests pass against both backends", "DependencyGraph produces same results regardless of backend", "mypy passes"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-p1t.2): id: cub-p1t.2 != cub-p1t.3; title: Implement new protocol methods in BeadsBackend != Implement new protocol methods in JsonlBackend; status: TaskStatus.IN_PROGRESS != TaskStatus.OPEN; description: 1147 chars != 1062 chars; assignee: cub-20260129-115503 != None; labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']; parent: None != cub-p1t; Task 1 (cub-p1t.3): id: cub-p1t.3 != cub-p1t.4; title: Implement new protocol methods in JsonlBackend != Build DependencyGraph class; description: 1062 chars != 1261 chars; labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:opus', 'complexity:high']; parent: None != cub-p1t; Task 2 (cub-p1t.4): id: cub-p1t.4 != cub-p1t.5; title: Build DependencyGraph class != Update BothBackend and write cross-backend tests; priority: TaskPriority.P0 != TaskPriority.P1; description: 1261 chars != 790 chars; labels: ['complexity:high', 'epic:cub-p1t', 'model:opus', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']; parent: None != cub-p1t"}
{"timestamp": "2026-01-29T12:20:53.854637", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-p1t.2", "title": "Implement new protocol methods in BeadsBackend", "status": "in_progress", "priority": "P0", "type": "task", "description": "BeadsBackend wraps the `bd` CLI. Each new protocol method needs a corresponding `bd` command wrapper. Follow the existing `_run_bd` pattern \u2014 bd commands that don't return JSON need a follow-up `get_task()` call.\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 run `bd dep add <task_id> <depends_on>`, then `get_task(task_id)`\n2. `remove_dependency(task_id, depends_on)` \u2014 run `bd dep remove <task_id> <depends_on>`, then `get_task(task_id)`\n3. `list_blocked_tasks(parent?)` \u2014 run `bd blocked --json` (or `bd list --status open --json` and filter), parse JSON output\n4. `reopen_task(task_id)` \u2014 run `bd update <id> --status open`, then `get_task(task_id)`\n5. `delete_task(task_id)` \u2014 run `bd delete <id>`, return True on success\n6. `add_label(task_id, label)` \u2014 run `bd label add <id> <label>`, then `get_task(task_id)`\n7. `remove_label(task_id, label)` \u2014 run `bd label remove <id> <label>`, then `get_task(task_id)`\n8. Extend `update_task` to pass `--title`, `--priority`, `--notes` flags when provided\n9. Update `get_task_counts` to include blocked count\n\n**Files:** src/cub/core/tasks/beads.py, tests/test_beads_backend.py", "assignee": "cub-20260129-115503", "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094128Z", "updated_at": "2026-01-29T12:05:50.285643-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-p1t.3", "title": "Implement new protocol methods in JsonlBackend", "status": "open", "priority": "P0", "type": "task", "description": "JsonlBackend operates on an in-memory task list with atomic file writes. New methods manipulate task fields directly using existing Task model methods (`add_label()`, `remove_label()`, `reopen()`).\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 find task, append to `depends_on` list, save\n2. `remove_dependency(task_id, depends_on)` \u2014 find task, remove from `depends_on` list, save\n3. `list_blocked_tasks(parent?)` \u2014 filter: status=OPEN, has depends_on, not all deps closed\n4. `reopen_task(task_id)` \u2014 find task, call `task.reopen()`, save\n5. `delete_task(task_id)` \u2014 remove task from list, save, return True\n6. `add_label(task_id, label)` \u2014 find task, call `task.add_label(label)`, save\n7. `remove_label(task_id, label)` \u2014 find task, call `task.remove_label(label)`, save\n8. Extend `update_task` to handle title, priority, notes field updates\n9. Update `get_task_counts` to include blocked count\n10. All mutations use existing atomic write pattern (temp file \u2192 rename)\n\n**Files:** src/cub/core/tasks/jsonl.py, tests/test_jsonl_backend.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094142Z", "updated_at": "2026-01-29T11:45:15.285156-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "open", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": null, "labels": ["complexity:high", "epic:cub-p1t", "model:opus", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094154Z", "updated_at": "2026-01-29T11:45:15.285348-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}], "secondary_result": [{"id": "cub-p1t.3", "title": "Implement new protocol methods in JsonlBackend", "status": "open", "priority": "P0", "type": "task", "description": "JsonlBackend operates on an in-memory task list with atomic file writes. New methods manipulate task fields directly using existing Task model methods (`add_label()`, `remove_label()`, `reopen()`).\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 find task, append to `depends_on` list, save\n2. `remove_dependency(task_id, depends_on)` \u2014 find task, remove from `depends_on` list, save\n3. `list_blocked_tasks(parent?)` \u2014 filter: status=OPEN, has depends_on, not all deps closed\n4. `reopen_task(task_id)` \u2014 find task, call `task.reopen()`, save\n5. `delete_task(task_id)` \u2014 remove task from list, save, return True\n6. `add_label(task_id, label)` \u2014 find task, call `task.add_label(label)`, save\n7. `remove_label(task_id, label)` \u2014 find task, call `task.remove_label(label)`, save\n8. Extend `update_task` to handle title, priority, notes field updates\n9. Update `get_task_counts` to include blocked count\n10. All mutations use existing atomic write pattern (temp file \u2192 rename)\n\n**Files:** src/cub/core/tasks/jsonl.py, tests/test_jsonl_backend.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463520", "updated_at": "2026-01-29T11:46:17.463521", "closed_at": null, "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Atomic writes for all mutations (no partial state)", "Unit tests pass for all new methods"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "open", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": null, "labels": ["phase-1", "model:opus", "complexity:high"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463535", "updated_at": "2026-01-29T11:46:17.463536", "closed_at": null, "acceptance_criteria": ["All 6 query methods return correct results for test topologies", "Cycle detection works and doesn't cause infinite loops in other methods", "Closed tasks are correctly excluded from graph (treated as resolved)", "`would_become_ready` checks ALL deps, not just the given task", "`root_blockers` correctly ranks by transitive impact", "`chains` returns paths sorted by length descending", "mypy passes with strict mode", "Tests cover: empty graph, single node, linear chain (5 deep), diamond dependency, forest (disconnected), cycle, mixed open/closed states"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.5", "title": "Update BothBackend and write cross-backend tests", "status": "open", "priority": "P1", "type": "task", "description": "BothBackend delegates to primary and secondary backends. It needs to delegate all 7 new methods and log divergences. Also write parametrized tests that verify the same operations work identically across both backends.\n\n**Implementation Steps:**\n1. Update `BothBackend` to delegate all 7 new methods (follow existing delegation pattern)\n2. Inherit from `TaskBackendDefaults` as fallback\n3. Add divergence logging for new methods\n4. Write parametrized pytest tests that run the same test cases against BeadsBackend (mocked) and JsonlBackend (temp files)\n5. Test scenarios: add/remove dependency, list blocked, reopen, delete, add/remove label\n6. Verify `DependencyGraph` produces consistent results from both backend outputs\n\n**Files:** src/cub/core/tasks/both.py, tests/test_task_backends.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463550", "updated_at": "2026-01-29T11:46:17.463550", "closed_at": null, "acceptance_criteria": ["BothBackend delegates all 7 new methods", "Divergence logging works for new methods", "Parametrized tests pass against both backends", "DependencyGraph produces same results regardless of backend", "mypy passes"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-p1t.2): id: cub-p1t.2 != cub-p1t.3; title: Implement new protocol methods in BeadsBackend != Implement new protocol methods in JsonlBackend; status: TaskStatus.IN_PROGRESS != TaskStatus.OPEN; description: 1147 chars != 1062 chars; assignee: cub-20260129-115503 != None; labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']; parent: None != cub-p1t; Task 1 (cub-p1t.3): id: cub-p1t.3 != cub-p1t.4; title: Implement new protocol methods in JsonlBackend != Build DependencyGraph class; description: 1062 chars != 1261 chars; labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:opus', 'complexity:high']; parent: None != cub-p1t; Task 2 (cub-p1t.4): id: cub-p1t.4 != cub-p1t.5; title: Build DependencyGraph class != Update BothBackend and write cross-backend tests; priority: TaskPriority.P0 != TaskPriority.P1; description: 1261 chars != 790 chars; labels: ['complexity:high', 'epic:cub-p1t', 'model:opus', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']; parent: None != cub-p1t"}
{"timestamp": "2026-01-29T12:20:59.065139", "operation": "get_task", "task_id": "cub-p1t.2", "primary_result": {"id": "cub-p1t.2", "title": "Implement new protocol methods in BeadsBackend", "status": "in_progress", "priority": "P0", "type": "task", "description": "BeadsBackend wraps the `bd` CLI. Each new protocol method needs a corresponding `bd` command wrapper. Follow the existing `_run_bd` pattern \u2014 bd commands that don't return JSON need a follow-up `get_task()` call.\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 run `bd dep add <task_id> <depends_on>`, then `get_task(task_id)`\n2. `remove_dependency(task_id, depends_on)` \u2014 run `bd dep remove <task_id> <depends_on>`, then `get_task(task_id)`\n3. `list_blocked_tasks(parent?)` \u2014 run `bd blocked --json` (or `bd list --status open --json` and filter), parse JSON output\n4. `reopen_task(task_id)` \u2014 run `bd update <id> --status open`, then `get_task(task_id)`\n5. `delete_task(task_id)` \u2014 run `bd delete <id>`, return True on success\n6. `add_label(task_id, label)` \u2014 run `bd label add <id> <label>`, then `get_task(task_id)`\n7. `remove_label(task_id, label)` \u2014 run `bd label remove <id> <label>`, then `get_task(task_id)`\n8. Extend `update_task` to pass `--title`, `--priority`, `--notes` flags when provided\n9. Update `get_task_counts` to include blocked count\n\n**Files:** src/cub/core/tasks/beads.py, tests/test_beads_backend.py", "assignee": "cub-20260129-115503", "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094128Z", "updated_at": "2026-01-29T12:05:50.285643-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-p1t.2", "title": "Implement new protocol methods in BeadsBackend", "status": "in_progress", "priority": "P0", "type": "task", "description": "BeadsBackend wraps the `bd` CLI. Each new protocol method needs a corresponding `bd` command wrapper. Follow the existing `_run_bd` pattern \u2014 bd commands that don't return JSON need a follow-up `get_task()` call.\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 run `bd dep add <task_id> <depends_on>`, then `get_task(task_id)`\n2. `remove_dependency(task_id, depends_on)` \u2014 run `bd dep remove <task_id> <depends_on>`, then `get_task(task_id)`\n3. `list_blocked_tasks(parent?)` \u2014 run `bd blocked --json` (or `bd list --status open --json` and filter), parse JSON output\n4. `reopen_task(task_id)` \u2014 run `bd update <id> --status open`, then `get_task(task_id)`\n5. `delete_task(task_id)` \u2014 run `bd delete <id>`, return True on success\n6. `add_label(task_id, label)` \u2014 run `bd label add <id> <label>`, then `get_task(task_id)`\n7. `remove_label(task_id, label)` \u2014 run `bd label remove <id> <label>`, then `get_task(task_id)`\n8. Extend `update_task` to pass `--title`, `--priority`, `--notes` flags when provided\n9. Update `get_task_counts` to include blocked count\n\n**Files:** src/cub/core/tasks/beads.py, tests/test_beads_backend.py", "assignee": "cub-20260129-115503", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463498", "updated_at": "2026-01-29T12:05:38.569017", "closed_at": null, "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Error handling follows existing pattern (ValueError on not found)", "Unit tests pass for all new methods (mocked bd subprocess)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:21:09.520693", "operation": "update_task", "task_id": "cub-p1t.2", "primary_result": {"id": "cub-p1t.2", "title": "Implement new protocol methods in BeadsBackend", "status": "in_progress", "priority": "P0", "type": "task", "description": "BeadsBackend wraps the `bd` CLI. Each new protocol method needs a corresponding `bd` command wrapper. Follow the existing `_run_bd` pattern \u2014 bd commands that don't return JSON need a follow-up `get_task()` call.\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 run `bd dep add <task_id> <depends_on>`, then `get_task(task_id)`\n2. `remove_dependency(task_id, depends_on)` \u2014 run `bd dep remove <task_id> <depends_on>`, then `get_task(task_id)`\n3. `list_blocked_tasks(parent?)` \u2014 run `bd blocked --json` (or `bd list --status open --json` and filter), parse JSON output\n4. `reopen_task(task_id)` \u2014 run `bd update <id> --status open`, then `get_task(task_id)`\n5. `delete_task(task_id)` \u2014 run `bd delete <id>`, return True on success\n6. `add_label(task_id, label)` \u2014 run `bd label add <id> <label>`, then `get_task(task_id)`\n7. `remove_label(task_id, label)` \u2014 run `bd label remove <id> <label>`, then `get_task(task_id)`\n8. Extend `update_task` to pass `--title`, `--priority`, `--notes` flags when provided\n9. Update `get_task_counts` to include blocked count\n\n**Files:** src/cub/core/tasks/beads.py, tests/test_beads_backend.py", "assignee": "cub-20260129-122038", "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094128Z", "updated_at": "2026-01-29T12:21:04.296350-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-p1t.2", "title": "Implement new protocol methods in BeadsBackend", "status": "in_progress", "priority": "P0", "type": "task", "description": "BeadsBackend wraps the `bd` CLI. Each new protocol method needs a corresponding `bd` command wrapper. Follow the existing `_run_bd` pattern \u2014 bd commands that don't return JSON need a follow-up `get_task()` call.\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 run `bd dep add <task_id> <depends_on>`, then `get_task(task_id)`\n2. `remove_dependency(task_id, depends_on)` \u2014 run `bd dep remove <task_id> <depends_on>`, then `get_task(task_id)`\n3. `list_blocked_tasks(parent?)` \u2014 run `bd blocked --json` (or `bd list --status open --json` and filter), parse JSON output\n4. `reopen_task(task_id)` \u2014 run `bd update <id> --status open`, then `get_task(task_id)`\n5. `delete_task(task_id)` \u2014 run `bd delete <id>`, return True on success\n6. `add_label(task_id, label)` \u2014 run `bd label add <id> <label>`, then `get_task(task_id)`\n7. `remove_label(task_id, label)` \u2014 run `bd label remove <id> <label>`, then `get_task(task_id)`\n8. Extend `update_task` to pass `--title`, `--priority`, `--notes` flags when provided\n9. Update `get_task_counts` to include blocked count\n\n**Files:** src/cub/core/tasks/beads.py, tests/test_beads_backend.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463498", "updated_at": "2026-01-29T12:21:09.517761", "closed_at": null, "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Error handling follows existing pattern (ValueError on not found)", "Unit tests pass for all new methods (mocked bd subprocess)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:26:16.882942", "operation": "get_task", "task_id": "cub-p1t.2", "primary_result": {"id": "cub-p1t.2", "title": "Implement new protocol methods in BeadsBackend", "status": "closed", "priority": "P0", "type": "task", "description": "BeadsBackend wraps the `bd` CLI. Each new protocol method needs a corresponding `bd` command wrapper. Follow the existing `_run_bd` pattern \u2014 bd commands that don't return JSON need a follow-up `get_task()` call.\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 run `bd dep add <task_id> <depends_on>`, then `get_task(task_id)`\n2. `remove_dependency(task_id, depends_on)` \u2014 run `bd dep remove <task_id> <depends_on>`, then `get_task(task_id)`\n3. `list_blocked_tasks(parent?)` \u2014 run `bd blocked --json` (or `bd list --status open --json` and filter), parse JSON output\n4. `reopen_task(task_id)` \u2014 run `bd update <id> --status open`, then `get_task(task_id)`\n5. `delete_task(task_id)` \u2014 run `bd delete <id>`, return True on success\n6. `add_label(task_id, label)` \u2014 run `bd label add <id> <label>`, then `get_task(task_id)`\n7. `remove_label(task_id, label)` \u2014 run `bd label remove <id> <label>`, then `get_task(task_id)`\n8. Extend `update_task` to pass `--title`, `--priority`, `--notes` flags when provided\n9. Update `get_task_counts` to include blocked count\n\n**Files:** src/cub/core/tasks/beads.py, tests/test_beads_backend.py", "assignee": "cub-20260129-122038", "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094128Z", "updated_at": "2026-01-29T12:25:47.712593-05:00", "closed_at": "2026-01-29T12:25:47.712593-05:00", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-p1t.2", "title": "Implement new protocol methods in BeadsBackend", "status": "in_progress", "priority": "P0", "type": "task", "description": "BeadsBackend wraps the `bd` CLI. Each new protocol method needs a corresponding `bd` command wrapper. Follow the existing `_run_bd` pattern \u2014 bd commands that don't return JSON need a follow-up `get_task()` call.\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 run `bd dep add <task_id> <depends_on>`, then `get_task(task_id)`\n2. `remove_dependency(task_id, depends_on)` \u2014 run `bd dep remove <task_id> <depends_on>`, then `get_task(task_id)`\n3. `list_blocked_tasks(parent?)` \u2014 run `bd blocked --json` (or `bd list --status open --json` and filter), parse JSON output\n4. `reopen_task(task_id)` \u2014 run `bd update <id> --status open`, then `get_task(task_id)`\n5. `delete_task(task_id)` \u2014 run `bd delete <id>`, return True on success\n6. `add_label(task_id, label)` \u2014 run `bd label add <id> <label>`, then `get_task(task_id)`\n7. `remove_label(task_id, label)` \u2014 run `bd label remove <id> <label>`, then `get_task(task_id)`\n8. Extend `update_task` to pass `--title`, `--priority`, `--notes` flags when provided\n9. Update `get_task_counts` to include blocked count\n\n**Files:** src/cub/core/tasks/beads.py, tests/test_beads_backend.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463498", "updated_at": "2026-01-29T12:21:09.517761", "closed_at": null, "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Error handling follows existing pattern (ValueError on not found)", "Unit tests pass for all new methods (mocked bd subprocess)"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:26:22.103769", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 91, "open": 90, "in_progress": 1, "closed": 0}, "secondary_result": {"total": 57, "open": 26, "in_progress": 1, "closed": 30}, "difference_summary": "total: 91 != 57; open: 90 != 26; closed: 0 != 30"}
{"timestamp": "2026-01-29T12:26:32.404059", "operation": "close_task", "task_id": "cub-p1t.2", "primary_result": {"id": "cub-p1t.2", "title": "Implement new protocol methods in BeadsBackend", "status": "closed", "priority": "P0", "type": "task", "description": "BeadsBackend wraps the `bd` CLI. Each new protocol method needs a corresponding `bd` command wrapper. Follow the existing `_run_bd` pattern \u2014 bd commands that don't return JSON need a follow-up `get_task()` call.\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 run `bd dep add <task_id> <depends_on>`, then `get_task(task_id)`\n2. `remove_dependency(task_id, depends_on)` \u2014 run `bd dep remove <task_id> <depends_on>`, then `get_task(task_id)`\n3. `list_blocked_tasks(parent?)` \u2014 run `bd blocked --json` (or `bd list --status open --json` and filter), parse JSON output\n4. `reopen_task(task_id)` \u2014 run `bd update <id> --status open`, then `get_task(task_id)`\n5. `delete_task(task_id)` \u2014 run `bd delete <id>`, return True on success\n6. `add_label(task_id, label)` \u2014 run `bd label add <id> <label>`, then `get_task(task_id)`\n7. `remove_label(task_id, label)` \u2014 run `bd label remove <id> <label>`, then `get_task(task_id)`\n8. Extend `update_task` to pass `--title`, `--priority`, `--notes` flags when provided\n9. Update `get_task_counts` to include blocked count\n\n**Files:** src/cub/core/tasks/beads.py, tests/test_beads_backend.py", "assignee": "cub-20260129-122038", "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094128Z", "updated_at": "2026-01-29T12:26:27.260069-05:00", "closed_at": "2026-01-29T12:26:27.260069-05:00", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-p1t.2", "title": "Implement new protocol methods in BeadsBackend", "status": "closed", "priority": "P0", "type": "task", "description": "BeadsBackend wraps the `bd` CLI. Each new protocol method needs a corresponding `bd` command wrapper. Follow the existing `_run_bd` pattern \u2014 bd commands that don't return JSON need a follow-up `get_task()` call.\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 run `bd dep add <task_id> <depends_on>`, then `get_task(task_id)`\n2. `remove_dependency(task_id, depends_on)` \u2014 run `bd dep remove <task_id> <depends_on>`, then `get_task(task_id)`\n3. `list_blocked_tasks(parent?)` \u2014 run `bd blocked --json` (or `bd list --status open --json` and filter), parse JSON output\n4. `reopen_task(task_id)` \u2014 run `bd update <id> --status open`, then `get_task(task_id)`\n5. `delete_task(task_id)` \u2014 run `bd delete <id>`, return True on success\n6. `add_label(task_id, label)` \u2014 run `bd label add <id> <label>`, then `get_task(task_id)`\n7. `remove_label(task_id, label)` \u2014 run `bd label remove <id> <label>`, then `get_task(task_id)`\n8. Extend `update_task` to pass `--title`, `--priority`, `--notes` flags when provided\n9. Update `get_task_counts` to include blocked count\n\n**Files:** src/cub/core/tasks/beads.py, tests/test_beads_backend.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463498", "updated_at": "2026-01-29T12:26:32.401999", "closed_at": "2026-01-29T12:26:32.401959", "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Error handling follows existing pattern (ValueError on not found)", "Unit tests pass for all new methods (mocked bd subprocess)"], "notes": "[Closed: 2026-01-29T12:26:32.402002] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:26:37.594035", "operation": "get_task", "task_id": "cub-p1t.2", "primary_result": {"id": "cub-p1t.2", "title": "Implement new protocol methods in BeadsBackend", "status": "closed", "priority": "P0", "type": "task", "description": "BeadsBackend wraps the `bd` CLI. Each new protocol method needs a corresponding `bd` command wrapper. Follow the existing `_run_bd` pattern \u2014 bd commands that don't return JSON need a follow-up `get_task()` call.\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 run `bd dep add <task_id> <depends_on>`, then `get_task(task_id)`\n2. `remove_dependency(task_id, depends_on)` \u2014 run `bd dep remove <task_id> <depends_on>`, then `get_task(task_id)`\n3. `list_blocked_tasks(parent?)` \u2014 run `bd blocked --json` (or `bd list --status open --json` and filter), parse JSON output\n4. `reopen_task(task_id)` \u2014 run `bd update <id> --status open`, then `get_task(task_id)`\n5. `delete_task(task_id)` \u2014 run `bd delete <id>`, return True on success\n6. `add_label(task_id, label)` \u2014 run `bd label add <id> <label>`, then `get_task(task_id)`\n7. `remove_label(task_id, label)` \u2014 run `bd label remove <id> <label>`, then `get_task(task_id)`\n8. Extend `update_task` to pass `--title`, `--priority`, `--notes` flags when provided\n9. Update `get_task_counts` to include blocked count\n\n**Files:** src/cub/core/tasks/beads.py, tests/test_beads_backend.py", "assignee": "cub-20260129-122038", "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094128Z", "updated_at": "2026-01-29T12:26:27.260069-05:00", "closed_at": "2026-01-29T12:26:27.260069-05:00", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-p1t.2", "title": "Implement new protocol methods in BeadsBackend", "status": "closed", "priority": "P0", "type": "task", "description": "BeadsBackend wraps the `bd` CLI. Each new protocol method needs a corresponding `bd` command wrapper. Follow the existing `_run_bd` pattern \u2014 bd commands that don't return JSON need a follow-up `get_task()` call.\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 run `bd dep add <task_id> <depends_on>`, then `get_task(task_id)`\n2. `remove_dependency(task_id, depends_on)` \u2014 run `bd dep remove <task_id> <depends_on>`, then `get_task(task_id)`\n3. `list_blocked_tasks(parent?)` \u2014 run `bd blocked --json` (or `bd list --status open --json` and filter), parse JSON output\n4. `reopen_task(task_id)` \u2014 run `bd update <id> --status open`, then `get_task(task_id)`\n5. `delete_task(task_id)` \u2014 run `bd delete <id>`, return True on success\n6. `add_label(task_id, label)` \u2014 run `bd label add <id> <label>`, then `get_task(task_id)`\n7. `remove_label(task_id, label)` \u2014 run `bd label remove <id> <label>`, then `get_task(task_id)`\n8. Extend `update_task` to pass `--title`, `--priority`, `--notes` flags when provided\n9. Update `get_task_counts` to include blocked count\n\n**Files:** src/cub/core/tasks/beads.py, tests/test_beads_backend.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463498", "updated_at": "2026-01-29T12:26:32.401999", "closed_at": "2026-01-29T12:26:32.401959", "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Error handling follows existing pattern (ValueError on not found)", "Unit tests pass for all new methods (mocked bd subprocess)"], "notes": "[Closed: 2026-01-29T12:26:32.402002] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:26:57.657825", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-p1t.3", "title": "Implement new protocol methods in JsonlBackend", "status": "open", "priority": "P0", "type": "task", "description": "JsonlBackend operates on an in-memory task list with atomic file writes. New methods manipulate task fields directly using existing Task model methods (`add_label()`, `remove_label()`, `reopen()`).\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 find task, append to `depends_on` list, save\n2. `remove_dependency(task_id, depends_on)` \u2014 find task, remove from `depends_on` list, save\n3. `list_blocked_tasks(parent?)` \u2014 filter: status=OPEN, has depends_on, not all deps closed\n4. `reopen_task(task_id)` \u2014 find task, call `task.reopen()`, save\n5. `delete_task(task_id)` \u2014 remove task from list, save, return True\n6. `add_label(task_id, label)` \u2014 find task, call `task.add_label(label)`, save\n7. `remove_label(task_id, label)` \u2014 find task, call `task.remove_label(label)`, save\n8. Extend `update_task` to handle title, priority, notes field updates\n9. Update `get_task_counts` to include blocked count\n10. All mutations use existing atomic write pattern (temp file \u2192 rename)\n\n**Files:** src/cub/core/tasks/jsonl.py, tests/test_jsonl_backend.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094142Z", "updated_at": "2026-01-29T11:45:15.285156-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "open", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": null, "labels": ["complexity:high", "epic:cub-p1t", "model:opus", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094154Z", "updated_at": "2026-01-29T11:45:15.285348-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}], "secondary_result": [{"id": "cub-p1t.3", "title": "Implement new protocol methods in JsonlBackend", "status": "open", "priority": "P0", "type": "task", "description": "JsonlBackend operates on an in-memory task list with atomic file writes. New methods manipulate task fields directly using existing Task model methods (`add_label()`, `remove_label()`, `reopen()`).\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 find task, append to `depends_on` list, save\n2. `remove_dependency(task_id, depends_on)` \u2014 find task, remove from `depends_on` list, save\n3. `list_blocked_tasks(parent?)` \u2014 filter: status=OPEN, has depends_on, not all deps closed\n4. `reopen_task(task_id)` \u2014 find task, call `task.reopen()`, save\n5. `delete_task(task_id)` \u2014 remove task from list, save, return True\n6. `add_label(task_id, label)` \u2014 find task, call `task.add_label(label)`, save\n7. `remove_label(task_id, label)` \u2014 find task, call `task.remove_label(label)`, save\n8. Extend `update_task` to handle title, priority, notes field updates\n9. Update `get_task_counts` to include blocked count\n10. All mutations use existing atomic write pattern (temp file \u2192 rename)\n\n**Files:** src/cub/core/tasks/jsonl.py, tests/test_jsonl_backend.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463520", "updated_at": "2026-01-29T11:46:17.463521", "closed_at": null, "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Atomic writes for all mutations (no partial state)", "Unit tests pass for all new methods"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "open", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": null, "labels": ["phase-1", "model:opus", "complexity:high"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463535", "updated_at": "2026-01-29T11:46:17.463536", "closed_at": null, "acceptance_criteria": ["All 6 query methods return correct results for test topologies", "Cycle detection works and doesn't cause infinite loops in other methods", "Closed tasks are correctly excluded from graph (treated as resolved)", "`would_become_ready` checks ALL deps, not just the given task", "`root_blockers` correctly ranks by transitive impact", "`chains` returns paths sorted by length descending", "mypy passes with strict mode", "Tests cover: empty graph, single node, linear chain (5 deep), diamond dependency, forest (disconnected), cycle, mixed open/closed states"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.5", "title": "Update BothBackend and write cross-backend tests", "status": "open", "priority": "P1", "type": "task", "description": "BothBackend delegates to primary and secondary backends. It needs to delegate all 7 new methods and log divergences. Also write parametrized tests that verify the same operations work identically across both backends.\n\n**Implementation Steps:**\n1. Update `BothBackend` to delegate all 7 new methods (follow existing delegation pattern)\n2. Inherit from `TaskBackendDefaults` as fallback\n3. Add divergence logging for new methods\n4. Write parametrized pytest tests that run the same test cases against BeadsBackend (mocked) and JsonlBackend (temp files)\n5. Test scenarios: add/remove dependency, list blocked, reopen, delete, add/remove label\n6. Verify `DependencyGraph` produces consistent results from both backend outputs\n\n**Files:** src/cub/core/tasks/both.py, tests/test_task_backends.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463550", "updated_at": "2026-01-29T11:46:17.463550", "closed_at": null, "acceptance_criteria": ["BothBackend delegates all 7 new methods", "Divergence logging works for new methods", "Parametrized tests pass against both backends", "DependencyGraph produces same results regardless of backend", "mypy passes"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 2 != 3"}
{"timestamp": "2026-01-29T12:27:02.775949", "operation": "get_task", "task_id": "cub-p1t.3", "primary_result": {"id": "cub-p1t.3", "title": "Implement new protocol methods in JsonlBackend", "status": "open", "priority": "P0", "type": "task", "description": "JsonlBackend operates on an in-memory task list with atomic file writes. New methods manipulate task fields directly using existing Task model methods (`add_label()`, `remove_label()`, `reopen()`).\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 find task, append to `depends_on` list, save\n2. `remove_dependency(task_id, depends_on)` \u2014 find task, remove from `depends_on` list, save\n3. `list_blocked_tasks(parent?)` \u2014 filter: status=OPEN, has depends_on, not all deps closed\n4. `reopen_task(task_id)` \u2014 find task, call `task.reopen()`, save\n5. `delete_task(task_id)` \u2014 remove task from list, save, return True\n6. `add_label(task_id, label)` \u2014 find task, call `task.add_label(label)`, save\n7. `remove_label(task_id, label)` \u2014 find task, call `task.remove_label(label)`, save\n8. Extend `update_task` to handle title, priority, notes field updates\n9. Update `get_task_counts` to include blocked count\n10. All mutations use existing atomic write pattern (temp file \u2192 rename)\n\n**Files:** src/cub/core/tasks/jsonl.py, tests/test_jsonl_backend.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094142Z", "updated_at": "2026-01-29T11:45:15.285156-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, "secondary_result": {"id": "cub-p1t.3", "title": "Implement new protocol methods in JsonlBackend", "status": "open", "priority": "P0", "type": "task", "description": "JsonlBackend operates on an in-memory task list with atomic file writes. New methods manipulate task fields directly using existing Task model methods (`add_label()`, `remove_label()`, `reopen()`).\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 find task, append to `depends_on` list, save\n2. `remove_dependency(task_id, depends_on)` \u2014 find task, remove from `depends_on` list, save\n3. `list_blocked_tasks(parent?)` \u2014 filter: status=OPEN, has depends_on, not all deps closed\n4. `reopen_task(task_id)` \u2014 find task, call `task.reopen()`, save\n5. `delete_task(task_id)` \u2014 remove task from list, save, return True\n6. `add_label(task_id, label)` \u2014 find task, call `task.add_label(label)`, save\n7. `remove_label(task_id, label)` \u2014 find task, call `task.remove_label(label)`, save\n8. Extend `update_task` to handle title, priority, notes field updates\n9. Update `get_task_counts` to include blocked count\n10. All mutations use existing atomic write pattern (temp file \u2192 rename)\n\n**Files:** src/cub/core/tasks/jsonl.py, tests/test_jsonl_backend.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463520", "updated_at": "2026-01-29T11:46:17.463521", "closed_at": null, "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Atomic writes for all mutations (no partial state)", "Unit tests pass for all new methods"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:27:13.179551", "operation": "update_task", "task_id": "cub-p1t.3", "primary_result": {"id": "cub-p1t.3", "title": "Implement new protocol methods in JsonlBackend", "status": "in_progress", "priority": "P0", "type": "task", "description": "JsonlBackend operates on an in-memory task list with atomic file writes. New methods manipulate task fields directly using existing Task model methods (`add_label()`, `remove_label()`, `reopen()`).\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 find task, append to `depends_on` list, save\n2. `remove_dependency(task_id, depends_on)` \u2014 find task, remove from `depends_on` list, save\n3. `list_blocked_tasks(parent?)` \u2014 filter: status=OPEN, has depends_on, not all deps closed\n4. `reopen_task(task_id)` \u2014 find task, call `task.reopen()`, save\n5. `delete_task(task_id)` \u2014 remove task from list, save, return True\n6. `add_label(task_id, label)` \u2014 find task, call `task.add_label(label)`, save\n7. `remove_label(task_id, label)` \u2014 find task, call `task.remove_label(label)`, save\n8. Extend `update_task` to handle title, priority, notes field updates\n9. Update `get_task_counts` to include blocked count\n10. All mutations use existing atomic write pattern (temp file \u2192 rename)\n\n**Files:** src/cub/core/tasks/jsonl.py, tests/test_jsonl_backend.py", "assignee": "cub-20260129-122038", "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094142Z", "updated_at": "2026-01-29T12:27:08.023201-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-p1t.3", "title": "Implement new protocol methods in JsonlBackend", "status": "in_progress", "priority": "P0", "type": "task", "description": "JsonlBackend operates on an in-memory task list with atomic file writes. New methods manipulate task fields directly using existing Task model methods (`add_label()`, `remove_label()`, `reopen()`).\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 find task, append to `depends_on` list, save\n2. `remove_dependency(task_id, depends_on)` \u2014 find task, remove from `depends_on` list, save\n3. `list_blocked_tasks(parent?)` \u2014 filter: status=OPEN, has depends_on, not all deps closed\n4. `reopen_task(task_id)` \u2014 find task, call `task.reopen()`, save\n5. `delete_task(task_id)` \u2014 remove task from list, save, return True\n6. `add_label(task_id, label)` \u2014 find task, call `task.add_label(label)`, save\n7. `remove_label(task_id, label)` \u2014 find task, call `task.remove_label(label)`, save\n8. Extend `update_task` to handle title, priority, notes field updates\n9. Update `get_task_counts` to include blocked count\n10. All mutations use existing atomic write pattern (temp file \u2192 rename)\n\n**Files:** src/cub/core/tasks/jsonl.py, tests/test_jsonl_backend.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463520", "updated_at": "2026-01-29T12:27:13.177788", "closed_at": null, "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Atomic writes for all mutations (no partial state)", "Unit tests pass for all new methods"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:32:25.435447", "operation": "get_task", "task_id": "cub-p1t.3", "primary_result": {"id": "cub-p1t.3", "title": "Implement new protocol methods in JsonlBackend", "status": "closed", "priority": "P0", "type": "task", "description": "JsonlBackend operates on an in-memory task list with atomic file writes. New methods manipulate task fields directly using existing Task model methods (`add_label()`, `remove_label()`, `reopen()`).\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 find task, append to `depends_on` list, save\n2. `remove_dependency(task_id, depends_on)` \u2014 find task, remove from `depends_on` list, save\n3. `list_blocked_tasks(parent?)` \u2014 filter: status=OPEN, has depends_on, not all deps closed\n4. `reopen_task(task_id)` \u2014 find task, call `task.reopen()`, save\n5. `delete_task(task_id)` \u2014 remove task from list, save, return True\n6. `add_label(task_id, label)` \u2014 find task, call `task.add_label(label)`, save\n7. `remove_label(task_id, label)` \u2014 find task, call `task.remove_label(label)`, save\n8. Extend `update_task` to handle title, priority, notes field updates\n9. Update `get_task_counts` to include blocked count\n10. All mutations use existing atomic write pattern (temp file \u2192 rename)\n\n**Files:** src/cub/core/tasks/jsonl.py, tests/test_jsonl_backend.py", "assignee": "cub-20260129-122038", "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094142Z", "updated_at": "2026-01-29T12:31:55.087926-05:00", "closed_at": "2026-01-29T12:31:55.087926-05:00", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-p1t.3", "title": "Implement new protocol methods in JsonlBackend", "status": "in_progress", "priority": "P0", "type": "task", "description": "JsonlBackend operates on an in-memory task list with atomic file writes. New methods manipulate task fields directly using existing Task model methods (`add_label()`, `remove_label()`, `reopen()`).\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 find task, append to `depends_on` list, save\n2. `remove_dependency(task_id, depends_on)` \u2014 find task, remove from `depends_on` list, save\n3. `list_blocked_tasks(parent?)` \u2014 filter: status=OPEN, has depends_on, not all deps closed\n4. `reopen_task(task_id)` \u2014 find task, call `task.reopen()`, save\n5. `delete_task(task_id)` \u2014 remove task from list, save, return True\n6. `add_label(task_id, label)` \u2014 find task, call `task.add_label(label)`, save\n7. `remove_label(task_id, label)` \u2014 find task, call `task.remove_label(label)`, save\n8. Extend `update_task` to handle title, priority, notes field updates\n9. Update `get_task_counts` to include blocked count\n10. All mutations use existing atomic write pattern (temp file \u2192 rename)\n\n**Files:** src/cub/core/tasks/jsonl.py, tests/test_jsonl_backend.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463520", "updated_at": "2026-01-29T12:27:13.177788", "closed_at": null, "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Atomic writes for all mutations (no partial state)", "Unit tests pass for all new methods"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:32:30.644353", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 90, "open": 89, "in_progress": 1, "closed": 0}, "secondary_result": {"total": 57, "open": 25, "in_progress": 1, "closed": 31}, "difference_summary": "total: 90 != 57; open: 89 != 25; closed: 0 != 31"}
{"timestamp": "2026-01-29T12:32:41.080517", "operation": "close_task", "task_id": "cub-p1t.3", "primary_result": {"id": "cub-p1t.3", "title": "Implement new protocol methods in JsonlBackend", "status": "closed", "priority": "P0", "type": "task", "description": "JsonlBackend operates on an in-memory task list with atomic file writes. New methods manipulate task fields directly using existing Task model methods (`add_label()`, `remove_label()`, `reopen()`).\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 find task, append to `depends_on` list, save\n2. `remove_dependency(task_id, depends_on)` \u2014 find task, remove from `depends_on` list, save\n3. `list_blocked_tasks(parent?)` \u2014 filter: status=OPEN, has depends_on, not all deps closed\n4. `reopen_task(task_id)` \u2014 find task, call `task.reopen()`, save\n5. `delete_task(task_id)` \u2014 remove task from list, save, return True\n6. `add_label(task_id, label)` \u2014 find task, call `task.add_label(label)`, save\n7. `remove_label(task_id, label)` \u2014 find task, call `task.remove_label(label)`, save\n8. Extend `update_task` to handle title, priority, notes field updates\n9. Update `get_task_counts` to include blocked count\n10. All mutations use existing atomic write pattern (temp file \u2192 rename)\n\n**Files:** src/cub/core/tasks/jsonl.py, tests/test_jsonl_backend.py", "assignee": "cub-20260129-122038", "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094142Z", "updated_at": "2026-01-29T12:32:35.854441-05:00", "closed_at": "2026-01-29T12:32:35.854441-05:00", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-p1t.3", "title": "Implement new protocol methods in JsonlBackend", "status": "closed", "priority": "P0", "type": "task", "description": "JsonlBackend operates on an in-memory task list with atomic file writes. New methods manipulate task fields directly using existing Task model methods (`add_label()`, `remove_label()`, `reopen()`).\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 find task, append to `depends_on` list, save\n2. `remove_dependency(task_id, depends_on)` \u2014 find task, remove from `depends_on` list, save\n3. `list_blocked_tasks(parent?)` \u2014 filter: status=OPEN, has depends_on, not all deps closed\n4. `reopen_task(task_id)` \u2014 find task, call `task.reopen()`, save\n5. `delete_task(task_id)` \u2014 remove task from list, save, return True\n6. `add_label(task_id, label)` \u2014 find task, call `task.add_label(label)`, save\n7. `remove_label(task_id, label)` \u2014 find task, call `task.remove_label(label)`, save\n8. Extend `update_task` to handle title, priority, notes field updates\n9. Update `get_task_counts` to include blocked count\n10. All mutations use existing atomic write pattern (temp file \u2192 rename)\n\n**Files:** src/cub/core/tasks/jsonl.py, tests/test_jsonl_backend.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463520", "updated_at": "2026-01-29T12:32:41.078321", "closed_at": "2026-01-29T12:32:41.078307", "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Atomic writes for all mutations (no partial state)", "Unit tests pass for all new methods"], "notes": "[Closed: 2026-01-29T12:32:41.078323] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:32:46.336594", "operation": "get_task", "task_id": "cub-p1t.3", "primary_result": {"id": "cub-p1t.3", "title": "Implement new protocol methods in JsonlBackend", "status": "closed", "priority": "P0", "type": "task", "description": "JsonlBackend operates on an in-memory task list with atomic file writes. New methods manipulate task fields directly using existing Task model methods (`add_label()`, `remove_label()`, `reopen()`).\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 find task, append to `depends_on` list, save\n2. `remove_dependency(task_id, depends_on)` \u2014 find task, remove from `depends_on` list, save\n3. `list_blocked_tasks(parent?)` \u2014 filter: status=OPEN, has depends_on, not all deps closed\n4. `reopen_task(task_id)` \u2014 find task, call `task.reopen()`, save\n5. `delete_task(task_id)` \u2014 remove task from list, save, return True\n6. `add_label(task_id, label)` \u2014 find task, call `task.add_label(label)`, save\n7. `remove_label(task_id, label)` \u2014 find task, call `task.remove_label(label)`, save\n8. Extend `update_task` to handle title, priority, notes field updates\n9. Update `get_task_counts` to include blocked count\n10. All mutations use existing atomic write pattern (temp file \u2192 rename)\n\n**Files:** src/cub/core/tasks/jsonl.py, tests/test_jsonl_backend.py", "assignee": "cub-20260129-122038", "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094142Z", "updated_at": "2026-01-29T12:32:35.854441-05:00", "closed_at": "2026-01-29T12:32:35.854441-05:00", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-p1t.3", "title": "Implement new protocol methods in JsonlBackend", "status": "closed", "priority": "P0", "type": "task", "description": "JsonlBackend operates on an in-memory task list with atomic file writes. New methods manipulate task fields directly using existing Task model methods (`add_label()`, `remove_label()`, `reopen()`).\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 find task, append to `depends_on` list, save\n2. `remove_dependency(task_id, depends_on)` \u2014 find task, remove from `depends_on` list, save\n3. `list_blocked_tasks(parent?)` \u2014 filter: status=OPEN, has depends_on, not all deps closed\n4. `reopen_task(task_id)` \u2014 find task, call `task.reopen()`, save\n5. `delete_task(task_id)` \u2014 remove task from list, save, return True\n6. `add_label(task_id, label)` \u2014 find task, call `task.add_label(label)`, save\n7. `remove_label(task_id, label)` \u2014 find task, call `task.remove_label(label)`, save\n8. Extend `update_task` to handle title, priority, notes field updates\n9. Update `get_task_counts` to include blocked count\n10. All mutations use existing atomic write pattern (temp file \u2192 rename)\n\n**Files:** src/cub/core/tasks/jsonl.py, tests/test_jsonl_backend.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463520", "updated_at": "2026-01-29T12:32:41.078321", "closed_at": "2026-01-29T12:32:41.078307", "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Atomic writes for all mutations (no partial state)", "Unit tests pass for all new methods"], "notes": "[Closed: 2026-01-29T12:32:41.078323] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:33:06.838108", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "open", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": null, "labels": ["complexity:high", "epic:cub-p1t", "model:opus", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094154Z", "updated_at": "2026-01-29T11:45:15.285348-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}], "secondary_result": [{"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "open", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": null, "labels": ["phase-1", "model:opus", "complexity:high"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463535", "updated_at": "2026-01-29T11:46:17.463536", "closed_at": null, "acceptance_criteria": ["All 6 query methods return correct results for test topologies", "Cycle detection works and doesn't cause infinite loops in other methods", "Closed tasks are correctly excluded from graph (treated as resolved)", "`would_become_ready` checks ALL deps, not just the given task", "`root_blockers` correctly ranks by transitive impact", "`chains` returns paths sorted by length descending", "mypy passes with strict mode", "Tests cover: empty graph, single node, linear chain (5 deep), diamond dependency, forest (disconnected), cycle, mixed open/closed states"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t.5", "title": "Update BothBackend and write cross-backend tests", "status": "open", "priority": "P1", "type": "task", "description": "BothBackend delegates to primary and secondary backends. It needs to delegate all 7 new methods and log divergences. Also write parametrized tests that verify the same operations work identically across both backends.\n\n**Implementation Steps:**\n1. Update `BothBackend` to delegate all 7 new methods (follow existing delegation pattern)\n2. Inherit from `TaskBackendDefaults` as fallback\n3. Add divergence logging for new methods\n4. Write parametrized pytest tests that run the same test cases against BeadsBackend (mocked) and JsonlBackend (temp files)\n5. Test scenarios: add/remove dependency, list blocked, reopen, delete, add/remove label\n6. Verify `DependencyGraph` produces consistent results from both backend outputs\n\n**Files:** src/cub/core/tasks/both.py, tests/test_task_backends.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463550", "updated_at": "2026-01-29T11:46:17.463550", "closed_at": null, "acceptance_criteria": ["BothBackend delegates all 7 new methods", "Divergence logging works for new methods", "Parametrized tests pass against both backends", "DependencyGraph produces same results regardless of backend", "mypy passes"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "List length mismatch: 1 != 2"}
{"timestamp": "2026-01-29T12:33:12.041599", "operation": "get_task", "task_id": "cub-p1t.4", "primary_result": {"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "open", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": null, "labels": ["complexity:high", "epic:cub-p1t", "model:opus", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094154Z", "updated_at": "2026-01-29T11:45:15.285348-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, "secondary_result": {"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "open", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": null, "labels": ["phase-1", "model:opus", "complexity:high"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463535", "updated_at": "2026-01-29T11:46:17.463536", "closed_at": null, "acceptance_criteria": ["All 6 query methods return correct results for test topologies", "Cycle detection works and doesn't cause infinite loops in other methods", "Closed tasks are correctly excluded from graph (treated as resolved)", "`would_become_ready` checks ALL deps, not just the given task", "`root_blockers` correctly ranks by transitive impact", "`chains` returns paths sorted by length descending", "mypy passes with strict mode", "Tests cover: empty graph, single node, linear chain (5 deep), diamond dependency, forest (disconnected), cycle, mixed open/closed states"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": true, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:high', 'epic:cub-p1t', 'model:opus', 'phase-1'] != ['phase-1', 'model:opus', 'complexity:high']"}
{"timestamp": "2026-01-29T12:33:22.439351", "operation": "update_task", "task_id": "cub-p1t.4", "primary_result": {"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "in_progress", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": "cub-20260129-122038", "labels": ["complexity:high", "epic:cub-p1t", "model:opus", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094154Z", "updated_at": "2026-01-29T12:33:17.246227-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "in_progress", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:opus", "complexity:high"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463535", "updated_at": "2026-01-29T12:33:22.437525", "closed_at": null, "acceptance_criteria": ["All 6 query methods return correct results for test topologies", "Cycle detection works and doesn't cause infinite loops in other methods", "Closed tasks are correctly excluded from graph (treated as resolved)", "`would_become_ready` checks ALL deps, not just the given task", "`root_blockers` correctly ranks by transitive impact", "`chains` returns paths sorted by length descending", "mypy passes with strict mode", "Tests cover: empty graph, single node, linear chain (5 deep), diamond dependency, forest (disconnected), cycle, mixed open/closed states"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:high', 'epic:cub-p1t', 'model:opus', 'phase-1'] != ['phase-1', 'model:opus', 'complexity:high']"}
{"timestamp": "2026-01-29T12:36:39.812762", "operation": "get_task", "task_id": "cub-p1t.4", "primary_result": {"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "closed", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": "cub-20260129-122038", "labels": ["complexity:high", "epic:cub-p1t", "model:opus", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094154Z", "updated_at": "2026-01-29T12:36:21.201255-05:00", "closed_at": "2026-01-29T12:36:21.201255-05:00", "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "in_progress", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:opus", "complexity:high"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463535", "updated_at": "2026-01-29T12:33:22.437525", "closed_at": null, "acceptance_criteria": ["All 6 query methods return correct results for test topologies", "Cycle detection works and doesn't cause infinite loops in other methods", "Closed tasks are correctly excluded from graph (treated as resolved)", "`would_become_ready` checks ALL deps, not just the given task", "`root_blockers` correctly ranks by transitive impact", "`chains` returns paths sorted by length descending", "mypy passes with strict mode", "Tests cover: empty graph, single node, linear chain (5 deep), diamond dependency, forest (disconnected), cycle, mixed open/closed states"], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['complexity:high', 'epic:cub-p1t', 'model:opus', 'phase-1'] != ['phase-1', 'model:opus', 'complexity:high']"}
{"timestamp": "2026-01-29T12:36:44.938057", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 89, "open": 88, "in_progress": 1, "closed": 0}, "secondary_result": {"total": 57, "open": 24, "in_progress": 1, "closed": 32}, "difference_summary": "total: 89 != 57; open: 88 != 24; closed: 0 != 32"}
{"timestamp": "2026-01-29T12:36:55.282410", "operation": "close_task", "task_id": "cub-p1t.4", "primary_result": {"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "closed", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": "cub-20260129-122038", "labels": ["complexity:high", "epic:cub-p1t", "model:opus", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094154Z", "updated_at": "2026-01-29T12:36:50.111047-05:00", "closed_at": "2026-01-29T12:36:50.111047-05:00", "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "closed", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:opus", "complexity:high"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463535", "updated_at": "2026-01-29T12:36:55.279963", "closed_at": "2026-01-29T12:36:55.279948", "acceptance_criteria": ["All 6 query methods return correct results for test topologies", "Cycle detection works and doesn't cause infinite loops in other methods", "Closed tasks are correctly excluded from graph (treated as resolved)", "`would_become_ready` checks ALL deps, not just the given task", "`root_blockers` correctly ranks by transitive impact", "`chains` returns paths sorted by length descending", "mypy passes with strict mode", "Tests cover: empty graph, single node, linear chain (5 deep), diamond dependency, forest (disconnected), cycle, mixed open/closed states"], "notes": "[Closed: 2026-01-29T12:36:55.279966] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:high', 'epic:cub-p1t', 'model:opus', 'phase-1'] != ['phase-1', 'model:opus', 'complexity:high']"}
{"timestamp": "2026-01-29T12:37:00.504546", "operation": "get_task", "task_id": "cub-p1t.4", "primary_result": {"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "closed", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": "cub-20260129-122038", "labels": ["complexity:high", "epic:cub-p1t", "model:opus", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094154Z", "updated_at": "2026-01-29T12:36:50.111047-05:00", "closed_at": "2026-01-29T12:36:50.111047-05:00", "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "secondary_result": {"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "closed", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:opus", "complexity:high"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463535", "updated_at": "2026-01-29T12:36:55.279963", "closed_at": "2026-01-29T12:36:55.279948", "acceptance_criteria": ["All 6 query methods return correct results for test topologies", "Cycle detection works and doesn't cause infinite loops in other methods", "Closed tasks are correctly excluded from graph (treated as resolved)", "`would_become_ready` checks ALL deps, not just the given task", "`root_blockers` correctly ranks by transitive impact", "`chains` returns paths sorted by length descending", "mypy passes with strict mode", "Tests cover: empty graph, single node, linear chain (5 deep), diamond dependency, forest (disconnected), cycle, mixed open/closed states"], "notes": "[Closed: 2026-01-29T12:36:55.279966] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:high', 'epic:cub-p1t', 'model:opus', 'phase-1'] != ['phase-1', 'model:opus', 'complexity:high']"}
{"timestamp": "2026-01-29T12:37:19.902241", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-p1t.5", "title": "Update BothBackend and write cross-backend tests", "status": "open", "priority": "P1", "type": "task", "description": "BothBackend delegates to primary and secondary backends. It needs to delegate all 7 new methods and log divergences. Also write parametrized tests that verify the same operations work identically across both backends.\n\n**Implementation Steps:**\n1. Update `BothBackend` to delegate all 7 new methods (follow existing delegation pattern)\n2. Inherit from `TaskBackendDefaults` as fallback\n3. Add divergence logging for new methods\n4. Write parametrized pytest tests that run the same test cases against BeadsBackend (mocked) and JsonlBackend (temp files)\n5. Test scenarios: add/remove dependency, list blocked, reopen, delete, add/remove label\n6. Verify `DependencyGraph` produces consistent results from both backend outputs\n\n**Files:** src/cub/core/tasks/both.py, tests/test_task_backends.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094165Z", "updated_at": "2026-01-29T11:45:15.285582-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "secondary_result": [{"id": "cub-p1t.5", "title": "Update BothBackend and write cross-backend tests", "status": "open", "priority": "P1", "type": "task", "description": "BothBackend delegates to primary and secondary backends. It needs to delegate all 7 new methods and log divergences. Also write parametrized tests that verify the same operations work identically across both backends.\n\n**Implementation Steps:**\n1. Update `BothBackend` to delegate all 7 new methods (follow existing delegation pattern)\n2. Inherit from `TaskBackendDefaults` as fallback\n3. Add divergence logging for new methods\n4. Write parametrized pytest tests that run the same test cases against BeadsBackend (mocked) and JsonlBackend (temp files)\n5. Test scenarios: add/remove dependency, list blocked, reopen, delete, add/remove label\n6. Verify `DependencyGraph` produces consistent results from both backend outputs\n\n**Files:** src/cub/core/tasks/both.py, tests/test_task_backends.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463550", "updated_at": "2026-01-29T11:46:17.463550", "closed_at": null, "acceptance_criteria": ["BothBackend delegates all 7 new methods", "Divergence logging works for new methods", "Parametrized tests pass against both backends", "DependencyGraph produces same results regardless of backend", "mypy passes"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}], "difference_summary": "Task 0 (cub-p1t.5): labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']; parent: None != cub-p1t"}
{"timestamp": "2026-01-29T12:37:25.118043", "operation": "get_task", "task_id": "cub-p1t.5", "primary_result": {"id": "cub-p1t.5", "title": "Update BothBackend and write cross-backend tests", "status": "open", "priority": "P1", "type": "task", "description": "BothBackend delegates to primary and secondary backends. It needs to delegate all 7 new methods and log divergences. Also write parametrized tests that verify the same operations work identically across both backends.\n\n**Implementation Steps:**\n1. Update `BothBackend` to delegate all 7 new methods (follow existing delegation pattern)\n2. Inherit from `TaskBackendDefaults` as fallback\n3. Add divergence logging for new methods\n4. Write parametrized pytest tests that run the same test cases against BeadsBackend (mocked) and JsonlBackend (temp files)\n5. Test scenarios: add/remove dependency, list blocked, reopen, delete, add/remove label\n6. Verify `DependencyGraph` produces consistent results from both backend outputs\n\n**Files:** src/cub/core/tasks/both.py, tests/test_task_backends.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094165Z", "updated_at": "2026-01-29T11:45:15.285582-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "secondary_result": {"id": "cub-p1t.5", "title": "Update BothBackend and write cross-backend tests", "status": "open", "priority": "P1", "type": "task", "description": "BothBackend delegates to primary and secondary backends. It needs to delegate all 7 new methods and log divergences. Also write parametrized tests that verify the same operations work identically across both backends.\n\n**Implementation Steps:**\n1. Update `BothBackend` to delegate all 7 new methods (follow existing delegation pattern)\n2. Inherit from `TaskBackendDefaults` as fallback\n3. Add divergence logging for new methods\n4. Write parametrized pytest tests that run the same test cases against BeadsBackend (mocked) and JsonlBackend (temp files)\n5. Test scenarios: add/remove dependency, list blocked, reopen, delete, add/remove label\n6. Verify `DependencyGraph` produces consistent results from both backend outputs\n\n**Files:** src/cub/core/tasks/both.py, tests/test_task_backends.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463550", "updated_at": "2026-01-29T11:46:17.463550", "closed_at": null, "acceptance_criteria": ["BothBackend delegates all 7 new methods", "Divergence logging works for new methods", "Parametrized tests pass against both backends", "DependencyGraph produces same results regardless of backend", "mypy passes"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:37:35.435209", "operation": "update_task", "task_id": "cub-p1t.5", "primary_result": {"id": "cub-p1t.5", "title": "Update BothBackend and write cross-backend tests", "status": "in_progress", "priority": "P1", "type": "task", "description": "BothBackend delegates to primary and secondary backends. It needs to delegate all 7 new methods and log divergences. Also write parametrized tests that verify the same operations work identically across both backends.\n\n**Implementation Steps:**\n1. Update `BothBackend` to delegate all 7 new methods (follow existing delegation pattern)\n2. Inherit from `TaskBackendDefaults` as fallback\n3. Add divergence logging for new methods\n4. Write parametrized pytest tests that run the same test cases against BeadsBackend (mocked) and JsonlBackend (temp files)\n5. Test scenarios: add/remove dependency, list blocked, reopen, delete, add/remove label\n6. Verify `DependencyGraph` produces consistent results from both backend outputs\n\n**Files:** src/cub/core/tasks/both.py, tests/test_task_backends.py", "assignee": "cub-20260129-122038", "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094165Z", "updated_at": "2026-01-29T12:37:30.290622-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-p1t.5", "title": "Update BothBackend and write cross-backend tests", "status": "in_progress", "priority": "P1", "type": "task", "description": "BothBackend delegates to primary and secondary backends. It needs to delegate all 7 new methods and log divergences. Also write parametrized tests that verify the same operations work identically across both backends.\n\n**Implementation Steps:**\n1. Update `BothBackend` to delegate all 7 new methods (follow existing delegation pattern)\n2. Inherit from `TaskBackendDefaults` as fallback\n3. Add divergence logging for new methods\n4. Write parametrized pytest tests that run the same test cases against BeadsBackend (mocked) and JsonlBackend (temp files)\n5. Test scenarios: add/remove dependency, list blocked, reopen, delete, add/remove label\n6. Verify `DependencyGraph` produces consistent results from both backend outputs\n\n**Files:** src/cub/core/tasks/both.py, tests/test_task_backends.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463550", "updated_at": "2026-01-29T12:37:35.433444", "closed_at": null, "acceptance_criteria": ["BothBackend delegates all 7 new methods", "Divergence logging works for new methods", "Parametrized tests pass against both backends", "DependencyGraph produces same results regardless of backend", "mypy passes"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:46:22.504205", "operation": "get_task", "task_id": "cub-p1t.5", "primary_result": {"id": "cub-p1t.5", "title": "Update BothBackend and write cross-backend tests", "status": "closed", "priority": "P1", "type": "task", "description": "BothBackend delegates to primary and secondary backends. It needs to delegate all 7 new methods and log divergences. Also write parametrized tests that verify the same operations work identically across both backends.\n\n**Implementation Steps:**\n1. Update `BothBackend` to delegate all 7 new methods (follow existing delegation pattern)\n2. Inherit from `TaskBackendDefaults` as fallback\n3. Add divergence logging for new methods\n4. Write parametrized pytest tests that run the same test cases against BeadsBackend (mocked) and JsonlBackend (temp files)\n5. Test scenarios: add/remove dependency, list blocked, reopen, delete, add/remove label\n6. Verify `DependencyGraph` produces consistent results from both backend outputs\n\n**Files:** src/cub/core/tasks/both.py, tests/test_task_backends.py", "assignee": "cub-20260129-122038", "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094165Z", "updated_at": "2026-01-29T12:45:38.523418-05:00", "closed_at": "2026-01-29T12:45:38.523418-05:00", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-p1t.5", "title": "Update BothBackend and write cross-backend tests", "status": "in_progress", "priority": "P1", "type": "task", "description": "BothBackend delegates to primary and secondary backends. It needs to delegate all 7 new methods and log divergences. Also write parametrized tests that verify the same operations work identically across both backends.\n\n**Implementation Steps:**\n1. Update `BothBackend` to delegate all 7 new methods (follow existing delegation pattern)\n2. Inherit from `TaskBackendDefaults` as fallback\n3. Add divergence logging for new methods\n4. Write parametrized pytest tests that run the same test cases against BeadsBackend (mocked) and JsonlBackend (temp files)\n5. Test scenarios: add/remove dependency, list blocked, reopen, delete, add/remove label\n6. Verify `DependencyGraph` produces consistent results from both backend outputs\n\n**Files:** src/cub/core/tasks/both.py, tests/test_task_backends.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463550", "updated_at": "2026-01-29T12:37:35.433444", "closed_at": null, "acceptance_criteria": ["BothBackend delegates all 7 new methods", "Divergence logging works for new methods", "Parametrized tests pass against both backends", "DependencyGraph produces same results regardless of backend", "mypy passes"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "status: TaskStatus.CLOSED != TaskStatus.IN_PROGRESS; labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:46:27.645125", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 88, "open": 87, "in_progress": 1, "closed": 0}, "secondary_result": {"total": 57, "open": 23, "in_progress": 1, "closed": 33}, "difference_summary": "total: 88 != 57; open: 87 != 23; closed: 0 != 33"}
{"timestamp": "2026-01-29T12:46:37.960887", "operation": "close_task", "task_id": "cub-p1t.5", "primary_result": {"id": "cub-p1t.5", "title": "Update BothBackend and write cross-backend tests", "status": "closed", "priority": "P1", "type": "task", "description": "BothBackend delegates to primary and secondary backends. It needs to delegate all 7 new methods and log divergences. Also write parametrized tests that verify the same operations work identically across both backends.\n\n**Implementation Steps:**\n1. Update `BothBackend` to delegate all 7 new methods (follow existing delegation pattern)\n2. Inherit from `TaskBackendDefaults` as fallback\n3. Add divergence logging for new methods\n4. Write parametrized pytest tests that run the same test cases against BeadsBackend (mocked) and JsonlBackend (temp files)\n5. Test scenarios: add/remove dependency, list blocked, reopen, delete, add/remove label\n6. Verify `DependencyGraph` produces consistent results from both backend outputs\n\n**Files:** src/cub/core/tasks/both.py, tests/test_task_backends.py", "assignee": "cub-20260129-122038", "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094165Z", "updated_at": "2026-01-29T12:46:32.792764-05:00", "closed_at": "2026-01-29T12:46:32.792764-05:00", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-p1t.5", "title": "Update BothBackend and write cross-backend tests", "status": "closed", "priority": "P1", "type": "task", "description": "BothBackend delegates to primary and secondary backends. It needs to delegate all 7 new methods and log divergences. Also write parametrized tests that verify the same operations work identically across both backends.\n\n**Implementation Steps:**\n1. Update `BothBackend` to delegate all 7 new methods (follow existing delegation pattern)\n2. Inherit from `TaskBackendDefaults` as fallback\n3. Add divergence logging for new methods\n4. Write parametrized pytest tests that run the same test cases against BeadsBackend (mocked) and JsonlBackend (temp files)\n5. Test scenarios: add/remove dependency, list blocked, reopen, delete, add/remove label\n6. Verify `DependencyGraph` produces consistent results from both backend outputs\n\n**Files:** src/cub/core/tasks/both.py, tests/test_task_backends.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463550", "updated_at": "2026-01-29T12:46:37.958238", "closed_at": "2026-01-29T12:46:37.958218", "acceptance_criteria": ["BothBackend delegates all 7 new methods", "Divergence logging works for new methods", "Parametrized tests pass against both backends", "DependencyGraph produces same results regardless of backend", "mypy passes"], "notes": "[Closed: 2026-01-29T12:46:37.958240] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:46:43.249421", "operation": "get_task", "task_id": "cub-p1t.5", "primary_result": {"id": "cub-p1t.5", "title": "Update BothBackend and write cross-backend tests", "status": "closed", "priority": "P1", "type": "task", "description": "BothBackend delegates to primary and secondary backends. It needs to delegate all 7 new methods and log divergences. Also write parametrized tests that verify the same operations work identically across both backends.\n\n**Implementation Steps:**\n1. Update `BothBackend` to delegate all 7 new methods (follow existing delegation pattern)\n2. Inherit from `TaskBackendDefaults` as fallback\n3. Add divergence logging for new methods\n4. Write parametrized pytest tests that run the same test cases against BeadsBackend (mocked) and JsonlBackend (temp files)\n5. Test scenarios: add/remove dependency, list blocked, reopen, delete, add/remove label\n6. Verify `DependencyGraph` produces consistent results from both backend outputs\n\n**Files:** src/cub/core/tasks/both.py, tests/test_task_backends.py", "assignee": "cub-20260129-122038", "labels": ["complexity:medium", "epic:cub-p1t", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T16:45:10.094165Z", "updated_at": "2026-01-29T12:46:32.792764-05:00", "closed_at": "2026-01-29T12:46:32.792764-05:00", "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-p1t.5", "title": "Update BothBackend and write cross-backend tests", "status": "closed", "priority": "P1", "type": "task", "description": "BothBackend delegates to primary and secondary backends. It needs to delegate all 7 new methods and log divergences. Also write parametrized tests that verify the same operations work identically across both backends.\n\n**Implementation Steps:**\n1. Update `BothBackend` to delegate all 7 new methods (follow existing delegation pattern)\n2. Inherit from `TaskBackendDefaults` as fallback\n3. Add divergence logging for new methods\n4. Write parametrized pytest tests that run the same test cases against BeadsBackend (mocked) and JsonlBackend (temp files)\n5. Test scenarios: add/remove dependency, list blocked, reopen, delete, add/remove label\n6. Verify `DependencyGraph` produces consistent results from both backend outputs\n\n**Files:** src/cub/core/tasks/both.py, tests/test_task_backends.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463550", "updated_at": "2026-01-29T12:46:37.958238", "closed_at": "2026-01-29T12:46:37.958218", "acceptance_criteria": ["BothBackend delegates all 7 new methods", "Divergence logging works for new methods", "Parametrized tests pass against both backends", "DependencyGraph produces same results regardless of backend", "mypy passes"], "notes": "[Closed: 2026-01-29T12:46:37.958240] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-p1t', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:47:08.805400", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 88, "open": 87, "in_progress": 1, "closed": 0}, "secondary_result": {"total": 57, "open": 23, "in_progress": 0, "closed": 34}, "difference_summary": "total: 88 != 57; open: 87 != 23; in_progress: 1 != 0; closed: 0 != 34"}
{"timestamp": "2026-01-29T12:47:47.720858", "operation": "get_task_counts", "task_id": null, "primary_result": {"total": 88, "open": 87, "in_progress": 1, "closed": 0}, "secondary_result": {"total": 57, "open": 22, "in_progress": 0, "closed": 35}, "difference_summary": "total: 88 != 57; open: 87 != 22; in_progress: 1 != 0; closed: 0 != 35"}
{"timestamp": "2026-01-29T12:47:52.846779", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-p2c.1", "title": "Add cub task blocked command", "status": "open", "priority": "P1", "type": "task", "description": "The most common gap \u2014 the router currently maps \"what's blocked\" to `bd blocked`. This command shows blocked tasks with optional epic filter. With `--agent`, it includes root blocker analysis and chain lengths from DependencyGraph.\n\n**Implementation Steps:**\n1. Add `blocked` command to task app in `cli/task.py`\n2. Parameters: `--epic` (filter), `--json`, `--agent`\n3. Rich output: table with ID, Priority, Title, Blocked By columns\n4. JSON output: task model dumps\n5. Agent output: call `AgentFormatter.format_blocked()` if available, otherwise fall back to a simple markdown table\n6. Build DependencyGraph from all tasks for analysis hints\n7. Show root blockers and chain summary in agent output\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p2c", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094176Z", "updated_at": "2026-01-29T11:45:15.285840-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.2", "title": "Add cub task dep add/remove and cub task label add/remove/list commands", "status": "open", "priority": "P1", "type": "task", "description": "Dependency and label management subcommands. These are simple CRUD wrappers around protocol methods with confirmation output.\n\n**Implementation Steps:**\n1. Create `dep` sub-app with `add` and `remove` commands\n2. `cub task dep add <task> <depends-on>` \u2014 calls `add_dependency()`, prints confirmation\n3. `cub task dep remove <task> <depends-on>` \u2014 calls `remove_dependency()`, prints confirmation\n4. Enhance existing `dep list` to show both directions (what this task depends on AND what depends on it)\n5. Create `label` sub-app with `add`, `remove`, `list` commands\n6. `cub task label add <task> <label>` \u2014 calls `add_label()`, prints confirmation\n7. `cub task label remove <task> <label>` \u2014 calls `remove_label()`, prints confirmation\n8. `cub task label list <task>` \u2014 calls `get_task()`, displays labels\n9. All commands support `--json` for machine output\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p2c", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094184Z", "updated_at": "2026-01-29T11:45:15.286106-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.3", "title": "Add cub task reopen and cub task delete commands", "status": "open", "priority": "P1", "type": "task", "description": "Lifecycle management commands. Reopen is straightforward. Delete is destructive and needs a confirmation prompt (skippable with `--force`).\n\n**Implementation Steps:**\n1. Add `reopen` command \u2014 calls `reopen_task()`, prints confirmation with task title\n2. Add `delete` command \u2014 prompts \"Delete task {id} '{title}'? [y/N]\" unless `--force` is passed\n3. Both support `--json` for machine output\n4. Error handling: task not found, task not in correct state (e.g., reopen a non-closed task)\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["complexity:low", "epic:cub-p2c", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094193Z", "updated_at": "2026-01-29T11:45:15.286309-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.4", "title": "Enhance existing cub task list, ready, create, update commands", "status": "open", "priority": "P1", "type": "task", "description": "Existing commands need additional filters and flags to reach parity. `list` and `ready` need `--epic` and `--assignee` filters. `create` needs full flag exposure. `update` needs `--title`, `--priority`, `--notes`.\n\n**Implementation Steps:**\n1. `cub task list`: add `--epic` (filter by parent), `--assignee` (filter by assignee) options\n2. `cub task ready`: add `--epic` filter, add `--by impact|priority` ordering option (impact uses DependencyGraph)\n3. `cub task create`: ensure CLI exposes `--type`, `--priority`, `--epic` (as `--parent`), `--description`, `--depends-on` (comma-separated list)\n4. `cub task update`: add `--title`, `--priority`, `--notes` flags alongside existing `--description`, `--assignee`, `--status`\n5. For `ready --by impact`: build DependencyGraph, sort tasks by `transitive_unblocks` count descending\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p2c", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094200Z", "updated_at": "2026-01-29T11:45:15.286499-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.5", "title": "Add cub task search command", "status": "open", "priority": "P2", "type": "task", "description": "Full-text search across task titles and descriptions. BeadsBackend wraps `bd search`. JsonlBackend does substring match on title + description in memory. This is P2 but included since we're not excluding anything.\n\n**Implementation Steps:**\n1. Add `search_tasks(query: str) -> list[Task]` to `TaskBackend` protocol\n2. Implement in BeadsBackend: run `bd search <query> --json`, parse results\n3. Implement in JsonlBackend: case-insensitive substring match on title and description\n4. Add `search` command to task CLI: `cub task search <query>`\n5. Support `--json` and `--agent` output modes\n6. Show match count and results table\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/beads.py, src/cub/core/tasks/jsonl.py, src/cub/cli/task.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p2c", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094208Z", "updated_at": "2026-01-29T11:45:15.286678-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "secondary_result": [{"id": "cub-p2c.1", "title": "Add cub task blocked command", "status": "open", "priority": "P1", "type": "task", "description": "The most common gap \u2014 the router currently maps \"what's blocked\" to `bd blocked`. This command shows blocked tasks with optional epic filter. With `--agent`, it includes root blocker analysis and chain lengths from DependencyGraph.\n\n**Implementation Steps:**\n1. Add `blocked` command to task app in `cli/task.py`\n2. Parameters: `--epic` (filter), `--json`, `--agent`\n3. Rich output: table with ID, Priority, Title, Blocked By columns\n4. JSON output: task model dumps\n5. Agent output: call `AgentFormatter.format_blocked()` if available, otherwise fall back to a simple markdown table\n6. Build DependencyGraph from all tasks for analysis hints\n7. Show root blockers and chain summary in agent output\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["phase-2", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T11:46:17.463571", "updated_at": "2026-01-29T11:46:17.463572", "closed_at": null, "acceptance_criteria": ["`cub task blocked` shows blocked tasks in Rich table", "`--epic` filter works", "`--json` outputs task list as JSON", "`--agent` outputs structured markdown with analysis", "Empty result shows helpful message (\"No blocked tasks\")", "CLI test covers all three output modes"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.2", "title": "Add cub task dep add/remove and cub task label add/remove/list commands", "status": "open", "priority": "P1", "type": "task", "description": "Dependency and label management subcommands. These are simple CRUD wrappers around protocol methods with confirmation output.\n\n**Implementation Steps:**\n1. Create `dep` sub-app with `add` and `remove` commands\n2. `cub task dep add <task> <depends-on>` \u2014 calls `add_dependency()`, prints confirmation\n3. `cub task dep remove <task> <depends-on>` \u2014 calls `remove_dependency()`, prints confirmation\n4. Enhance existing `dep list` to show both directions (what this task depends on AND what depends on it)\n5. Create `label` sub-app with `add`, `remove`, `list` commands\n6. `cub task label add <task> <label>` \u2014 calls `add_label()`, prints confirmation\n7. `cub task label remove <task> <label>` \u2014 calls `remove_label()`, prints confirmation\n8. `cub task label list <task>` \u2014 calls `get_task()`, displays labels\n9. All commands support `--json` for machine output\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["phase-2", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T11:46:17.463585", "updated_at": "2026-01-29T11:46:17.463586", "closed_at": null, "acceptance_criteria": ["`cub task dep add/remove` work and confirm the operation", "`cub task dep list <id>` shows both directions", "`cub task label add/remove/list` work and confirm operations", "`--json` output works for all commands", "Error handling for invalid task IDs", "CLI tests for each command"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.3", "title": "Add cub task reopen and cub task delete commands", "status": "open", "priority": "P1", "type": "task", "description": "Lifecycle management commands. Reopen is straightforward. Delete is destructive and needs a confirmation prompt (skippable with `--force`).\n\n**Implementation Steps:**\n1. Add `reopen` command \u2014 calls `reopen_task()`, prints confirmation with task title\n2. Add `delete` command \u2014 prompts \"Delete task {id} '{title}'? [y/N]\" unless `--force` is passed\n3. Both support `--json` for machine output\n4. Error handling: task not found, task not in correct state (e.g., reopen a non-closed task)\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["phase-2", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T11:46:17.463596", "updated_at": "2026-01-29T11:46:17.463597", "closed_at": null, "acceptance_criteria": ["`cub task reopen <id>` reopens a closed task", "`cub task delete <id>` prompts for confirmation", "`cub task delete <id> --force` skips confirmation", "Error messages for invalid states (reopen non-closed, delete non-existent)", "CLI tests"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.4", "title": "Enhance existing cub task list, ready, create, update commands", "status": "open", "priority": "P1", "type": "task", "description": "Existing commands need additional filters and flags to reach parity. `list` and `ready` need `--epic` and `--assignee` filters. `create` needs full flag exposure. `update` needs `--title`, `--priority`, `--notes`.\n\n**Implementation Steps:**\n1. `cub task list`: add `--epic` (filter by parent), `--assignee` (filter by assignee) options\n2. `cub task ready`: add `--epic` filter, add `--by impact|priority` ordering option (impact uses DependencyGraph)\n3. `cub task create`: ensure CLI exposes `--type`, `--priority`, `--epic` (as `--parent`), `--description`, `--depends-on` (comma-separated list)\n4. `cub task update`: add `--title`, `--priority`, `--notes` flags alongside existing `--description`, `--assignee`, `--status`\n5. For `ready --by impact`: build DependencyGraph, sort tasks by `transitive_unblocks` count descending\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["phase-2", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T11:46:17.463607", "updated_at": "2026-01-29T11:46:17.463607", "closed_at": null, "acceptance_criteria": ["`cub task list --epic <id>` filters correctly", "`cub task list --assignee <name>` filters correctly", "`cub task ready --epic <id>` filters correctly", "`cub task ready --by impact` sorts by unblock count", "`cub task create` exposes all flags", "`cub task update` supports title, priority, notes", "CLI tests for new filters and flags"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.5", "title": "Add cub task search command", "status": "open", "priority": "P2", "type": "task", "description": "Full-text search across task titles and descriptions. BeadsBackend wraps `bd search`. JsonlBackend does substring match on title + description in memory. This is P2 but included since we're not excluding anything.\n\n**Implementation Steps:**\n1. Add `search_tasks(query: str) -> list[Task]` to `TaskBackend` protocol\n2. Implement in BeadsBackend: run `bd search <query> --json`, parse results\n3. Implement in JsonlBackend: case-insensitive substring match on title and description\n4. Add `search` command to task CLI: `cub task search <query>`\n5. Support `--json` and `--agent` output modes\n6. Show match count and results table\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/beads.py, src/cub/core/tasks/jsonl.py, src/cub/cli/task.py", "assignee": null, "labels": ["phase-2", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T11:46:17.463618", "updated_at": "2026-01-29T11:46:17.463619", "closed_at": null, "acceptance_criteria": ["`cub task search \"auth\"` finds tasks with \"auth\" in title or description", "Works with both backends", "`--json` and Rich output modes work", "Empty results show helpful message", "Tests for both backends"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "difference_summary": "Task 0 (cub-p2c.1): labels: ['complexity:medium', 'epic:cub-p2c', 'model:sonnet', 'phase-2'] != ['phase-2', 'model:sonnet', 'complexity:medium']; parent: None != cub-p2c; Task 1 (cub-p2c.2): labels: ['complexity:medium', 'epic:cub-p2c', 'model:sonnet', 'phase-2'] != ['phase-2', 'model:sonnet', 'complexity:medium']; parent: None != cub-p2c; Task 2 (cub-p2c.3): labels: ['complexity:low', 'epic:cub-p2c', 'model:haiku', 'phase-2'] != ['phase-2', 'model:haiku', 'complexity:low']; parent: None != cub-p2c; Task 3 (cub-p2c.4): labels: ['complexity:medium', 'epic:cub-p2c', 'model:sonnet', 'phase-2'] != ['phase-2', 'model:sonnet', 'complexity:medium']; parent: None != cub-p2c; Task 4 (cub-p2c.5): labels: ['complexity:medium', 'epic:cub-p2c', 'model:sonnet', 'phase-2'] != ['phase-2', 'model:sonnet', 'complexity:medium']; parent: None != cub-p2c"}
{"timestamp": "2026-01-29T12:47:57.995990", "operation": "get_ready_tasks", "task_id": null, "primary_result": [{"id": "cub-p2c.1", "title": "Add cub task blocked command", "status": "open", "priority": "P1", "type": "task", "description": "The most common gap \u2014 the router currently maps \"what's blocked\" to `bd blocked`. This command shows blocked tasks with optional epic filter. With `--agent`, it includes root blocker analysis and chain lengths from DependencyGraph.\n\n**Implementation Steps:**\n1. Add `blocked` command to task app in `cli/task.py`\n2. Parameters: `--epic` (filter), `--json`, `--agent`\n3. Rich output: table with ID, Priority, Title, Blocked By columns\n4. JSON output: task model dumps\n5. Agent output: call `AgentFormatter.format_blocked()` if available, otherwise fall back to a simple markdown table\n6. Build DependencyGraph from all tasks for analysis hints\n7. Show root blockers and chain summary in agent output\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p2c", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094176Z", "updated_at": "2026-01-29T11:45:15.285840-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.2", "title": "Add cub task dep add/remove and cub task label add/remove/list commands", "status": "open", "priority": "P1", "type": "task", "description": "Dependency and label management subcommands. These are simple CRUD wrappers around protocol methods with confirmation output.\n\n**Implementation Steps:**\n1. Create `dep` sub-app with `add` and `remove` commands\n2. `cub task dep add <task> <depends-on>` \u2014 calls `add_dependency()`, prints confirmation\n3. `cub task dep remove <task> <depends-on>` \u2014 calls `remove_dependency()`, prints confirmation\n4. Enhance existing `dep list` to show both directions (what this task depends on AND what depends on it)\n5. Create `label` sub-app with `add`, `remove`, `list` commands\n6. `cub task label add <task> <label>` \u2014 calls `add_label()`, prints confirmation\n7. `cub task label remove <task> <label>` \u2014 calls `remove_label()`, prints confirmation\n8. `cub task label list <task>` \u2014 calls `get_task()`, displays labels\n9. All commands support `--json` for machine output\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p2c", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094184Z", "updated_at": "2026-01-29T11:45:15.286106-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.3", "title": "Add cub task reopen and cub task delete commands", "status": "open", "priority": "P1", "type": "task", "description": "Lifecycle management commands. Reopen is straightforward. Delete is destructive and needs a confirmation prompt (skippable with `--force`).\n\n**Implementation Steps:**\n1. Add `reopen` command \u2014 calls `reopen_task()`, prints confirmation with task title\n2. Add `delete` command \u2014 prompts \"Delete task {id} '{title}'? [y/N]\" unless `--force` is passed\n3. Both support `--json` for machine output\n4. Error handling: task not found, task not in correct state (e.g., reopen a non-closed task)\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["complexity:low", "epic:cub-p2c", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094193Z", "updated_at": "2026-01-29T11:45:15.286309-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.4", "title": "Enhance existing cub task list, ready, create, update commands", "status": "open", "priority": "P1", "type": "task", "description": "Existing commands need additional filters and flags to reach parity. `list` and `ready` need `--epic` and `--assignee` filters. `create` needs full flag exposure. `update` needs `--title`, `--priority`, `--notes`.\n\n**Implementation Steps:**\n1. `cub task list`: add `--epic` (filter by parent), `--assignee` (filter by assignee) options\n2. `cub task ready`: add `--epic` filter, add `--by impact|priority` ordering option (impact uses DependencyGraph)\n3. `cub task create`: ensure CLI exposes `--type`, `--priority`, `--epic` (as `--parent`), `--description`, `--depends-on` (comma-separated list)\n4. `cub task update`: add `--title`, `--priority`, `--notes` flags alongside existing `--description`, `--assignee`, `--status`\n5. For `ready --by impact`: build DependencyGraph, sort tasks by `transitive_unblocks` count descending\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p2c", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094200Z", "updated_at": "2026-01-29T11:45:15.286499-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.5", "title": "Add cub task search command", "status": "open", "priority": "P2", "type": "task", "description": "Full-text search across task titles and descriptions. BeadsBackend wraps `bd search`. JsonlBackend does substring match on title + description in memory. This is P2 but included since we're not excluding anything.\n\n**Implementation Steps:**\n1. Add `search_tasks(query: str) -> list[Task]` to `TaskBackend` protocol\n2. Implement in BeadsBackend: run `bd search <query> --json`, parse results\n3. Implement in JsonlBackend: case-insensitive substring match on title and description\n4. Add `search` command to task CLI: `cub task search <query>`\n5. Support `--json` and `--agent` output modes\n6. Show match count and results table\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/beads.py, src/cub/core/tasks/jsonl.py, src/cub/cli/task.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p2c", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094208Z", "updated_at": "2026-01-29T11:45:15.286678-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "secondary_result": [{"id": "cub-p2c.1", "title": "Add cub task blocked command", "status": "open", "priority": "P1", "type": "task", "description": "The most common gap \u2014 the router currently maps \"what's blocked\" to `bd blocked`. This command shows blocked tasks with optional epic filter. With `--agent`, it includes root blocker analysis and chain lengths from DependencyGraph.\n\n**Implementation Steps:**\n1. Add `blocked` command to task app in `cli/task.py`\n2. Parameters: `--epic` (filter), `--json`, `--agent`\n3. Rich output: table with ID, Priority, Title, Blocked By columns\n4. JSON output: task model dumps\n5. Agent output: call `AgentFormatter.format_blocked()` if available, otherwise fall back to a simple markdown table\n6. Build DependencyGraph from all tasks for analysis hints\n7. Show root blockers and chain summary in agent output\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["phase-2", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T11:46:17.463571", "updated_at": "2026-01-29T11:46:17.463572", "closed_at": null, "acceptance_criteria": ["`cub task blocked` shows blocked tasks in Rich table", "`--epic` filter works", "`--json` outputs task list as JSON", "`--agent` outputs structured markdown with analysis", "Empty result shows helpful message (\"No blocked tasks\")", "CLI test covers all three output modes"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.2", "title": "Add cub task dep add/remove and cub task label add/remove/list commands", "status": "open", "priority": "P1", "type": "task", "description": "Dependency and label management subcommands. These are simple CRUD wrappers around protocol methods with confirmation output.\n\n**Implementation Steps:**\n1. Create `dep` sub-app with `add` and `remove` commands\n2. `cub task dep add <task> <depends-on>` \u2014 calls `add_dependency()`, prints confirmation\n3. `cub task dep remove <task> <depends-on>` \u2014 calls `remove_dependency()`, prints confirmation\n4. Enhance existing `dep list` to show both directions (what this task depends on AND what depends on it)\n5. Create `label` sub-app with `add`, `remove`, `list` commands\n6. `cub task label add <task> <label>` \u2014 calls `add_label()`, prints confirmation\n7. `cub task label remove <task> <label>` \u2014 calls `remove_label()`, prints confirmation\n8. `cub task label list <task>` \u2014 calls `get_task()`, displays labels\n9. All commands support `--json` for machine output\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["phase-2", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T11:46:17.463585", "updated_at": "2026-01-29T11:46:17.463586", "closed_at": null, "acceptance_criteria": ["`cub task dep add/remove` work and confirm the operation", "`cub task dep list <id>` shows both directions", "`cub task label add/remove/list` work and confirm operations", "`--json` output works for all commands", "Error handling for invalid task IDs", "CLI tests for each command"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.3", "title": "Add cub task reopen and cub task delete commands", "status": "open", "priority": "P1", "type": "task", "description": "Lifecycle management commands. Reopen is straightforward. Delete is destructive and needs a confirmation prompt (skippable with `--force`).\n\n**Implementation Steps:**\n1. Add `reopen` command \u2014 calls `reopen_task()`, prints confirmation with task title\n2. Add `delete` command \u2014 prompts \"Delete task {id} '{title}'? [y/N]\" unless `--force` is passed\n3. Both support `--json` for machine output\n4. Error handling: task not found, task not in correct state (e.g., reopen a non-closed task)\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["phase-2", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T11:46:17.463596", "updated_at": "2026-01-29T11:46:17.463597", "closed_at": null, "acceptance_criteria": ["`cub task reopen <id>` reopens a closed task", "`cub task delete <id>` prompts for confirmation", "`cub task delete <id> --force` skips confirmation", "Error messages for invalid states (reopen non-closed, delete non-existent)", "CLI tests"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.4", "title": "Enhance existing cub task list, ready, create, update commands", "status": "open", "priority": "P1", "type": "task", "description": "Existing commands need additional filters and flags to reach parity. `list` and `ready` need `--epic` and `--assignee` filters. `create` needs full flag exposure. `update` needs `--title`, `--priority`, `--notes`.\n\n**Implementation Steps:**\n1. `cub task list`: add `--epic` (filter by parent), `--assignee` (filter by assignee) options\n2. `cub task ready`: add `--epic` filter, add `--by impact|priority` ordering option (impact uses DependencyGraph)\n3. `cub task create`: ensure CLI exposes `--type`, `--priority`, `--epic` (as `--parent`), `--description`, `--depends-on` (comma-separated list)\n4. `cub task update`: add `--title`, `--priority`, `--notes` flags alongside existing `--description`, `--assignee`, `--status`\n5. For `ready --by impact`: build DependencyGraph, sort tasks by `transitive_unblocks` count descending\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["phase-2", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T11:46:17.463607", "updated_at": "2026-01-29T11:46:17.463607", "closed_at": null, "acceptance_criteria": ["`cub task list --epic <id>` filters correctly", "`cub task list --assignee <name>` filters correctly", "`cub task ready --epic <id>` filters correctly", "`cub task ready --by impact` sorts by unblock count", "`cub task create` exposes all flags", "`cub task update` supports title, priority, notes", "CLI tests for new filters and flags"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.5", "title": "Add cub task search command", "status": "open", "priority": "P2", "type": "task", "description": "Full-text search across task titles and descriptions. BeadsBackend wraps `bd search`. JsonlBackend does substring match on title + description in memory. This is P2 but included since we're not excluding anything.\n\n**Implementation Steps:**\n1. Add `search_tasks(query: str) -> list[Task]` to `TaskBackend` protocol\n2. Implement in BeadsBackend: run `bd search <query> --json`, parse results\n3. Implement in JsonlBackend: case-insensitive substring match on title and description\n4. Add `search` command to task CLI: `cub task search <query>`\n5. Support `--json` and `--agent` output modes\n6. Show match count and results table\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/beads.py, src/cub/core/tasks/jsonl.py, src/cub/cli/task.py", "assignee": null, "labels": ["phase-2", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T11:46:17.463618", "updated_at": "2026-01-29T11:46:17.463619", "closed_at": null, "acceptance_criteria": ["`cub task search \"auth\"` finds tasks with \"auth\" in title or description", "Works with both backends", "`--json` and Rich output modes work", "Empty results show helpful message", "Tests for both backends"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "difference_summary": "Task 0 (cub-p2c.1): labels: ['complexity:medium', 'epic:cub-p2c', 'model:sonnet', 'phase-2'] != ['phase-2', 'model:sonnet', 'complexity:medium']; parent: None != cub-p2c; Task 1 (cub-p2c.2): labels: ['complexity:medium', 'epic:cub-p2c', 'model:sonnet', 'phase-2'] != ['phase-2', 'model:sonnet', 'complexity:medium']; parent: None != cub-p2c; Task 2 (cub-p2c.3): labels: ['complexity:low', 'epic:cub-p2c', 'model:haiku', 'phase-2'] != ['phase-2', 'model:haiku', 'complexity:low']; parent: None != cub-p2c; Task 3 (cub-p2c.4): labels: ['complexity:medium', 'epic:cub-p2c', 'model:sonnet', 'phase-2'] != ['phase-2', 'model:sonnet', 'complexity:medium']; parent: None != cub-p2c; Task 4 (cub-p2c.5): labels: ['complexity:medium', 'epic:cub-p2c', 'model:sonnet', 'phase-2'] != ['phase-2', 'model:sonnet', 'complexity:medium']; parent: None != cub-p2c"}
{"timestamp": "2026-01-29T12:48:03.204767", "operation": "get_task", "task_id": "cub-p2c.1", "primary_result": {"id": "cub-p2c.1", "title": "Add cub task blocked command", "status": "open", "priority": "P1", "type": "task", "description": "The most common gap \u2014 the router currently maps \"what's blocked\" to `bd blocked`. This command shows blocked tasks with optional epic filter. With `--agent`, it includes root blocker analysis and chain lengths from DependencyGraph.\n\n**Implementation Steps:**\n1. Add `blocked` command to task app in `cli/task.py`\n2. Parameters: `--epic` (filter), `--json`, `--agent`\n3. Rich output: table with ID, Priority, Title, Blocked By columns\n4. JSON output: task model dumps\n5. Agent output: call `AgentFormatter.format_blocked()` if available, otherwise fall back to a simple markdown table\n6. Build DependencyGraph from all tasks for analysis hints\n7. Show root blockers and chain summary in agent output\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p2c", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T16:45:10.094176Z", "updated_at": "2026-01-29T11:45:15.285840-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "secondary_result": {"id": "cub-p2c.1", "title": "Add cub task blocked command", "status": "open", "priority": "P1", "type": "task", "description": "The most common gap \u2014 the router currently maps \"what's blocked\" to `bd blocked`. This command shows blocked tasks with optional epic filter. With `--agent`, it includes root blocker analysis and chain lengths from DependencyGraph.\n\n**Implementation Steps:**\n1. Add `blocked` command to task app in `cli/task.py`\n2. Parameters: `--epic` (filter), `--json`, `--agent`\n3. Rich output: table with ID, Priority, Title, Blocked By columns\n4. JSON output: task model dumps\n5. Agent output: call `AgentFormatter.format_blocked()` if available, otherwise fall back to a simple markdown table\n6. Build DependencyGraph from all tasks for analysis hints\n7. Show root blockers and chain summary in agent output\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["phase-2", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T11:46:17.463571", "updated_at": "2026-01-29T11:46:17.463572", "closed_at": null, "acceptance_criteria": ["`cub task blocked` shows blocked tasks in Rich table", "`--epic` filter works", "`--json` outputs task list as JSON", "`--agent` outputs structured markdown with analysis", "Empty result shows helpful message (\"No blocked tasks\")", "CLI test covers all three output modes"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-p2c', 'model:sonnet', 'phase-2'] != ['phase-2', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:48:13.524652", "operation": "update_task", "task_id": "cub-p2c.1", "primary_result": {"id": "cub-p2c.1", "title": "Add cub task blocked command", "status": "in_progress", "priority": "P1", "type": "task", "description": "The most common gap \u2014 the router currently maps \"what's blocked\" to `bd blocked`. This command shows blocked tasks with optional epic filter. With `--agent`, it includes root blocker analysis and chain lengths from DependencyGraph.\n\n**Implementation Steps:**\n1. Add `blocked` command to task app in `cli/task.py`\n2. Parameters: `--epic` (filter), `--json`, `--agent`\n3. Rich output: table with ID, Priority, Title, Blocked By columns\n4. JSON output: task model dumps\n5. Agent output: call `AgentFormatter.format_blocked()` if available, otherwise fall back to a simple markdown table\n6. Build DependencyGraph from all tasks for analysis hints\n7. Show root blockers and chain summary in agent output\n\n**Files:** src/cub/cli/task.py", "assignee": "cub-20260129-124742", "labels": ["complexity:medium", "epic:cub-p2c", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T16:45:10.094176Z", "updated_at": "2026-01-29T12:48:08.366418-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "secondary_result": {"id": "cub-p2c.1", "title": "Add cub task blocked command", "status": "in_progress", "priority": "P1", "type": "task", "description": "The most common gap \u2014 the router currently maps \"what's blocked\" to `bd blocked`. This command shows blocked tasks with optional epic filter. With `--agent`, it includes root blocker analysis and chain lengths from DependencyGraph.\n\n**Implementation Steps:**\n1. Add `blocked` command to task app in `cli/task.py`\n2. Parameters: `--epic` (filter), `--json`, `--agent`\n3. Rich output: table with ID, Priority, Title, Blocked By columns\n4. JSON output: task model dumps\n5. Agent output: call `AgentFormatter.format_blocked()` if available, otherwise fall back to a simple markdown table\n6. Build DependencyGraph from all tasks for analysis hints\n7. Show root blockers and chain summary in agent output\n\n**Files:** src/cub/cli/task.py", "assignee": "cub-20260129-124742", "labels": ["phase-2", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T11:46:17.463571", "updated_at": "2026-01-29T12:48:13.522238", "closed_at": null, "acceptance_criteria": ["`cub task blocked` shows blocked tasks in Rich table", "`--epic` filter works", "`--json` outputs task list as JSON", "`--agent` outputs structured markdown with analysis", "Empty result shows helpful message (\"No blocked tasks\")", "CLI test covers all three output modes"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-p2c', 'model:sonnet', 'phase-2'] != ['phase-2', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:49:43.035446", "operation": "list_blocked_tasks", "task_id": null, "primary_result": [{"id": "cub-a1f.2", "title": "Wire --agent flag into Phase 1 CLI commands", "status": "open", "priority": "P0", "type": "task", "description": "Add `--agent` flag to `cub task ready`, `cub task show`, `cub status`, and `cub suggest`. Follow the existing `--json` pattern. When `--agent` is passed, call the corresponding AgentFormatter method and print the result. `--agent` wins silently over `--json` if both are passed. Include `_try_build_graph` helper that attempts to import DependencyGraph (returns None if not available yet).\n\n**Implementation Steps:**\n1. Create `_try_build_graph(backend)` helper function in `cli/task.py`:\n2. In `cub task ready`:\n3. In `cub task show`:\n4. In `cub status` (status.py):\n5. In `cub suggest` (suggest.py):\n6. Write CLI integration tests for each command with `--agent` flag\n\n**Files:** src/cub/cli/task.py, src/cub/cli/status.py, src/cub/cli/suggest.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495119Z", "updated_at": "2026-01-29T11:46:55.683939-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r4h.2", "title": "Integration tests for exit scenarios", "status": "open", "priority": "P0", "type": "task", "description": "We need automated tests that verify clean exits on all paths. These tests ensure regressions are caught early.\n\n**Implementation Steps:**\n1. Add `pytest-timeout` to dev dependencies if not present\n2. Create `tests/integration/test_run_exits.py`\n3. Write tests for: Ctrl+C (SIGINT), SIGTERM, budget exhaustion, iteration limit reached, task failure\n4. Each test should verify: clean exit (no crash), status.json updated, run artifact created\n5. Use subprocess to run `cub run` and send signals\n\n**Files:** tests/integration/test_run_exits.py, pyproject.toml", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923515Z", "updated_at": "2026-01-26T16:32:00.156994-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r4h.3", "title": "Ensure artifacts on all exits", "status": "open", "priority": "P0", "type": "task", "description": "Based on audit findings, fix any exit paths that don't preserve artifacts. This is the core deliverable of E4.\n\n**Implementation Steps:**\n1. Review gaps identified in cub-r4h.1 audit\n2. Add try/finally blocks where needed to ensure `write_run_artifact()` is called\n3. Ensure `StatusWriter.write()` is called before any exit\n4. Handle edge cases: exceptions during artifact write, partial state\n5. Run integration tests to verify fixes\n\n**Files:** src/cub/cli/run.py, src/cub/core/status/writer.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923537Z", "updated_at": "2026-01-26T16:32:00.157257-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r5c.2", "title": "Implement CircuitBreaker class", "status": "open", "priority": "P0", "type": "task", "description": "The core circuit breaker logic. Uses asyncio timeout to detect hung harness execution.\n\n**Implementation Steps:**\n1. Create `src/cub/core/circuit_breaker.py`\n2. Implement `CircuitBreaker` class with:\n3. On timeout: raise `CircuitBreakerTripped` exception with clear message\n4. Handle graceful cancellation of the wrapped coroutine\n5. Write unit tests\n\n**Files:** src/cub/core/circuit_breaker.py, tests/unit/test_circuit_breaker.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923575Z", "updated_at": "2026-01-26T16:32:00.158012-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r5c.3", "title": "Integrate circuit breaker into run.py", "status": "open", "priority": "P0", "type": "task", "description": "Wire the circuit breaker into the run loop so harness invocations are timeout-protected.\n\n**Implementation Steps:**\n1. Import CircuitBreaker in `src/cub/cli/run.py`\n2. Create CircuitBreaker instance from config in run initialization\n3. Wrap `_invoke_harness()` call with `circuit_breaker.execute()`\n4. Handle `CircuitBreakerTripped` exception: log, update status, exit cleanly with artifacts\n5. Add circuit breaker status to run summary output\n\n**Files:** src/cub/cli/run.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923591Z", "updated_at": "2026-01-26T16:32:00.158242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-a3r.2", "title": "Build route compiler and cub routes CLI", "status": "open", "priority": "P1", "type": "task", "description": "The route compiler reads the raw log, normalizes commands (strips task IDs, file paths), aggregates by frequency, filters noise (count < 3), and writes a markdown table to `.cub/learned-routes.md`. This compiled file is git-tracked and shared with the team. The compiler is triggered by the Stop hook at session end.\n\n**Implementation Steps:**\n1. Create `src/cub/core/routes/compiler.py`:\n2. Create `src/cub/core/routes/__init__.py`\n3. Create `src/cub/cli/routes.py`:\n4. Register routes app in `src/cub/cli/__init__.py`\n5. Add Stop hook trigger in `cub-hook.sh`:\n6. Write tests for `normalize_command` with edge cases (various command patterns)\n7. Write tests for `compile_routes` with sample JSONL input\n8. Write tests for `render_learned_routes` output format\n\n**Files:** src/cub/core/routes/__init__.py, src/cub/core/routes/compiler.py, src/cub/cli/routes.py, src/cub/cli/__init__.py, .cub/scripts/hooks/cub-hook.sh, tests/test_route_compiler.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495159Z", "updated_at": "2026-01-29T11:46:55.684499-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-a3r.3", "title": "Add learned routes section to router skill", "status": "open", "priority": "P1", "type": "task", "description": "The router skill needs to reference the compiled routes file so Claude can use frequency data as a tiebreaker for ambiguous intent. This is the only point where LLM judgment enters the route learning system.\n\n**Implementation Steps:**\n1. Add a \"Learned Routes\" section to `.claude/commands/cub.md`:\n2. Place this section after the \"Execution Rules\" section and before \"Examples\"\n3. The `@` prefix ensures Claude Code injects the file content into context\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495168Z", "updated_at": "2026-01-29T11:46:55.684676-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r6s.2", "title": "Implement InstructionGenerator", "status": "open", "priority": "P1", "type": "task", "description": "Generate CLAUDE.md and AGENTS.md with workflow instructions that guide agents to use cub commands.\n\n**Implementation Steps:**\n1. Create `src/cub/core/instructions.py`\n2. Implement `generate_agents_md(project_dir, config)` - harness-agnostic instructions\n3. Implement `generate_claude_md(project_dir, config)` - Claude-specific additions\n4. Include sections: finding tasks (`cub status`), claiming work (`cub wip`), completing (`cub done`), logging (`cub log`)\n5. Include escape hatch language from E5\n6. Make output customizable via config (future: templates)\n\n**Files:** src/cub/core/instructions.py, tests/unit/test_instructions.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923641Z", "updated_at": "2026-01-26T16:32:00.159055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r6s.3", "title": "Update cub init for AGENTS.md", "status": "open", "priority": "P1", "type": "task", "description": "`cub init` should create AGENTS.md at project root for cross-harness compatibility.\n\n**Implementation Steps:**\n1. Update `src/cub/cli/init_cmd.py` to call InstructionGenerator\n2. Generate AGENTS.md at project root (not in .cub/)\n3. Generate/update CLAUDE.md at project root\n4. Don't overwrite if files exist (or prompt user)\n5. Add success message mentioning the files created\n\n**Files:** src/cub/cli/init_cmd.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923654Z", "updated_at": "2026-01-26T16:32:00.159256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r6s.6", "title": "Manual testing: direct session workflow", "status": "open", "priority": "P1", "type": "task", "description": "The ultimate validation: Marc runs Claude Code directly and verifies the ledger captures work naturally.\n\n**Implementation Steps:**\n1. Create test protocol in `plans/reliability-phase/e6-manual-tests.md`\n2. Scenarios: start direct session, claim task with `cub wip`, do work, complete with `cub done`\n3. Verify: ledger entry created, task status updated, session log captured\n4. Test friction: is the workflow natural? What's awkward?\n5. Document findings and iterate\n\n**Files:** plans/reliability-phase/e6-manual-tests.md", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923692Z", "updated_at": "2026-01-26T16:32:00.160048-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-a4e.2", "title": "Wire --agent flag into blocked, list, and ledger CLI commands", "status": "open", "priority": "P2", "type": "task", "description": "Add `--agent` flag to `cub task blocked`, `cub task list`, and `cub ledger show`. These commands should already exist from the task parity spec. Wire in the AgentFormatter methods.\n\n**Implementation Steps:**\n1. In `cub task blocked` (cli/task.py):\n2. In `cub task list` (cli/task.py):\n3. In `cub ledger show` (cli/ledger.py):\n4. Update corresponding skill files to use `--agent`\n5. Write CLI tests\n\n**Files:** src/cub/cli/task.py, src/cub/cli/ledger.py, .claude/commands/cub:tasks.md, .claude/commands/cub:ledger.md", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495183Z", "updated_at": "2026-01-29T11:46:55.685013-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-r6s.5", "title": "Implement hook handlers for artifact capture", "status": "open", "priority": "P2", "type": "task", "description": "Based on hook research, implement handlers to auto-capture artifacts when possible.\n\n**Implementation Steps:**\n1. Create `src/cub/core/harness/hooks.py`\n2. Implement `handle_hook_event(event_type, payload)` dispatcher\n3. For PostToolUse/Write: detect writes to plans/, log to ledger\n4. For Stop: capture session end, finalize any open ledger entries\n5. Parse payloads defensively (malformed \u2192 skip, don't crash)\n6. Create hook scripts for `.cub/hooks/` that call these handlers\n\n**Files:** src/cub/core/harness/hooks.py, .cub/hooks/", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923682Z", "updated_at": "2026-01-26T16:32:00.159779-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": "[]", "difference_summary": "List length mismatch: 22 != 0"}
{"timestamp": "2026-01-29T12:49:53.457432", "operation": "get_task", "task_id": "cub-a1f.2", "primary_result": {"id": "cub-a1f.2", "title": "Wire --agent flag into Phase 1 CLI commands", "status": "open", "priority": "P0", "type": "task", "description": "Add `--agent` flag to `cub task ready`, `cub task show`, `cub status`, and `cub suggest`. Follow the existing `--json` pattern. When `--agent` is passed, call the corresponding AgentFormatter method and print the result. `--agent` wins silently over `--json` if both are passed. Include `_try_build_graph` helper that attempts to import DependencyGraph (returns None if not available yet).\n\n**Implementation Steps:**\n1. Create `_try_build_graph(backend)` helper function in `cli/task.py`:\n2. In `cub task ready`:\n3. In `cub task show`:\n4. In `cub status` (status.py):\n5. In `cub suggest` (suggest.py):\n6. Write CLI integration tests for each command with `--agent` flag\n\n**Files:** src/cub/cli/task.py, src/cub/cli/status.py, src/cub/cli/suggest.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-a1f", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": "cub-a1f", "created_at": "2026-01-29T16:46:50.495119Z", "updated_at": "2026-01-29T11:46:55.683939-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, "secondary_result": {"id": "cub-a1f.2", "title": "Wire --agent flag into Phase 1 CLI commands", "status": "open", "priority": "P0", "type": "task", "description": "Add `--agent` flag to `cub task ready`, `cub task show`, `cub status`, and `cub suggest`. Follow the existing `--json` pattern. When `--agent` is passed, call the corresponding AgentFormatter method and print the result. `--agent` wins silently over `--json` if both are passed. Include `_try_build_graph` helper that attempts to import DependencyGraph (returns None if not available yet).\n\n**Implementation Steps:**\n1. Create `_try_build_graph(backend)` helper function in `cli/task.py`:\n2. In `cub task ready`:\n3. In `cub task show`:\n4. In `cub status` (status.py):\n5. In `cub suggest` (suggest.py):\n6. Write CLI integration tests for each command with `--agent` flag\n\n**Files:** src/cub/cli/task.py, src/cub/cli/status.py, src/cub/cli/suggest.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-a1f", "created_at": "2026-01-29T11:47:42.431536", "updated_at": "2026-01-29T11:47:42.431537", "closed_at": null, "acceptance_criteria": ["`cub task ready --agent` outputs structured markdown", "`cub task show <id> --agent` outputs structured markdown", "`cub status --agent` outputs structured markdown", "`cub suggest --agent` outputs structured markdown", "`--agent` takes precedence over `--json` silently", "`_try_build_graph` returns None gracefully when DependencyGraph not available", "`_try_build_graph` returns working graph when DependencyGraph is available", "CLI tests pass for all four commands"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, "difference_summary": "labels: ['complexity:medium', 'epic:cub-a1f', 'model:sonnet', 'phase-1'] != ['phase-1', 'model:sonnet', 'complexity:medium']"}
{"timestamp": "2026-01-29T12:50:12.937719", "operation": "list_blocked_tasks", "task_id": null, "primary_result": [{"id": "cub-a1f.2", "title": "Wire --agent flag into Phase 1 CLI commands", "status": "open", "priority": "P0", "type": "task", "description": "Add `--agent` flag to `cub task ready`, `cub task show`, `cub status`, and `cub suggest`. Follow the existing `--json` pattern. When `--agent` is passed, call the corresponding AgentFormatter method and print the result. `--agent` wins silently over `--json` if both are passed. Include `_try_build_graph` helper that attempts to import DependencyGraph (returns None if not available yet).\n\n**Implementation Steps:**\n1. Create `_try_build_graph(backend)` helper function in `cli/task.py`:\n2. In `cub task ready`:\n3. In `cub task show`:\n4. In `cub status` (status.py):\n5. In `cub suggest` (suggest.py):\n6. Write CLI integration tests for each command with `--agent` flag\n\n**Files:** src/cub/cli/task.py, src/cub/cli/status.py, src/cub/cli/suggest.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495119Z", "updated_at": "2026-01-29T11:46:55.683939-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r4h.2", "title": "Integration tests for exit scenarios", "status": "open", "priority": "P0", "type": "task", "description": "We need automated tests that verify clean exits on all paths. These tests ensure regressions are caught early.\n\n**Implementation Steps:**\n1. Add `pytest-timeout` to dev dependencies if not present\n2. Create `tests/integration/test_run_exits.py`\n3. Write tests for: Ctrl+C (SIGINT), SIGTERM, budget exhaustion, iteration limit reached, task failure\n4. Each test should verify: clean exit (no crash), status.json updated, run artifact created\n5. Use subprocess to run `cub run` and send signals\n\n**Files:** tests/integration/test_run_exits.py, pyproject.toml", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923515Z", "updated_at": "2026-01-26T16:32:00.156994-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r4h.3", "title": "Ensure artifacts on all exits", "status": "open", "priority": "P0", "type": "task", "description": "Based on audit findings, fix any exit paths that don't preserve artifacts. This is the core deliverable of E4.\n\n**Implementation Steps:**\n1. Review gaps identified in cub-r4h.1 audit\n2. Add try/finally blocks where needed to ensure `write_run_artifact()` is called\n3. Ensure `StatusWriter.write()` is called before any exit\n4. Handle edge cases: exceptions during artifact write, partial state\n5. Run integration tests to verify fixes\n\n**Files:** src/cub/cli/run.py, src/cub/core/status/writer.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923537Z", "updated_at": "2026-01-26T16:32:00.157257-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r5c.2", "title": "Implement CircuitBreaker class", "status": "open", "priority": "P0", "type": "task", "description": "The core circuit breaker logic. Uses asyncio timeout to detect hung harness execution.\n\n**Implementation Steps:**\n1. Create `src/cub/core/circuit_breaker.py`\n2. Implement `CircuitBreaker` class with:\n3. On timeout: raise `CircuitBreakerTripped` exception with clear message\n4. Handle graceful cancellation of the wrapped coroutine\n5. Write unit tests\n\n**Files:** src/cub/core/circuit_breaker.py, tests/unit/test_circuit_breaker.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923575Z", "updated_at": "2026-01-26T16:32:00.158012-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r5c.3", "title": "Integrate circuit breaker into run.py", "status": "open", "priority": "P0", "type": "task", "description": "Wire the circuit breaker into the run loop so harness invocations are timeout-protected.\n\n**Implementation Steps:**\n1. Import CircuitBreaker in `src/cub/cli/run.py`\n2. Create CircuitBreaker instance from config in run initialization\n3. Wrap `_invoke_harness()` call with `circuit_breaker.execute()`\n4. Handle `CircuitBreakerTripped` exception: log, update status, exit cleanly with artifacts\n5. Add circuit breaker status to run summary output\n\n**Files:** src/cub/cli/run.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923591Z", "updated_at": "2026-01-26T16:32:00.158242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-a3r.2", "title": "Build route compiler and cub routes CLI", "status": "open", "priority": "P1", "type": "task", "description": "The route compiler reads the raw log, normalizes commands (strips task IDs, file paths), aggregates by frequency, filters noise (count < 3), and writes a markdown table to `.cub/learned-routes.md`. This compiled file is git-tracked and shared with the team. The compiler is triggered by the Stop hook at session end.\n\n**Implementation Steps:**\n1. Create `src/cub/core/routes/compiler.py`:\n2. Create `src/cub/core/routes/__init__.py`\n3. Create `src/cub/cli/routes.py`:\n4. Register routes app in `src/cub/cli/__init__.py`\n5. Add Stop hook trigger in `cub-hook.sh`:\n6. Write tests for `normalize_command` with edge cases (various command patterns)\n7. Write tests for `compile_routes` with sample JSONL input\n8. Write tests for `render_learned_routes` output format\n\n**Files:** src/cub/core/routes/__init__.py, src/cub/core/routes/compiler.py, src/cub/cli/routes.py, src/cub/cli/__init__.py, .cub/scripts/hooks/cub-hook.sh, tests/test_route_compiler.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495159Z", "updated_at": "2026-01-29T11:46:55.684499-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-a3r.3", "title": "Add learned routes section to router skill", "status": "open", "priority": "P1", "type": "task", "description": "The router skill needs to reference the compiled routes file so Claude can use frequency data as a tiebreaker for ambiguous intent. This is the only point where LLM judgment enters the route learning system.\n\n**Implementation Steps:**\n1. Add a \"Learned Routes\" section to `.claude/commands/cub.md`:\n2. Place this section after the \"Execution Rules\" section and before \"Examples\"\n3. The `@` prefix ensures Claude Code injects the file content into context\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495168Z", "updated_at": "2026-01-29T11:46:55.684676-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r6s.2", "title": "Implement InstructionGenerator", "status": "open", "priority": "P1", "type": "task", "description": "Generate CLAUDE.md and AGENTS.md with workflow instructions that guide agents to use cub commands.\n\n**Implementation Steps:**\n1. Create `src/cub/core/instructions.py`\n2. Implement `generate_agents_md(project_dir, config)` - harness-agnostic instructions\n3. Implement `generate_claude_md(project_dir, config)` - Claude-specific additions\n4. Include sections: finding tasks (`cub status`), claiming work (`cub wip`), completing (`cub done`), logging (`cub log`)\n5. Include escape hatch language from E5\n6. Make output customizable via config (future: templates)\n\n**Files:** src/cub/core/instructions.py, tests/unit/test_instructions.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923641Z", "updated_at": "2026-01-26T16:32:00.159055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r6s.3", "title": "Update cub init for AGENTS.md", "status": "open", "priority": "P1", "type": "task", "description": "`cub init` should create AGENTS.md at project root for cross-harness compatibility.\n\n**Implementation Steps:**\n1. Update `src/cub/cli/init_cmd.py` to call InstructionGenerator\n2. Generate AGENTS.md at project root (not in .cub/)\n3. Generate/update CLAUDE.md at project root\n4. Don't overwrite if files exist (or prompt user)\n5. Add success message mentioning the files created\n\n**Files:** src/cub/cli/init_cmd.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923654Z", "updated_at": "2026-01-26T16:32:00.159256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r6s.6", "title": "Manual testing: direct session workflow", "status": "open", "priority": "P1", "type": "task", "description": "The ultimate validation: Marc runs Claude Code directly and verifies the ledger captures work naturally.\n\n**Implementation Steps:**\n1. Create test protocol in `plans/reliability-phase/e6-manual-tests.md`\n2. Scenarios: start direct session, claim task with `cub wip`, do work, complete with `cub done`\n3. Verify: ledger entry created, task status updated, session log captured\n4. Test friction: is the workflow natural? What's awkward?\n5. Document findings and iterate\n\n**Files:** plans/reliability-phase/e6-manual-tests.md", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923692Z", "updated_at": "2026-01-26T16:32:00.160048-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-a4e.2", "title": "Wire --agent flag into blocked, list, and ledger CLI commands", "status": "open", "priority": "P2", "type": "task", "description": "Add `--agent` flag to `cub task blocked`, `cub task list`, and `cub ledger show`. These commands should already exist from the task parity spec. Wire in the AgentFormatter methods.\n\n**Implementation Steps:**\n1. In `cub task blocked` (cli/task.py):\n2. In `cub task list` (cli/task.py):\n3. In `cub ledger show` (cli/ledger.py):\n4. Update corresponding skill files to use `--agent`\n5. Write CLI tests\n\n**Files:** src/cub/cli/task.py, src/cub/cli/ledger.py, .claude/commands/cub:tasks.md, .claude/commands/cub:ledger.md", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495183Z", "updated_at": "2026-01-29T11:46:55.685013-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-r6s.5", "title": "Implement hook handlers for artifact capture", "status": "open", "priority": "P2", "type": "task", "description": "Based on hook research, implement handlers to auto-capture artifacts when possible.\n\n**Implementation Steps:**\n1. Create `src/cub/core/harness/hooks.py`\n2. Implement `handle_hook_event(event_type, payload)` dispatcher\n3. For PostToolUse/Write: detect writes to plans/, log to ledger\n4. For Stop: capture session end, finalize any open ledger entries\n5. Parse payloads defensively (malformed \u2192 skip, don't crash)\n6. Create hook scripts for `.cub/hooks/` that call these handlers\n\n**Files:** src/cub/core/harness/hooks.py, .cub/hooks/", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923682Z", "updated_at": "2026-01-26T16:32:00.159779-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": "[]", "difference_summary": "List length mismatch: 22 != 0"}
{"timestamp": "2026-01-29T12:50:18.084348", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-a1f.2", "title": "Wire --agent flag into Phase 1 CLI commands", "status": "open", "priority": "P0", "type": "task", "description": "Add `--agent` flag to `cub task ready`, `cub task show`, `cub status`, and `cub suggest`. Follow the existing `--json` pattern. When `--agent` is passed, call the corresponding AgentFormatter method and print the result. `--agent` wins silently over `--json` if both are passed. Include `_try_build_graph` helper that attempts to import DependencyGraph (returns None if not available yet).\n\n**Implementation Steps:**\n1. Create `_try_build_graph(backend)` helper function in `cli/task.py`:\n2. In `cub task ready`:\n3. In `cub task show`:\n4. In `cub status` (status.py):\n5. In `cub suggest` (suggest.py):\n6. Write CLI integration tests for each command with `--agent` flag\n\n**Files:** src/cub/cli/task.py, src/cub/cli/status.py, src/cub/cli/suggest.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-a1f", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495119Z", "updated_at": "2026-01-29T11:46:55.683939-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-a1f.1", "title": "Build AgentFormatter module with Phase 1 format methods", "status": "open", "priority": "P0", "type": "task", "description": "The AgentFormatter is a collection of static methods that transform service-layer data into structured markdown for LLM consumption. Each method follows the envelope template: heading, summary line, data tables, truncation notice, analysis section. The formatter returns plain strings \u2014 no Rich, no console. DependencyGraph is an optional parameter; when None, analysis hints that require graph queries are omitted.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/agent_format.py` with `AgentFormatter` class\n2. Implement shared helpers:\n3. Implement `format_ready(tasks, graph=None)`:\n4. Implement `format_task_detail(task, graph=None, epic_progress=None)`:\n5. Implement `format_status(stats, epic_progress=None)`:\n6. Implement `format_suggestions(suggestions)`:\n7. Write snapshot tests for each method with representative inputs (0, 1, 10, 20 items)\n8. Write token budget test: assert output character count < 2000 for representative inputs\n\n**Files:** src/cub/core/services/agent_format.py, tests/test_agent_format.py", "assignee": null, "labels": ["complexity:high", "epic:cub-a1f", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495070Z", "updated_at": "2026-01-29T11:46:55.683109-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-a1f", "title": "agent-output #1: AgentFormatter & --agent Flag", "status": "open", "priority": "P0", "type": "epic", "description": "Build the AgentFormatter module and wire `--agent` flags into Phase 1 CLI commands (task ready, task show, status, suggest). This is the core value \u2014 Claude gets structured, compact markdown with pre-computed analysis hints instead of raw Rich output.", "assignee": null, "labels": ["complexity:high", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:24.447456Z", "updated_at": "2026-01-29T11:46:29.681754-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t", "title": "cub-task-parity #1: Protocol Extensions & DependencyGraph", "status": "open", "priority": "P0", "type": "epic", "description": "Extend the TaskBackend protocol with 7 new methods, implement them in BeadsBackend and JsonlBackend, extend `update_task` signature, and build the DependencyGraph class. This is the foundation that everything else depends on.", "assignee": null, "labels": ["complexity:high", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:44:49.313987Z", "updated_at": "2026-01-29T11:44:54.566273-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "in_progress", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": "cub-20260128-204328", "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-29T09:37:07.870355-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-r6s.1", "title": "Create direct session CLI commands", "status": "open", "priority": "P0", "type": "task", "description": "Direct sessions need commands to record work. These are the integration layer between harness and ledger.\n\n**Implementation Steps:**\n1. Create `src/cub/cli/session.py` with Typer app\n2. Implement `cub log <message>` - adds timestamped entry to session log\n3. Implement `cub done <task-id> [--reason]` - marks task complete, creates ledger entry\n4. Implement `cub wip <task-id>` - marks task in-progress\n5. Register commands in main CLI app\n6. Add `source: \"direct_session\"` to ledger entries created by these commands\n\n**Files:** src/cub/cli/session.py, src/cub/cli/__init__.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-r6s", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923630Z", "updated_at": "2026-01-26T16:32:00.158850-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-r5c.3", "title": "Integrate circuit breaker into run.py", "status": "open", "priority": "P0", "type": "task", "description": "Wire the circuit breaker into the run loop so harness invocations are timeout-protected.\n\n**Implementation Steps:**\n1. Import CircuitBreaker in `src/cub/cli/run.py`\n2. Create CircuitBreaker instance from config in run initialization\n3. Wrap `_invoke_harness()` call with `circuit_breaker.execute()`\n4. Handle `CircuitBreakerTripped` exception: log, update status, exit cleanly with artifacts\n5. Add circuit breaker status to run summary output\n\n**Files:** src/cub/cli/run.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-r5c", "integration", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923591Z", "updated_at": "2026-01-26T16:32:00.158242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-r5c.2", "title": "Implement CircuitBreaker class", "status": "open", "priority": "P0", "type": "task", "description": "The core circuit breaker logic. Uses asyncio timeout to detect hung harness execution.\n\n**Implementation Steps:**\n1. Create `src/cub/core/circuit_breaker.py`\n2. Implement `CircuitBreaker` class with:\n3. On timeout: raise `CircuitBreakerTripped` exception with clear message\n4. Handle graceful cancellation of the wrapped coroutine\n5. Write unit tests\n\n**Files:** src/cub/core/circuit_breaker.py, tests/unit/test_circuit_breaker.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-r5c", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923575Z", "updated_at": "2026-01-26T16:32:00.158012-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-r5c.1", "title": "Add CircuitBreakerConfig", "status": "open", "priority": "P0", "type": "task", "description": "Configuration must exist before we can implement the circuit breaker. This adds the config model and wires it into CubConfig.\n\n**Implementation Steps:**\n1. Add `CircuitBreakerConfig` class to `src/cub/core/config/models.py`\n2. Fields: `enabled: bool = True`, `timeout_minutes: int = 30`\n3. Add `circuit_breaker: CircuitBreakerConfig` field to `CubConfig`\n4. Add environment variable support: `CUB_CIRCUIT_BREAKER_ENABLED`, `CUB_CIRCUIT_BREAKER_TIMEOUT`\n5. Update config documentation\n\n**Files:** src/cub/core/config/models.py, docs/CONFIG.md", "assignee": null, "labels": ["complexity:low", "config", "epic:cub-r5c", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923564Z", "updated_at": "2026-01-26T16:32:00.157779-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 0}, {"id": "cub-r4h.3", "title": "Ensure artifacts on all exits", "status": "open", "priority": "P0", "type": "task", "description": "Based on audit findings, fix any exit paths that don't preserve artifacts. This is the core deliverable of E4.\n\n**Implementation Steps:**\n1. Review gaps identified in cub-r4h.1 audit\n2. Add try/finally blocks where needed to ensure `write_run_artifact()` is called\n3. Ensure `StatusWriter.write()` is called before any exit\n4. Handle edge cases: exceptions during artifact write, partial state\n5. Run integration tests to verify fixes\n\n**Files:** src/cub/cli/run.py, src/cub/core/status/writer.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-r4h", "fix", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923537Z", "updated_at": "2026-01-26T16:32:00.157257-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-r4h.2", "title": "Integration tests for exit scenarios", "status": "open", "priority": "P0", "type": "task", "description": "We need automated tests that verify clean exits on all paths. These tests ensure regressions are caught early.\n\n**Implementation Steps:**\n1. Add `pytest-timeout` to dev dependencies if not present\n2. Create `tests/integration/test_run_exits.py`\n3. Write tests for: Ctrl+C (SIGINT), SIGTERM, budget exhaustion, iteration limit reached, task failure\n4. Each test should verify: clean exit (no crash), status.json updated, run artifact created\n5. Use subprocess to run `cub run` and send signals\n\n**Files:** tests/integration/test_run_exits.py, pyproject.toml", "assignee": null, "labels": ["complexity:medium", "epic:cub-r4h", "model:sonnet", "phase-1", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923515Z", "updated_at": "2026-01-26T16:32:00.156994-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-r4h.1", "title": "Audit run.py exit paths", "status": "open", "priority": "P0", "type": "task", "description": "Before adding tests, we need to document current behavior. This audit identifies all exit paths and their current artifact-preservation status.\n\n**Implementation Steps:**\n1. Read through `src/cub/cli/run.py` and identify all exit points (return statements, sys.exit, exceptions)\n2. For each exit path, document: trigger condition, whether `write_run_artifact()` is called, whether status is persisted\n3. Identify gaps where artifacts might not be created\n4. Create a markdown document in `.cub/docs/` summarizing findings\n\n**Files:** src/cub/cli/run.py, .cub/docs/run-exit-paths.md", "assignee": null, "labels": ["audit", "complexity:medium", "epic:cub-r4h", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923445Z", "updated_at": "2026-01-26T16:32:00.156299-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-r5c", "title": "reliability-phase #2: Circuit Breaker", "status": "open", "priority": "P0", "type": "epic", "description": "Add timeout monitoring to harness execution. If no harness activity for 30 minutes, trip breaker and stop run with clear message. Prevents overnight runs from wasting hours on stuck tasks.", "assignee": null, "labels": ["circuit-breaker", "e5", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:34.004210Z", "updated_at": "2026-01-26T16:31:39.276468-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r4h", "title": "reliability-phase #1: Core Loop Hardening", "status": "open", "priority": "P0", "type": "epic", "description": "Verify and strengthen existing exit handling in `cub run`. The foundation is solid\u2014this is primarily testing, documentation, and edge case fixes. Goal: `cub run` exits cleanly on all paths with artifacts preserved.", "assignee": null, "labels": ["e4", "hardening", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:34.004176Z", "updated_at": "2026-01-26T16:31:39.275620-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-a3r.3", "title": "Add learned routes section to router skill", "status": "open", "priority": "P1", "type": "task", "description": "The router skill needs to reference the compiled routes file so Claude can use frequency data as a tiebreaker for ambiguous intent. This is the only point where LLM judgment enters the route learning system.\n\n**Implementation Steps:**\n1. Add a \"Learned Routes\" section to `.claude/commands/cub.md`:\n2. Place this section after the \"Execution Rules\" section and before \"Examples\"\n3. The `@` prefix ensures Claude Code injects the file content into context\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:low", "epic:cub-a3r", "model:haiku", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495168Z", "updated_at": "2026-01-29T11:46:55.684676-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-a3r.1", "title": "Add route observation to cub-hook.sh", "status": "open", "priority": "P1", "type": "task", "description": "The existing `cub-hook.sh` fast-path filter fires on every Bash tool use. It already detects `cub` commands for the symbiotic workflow. Extend it to log command usage to `.cub/route-log.jsonl`. This is 4 lines of shell \u2014 minimal latency impact.\n\n**Implementation Steps:**\n1. In `.cub/scripts/hooks/cub-hook.sh`, in the PostToolUse/Bash handler where `cub ` commands are detected:\n2. Add `.cub/route-log.jsonl` to `.gitignore` (raw log is local-only)\n3. Ensure the logging doesn't interfere with existing hook behavior (the line is additive)\n4. Test manually: run a `cub task ready` in Claude Code, verify log entry appears\n\n**Files:** .cub/scripts/hooks/cub-hook.sh, .gitignore", "assignee": null, "labels": ["complexity:low", "epic:cub-a3r", "model:haiku", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495150Z", "updated_at": "2026-01-29T11:46:55.684328-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-a3r.2", "title": "Build route compiler and cub routes CLI", "status": "open", "priority": "P1", "type": "task", "description": "The route compiler reads the raw log, normalizes commands (strips task IDs, file paths), aggregates by frequency, filters noise (count < 3), and writes a markdown table to `.cub/learned-routes.md`. This compiled file is git-tracked and shared with the team. The compiler is triggered by the Stop hook at session end.\n\n**Implementation Steps:**\n1. Create `src/cub/core/routes/compiler.py`:\n2. Create `src/cub/core/routes/__init__.py`\n3. Create `src/cub/cli/routes.py`:\n4. Register routes app in `src/cub/cli/__init__.py`\n5. Add Stop hook trigger in `cub-hook.sh`:\n6. Write tests for `normalize_command` with edge cases (various command patterns)\n7. Write tests for `compile_routes` with sample JSONL input\n8. Write tests for `render_learned_routes` output format\n\n**Files:** src/cub/core/routes/__init__.py, src/cub/core/routes/compiler.py, src/cub/cli/routes.py, src/cub/cli/__init__.py, .cub/scripts/hooks/cub-hook.sh, tests/test_route_compiler.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-a3r", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495159Z", "updated_at": "2026-01-29T11:46:55.684499-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-a2s.1", "title": "Update passthrough skills and router to use --agent", "status": "open", "priority": "P1", "type": "task", "description": "Seven passthrough skills exist and the router skill maps intent to CLI commands. Update all command invocations to include `--agent` so Claude always gets structured output when routing through skills. The router skill needs `--agent` on all CLI command mappings.\n\n**Implementation Steps:**\n1. Update `.claude/commands/cub:tasks.md`:\n2. Update `.claude/commands/cub:status.md`:\n3. Update `.claude/commands/cub:suggest.md`:\n4. Update `.claude/commands/cub:ledger.md`:\n5. Update `.claude/commands/cub:doctor.md`:\n6. Update `.claude/commands/cub.md` (router):\n7. Add instruction in router skill about how Claude should treat `--agent` output:\n\n**Files:** .claude/commands/cub.md, .claude/commands/cub:tasks.md, .claude/commands/cub:status.md, .claude/commands/cub:suggest.md, .claude/commands/cub:ledger.md, .claude/commands/cub:doctor.md", "assignee": null, "labels": ["complexity:low", "epic:cub-a2s", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495139Z", "updated_at": "2026-01-29T11:46:55.684146-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-a3r", "title": "agent-output #3: Route Learning", "status": "open", "priority": "P1", "type": "epic", "description": "Build the hook-based route learning system: observe cub command usage via hooks, compile frequency data at session end, surface compiled routes to the router skill via file reference.", "assignee": null, "labels": ["complexity:medium", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:24.447509Z", "updated_at": "2026-01-29T11:46:29.682930-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-a2s", "title": "agent-output #2: Skill Updates & Router Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Update all passthrough skill files and the router skill to use `--agent` flag in their CLI invocations. This closes the loop: `/cub` \u2192 router \u2192 `cub task ready --agent` \u2192 structured markdown \u2192 Claude interprets.", "assignee": null, "labels": ["complexity:low", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:24.447498Z", "updated_at": "2026-01-29T11:46:29.682667-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.4", "title": "Enhance existing cub task list, ready, create, update commands", "status": "open", "priority": "P1", "type": "task", "description": "Existing commands need additional filters and flags to reach parity. `list` and `ready` need `--epic` and `--assignee` filters. `create` needs full flag exposure. `update` needs `--title`, `--priority`, `--notes`.\n\n**Implementation Steps:**\n1. `cub task list`: add `--epic` (filter by parent), `--assignee` (filter by assignee) options\n2. `cub task ready`: add `--epic` filter, add `--by impact|priority` ordering option (impact uses DependencyGraph)\n3. `cub task create`: ensure CLI exposes `--type`, `--priority`, `--epic` (as `--parent`), `--description`, `--depends-on` (comma-separated list)\n4. `cub task update`: add `--title`, `--priority`, `--notes` flags alongside existing `--description`, `--assignee`, `--status`\n5. For `ready --by impact`: build DependencyGraph, sort tasks by `transitive_unblocks` count descending\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p2c", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094200Z", "updated_at": "2026-01-29T11:45:15.286499-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p3s.1", "title": "Update router skill and passthrough skills", "status": "open", "priority": "P1", "type": "task", "description": "The router skill (`.claude/commands/cub.md`) currently maps \"what's blocked\" to `bd blocked`. Passthrough skills reference `bd` commands. Update all to use `cub task` equivalents with `--agent` flag.\n\n**Implementation Steps:**\n1. In `.claude/commands/cub.md`:\n2. In `.claude/commands/cub:tasks.md`:\n3. Review other skill files for any remaining `bd` references\n\n**Files:** .claude/commands/cub.md, .claude/commands/cub:tasks.md", "assignee": null, "labels": ["complexity:low", "epic:cub-p3s", "model:haiku", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094216Z", "updated_at": "2026-01-29T11:45:15.286843-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.3", "title": "Add cub task reopen and cub task delete commands", "status": "open", "priority": "P1", "type": "task", "description": "Lifecycle management commands. Reopen is straightforward. Delete is destructive and needs a confirmation prompt (skippable with `--force`).\n\n**Implementation Steps:**\n1. Add `reopen` command \u2014 calls `reopen_task()`, prints confirmation with task title\n2. Add `delete` command \u2014 prompts \"Delete task {id} '{title}'? [y/N]\" unless `--force` is passed\n3. Both support `--json` for machine output\n4. Error handling: task not found, task not in correct state (e.g., reopen a non-closed task)\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["complexity:low", "epic:cub-p2c", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094193Z", "updated_at": "2026-01-29T11:45:15.286309-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.2", "title": "Add cub task dep add/remove and cub task label add/remove/list commands", "status": "open", "priority": "P1", "type": "task", "description": "Dependency and label management subcommands. These are simple CRUD wrappers around protocol methods with confirmation output.\n\n**Implementation Steps:**\n1. Create `dep` sub-app with `add` and `remove` commands\n2. `cub task dep add <task> <depends-on>` \u2014 calls `add_dependency()`, prints confirmation\n3. `cub task dep remove <task> <depends-on>` \u2014 calls `remove_dependency()`, prints confirmation\n4. Enhance existing `dep list` to show both directions (what this task depends on AND what depends on it)\n5. Create `label` sub-app with `add`, `remove`, `list` commands\n6. `cub task label add <task> <label>` \u2014 calls `add_label()`, prints confirmation\n7. `cub task label remove <task> <label>` \u2014 calls `remove_label()`, prints confirmation\n8. `cub task label list <task>` \u2014 calls `get_task()`, displays labels\n9. All commands support `--json` for machine output\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p2c", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094184Z", "updated_at": "2026-01-29T11:45:15.286106-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.1", "title": "Add cub task blocked command", "status": "in_progress", "priority": "P1", "type": "task", "description": "The most common gap \u2014 the router currently maps \"what's blocked\" to `bd blocked`. This command shows blocked tasks with optional epic filter. With `--agent`, it includes root blocker analysis and chain lengths from DependencyGraph.\n\n**Implementation Steps:**\n1. Add `blocked` command to task app in `cli/task.py`\n2. Parameters: `--epic` (filter), `--json`, `--agent`\n3. Rich output: table with ID, Priority, Title, Blocked By columns\n4. JSON output: task model dumps\n5. Agent output: call `AgentFormatter.format_blocked()` if available, otherwise fall back to a simple markdown table\n6. Build DependencyGraph from all tasks for analysis hints\n7. Show root blockers and chain summary in agent output\n\n**Files:** src/cub/cli/task.py", "assignee": "cub-20260129-124742", "labels": ["complexity:medium", "epic:cub-p2c", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094176Z", "updated_at": "2026-01-29T12:48:25.480755-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-p3s", "title": "cub-task-parity #3: Skill & Documentation Updates", "status": "open", "priority": "P1", "type": "epic", "description": "Update all skills, router, and documentation to reference `cub task` exclusively. Remove `bd` from user-facing content.", "assignee": null, "labels": ["complexity:low", "model:haiku", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:44:49.314043Z", "updated_at": "2026-01-29T11:44:54.567497-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c", "title": "cub-task-parity #2: CLI Subcommands", "status": "open", "priority": "P1", "type": "epic", "description": "Add CLI commands for all new protocol operations. Each command supports three output modes: Rich (default), `--json`, `--agent`.", "assignee": null, "labels": ["complexity:medium", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:44:49.314028Z", "updated_at": "2026-01-29T11:44:54.567280-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r6s.6", "title": "Manual testing: direct session workflow", "status": "open", "priority": "P1", "type": "task", "description": "The ultimate validation: Marc runs Claude Code directly and verifies the ledger captures work naturally.\n\n**Implementation Steps:**\n1. Create test protocol in `plans/reliability-phase/e6-manual-tests.md`\n2. Scenarios: start direct session, claim task with `cub wip`, do work, complete with `cub done`\n3. Verify: ledger entry created, task status updated, session log captured\n4. Test friction: is the workflow natural? What's awkward?\n5. Document findings and iterate\n\n**Files:** plans/reliability-phase/e6-manual-tests.md", "assignee": null, "labels": ["checkpoint", "complexity:low", "epic:cub-r6s", "model:haiku", "phase-3", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923692Z", "updated_at": "2026-01-26T16:32:00.160048-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-r6s.4", "title": "Research Claude Code hooks", "status": "open", "priority": "P1", "type": "task", "description": "Understand what hooks Claude Code exposes for artifact capture. This informs whether we can auto-capture or must rely on instructions.\n\n**Implementation Steps:**\n1. Review Claude Code documentation for hooks system\n2. Test available hook events: PreToolUse, PostToolUse, Stop, PermissionRequest\n3. Document payload structure for each relevant event\n4. Identify: can we detect session start/end? Can we capture plan content?\n5. Write findings to `.cub/docs/claude-code-hooks.md`\n\n**Files:** .cub/docs/claude-code-hooks.md", "assignee": null, "labels": ["complexity:medium", "epic:cub-r6s", "model:sonnet", "phase-3", "research"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923670Z", "updated_at": "2026-01-26T16:32:00.159524-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-r6s.3", "title": "Update cub init for AGENTS.md", "status": "open", "priority": "P1", "type": "task", "description": "`cub init` should create AGENTS.md at project root for cross-harness compatibility.\n\n**Implementation Steps:**\n1. Update `src/cub/cli/init_cmd.py` to call InstructionGenerator\n2. Generate AGENTS.md at project root (not in .cub/)\n3. Generate/update CLAUDE.md at project root\n4. Don't overwrite if files exist (or prompt user)\n5. Add success message mentioning the files created\n\n**Files:** src/cub/cli/init_cmd.py", "assignee": null, "labels": ["cli", "complexity:low", "epic:cub-r6s", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923654Z", "updated_at": "2026-01-26T16:32:00.159256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-r6s.2", "title": "Implement InstructionGenerator", "status": "open", "priority": "P1", "type": "task", "description": "Generate CLAUDE.md and AGENTS.md with workflow instructions that guide agents to use cub commands.\n\n**Implementation Steps:**\n1. Create `src/cub/core/instructions.py`\n2. Implement `generate_agents_md(project_dir, config)` - harness-agnostic instructions\n3. Implement `generate_claude_md(project_dir, config)` - Claude-specific additions\n4. Include sections: finding tasks (`cub status`), claiming work (`cub wip`), completing (`cub done`), logging (`cub log`)\n5. Include escape hatch language from E5\n6. Make output customizable via config (future: templates)\n\n**Files:** src/cub/core/instructions.py, tests/unit/test_instructions.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-r6s", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923641Z", "updated_at": "2026-01-26T16:32:00.159055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-r5c.5", "title": "Add \"giving up\" escape hatch to prompts", "status": "open", "priority": "P1", "type": "task", "description": "Complement time-based detection with agent self-awareness. Add instruction letting agents signal when they're stuck.\n\n**Implementation Steps:**\n1. Update `templates/PROMPT.md` with escape hatch section\n2. Add instruction: \"If you are stuck and cannot make progress, output: <stuck>REASON</stuck>\"\n3. Document that this complements (doesn't replace) circuit breaker\n4. Consider: should run.py detect this signal? (Future enhancement, document but don't implement)\n\n**Files:** templates/PROMPT.md", "assignee": null, "labels": ["checkpoint", "complexity:low", "epic:cub-r5c", "model:haiku", "phase-2", "prompt"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923617Z", "updated_at": "2026-01-26T16:32:00.158649-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-r5c.4", "title": "Add --no-circuit-breaker CLI flag", "status": "open", "priority": "P1", "type": "task", "description": "Users need ability to disable circuit breaker for legitimately long operations.\n\n**Implementation Steps:**\n1. Add `--no-circuit-breaker` flag to `cub run` command\n2. Flag sets `config.circuit_breaker.enabled = False`\n3. Document flag in `cub run --help`\n4. Add example to README showing when to use it\n\n**Files:** src/cub/cli/run.py, README.md", "assignee": null, "labels": ["cli", "complexity:low", "epic:cub-r5c", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923605Z", "updated_at": "2026-01-26T16:32:00.158452-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-r4h.4", "title": "Manual testing protocol for E4", "status": "open", "priority": "P1", "type": "task", "description": "Automated tests can't catch everything. Create a checklist for Marc to manually validate exit behavior.\n\n**Implementation Steps:**\n1. Create manual test checklist in `plans/reliability-phase/e4-manual-tests.md`\n2. Include scenarios: overnight run, Ctrl+C at various points, kill -9, budget warning then exhaustion\n3. Document expected behavior and what to check (files created, messages shown)\n4. Include recovery steps if something goes wrong\n\n**Files:** plans/reliability-phase/e4-manual-tests.md", "assignee": null, "labels": ["checkpoint", "complexity:low", "docs", "epic:cub-r4h", "model:haiku", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923553Z", "updated_at": "2026-01-26T16:32:00.157500-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-r6s", "title": "reliability-phase #3: Symbiotic Workflow", "status": "open", "priority": "P1", "type": "epic", "description": "Unified audit trail for direct harness sessions. When users run Claude Code/Codex directly, CLAUDE.md/AGENTS.md instructions + hooks ensure ledger captures equivalent records to `cub run`.", "assignee": null, "labels": ["e6", "phase-3", "symbiotic"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:34.004222Z", "updated_at": "2026-01-26T16:31:39.276695-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-a4e.3", "title": "Add --agent support for doctor command (requires refactor)", "status": "open", "priority": "P2", "type": "task", "description": "The doctor command currently prints directly via Rich console. To support `--agent`, it needs to return structured diagnostic results instead. This is a refactor of the existing doctor command internals, not just adding a flag.\n\n**Implementation Steps:**\n1. Define `DiagnosticResult` model (or use existing if one exists):\n2. Refactor doctor command to collect `list[DiagnosticResult]` before rendering\n3. Add `format_doctor(checks: list[DiagnosticResult])` to AgentFormatter:\n4. Add `--agent` flag to `cub doctor` command\n5. If agent: call `AgentFormatter.format_doctor(checks)`, print\n6. Ensure existing Rich output is unchanged when `--agent` is not passed\n7. Update `cub:doctor.md` skill to use `--agent`\n8. Write tests for both the refactored data collection and agent formatting\n\n**Files:** src/cub/cli/doctor.py, src/cub/core/services/agent_format.py, .claude/commands/cub:doctor.md, tests/test_agent_format.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-a4e", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495194Z", "updated_at": "2026-01-29T11:46:55.685189-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-a4e.2", "title": "Wire --agent flag into blocked, list, and ledger CLI commands", "status": "open", "priority": "P2", "type": "task", "description": "Add `--agent` flag to `cub task blocked`, `cub task list`, and `cub ledger show`. These commands should already exist from the task parity spec. Wire in the AgentFormatter methods.\n\n**Implementation Steps:**\n1. In `cub task blocked` (cli/task.py):\n2. In `cub task list` (cli/task.py):\n3. In `cub ledger show` (cli/ledger.py):\n4. Update corresponding skill files to use `--agent`\n5. Write CLI tests\n\n**Files:** src/cub/cli/task.py, src/cub/cli/ledger.py, .claude/commands/cub:tasks.md, .claude/commands/cub:ledger.md", "assignee": null, "labels": ["complexity:medium", "epic:cub-a4e", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495183Z", "updated_at": "2026-01-29T11:46:55.685013-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-a4e.1", "title": "Add AgentFormatter methods for blocked, list, and ledger", "status": "open", "priority": "P2", "type": "task", "description": "Three more commands get `--agent` support. `format_blocked` uses DependencyGraph heavily (root blockers, chain visualization). `format_list` is a general-purpose task table. `format_ledger` shows recent completions with cost summary. These depend on the task parity spec having landed `cub task blocked` and `cub task list` enhancements.\n\n**Implementation Steps:**\n1. Add `format_blocked(tasks, graph=None)` to AgentFormatter:\n2. Add `format_list(tasks)` to AgentFormatter:\n3. Add `format_ledger(entries, stats=None)` to AgentFormatter:\n4. Write snapshot tests for each method\n5. Write token budget tests\n\n**Files:** src/cub/core/services/agent_format.py, tests/test_agent_format.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-a4e", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495175Z", "updated_at": "2026-01-29T11:46:55.684841-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-a4e", "title": "agent-output #4: Extended Commands", "status": "open", "priority": "P2", "type": "epic", "description": "Add `--agent` support to Phase 2 and Phase 3 commands. These depend on task parity (cub-task-parity) landing for `blocked` and `list`, and doctor refactor for `doctor`.", "assignee": null, "labels": ["complexity:medium", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:24.447519Z", "updated_at": "2026-01-29T11:46:29.683108-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-p3s.2", "title": "Update CLAUDE.md and PROMPT.md documentation", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md (agent instructions) and `.cub/PROMPT.md` (runloop instructions) reference `bd` commands in examples. Update all examples to use `cub task` equivalents. Keep `bd` mentioned only in the \"Pre-approved Commands\" section (bd is still available for power users).\n\n**Implementation Steps:**\n1. In CLAUDE.md:\n2. In `.cub/PROMPT.md`:\n3. Audit all `.md` files in `.cub/` directory for stale `bd` references\n\n**Files:** CLAUDE.md, .cub/PROMPT.md", "assignee": null, "labels": ["complexity:low", "epic:cub-p3s", "model:haiku", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094223Z", "updated_at": "2026-01-29T11:45:15.287011-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-p2c.5", "title": "Add cub task search command", "status": "open", "priority": "P2", "type": "task", "description": "Full-text search across task titles and descriptions. BeadsBackend wraps `bd search`. JsonlBackend does substring match on title + description in memory. This is P2 but included since we're not excluding anything.\n\n**Implementation Steps:**\n1. Add `search_tasks(query: str) -> list[Task]` to `TaskBackend` protocol\n2. Implement in BeadsBackend: run `bd search <query> --json`, parse results\n3. Implement in JsonlBackend: case-insensitive substring match on title and description\n4. Add `search` command to task CLI: `cub task search <query>`\n5. Support `--json` and `--agent` output modes\n6. Show match count and results table\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/beads.py, src/cub/core/tasks/jsonl.py, src/cub/cli/task.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p2c", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094208Z", "updated_at": "2026-01-29T11:45:15.286678-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-ezpv", "title": "Add newlines between streamed messages in cub run", "status": "open", "priority": "P2", "type": "task", "description": "When `cub run --stream` is enabled, consecutive messages from the AI harness are concatenated without visual separation, making output difficult to read. Each message should be followed by a newline for clarity.\n\n**Current behavior:**\n```\nRunning claude...\nI'll help you implement...Good! Now let me check...Perfect! Now let me explore...\n```\n\n**Expected behavior:**\n```\nRunning claude...\nI'll help you implement...\n\nGood! Now let me check...\n\nPerfect! Now let me explore...\n```\n\n**Acceptance Criteria:**\n- Each streamed message is followed by a newline character\n- Output remains readable and properly formatted\n- Does not affect non-stream output\n- Works with all harness backends (claude, codex, gemini, etc.)", "assignee": null, "labels": ["epic:cub-8av0", "punchlist"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T19:49:00.029599-05:00", "updated_at": "2026-01-28T19:49:05.319793-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-wz1m", "title": "Add harness and model info to task headline", "status": "open", "priority": "P2", "type": "task", "description": "When starting a task iteration, the headline box should display the harness backend, model, and any other explicitly configured specs alongside the existing task metadata.\n\n**Current behavior:**\nThe headline box shows: Task ID, Title, Priority, Type, Iteration\n\n**Desired behavior:**\nInclude additional configuration details in the headline, such as:\n- Harness backend (e.g., \"claude\", \"gemini\")\n- Model (e.g., \"claude-opus-4.5\", \"gemini-2.0\")\n- Any other explicit specs from the task config or run context\n\n**Acceptance criteria:**\n- [ ] Headline box displays harness backend when available\n- [ ] Headline box displays model name when available\n- [ ] Other explicit specs are included if applicable\n- [ ] Layout remains readable (no excessive line wrapping)\n- [ ] Specs are omitted gracefully if not configured (no \"None\" values displayed)\n- [ ] Changes apply to both `cub run` and direct session contexts", "assignee": null, "labels": ["epic:cub-8av0", "punchlist"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T19:48:39.101778-05:00", "updated_at": "2026-01-28T19:48:44.355712-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-n57z", "title": "Remove deprecated cub:triage and cub:plan commands", "status": "open", "priority": "P2", "type": "task", "description": "Remove the `cub:triage` and `cub:plan` skill commands from the codebase. These commands are no longer needed and don't require backward compatibility maintenance.\n\n**Changes needed:**\n1. Remove `cub:triage` and `cub:plan` from skill/command templates\n2. Remove these commands from `.claude/commands` configuration\n3. Remove any references or registrations in the codebase that support these skills\n\n**Acceptance criteria:**\n- `cub:triage` and `cub:plan` no longer appear in any templates or configuration files\n- No skill registration or command routing code supports these commands\n- Remaining skills and commands continue to function correctly\n- No broken references to removed commands", "assignee": null, "labels": ["epic:cub-8av0", "punchlist"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T19:48:18.010514-05:00", "updated_at": "2026-01-28T19:48:23.298384-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-rcei", "title": "Ensure plan.json is created at pipeline start, not after orient begins", "status": "open", "priority": "P2", "type": "task", "description": "plan.json is currently first written during the orient stage (after start_stage() is called), rather than when the plan context is initially created. This means if orient fails before that point, there's no plan.json to recover from.\n\n**Current behavior:**\n- PlanContext.create() initializes a Plan object in memory\n- Pipeline runs orient stage, which calls ctx.save_plan() at line 484\n- plan.json is written at that point\n\n**Proposed improvement:**\n- Call ctx.save_plan() immediately after creating or loading the plan context in PipelineConfig.run()\n- Ensures plan.json exists before any stage runs\n- Improves fault tolerance and allows resuming even if orient fails early\n\n**Acceptance criteria:**\n- plan.json is created when plan context is first created\n- plan.json exists before orient stage runs\n- Existing pipeline behavior unchanged (all tests pass)\n- Plan data is accessible for recovery/resumption even if stages fail early", "assignee": null, "labels": ["epic:cub-8av0", "punchlist"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T19:47:56.958004-05:00", "updated_at": "2026-01-28T19:48:02.229409-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-tmrm", "title": "Add build failure detection and retry logic to cub pr", "status": "open", "priority": "P2", "type": "task", "description": "The `cub pr` command should monitor PR checks (CI messages, build failures) and automatically retry or re-trigger them after a configurable timeout when failures are detected.\n\n**Context:**\nCurrently, `cub pr` creates a pull request but doesn't actively monitor the status of CI checks and build results. This means failures that could be transient (flaky tests, rate limits, temporary service issues) require manual intervention to retry.\n\n**Requirements:**\n- Monitor PR checks via `gh pr checks` after creating a PR\n- Detect build failures, CI errors, and other check failures\n- When failures are detected, start a 10-minute timer (configurable via flag or config)\n- After timer expires, automatically retry failed checks or re-trigger CI\n- Continue monitoring until checks pass or max retries reached\n- Log all check statuses and retry attempts to session ledger\n- Gracefully handle network errors and API rate limiting\n\n**Acceptance Criteria:**\n- [ ] `cub pr` detects and logs PR check failures\n- [ ] Automatic 10-minute retry timer kicks off when failures detected\n- [ ] `--retry-timeout` flag allows customization (e.g., `--retry-timeout 5m`)\n- [ ] `--no-retry` flag disables auto-retry behavior\n- [ ] Checks are re-triggered via `gh pr checks --rerun` or similar\n- [ ] Session ledger captures retry history with timestamps\n- [ ] Max retries (default 3) prevents infinite loops\n- [ ] Works with both draft and regular PRs", "assignee": null, "labels": ["epic:cub-8av0", "punchlist"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T19:47:35.895643-05:00", "updated_at": "2026-01-28T19:47:41.163960-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-zpxr", "title": "Check completed steps before launching architect in plan run exit", "status": "open", "priority": "P2", "type": "task", "description": "When exiting `cub plan run`, the system should inspect which steps have already been completed in the prep pipeline (triage, architect, plan, bootstrap) instead of automatically launching into architect mode.\n\n**Context:**\nCurrently, when a user exits the plan command, the tool assumes the next step should be architect mode. This breaks the workflow when:\n- Some steps have already been completed\n- The user wants to re-run or skip a particular step\n- Multiple iterations through the pipeline are needed\n\n**Acceptance Criteria:**\n- [ ] Detect which prep steps have been completed (check for artifacts: triage output, architect output, plan.jsonl, beads state)\n- [ ] Display a summary of completed steps before prompting next action\n- [ ] Offer user a choice: continue from next incomplete step, re-run a specific step, or exit\n- [ ] Don't automatically jump to architect if earlier steps are incomplete\n- [ ] Handle partial completion gracefully (e.g., architect started but not finished)", "assignee": null, "labels": ["epic:cub-8av0", "punchlist"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T19:47:14.625064-05:00", "updated_at": "2026-01-28T19:47:19.970371-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-i4x9", "title": "Ensure build-plan sets git upstream on push", "status": "open", "priority": "P2", "type": "task", "description": "When creating a feature branch during build-plan, the upstream tracking should be automatically configured so subsequent `git push` commands work without requiring `--set-upstream`.\n\n**Context:**\nAfter running build-plan and creating a feature branch, users encounter: \"fatal: The current branch has no upstream branch\" when attempting to push. This requires manual intervention with `git push --set-upstream origin <branch>`.\n\n**Acceptance Criteria:**\n- Build-plan creates feature branches with upstream tracking configured (equivalent to `git push -u origin <branch>` on first push)\n- Subsequent `git push` commands work without additional flags\n- Works with both initial branch creation and when pushing existing local branches\n- Alternative: Configure `push.autoSetupRemote = true` in git config as part of `cub init`", "assignee": null, "labels": ["epic:cub-8av0", "punchlist"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T19:46:53.533575-05:00", "updated_at": "2026-01-28T19:46:58.822413-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-zlfs", "title": "Add post-command guidance messages to cub workflow", "status": "open", "priority": "P2", "type": "task", "description": "Improve user experience by providing contextual next-step guidance after key cub commands execute.\n\n**Context:**\nUsers new to cub need clear direction on what to do after running commands. Currently, commands complete silently or with minimal output, leaving users uncertain about the next workflow step.\n\n**Acceptance Criteria:**\n\n1. **`cub init` command**\n   - After successful initialization, display a bulleted list of suggested next steps\n   - Include: creating first capture, running interview, starting first task\n   - Link to relevant documentation or show example commands\n\n2. **`cub capture` command**\n   - After successfully creating a capture, suggest next steps\n   - Recommend: review capture, start interview, organize into spec\n\n3. **`cub spec` command** (if creating new spec)\n   - After spec creation, guide user to next phase\n   - Suggest: detailed requirements, link to parent epic, schedule for planning\n\n4. **General pattern**\n   - Guidance should be concise (3-5 bullet points max)\n   - Include actual command examples users can copy/paste\n   - Use Rich formatting for readability\n   - Respect `--quiet` flag if present (suppress guidance)\n\n**Out of scope:**\n- Changes to existing command behavior\n- New commands beyond what's listed\n- Modifying beads (`bd`) output (it's separate tool)", "assignee": null, "labels": ["epic:cub-8av0", "punchlist"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T19:46:32.528118-05:00", "updated_at": "2026-01-28T19:46:37.797062-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bets", "title": "Fix monitor command to work with beads backend", "status": "open", "priority": "P2", "type": "task", "description": "The `cub monitor` command currently fails with \"No active session found\" error. This appears to be due to changes in the codebase that have shifted from session-based monitoring to task-based execution using the beads backend.\n\n**Context:**\n- `cub monitor` is designed to provide a live dashboard during task execution\n- The error suggests it's looking for an \"active session\" concept that may no longer exist or is stored differently\n- The project now uses beads as the primary task backend\n\n**Acceptance Criteria:**\n- `cub monitor` command executes without error\n- It displays task progress in real-time (or shows appropriate status if no tasks are running)\n- It works with the current beads backend task management system\n- Help text accurately describes what the command does\n\n**Investigation needed:**\n- Check how session state is tracked with beads backend\n- Review what \"active session\" means in current architecture\n- Determine if monitor should show beads task progress or if it needs refactoring for the new task model", "assignee": null, "labels": ["epic:cub-8av0", "punchlist"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T19:46:11.486911-05:00", "updated_at": "2026-01-28T19:46:16.761131-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-nejt", "title": "Fix label order comparison in backend divergence checks", "status": "open", "priority": "P2", "type": "task", "description": "The backend divergence detection is comparing task labels as ordered lists, causing false positives when the same labels appear in different orders. This occurs in `close_task()` and `get_task()` operations where the beads backend returns labels in a different order than the in-memory state.\n\n**Context:**\nLabels are semantically unordered and should be compared as sets, not lists. The current list comparison fails when:\n- Beads sorts labels alphabetically: `['complexity:medium', 'core', 'epic:cub-b1a', ...]`\n- In-memory state has different sort order: `['phase-1', 'core', 'refactor', ...]`\n\n**Acceptance Criteria:**\n1. Backend divergence checks compare labels as sets (order-independent)\n2. False positives from label reordering are eliminated\n3. Real divergences (actual label additions/removals) are still detected\n4. No warnings logged when only label order differs\n5. Tests verify set-based comparison with various label orderings", "assignee": null, "labels": ["epic:cub-8av0", "punchlist"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T19:45:50.519188-05:00", "updated_at": "2026-01-28T19:45:55.771109-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-8av0", "title": "2026-01-28-assorted Bug Fixes", "status": "open", "priority": "P2", "type": "epic", "description": "Punchlist tasks from: 2026-01-28-assorted-bugs.md\n\nSource: plans/_punchlists/2026-01-28-assorted-bugs.md", "assignee": null, "labels": ["punchlist", "punchlist:2026-01-28-assorted-bugs"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T19:45:29.422306-05:00", "updated_at": "2026-01-28T19:45:34.782723-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-r6s.5", "title": "Implement hook handlers for artifact capture", "status": "open", "priority": "P2", "type": "task", "description": "Based on hook research, implement handlers to auto-capture artifacts when possible.\n\n**Implementation Steps:**\n1. Create `src/cub/core/harness/hooks.py`\n2. Implement `handle_hook_event(event_type, payload)` dispatcher\n3. For PostToolUse/Write: detect writes to plans/, log to ledger\n4. For Stop: capture session end, finalize any open ledger entries\n5. Parse payloads defensively (malformed \u2192 skip, don't crash)\n6. Create hook scripts for `.cub/hooks/` that call these handlers\n\n**Files:** src/cub/core/harness/hooks.py, .cub/hooks/", "assignee": null, "labels": ["complexity:medium", "epic:cub-r6s", "hooks", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923682Z", "updated_at": "2026-01-26T16:32:00.159779-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "closed", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["phase-1", "core", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407838", "updated_at": "2026-01-28T18:57:22.732005", "closed_at": "2026-01-28T18:57:22.732002", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T18:57:22.732007] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "closed", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["phase-2", "core", "refactor", "cleanup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407983", "updated_at": "2026-01-28T19:20:21.672421", "closed_at": "2026-01-28T19:20:21.672417", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:20:21.672422] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "closed", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["phase-3", "core", "architecture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408044", "updated_at": "2026-01-28T19:59:09.455587", "closed_at": "2026-01-28T19:59:09.455581", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:59:09.455589] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "closed", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T20:22:42.124609", "closed_at": "2026-01-28T20:22:42.124605", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T20:22:42.124610] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "closed", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T20:46:13.750875", "closed_at": "2026-01-28T20:46:13.750871", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T20:46:13.750876] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "closed", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T21:05:14.566952", "closed_at": "2026-01-28T21:05:14.566948", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T21:05:14.566953] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 2}, {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "closed", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:22:32.062910", "closed_at": "2026-01-28T20:22:32.062906", "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "[Closed: 2026-01-28T20:22:32.062912] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "closed", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T20:31:26.493282", "closed_at": "2026-01-28T20:31:26.493257", "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "[Closed: 2026-01-28T20:31:26.493284] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "closed", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T20:37:11.972618", "closed_at": "2026-01-28T20:37:11.972614", "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "[Closed: 2026-01-28T20:37:11.972622] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "closed", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T20:46:03.745287", "closed_at": "2026-01-28T20:46:03.745282", "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "[Closed: 2026-01-28T20:46:03.745289] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "closed", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": "cub-20260128-204617", "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T20:54:38.292608", "closed_at": "2026-01-28T20:54:38.292604", "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "[Closed: 2026-01-28T20:54:38.292610] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "closed", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": "cub-20260128-204617", "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T21:05:03.067296", "closed_at": "2026-01-28T21:05:03.067292", "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "[Closed: 2026-01-28T21:05:03.067297] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "closed", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": "cub-20260128-204617", "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T20:52:34.691040", "closed_at": "2026-01-28T20:52:34.691014", "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "[Closed: 2026-01-28T20:52:34.691043] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-p1t", "title": "cub-task-parity #1: Protocol Extensions & DependencyGraph", "status": "closed", "priority": "P0", "type": "epic", "description": "Extend the TaskBackend protocol with 7 new methods, implement them in BeadsBackend and JsonlBackend, extend `update_task` signature, and build the DependencyGraph class. This is the foundation that everything else depends on.", "assignee": null, "labels": ["phase-1", "complexity:high", "model:sonnet"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T11:45:10.091591", "updated_at": "2026-01-29T12:47:24.167150", "closed_at": "2026-01-29T12:47:24.167133", "acceptance_criteria": [], "notes": "[Closed: 2026-01-29T12:47:24.167151] All tasks completed", "complexity_label": "high", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-p2c", "title": "cub-task-parity #2: CLI Subcommands", "status": "open", "priority": "P1", "type": "epic", "description": "Add CLI commands for all new protocol operations. Each command supports three output modes: Rich (default), `--json`, `--agent`.", "assignee": null, "labels": ["phase-2", "complexity:medium", "model:sonnet"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T11:45:10.092044", "updated_at": "2026-01-29T11:45:10.092045", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p3s", "title": "cub-task-parity #3: Skill & Documentation Updates", "status": "open", "priority": "P1", "type": "epic", "description": "Update all skills, router, and documentation to reference `cub task` exclusively. Remove `bd` from user-facing content.", "assignee": null, "labels": ["phase-3", "complexity:low", "model:haiku"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T11:45:10.092066", "updated_at": "2026-01-29T11:45:10.092067", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p1t.1", "title": "Extend TaskBackend protocol with 7 new methods", "status": "closed", "priority": "P0", "type": "task", "description": "The protocol needs 7 new methods for full lifecycle coverage. Also extend `update_task` to accept `title`, `priority`, and `notes` parameters. Create a `TaskBackendDefaults` mixin with default implementations for methods that can be derived from existing operations.\n\n**Implementation Steps:**\n1. Add 7 new method signatures to `TaskBackend` protocol in `backend.py`: `add_dependency`, `remove_dependency`, `list_blocked_tasks`, `reopen_task`, `delete_task`, `add_label`, `remove_label`\n2. Extend `update_task` signature with optional `title: str | None`, `priority: int | None`, `notes: str | None` parameters\n3. Create `TaskBackendDefaults` mixin class with default implementations:\n4. Add `blocked: int = 0` field to `TaskCounts` model\n5. Update type annotations and docstrings for all new methods\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/models.py", "assignee": "cub-20260129-115503", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.2", "cub-p1t.3", "cub-p1t.4"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463297", "updated_at": "2026-01-29T12:04:59.972632", "closed_at": "2026-01-29T12:04:59.972586", "acceptance_criteria": ["`TaskBackend` protocol has 19 methods (12 existing + 7 new)", "`update_task` accepts `title`, `priority`, `notes` optional params", "`TaskBackendDefaults` mixin has working default implementations", "`TaskCounts.blocked` field exists", "mypy passes with strict mode", "All new methods have complete docstrings"], "notes": "[Closed: 2026-01-29T12:04:59.972635] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-p1t.2", "title": "Implement new protocol methods in BeadsBackend", "status": "closed", "priority": "P0", "type": "task", "description": "BeadsBackend wraps the `bd` CLI. Each new protocol method needs a corresponding `bd` command wrapper. Follow the existing `_run_bd` pattern \u2014 bd commands that don't return JSON need a follow-up `get_task()` call.\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 run `bd dep add <task_id> <depends_on>`, then `get_task(task_id)`\n2. `remove_dependency(task_id, depends_on)` \u2014 run `bd dep remove <task_id> <depends_on>`, then `get_task(task_id)`\n3. `list_blocked_tasks(parent?)` \u2014 run `bd blocked --json` (or `bd list --status open --json` and filter), parse JSON output\n4. `reopen_task(task_id)` \u2014 run `bd update <id> --status open`, then `get_task(task_id)`\n5. `delete_task(task_id)` \u2014 run `bd delete <id>`, return True on success\n6. `add_label(task_id, label)` \u2014 run `bd label add <id> <label>`, then `get_task(task_id)`\n7. `remove_label(task_id, label)` \u2014 run `bd label remove <id> <label>`, then `get_task(task_id)`\n8. Extend `update_task` to pass `--title`, `--priority`, `--notes` flags when provided\n9. Update `get_task_counts` to include blocked count\n\n**Files:** src/cub/core/tasks/beads.py, tests/test_beads_backend.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463498", "updated_at": "2026-01-29T12:26:32.401999", "closed_at": "2026-01-29T12:26:32.401959", "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Error handling follows existing pattern (ValueError on not found)", "Unit tests pass for all new methods (mocked bd subprocess)"], "notes": "[Closed: 2026-01-29T12:26:32.402002] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-p1t.3", "title": "Implement new protocol methods in JsonlBackend", "status": "closed", "priority": "P0", "type": "task", "description": "JsonlBackend operates on an in-memory task list with atomic file writes. New methods manipulate task fields directly using existing Task model methods (`add_label()`, `remove_label()`, `reopen()`).\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 find task, append to `depends_on` list, save\n2. `remove_dependency(task_id, depends_on)` \u2014 find task, remove from `depends_on` list, save\n3. `list_blocked_tasks(parent?)` \u2014 filter: status=OPEN, has depends_on, not all deps closed\n4. `reopen_task(task_id)` \u2014 find task, call `task.reopen()`, save\n5. `delete_task(task_id)` \u2014 remove task from list, save, return True\n6. `add_label(task_id, label)` \u2014 find task, call `task.add_label(label)`, save\n7. `remove_label(task_id, label)` \u2014 find task, call `task.remove_label(label)`, save\n8. Extend `update_task` to handle title, priority, notes field updates\n9. Update `get_task_counts` to include blocked count\n10. All mutations use existing atomic write pattern (temp file \u2192 rename)\n\n**Files:** src/cub/core/tasks/jsonl.py, tests/test_jsonl_backend.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463520", "updated_at": "2026-01-29T12:32:41.078321", "closed_at": "2026-01-29T12:32:41.078307", "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Atomic writes for all mutations (no partial state)", "Unit tests pass for all new methods"], "notes": "[Closed: 2026-01-29T12:32:41.078323] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "closed", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:opus", "complexity:high"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463535", "updated_at": "2026-01-29T12:36:55.279963", "closed_at": "2026-01-29T12:36:55.279948", "acceptance_criteria": ["All 6 query methods return correct results for test topologies", "Cycle detection works and doesn't cause infinite loops in other methods", "Closed tasks are correctly excluded from graph (treated as resolved)", "`would_become_ready` checks ALL deps, not just the given task", "`root_blockers` correctly ranks by transitive impact", "`chains` returns paths sorted by length descending", "mypy passes with strict mode", "Tests cover: empty graph, single node, linear chain (5 deep), diamond dependency, forest (disconnected), cycle, mixed open/closed states"], "notes": "[Closed: 2026-01-29T12:36:55.279966] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-p1t.5", "title": "Update BothBackend and write cross-backend tests", "status": "closed", "priority": "P1", "type": "task", "description": "BothBackend delegates to primary and secondary backends. It needs to delegate all 7 new methods and log divergences. Also write parametrized tests that verify the same operations work identically across both backends.\n\n**Implementation Steps:**\n1. Update `BothBackend` to delegate all 7 new methods (follow existing delegation pattern)\n2. Inherit from `TaskBackendDefaults` as fallback\n3. Add divergence logging for new methods\n4. Write parametrized pytest tests that run the same test cases against BeadsBackend (mocked) and JsonlBackend (temp files)\n5. Test scenarios: add/remove dependency, list blocked, reopen, delete, add/remove label\n6. Verify `DependencyGraph` produces consistent results from both backend outputs\n\n**Files:** src/cub/core/tasks/both.py, tests/test_task_backends.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463550", "updated_at": "2026-01-29T12:46:37.958238", "closed_at": "2026-01-29T12:46:37.958218", "acceptance_criteria": ["BothBackend delegates all 7 new methods", "Divergence logging works for new methods", "Parametrized tests pass against both backends", "DependencyGraph produces same results regardless of backend", "mypy passes"], "notes": "[Closed: 2026-01-29T12:46:37.958240] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-p2c.1", "title": "Add cub task blocked command", "status": "in_progress", "priority": "P1", "type": "task", "description": "The most common gap \u2014 the router currently maps \"what's blocked\" to `bd blocked`. This command shows blocked tasks with optional epic filter. With `--agent`, it includes root blocker analysis and chain lengths from DependencyGraph.\n\n**Implementation Steps:**\n1. Add `blocked` command to task app in `cli/task.py`\n2. Parameters: `--epic` (filter), `--json`, `--agent`\n3. Rich output: table with ID, Priority, Title, Blocked By columns\n4. JSON output: task model dumps\n5. Agent output: call `AgentFormatter.format_blocked()` if available, otherwise fall back to a simple markdown table\n6. Build DependencyGraph from all tasks for analysis hints\n7. Show root blockers and chain summary in agent output\n\n**Files:** src/cub/cli/task.py", "assignee": "cub-20260129-124742", "labels": ["phase-2", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T11:46:17.463571", "updated_at": "2026-01-29T12:48:13.522238", "closed_at": null, "acceptance_criteria": ["`cub task blocked` shows blocked tasks in Rich table", "`--epic` filter works", "`--json` outputs task list as JSON", "`--agent` outputs structured markdown with analysis", "Empty result shows helpful message (\"No blocked tasks\")", "CLI test covers all three output modes"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-p2c.2", "title": "Add cub task dep add/remove and cub task label add/remove/list commands", "status": "open", "priority": "P1", "type": "task", "description": "Dependency and label management subcommands. These are simple CRUD wrappers around protocol methods with confirmation output.\n\n**Implementation Steps:**\n1. Create `dep` sub-app with `add` and `remove` commands\n2. `cub task dep add <task> <depends-on>` \u2014 calls `add_dependency()`, prints confirmation\n3. `cub task dep remove <task> <depends-on>` \u2014 calls `remove_dependency()`, prints confirmation\n4. Enhance existing `dep list` to show both directions (what this task depends on AND what depends on it)\n5. Create `label` sub-app with `add`, `remove`, `list` commands\n6. `cub task label add <task> <label>` \u2014 calls `add_label()`, prints confirmation\n7. `cub task label remove <task> <label>` \u2014 calls `remove_label()`, prints confirmation\n8. `cub task label list <task>` \u2014 calls `get_task()`, displays labels\n9. All commands support `--json` for machine output\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["phase-2", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T11:46:17.463585", "updated_at": "2026-01-29T11:46:17.463586", "closed_at": null, "acceptance_criteria": ["`cub task dep add/remove` work and confirm the operation", "`cub task dep list <id>` shows both directions", "`cub task label add/remove/list` work and confirm operations", "`--json` output works for all commands", "Error handling for invalid task IDs", "CLI tests for each command"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.3", "title": "Add cub task reopen and cub task delete commands", "status": "open", "priority": "P1", "type": "task", "description": "Lifecycle management commands. Reopen is straightforward. Delete is destructive and needs a confirmation prompt (skippable with `--force`).\n\n**Implementation Steps:**\n1. Add `reopen` command \u2014 calls `reopen_task()`, prints confirmation with task title\n2. Add `delete` command \u2014 prompts \"Delete task {id} '{title}'? [y/N]\" unless `--force` is passed\n3. Both support `--json` for machine output\n4. Error handling: task not found, task not in correct state (e.g., reopen a non-closed task)\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["phase-2", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T11:46:17.463596", "updated_at": "2026-01-29T11:46:17.463597", "closed_at": null, "acceptance_criteria": ["`cub task reopen <id>` reopens a closed task", "`cub task delete <id>` prompts for confirmation", "`cub task delete <id> --force` skips confirmation", "Error messages for invalid states (reopen non-closed, delete non-existent)", "CLI tests"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.4", "title": "Enhance existing cub task list, ready, create, update commands", "status": "open", "priority": "P1", "type": "task", "description": "Existing commands need additional filters and flags to reach parity. `list` and `ready` need `--epic` and `--assignee` filters. `create` needs full flag exposure. `update` needs `--title`, `--priority`, `--notes`.\n\n**Implementation Steps:**\n1. `cub task list`: add `--epic` (filter by parent), `--assignee` (filter by assignee) options\n2. `cub task ready`: add `--epic` filter, add `--by impact|priority` ordering option (impact uses DependencyGraph)\n3. `cub task create`: ensure CLI exposes `--type`, `--priority`, `--epic` (as `--parent`), `--description`, `--depends-on` (comma-separated list)\n4. `cub task update`: add `--title`, `--priority`, `--notes` flags alongside existing `--description`, `--assignee`, `--status`\n5. For `ready --by impact`: build DependencyGraph, sort tasks by `transitive_unblocks` count descending\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["phase-2", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T11:46:17.463607", "updated_at": "2026-01-29T11:46:17.463607", "closed_at": null, "acceptance_criteria": ["`cub task list --epic <id>` filters correctly", "`cub task list --assignee <name>` filters correctly", "`cub task ready --epic <id>` filters correctly", "`cub task ready --by impact` sorts by unblock count", "`cub task create` exposes all flags", "`cub task update` supports title, priority, notes", "CLI tests for new filters and flags"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.5", "title": "Add cub task search command", "status": "open", "priority": "P2", "type": "task", "description": "Full-text search across task titles and descriptions. BeadsBackend wraps `bd search`. JsonlBackend does substring match on title + description in memory. This is P2 but included since we're not excluding anything.\n\n**Implementation Steps:**\n1. Add `search_tasks(query: str) -> list[Task]` to `TaskBackend` protocol\n2. Implement in BeadsBackend: run `bd search <query> --json`, parse results\n3. Implement in JsonlBackend: case-insensitive substring match on title and description\n4. Add `search` command to task CLI: `cub task search <query>`\n5. Support `--json` and `--agent` output modes\n6. Show match count and results table\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/beads.py, src/cub/core/tasks/jsonl.py, src/cub/cli/task.py", "assignee": null, "labels": ["phase-2", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T11:46:17.463618", "updated_at": "2026-01-29T11:46:17.463619", "closed_at": null, "acceptance_criteria": ["`cub task search \"auth\"` finds tasks with \"auth\" in title or description", "Works with both backends", "`--json` and Rich output modes work", "Empty results show helpful message", "Tests for both backends"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-p3s.1", "title": "Update router skill and passthrough skills", "status": "open", "priority": "P1", "type": "task", "description": "The router skill (`.claude/commands/cub.md`) currently maps \"what's blocked\" to `bd blocked`. Passthrough skills reference `bd` commands. Update all to use `cub task` equivalents with `--agent` flag.\n\n**Implementation Steps:**\n1. In `.claude/commands/cub.md`:\n2. In `.claude/commands/cub:tasks.md`:\n3. Review other skill files for any remaining `bd` references\n\n**Files:** .claude/commands/cub.md, .claude/commands/cub:tasks.md", "assignee": null, "labels": ["phase-3", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-p3s", "created_at": "2026-01-29T11:46:17.463629", "updated_at": "2026-01-29T11:46:17.463629", "closed_at": null, "acceptance_criteria": ["Router skill has no `bd` references (except in \"power user\" context if desired)", "All task intent patterns route to `cub task` commands", "New subcommands (blocked, dep, label, reopen, delete, search) are in routing table", "`--agent` flag used in all command invocations within skills"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p3s.2", "title": "Update CLAUDE.md and PROMPT.md documentation", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md (agent instructions) and `.cub/PROMPT.md` (runloop instructions) reference `bd` commands in examples. Update all examples to use `cub task` equivalents. Keep `bd` mentioned only in the \"Pre-approved Commands\" section (bd is still available for power users).\n\n**Implementation Steps:**\n1. In CLAUDE.md:\n2. In `.cub/PROMPT.md`:\n3. Audit all `.md` files in `.cub/` directory for stale `bd` references\n\n**Files:** CLAUDE.md, .cub/PROMPT.md", "assignee": null, "labels": ["phase-3", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-p3s", "created_at": "2026-01-29T11:46:17.463639", "updated_at": "2026-01-29T11:46:17.463640", "closed_at": null, "acceptance_criteria": ["CLAUDE.md examples use `cub task` not `bd` (except Pre-approved section)", "PROMPT.md task instructions use `cub task`", "No stale `bd` references in user-facing documentation", "`bd` still listed as pre-approved for power users"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-a1f", "title": "agent-output #1: AgentFormatter & --agent Flag", "status": "open", "priority": "P0", "type": "epic", "description": "Build the AgentFormatter module and wire `--agent` flags into Phase 1 CLI commands (task ready, task show, status, suggest). This is the core value \u2014 Claude gets structured, compact markdown with pre-computed analysis hints instead of raw Rich output.", "assignee": null, "labels": ["phase-1", "complexity:high", "model:sonnet"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T11:46:50.492408", "updated_at": "2026-01-29T11:46:50.492428", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-a2s", "title": "agent-output #2: Skill Updates & Router Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Update all passthrough skill files and the router skill to use `--agent` flag in their CLI invocations. This closes the loop: `/cub` \u2192 router \u2192 `cub task ready --agent` \u2192 structured markdown \u2192 Claude interprets.", "assignee": null, "labels": ["phase-2", "complexity:low", "model:haiku"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T11:46:50.492616", "updated_at": "2026-01-29T11:46:50.492617", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-a3r", "title": "agent-output #3: Route Learning", "status": "open", "priority": "P1", "type": "epic", "description": "Build the hook-based route learning system: observe cub command usage via hooks, compile frequency data at session end, surface compiled routes to the router skill via file reference.", "assignee": null, "labels": ["phase-3", "complexity:medium", "model:sonnet"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T11:46:50.492636", "updated_at": "2026-01-29T11:46:50.492636", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-a4e", "title": "agent-output #4: Extended Commands", "status": "open", "priority": "P2", "type": "epic", "description": "Add `--agent` support to Phase 2 and Phase 3 commands. These depend on task parity (cub-task-parity) landing for `blocked` and `list`, and doctor refactor for `doctor`.", "assignee": null, "labels": ["phase-4", "complexity:medium", "model:sonnet"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T11:46:50.492652", "updated_at": "2026-01-29T11:46:50.492653", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-a1f.1", "title": "Build AgentFormatter module with Phase 1 format methods", "status": "open", "priority": "P0", "type": "task", "description": "The AgentFormatter is a collection of static methods that transform service-layer data into structured markdown for LLM consumption. Each method follows the envelope template: heading, summary line, data tables, truncation notice, analysis section. The formatter returns plain strings \u2014 no Rich, no console. DependencyGraph is an optional parameter; when None, analysis hints that require graph queries are omitted.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/agent_format.py` with `AgentFormatter` class\n2. Implement shared helpers:\n3. Implement `format_ready(tasks, graph=None)`:\n4. Implement `format_task_detail(task, graph=None, epic_progress=None)`:\n5. Implement `format_status(stats, epic_progress=None)`:\n6. Implement `format_suggestions(suggestions)`:\n7. Write snapshot tests for each method with representative inputs (0, 1, 10, 20 items)\n8. Write token budget test: assert output character count < 2000 for representative inputs\n\n**Files:** src/cub/core/services/agent_format.py, tests/test_agent_format.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:high"], "depends_on": [], "blocks": ["cub-a1f.2"], "parent": "cub-a1f", "created_at": "2026-01-29T11:47:42.431379", "updated_at": "2026-01-29T11:47:42.431403", "closed_at": null, "acceptance_criteria": ["All 4 format methods return valid markdown strings", "Output follows the envelope template (heading, summary, tables, truncation, analysis)", "Truncation works: shows all if \u2264 15 items, truncates to 10 with notice if > 15", "Analysis section omits graph-dependent hints when graph is None", "Analysis section includes graph-dependent hints when graph is provided", "No Rich or console dependencies \u2014 pure string operations", "Token budget: all representative outputs < 2000 characters", "mypy passes with strict mode", "Snapshot tests pass for each method"], "notes": "", "complexity_label": "high", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-a1f.2", "title": "Wire --agent flag into Phase 1 CLI commands", "status": "open", "priority": "P0", "type": "task", "description": "Add `--agent` flag to `cub task ready`, `cub task show`, `cub status`, and `cub suggest`. Follow the existing `--json` pattern. When `--agent` is passed, call the corresponding AgentFormatter method and print the result. `--agent` wins silently over `--json` if both are passed. Include `_try_build_graph` helper that attempts to import DependencyGraph (returns None if not available yet).\n\n**Implementation Steps:**\n1. Create `_try_build_graph(backend)` helper function in `cli/task.py`:\n2. In `cub task ready`:\n3. In `cub task show`:\n4. In `cub status` (status.py):\n5. In `cub suggest` (suggest.py):\n6. Write CLI integration tests for each command with `--agent` flag\n\n**Files:** src/cub/cli/task.py, src/cub/cli/status.py, src/cub/cli/suggest.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-a1f", "created_at": "2026-01-29T11:47:42.431536", "updated_at": "2026-01-29T11:47:42.431537", "closed_at": null, "acceptance_criteria": ["`cub task ready --agent` outputs structured markdown", "`cub task show <id> --agent` outputs structured markdown", "`cub status --agent` outputs structured markdown", "`cub suggest --agent` outputs structured markdown", "`--agent` takes precedence over `--json` silently", "`_try_build_graph` returns None gracefully when DependencyGraph not available", "`_try_build_graph` returns working graph when DependencyGraph is available", "CLI tests pass for all four commands"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-a2s.1", "title": "Update passthrough skills and router to use --agent", "status": "open", "priority": "P1", "type": "task", "description": "Seven passthrough skills exist and the router skill maps intent to CLI commands. Update all command invocations to include `--agent` so Claude always gets structured output when routing through skills. The router skill needs `--agent` on all CLI command mappings.\n\n**Implementation Steps:**\n1. Update `.claude/commands/cub:tasks.md`:\n2. Update `.claude/commands/cub:status.md`:\n3. Update `.claude/commands/cub:suggest.md`:\n4. Update `.claude/commands/cub:ledger.md`:\n5. Update `.claude/commands/cub:doctor.md`:\n6. Update `.claude/commands/cub.md` (router):\n7. Add instruction in router skill about how Claude should treat `--agent` output:\n\n**Files:** .claude/commands/cub.md, .claude/commands/cub:tasks.md, .claude/commands/cub:status.md, .claude/commands/cub:suggest.md, .claude/commands/cub:ledger.md, .claude/commands/cub:doctor.md", "assignee": null, "labels": ["phase-2", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-a2s", "created_at": "2026-01-29T11:47:42.431554", "updated_at": "2026-01-29T11:47:42.431555", "closed_at": null, "acceptance_criteria": ["All Phase 1 commands in skill files use `--agent`", "Router skill intent table uses `--agent` for all supported commands", "Router skill includes instruction on treating analysis hints", "Skills for commands without `--agent` support are left unchanged", "No broken command invocations"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-a3r.1", "title": "Add route observation to cub-hook.sh", "status": "open", "priority": "P1", "type": "task", "description": "The existing `cub-hook.sh` fast-path filter fires on every Bash tool use. It already detects `cub` commands for the symbiotic workflow. Extend it to log command usage to `.cub/route-log.jsonl`. This is 4 lines of shell \u2014 minimal latency impact.\n\n**Implementation Steps:**\n1. In `.cub/scripts/hooks/cub-hook.sh`, in the PostToolUse/Bash handler where `cub ` commands are detected:\n2. Add `.cub/route-log.jsonl` to `.gitignore` (raw log is local-only)\n3. Ensure the logging doesn't interfere with existing hook behavior (the line is additive)\n4. Test manually: run a `cub task ready` in Claude Code, verify log entry appears\n\n**Files:** .cub/scripts/hooks/cub-hook.sh, .gitignore", "assignee": null, "labels": ["phase-3", "model:haiku", "complexity:low"], "depends_on": [], "blocks": ["cub-a3r.2"], "parent": "cub-a3r", "created_at": "2026-01-29T11:47:42.431572", "updated_at": "2026-01-29T11:47:42.431572", "closed_at": null, "acceptance_criteria": ["Every `cub *` command executed via Bash tool use is logged to `.cub/route-log.jsonl`", "Log entries have ISO timestamp and full command string", "`.cub/route-log.jsonl` is in `.gitignore`", "Existing hook behavior is unchanged", "No measurable latency impact (shell echo + redirect)"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-a3r.2", "title": "Build route compiler and cub routes CLI", "status": "open", "priority": "P1", "type": "task", "description": "The route compiler reads the raw log, normalizes commands (strips task IDs, file paths), aggregates by frequency, filters noise (count < 3), and writes a markdown table to `.cub/learned-routes.md`. This compiled file is git-tracked and shared with the team. The compiler is triggered by the Stop hook at session end.\n\n**Implementation Steps:**\n1. Create `src/cub/core/routes/compiler.py`:\n2. Create `src/cub/core/routes/__init__.py`\n3. Create `src/cub/cli/routes.py`:\n4. Register routes app in `src/cub/cli/__init__.py`\n5. Add Stop hook trigger in `cub-hook.sh`:\n6. Write tests for `normalize_command` with edge cases (various command patterns)\n7. Write tests for `compile_routes` with sample JSONL input\n8. Write tests for `render_learned_routes` output format\n\n**Files:** src/cub/core/routes/__init__.py, src/cub/core/routes/compiler.py, src/cub/cli/routes.py, src/cub/cli/__init__.py, .cub/scripts/hooks/cub-hook.sh, tests/test_route_compiler.py", "assignee": null, "labels": ["phase-3", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-a3r.3"], "parent": "cub-a3r", "created_at": "2026-01-29T11:47:42.431583", "updated_at": "2026-01-29T11:47:42.431584", "closed_at": null, "acceptance_criteria": ["`normalize_command` correctly strips IDs and values from 10+ command patterns", "`compile_routes` aggregates correctly, filters count < 3, sorts by frequency", "`compile_routes` handles max_entries truncation for large logs", "`render_learned_routes` produces valid markdown table", "`cub routes compile` writes `.cub/learned-routes.md`", "`cub routes show` displays the compiled routes", "`cub routes clear` deletes both files", "Stop hook triggers compilation in background", "mypy passes", "Tests pass for normalizer, compiler, and renderer"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-a3r.3", "title": "Add learned routes section to router skill", "status": "open", "priority": "P1", "type": "task", "description": "The router skill needs to reference the compiled routes file so Claude can use frequency data as a tiebreaker for ambiguous intent. This is the only point where LLM judgment enters the route learning system.\n\n**Implementation Steps:**\n1. Add a \"Learned Routes\" section to `.claude/commands/cub.md`:\n2. Place this section after the \"Execution Rules\" section and before \"Examples\"\n3. The `@` prefix ensures Claude Code injects the file content into context\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-3", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-a3r", "created_at": "2026-01-29T11:47:42.431594", "updated_at": "2026-01-29T11:47:42.431595", "closed_at": null, "acceptance_criteria": ["Router skill references `@.cub/learned-routes.md`", "Instructions tell Claude to use learned routes as tiebreaker, not override", "Section is positioned logically in the skill file", "Skill still works correctly when learned-routes.md doesn't exist yet"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-a4e.1", "title": "Add AgentFormatter methods for blocked, list, and ledger", "status": "open", "priority": "P2", "type": "task", "description": "Three more commands get `--agent` support. `format_blocked` uses DependencyGraph heavily (root blockers, chain visualization). `format_list` is a general-purpose task table. `format_ledger` shows recent completions with cost summary. These depend on the task parity spec having landed `cub task blocked` and `cub task list` enhancements.\n\n**Implementation Steps:**\n1. Add `format_blocked(tasks, graph=None)` to AgentFormatter:\n2. Add `format_list(tasks)` to AgentFormatter:\n3. Add `format_ledger(entries, stats=None)` to AgentFormatter:\n4. Write snapshot tests for each method\n5. Write token budget tests\n\n**Files:** src/cub/core/services/agent_format.py, tests/test_agent_format.py", "assignee": null, "labels": ["phase-4", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-a4e.2"], "parent": "cub-a4e", "created_at": "2026-01-29T11:47:42.431604", "updated_at": "2026-01-29T11:47:42.431605", "closed_at": null, "acceptance_criteria": ["`format_blocked` produces correct output with and without graph", "`format_blocked` with graph shows root blockers and chains", "`format_list` produces correct output with truncation", "`format_ledger` produces correct output with cost summary", "All outputs < 2000 characters for representative inputs", "Snapshot tests pass"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-a4e.2", "title": "Wire --agent flag into blocked, list, and ledger CLI commands", "status": "open", "priority": "P2", "type": "task", "description": "Add `--agent` flag to `cub task blocked`, `cub task list`, and `cub ledger show`. These commands should already exist from the task parity spec. Wire in the AgentFormatter methods.\n\n**Implementation Steps:**\n1. In `cub task blocked` (cli/task.py):\n2. In `cub task list` (cli/task.py):\n3. In `cub ledger show` (cli/ledger.py):\n4. Update corresponding skill files to use `--agent`\n5. Write CLI tests\n\n**Files:** src/cub/cli/task.py, src/cub/cli/ledger.py, .claude/commands/cub:tasks.md, .claude/commands/cub:ledger.md", "assignee": null, "labels": ["phase-4", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-a4e", "created_at": "2026-01-29T11:47:42.431614", "updated_at": "2026-01-29T11:47:42.431615", "closed_at": null, "acceptance_criteria": ["`cub task blocked --agent` outputs structured markdown", "`cub task list --agent` outputs structured markdown", "`cub ledger show --agent` outputs structured markdown", "Skill files updated to use `--agent` for these commands", "CLI tests pass"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-a4e.3", "title": "Add --agent support for doctor command (requires refactor)", "status": "open", "priority": "P2", "type": "task", "description": "The doctor command currently prints directly via Rich console. To support `--agent`, it needs to return structured diagnostic results instead. This is a refactor of the existing doctor command internals, not just adding a flag.\n\n**Implementation Steps:**\n1. Define `DiagnosticResult` model (or use existing if one exists):\n2. Refactor doctor command to collect `list[DiagnosticResult]` before rendering\n3. Add `format_doctor(checks: list[DiagnosticResult])` to AgentFormatter:\n4. Add `--agent` flag to `cub doctor` command\n5. If agent: call `AgentFormatter.format_doctor(checks)`, print\n6. Ensure existing Rich output is unchanged when `--agent` is not passed\n7. Update `cub:doctor.md` skill to use `--agent`\n8. Write tests for both the refactored data collection and agent formatting\n\n**Files:** src/cub/cli/doctor.py, src/cub/core/services/agent_format.py, .claude/commands/cub:doctor.md, tests/test_agent_format.py", "assignee": null, "labels": ["phase-4", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-a4e", "created_at": "2026-01-29T11:47:42.431624", "updated_at": "2026-01-29T11:47:42.431625", "closed_at": null, "acceptance_criteria": ["Doctor command collects structured `DiagnosticResult` list before rendering", "Existing Rich output is unchanged (no regression)", "`cub doctor --agent` outputs structured markdown", "`format_doctor` produces correct output", "Skill file updated", "Tests pass for both output modes"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "difference_summary": "List length mismatch: 88 != 57"}
{"timestamp": "2026-01-29T12:50:26.674436", "operation": "list_blocked_tasks", "task_id": null, "primary_result": [{"id": "cub-a1f.2", "title": "Wire --agent flag into Phase 1 CLI commands", "status": "open", "priority": "P0", "type": "task", "description": "Add `--agent` flag to `cub task ready`, `cub task show`, `cub status`, and `cub suggest`. Follow the existing `--json` pattern. When `--agent` is passed, call the corresponding AgentFormatter method and print the result. `--agent` wins silently over `--json` if both are passed. Include `_try_build_graph` helper that attempts to import DependencyGraph (returns None if not available yet).\n\n**Implementation Steps:**\n1. Create `_try_build_graph(backend)` helper function in `cli/task.py`:\n2. In `cub task ready`:\n3. In `cub task show`:\n4. In `cub status` (status.py):\n5. In `cub suggest` (suggest.py):\n6. Write CLI integration tests for each command with `--agent` flag\n\n**Files:** src/cub/cli/task.py, src/cub/cli/status.py, src/cub/cli/suggest.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495119Z", "updated_at": "2026-01-29T11:46:55.683939-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r4h.2", "title": "Integration tests for exit scenarios", "status": "open", "priority": "P0", "type": "task", "description": "We need automated tests that verify clean exits on all paths. These tests ensure regressions are caught early.\n\n**Implementation Steps:**\n1. Add `pytest-timeout` to dev dependencies if not present\n2. Create `tests/integration/test_run_exits.py`\n3. Write tests for: Ctrl+C (SIGINT), SIGTERM, budget exhaustion, iteration limit reached, task failure\n4. Each test should verify: clean exit (no crash), status.json updated, run artifact created\n5. Use subprocess to run `cub run` and send signals\n\n**Files:** tests/integration/test_run_exits.py, pyproject.toml", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923515Z", "updated_at": "2026-01-26T16:32:00.156994-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r4h.3", "title": "Ensure artifacts on all exits", "status": "open", "priority": "P0", "type": "task", "description": "Based on audit findings, fix any exit paths that don't preserve artifacts. This is the core deliverable of E4.\n\n**Implementation Steps:**\n1. Review gaps identified in cub-r4h.1 audit\n2. Add try/finally blocks where needed to ensure `write_run_artifact()` is called\n3. Ensure `StatusWriter.write()` is called before any exit\n4. Handle edge cases: exceptions during artifact write, partial state\n5. Run integration tests to verify fixes\n\n**Files:** src/cub/cli/run.py, src/cub/core/status/writer.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923537Z", "updated_at": "2026-01-26T16:32:00.157257-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r5c.2", "title": "Implement CircuitBreaker class", "status": "open", "priority": "P0", "type": "task", "description": "The core circuit breaker logic. Uses asyncio timeout to detect hung harness execution.\n\n**Implementation Steps:**\n1. Create `src/cub/core/circuit_breaker.py`\n2. Implement `CircuitBreaker` class with:\n3. On timeout: raise `CircuitBreakerTripped` exception with clear message\n4. Handle graceful cancellation of the wrapped coroutine\n5. Write unit tests\n\n**Files:** src/cub/core/circuit_breaker.py, tests/unit/test_circuit_breaker.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923575Z", "updated_at": "2026-01-26T16:32:00.158012-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r5c.3", "title": "Integrate circuit breaker into run.py", "status": "open", "priority": "P0", "type": "task", "description": "Wire the circuit breaker into the run loop so harness invocations are timeout-protected.\n\n**Implementation Steps:**\n1. Import CircuitBreaker in `src/cub/cli/run.py`\n2. Create CircuitBreaker instance from config in run initialization\n3. Wrap `_invoke_harness()` call with `circuit_breaker.execute()`\n4. Handle `CircuitBreakerTripped` exception: log, update status, exit cleanly with artifacts\n5. Add circuit breaker status to run summary output\n\n**Files:** src/cub/cli/run.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923591Z", "updated_at": "2026-01-26T16:32:00.158242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-a3r.2", "title": "Build route compiler and cub routes CLI", "status": "open", "priority": "P1", "type": "task", "description": "The route compiler reads the raw log, normalizes commands (strips task IDs, file paths), aggregates by frequency, filters noise (count < 3), and writes a markdown table to `.cub/learned-routes.md`. This compiled file is git-tracked and shared with the team. The compiler is triggered by the Stop hook at session end.\n\n**Implementation Steps:**\n1. Create `src/cub/core/routes/compiler.py`:\n2. Create `src/cub/core/routes/__init__.py`\n3. Create `src/cub/cli/routes.py`:\n4. Register routes app in `src/cub/cli/__init__.py`\n5. Add Stop hook trigger in `cub-hook.sh`:\n6. Write tests for `normalize_command` with edge cases (various command patterns)\n7. Write tests for `compile_routes` with sample JSONL input\n8. Write tests for `render_learned_routes` output format\n\n**Files:** src/cub/core/routes/__init__.py, src/cub/core/routes/compiler.py, src/cub/cli/routes.py, src/cub/cli/__init__.py, .cub/scripts/hooks/cub-hook.sh, tests/test_route_compiler.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495159Z", "updated_at": "2026-01-29T11:46:55.684499-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-a3r.3", "title": "Add learned routes section to router skill", "status": "open", "priority": "P1", "type": "task", "description": "The router skill needs to reference the compiled routes file so Claude can use frequency data as a tiebreaker for ambiguous intent. This is the only point where LLM judgment enters the route learning system.\n\n**Implementation Steps:**\n1. Add a \"Learned Routes\" section to `.claude/commands/cub.md`:\n2. Place this section after the \"Execution Rules\" section and before \"Examples\"\n3. The `@` prefix ensures Claude Code injects the file content into context\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495168Z", "updated_at": "2026-01-29T11:46:55.684676-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r6s.2", "title": "Implement InstructionGenerator", "status": "open", "priority": "P1", "type": "task", "description": "Generate CLAUDE.md and AGENTS.md with workflow instructions that guide agents to use cub commands.\n\n**Implementation Steps:**\n1. Create `src/cub/core/instructions.py`\n2. Implement `generate_agents_md(project_dir, config)` - harness-agnostic instructions\n3. Implement `generate_claude_md(project_dir, config)` - Claude-specific additions\n4. Include sections: finding tasks (`cub status`), claiming work (`cub wip`), completing (`cub done`), logging (`cub log`)\n5. Include escape hatch language from E5\n6. Make output customizable via config (future: templates)\n\n**Files:** src/cub/core/instructions.py, tests/unit/test_instructions.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923641Z", "updated_at": "2026-01-26T16:32:00.159055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r6s.3", "title": "Update cub init for AGENTS.md", "status": "open", "priority": "P1", "type": "task", "description": "`cub init` should create AGENTS.md at project root for cross-harness compatibility.\n\n**Implementation Steps:**\n1. Update `src/cub/cli/init_cmd.py` to call InstructionGenerator\n2. Generate AGENTS.md at project root (not in .cub/)\n3. Generate/update CLAUDE.md at project root\n4. Don't overwrite if files exist (or prompt user)\n5. Add success message mentioning the files created\n\n**Files:** src/cub/cli/init_cmd.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923654Z", "updated_at": "2026-01-26T16:32:00.159256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r6s.6", "title": "Manual testing: direct session workflow", "status": "open", "priority": "P1", "type": "task", "description": "The ultimate validation: Marc runs Claude Code directly and verifies the ledger captures work naturally.\n\n**Implementation Steps:**\n1. Create test protocol in `plans/reliability-phase/e6-manual-tests.md`\n2. Scenarios: start direct session, claim task with `cub wip`, do work, complete with `cub done`\n3. Verify: ledger entry created, task status updated, session log captured\n4. Test friction: is the workflow natural? What's awkward?\n5. Document findings and iterate\n\n**Files:** plans/reliability-phase/e6-manual-tests.md", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923692Z", "updated_at": "2026-01-26T16:32:00.160048-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-a4e.2", "title": "Wire --agent flag into blocked, list, and ledger CLI commands", "status": "open", "priority": "P2", "type": "task", "description": "Add `--agent` flag to `cub task blocked`, `cub task list`, and `cub ledger show`. These commands should already exist from the task parity spec. Wire in the AgentFormatter methods.\n\n**Implementation Steps:**\n1. In `cub task blocked` (cli/task.py):\n2. In `cub task list` (cli/task.py):\n3. In `cub ledger show` (cli/ledger.py):\n4. Update corresponding skill files to use `--agent`\n5. Write CLI tests\n\n**Files:** src/cub/cli/task.py, src/cub/cli/ledger.py, .claude/commands/cub:tasks.md, .claude/commands/cub:ledger.md", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495183Z", "updated_at": "2026-01-29T11:46:55.685013-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-r6s.5", "title": "Implement hook handlers for artifact capture", "status": "open", "priority": "P2", "type": "task", "description": "Based on hook research, implement handlers to auto-capture artifacts when possible.\n\n**Implementation Steps:**\n1. Create `src/cub/core/harness/hooks.py`\n2. Implement `handle_hook_event(event_type, payload)` dispatcher\n3. For PostToolUse/Write: detect writes to plans/, log to ledger\n4. For Stop: capture session end, finalize any open ledger entries\n5. Parse payloads defensively (malformed \u2192 skip, don't crash)\n6. Create hook scripts for `.cub/hooks/` that call these handlers\n\n**Files:** src/cub/core/harness/hooks.py, .cub/hooks/", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923682Z", "updated_at": "2026-01-26T16:32:00.159779-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": "[]", "difference_summary": "List length mismatch: 22 != 0"}
{"timestamp": "2026-01-29T12:50:31.812269", "operation": "list_tasks", "task_id": null, "primary_result": [{"id": "cub-a1f.2", "title": "Wire --agent flag into Phase 1 CLI commands", "status": "open", "priority": "P0", "type": "task", "description": "Add `--agent` flag to `cub task ready`, `cub task show`, `cub status`, and `cub suggest`. Follow the existing `--json` pattern. When `--agent` is passed, call the corresponding AgentFormatter method and print the result. `--agent` wins silently over `--json` if both are passed. Include `_try_build_graph` helper that attempts to import DependencyGraph (returns None if not available yet).\n\n**Implementation Steps:**\n1. Create `_try_build_graph(backend)` helper function in `cli/task.py`:\n2. In `cub task ready`:\n3. In `cub task show`:\n4. In `cub status` (status.py):\n5. In `cub suggest` (suggest.py):\n6. Write CLI integration tests for each command with `--agent` flag\n\n**Files:** src/cub/cli/task.py, src/cub/cli/status.py, src/cub/cli/suggest.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-a1f", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495119Z", "updated_at": "2026-01-29T11:46:55.683939-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-a1f.1", "title": "Build AgentFormatter module with Phase 1 format methods", "status": "open", "priority": "P0", "type": "task", "description": "The AgentFormatter is a collection of static methods that transform service-layer data into structured markdown for LLM consumption. Each method follows the envelope template: heading, summary line, data tables, truncation notice, analysis section. The formatter returns plain strings \u2014 no Rich, no console. DependencyGraph is an optional parameter; when None, analysis hints that require graph queries are omitted.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/agent_format.py` with `AgentFormatter` class\n2. Implement shared helpers:\n3. Implement `format_ready(tasks, graph=None)`:\n4. Implement `format_task_detail(task, graph=None, epic_progress=None)`:\n5. Implement `format_status(stats, epic_progress=None)`:\n6. Implement `format_suggestions(suggestions)`:\n7. Write snapshot tests for each method with representative inputs (0, 1, 10, 20 items)\n8. Write token budget test: assert output character count < 2000 for representative inputs\n\n**Files:** src/cub/core/services/agent_format.py, tests/test_agent_format.py", "assignee": null, "labels": ["complexity:high", "epic:cub-a1f", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495070Z", "updated_at": "2026-01-29T11:46:55.683109-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-a1f", "title": "agent-output #1: AgentFormatter & --agent Flag", "status": "open", "priority": "P0", "type": "epic", "description": "Build the AgentFormatter module and wire `--agent` flags into Phase 1 CLI commands (task ready, task show, status, suggest). This is the core value \u2014 Claude gets structured, compact markdown with pre-computed analysis hints instead of raw Rich output.", "assignee": null, "labels": ["complexity:high", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:24.447456Z", "updated_at": "2026-01-29T11:46:29.681754-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-p1t", "title": "cub-task-parity #1: Protocol Extensions & DependencyGraph", "status": "open", "priority": "P0", "type": "epic", "description": "Extend the TaskBackend protocol with 7 new methods, implement them in BeadsBackend and JsonlBackend, extend `update_task` signature, and build the DependencyGraph class. This is the foundation that everything else depends on.", "assignee": null, "labels": ["complexity:high", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:44:49.313987Z", "updated_at": "2026-01-29T11:44:54.566273-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "open", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["cli", "feature", "phase-5"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707912Z", "updated_at": "2026-01-28T17:54:43.878390Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "open", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["core", "phase-1", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707841Z", "updated_at": "2026-01-28T17:54:43.875865Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1b", "title": "context-restructure #2: Foundation", "status": "open", "priority": "P0", "type": "epic", "description": "Build the demarcated section engine, constitution manager, and runloop prompt.", "assignee": null, "labels": ["core", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014075Z", "updated_at": "2026-01-28T03:34:52.132156Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r1a", "title": "context-restructure #1: Cleanup", "status": "in_progress", "priority": "P0", "type": "epic", "description": "Remove deprecated context files and references before building the new system.", "assignee": "cub-20260128-204328", "labels": ["phase-1", "setup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014034Z", "updated_at": "2026-01-29T09:37:07.870355-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-r6s.1", "title": "Create direct session CLI commands", "status": "open", "priority": "P0", "type": "task", "description": "Direct sessions need commands to record work. These are the integration layer between harness and ledger.\n\n**Implementation Steps:**\n1. Create `src/cub/cli/session.py` with Typer app\n2. Implement `cub log <message>` - adds timestamped entry to session log\n3. Implement `cub done <task-id> [--reason]` - marks task complete, creates ledger entry\n4. Implement `cub wip <task-id>` - marks task in-progress\n5. Register commands in main CLI app\n6. Add `source: \"direct_session\"` to ledger entries created by these commands\n\n**Files:** src/cub/cli/session.py, src/cub/cli/__init__.py", "assignee": null, "labels": ["cli", "complexity:medium", "epic:cub-r6s", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923630Z", "updated_at": "2026-01-26T16:32:00.158850-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-r5c.3", "title": "Integrate circuit breaker into run.py", "status": "open", "priority": "P0", "type": "task", "description": "Wire the circuit breaker into the run loop so harness invocations are timeout-protected.\n\n**Implementation Steps:**\n1. Import CircuitBreaker in `src/cub/cli/run.py`\n2. Create CircuitBreaker instance from config in run initialization\n3. Wrap `_invoke_harness()` call with `circuit_breaker.execute()`\n4. Handle `CircuitBreakerTripped` exception: log, update status, exit cleanly with artifacts\n5. Add circuit breaker status to run summary output\n\n**Files:** src/cub/cli/run.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-r5c", "integration", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923591Z", "updated_at": "2026-01-26T16:32:00.158242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-r5c.2", "title": "Implement CircuitBreaker class", "status": "open", "priority": "P0", "type": "task", "description": "The core circuit breaker logic. Uses asyncio timeout to detect hung harness execution.\n\n**Implementation Steps:**\n1. Create `src/cub/core/circuit_breaker.py`\n2. Implement `CircuitBreaker` class with:\n3. On timeout: raise `CircuitBreakerTripped` exception with clear message\n4. Handle graceful cancellation of the wrapped coroutine\n5. Write unit tests\n\n**Files:** src/cub/core/circuit_breaker.py, tests/unit/test_circuit_breaker.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-r5c", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923575Z", "updated_at": "2026-01-26T16:32:00.158012-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-r5c.1", "title": "Add CircuitBreakerConfig", "status": "open", "priority": "P0", "type": "task", "description": "Configuration must exist before we can implement the circuit breaker. This adds the config model and wires it into CubConfig.\n\n**Implementation Steps:**\n1. Add `CircuitBreakerConfig` class to `src/cub/core/config/models.py`\n2. Fields: `enabled: bool = True`, `timeout_minutes: int = 30`\n3. Add `circuit_breaker: CircuitBreakerConfig` field to `CubConfig`\n4. Add environment variable support: `CUB_CIRCUIT_BREAKER_ENABLED`, `CUB_CIRCUIT_BREAKER_TIMEOUT`\n5. Update config documentation\n\n**Files:** src/cub/core/config/models.py, docs/CONFIG.md", "assignee": null, "labels": ["complexity:low", "config", "epic:cub-r5c", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923564Z", "updated_at": "2026-01-26T16:32:00.157779-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 0}, {"id": "cub-r4h.3", "title": "Ensure artifacts on all exits", "status": "open", "priority": "P0", "type": "task", "description": "Based on audit findings, fix any exit paths that don't preserve artifacts. This is the core deliverable of E4.\n\n**Implementation Steps:**\n1. Review gaps identified in cub-r4h.1 audit\n2. Add try/finally blocks where needed to ensure `write_run_artifact()` is called\n3. Ensure `StatusWriter.write()` is called before any exit\n4. Handle edge cases: exceptions during artifact write, partial state\n5. Run integration tests to verify fixes\n\n**Files:** src/cub/cli/run.py, src/cub/core/status/writer.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-r4h", "fix", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923537Z", "updated_at": "2026-01-26T16:32:00.157257-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-r4h.2", "title": "Integration tests for exit scenarios", "status": "open", "priority": "P0", "type": "task", "description": "We need automated tests that verify clean exits on all paths. These tests ensure regressions are caught early.\n\n**Implementation Steps:**\n1. Add `pytest-timeout` to dev dependencies if not present\n2. Create `tests/integration/test_run_exits.py`\n3. Write tests for: Ctrl+C (SIGINT), SIGTERM, budget exhaustion, iteration limit reached, task failure\n4. Each test should verify: clean exit (no crash), status.json updated, run artifact created\n5. Use subprocess to run `cub run` and send signals\n\n**Files:** tests/integration/test_run_exits.py, pyproject.toml", "assignee": null, "labels": ["complexity:medium", "epic:cub-r4h", "model:sonnet", "phase-1", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923515Z", "updated_at": "2026-01-26T16:32:00.156994-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-r4h.1", "title": "Audit run.py exit paths", "status": "open", "priority": "P0", "type": "task", "description": "Before adding tests, we need to document current behavior. This audit identifies all exit paths and their current artifact-preservation status.\n\n**Implementation Steps:**\n1. Read through `src/cub/cli/run.py` and identify all exit points (return statements, sys.exit, exceptions)\n2. For each exit path, document: trigger condition, whether `write_run_artifact()` is called, whether status is persisted\n3. Identify gaps where artifacts might not be created\n4. Create a markdown document in `.cub/docs/` summarizing findings\n\n**Files:** src/cub/cli/run.py, .cub/docs/run-exit-paths.md", "assignee": null, "labels": ["audit", "complexity:medium", "epic:cub-r4h", "model:sonnet", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923445Z", "updated_at": "2026-01-26T16:32:00.156299-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-r5c", "title": "reliability-phase #2: Circuit Breaker", "status": "open", "priority": "P0", "type": "epic", "description": "Add timeout monitoring to harness execution. If no harness activity for 30 minutes, trip breaker and stop run with clear message. Prevents overnight runs from wasting hours on stuck tasks.", "assignee": null, "labels": ["circuit-breaker", "e5", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:34.004210Z", "updated_at": "2026-01-26T16:31:39.276468-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r4h", "title": "reliability-phase #1: Core Loop Hardening", "status": "open", "priority": "P0", "type": "epic", "description": "Verify and strengthen existing exit handling in `cub run`. The foundation is solid\u2014this is primarily testing, documentation, and edge case fixes. Goal: `cub run` exits cleanly on all paths with artifacts preserved.", "assignee": null, "labels": ["e4", "hardening", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:34.004176Z", "updated_at": "2026-01-26T16:31:39.275620-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-iyk", "title": "Phase 1: Foundation - Establish Stability Framework", "status": "open", "priority": "P0", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:53:12.334815-05:00", "updated_at": "2026-01-18T21:53:12.334815-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-a3r.3", "title": "Add learned routes section to router skill", "status": "open", "priority": "P1", "type": "task", "description": "The router skill needs to reference the compiled routes file so Claude can use frequency data as a tiebreaker for ambiguous intent. This is the only point where LLM judgment enters the route learning system.\n\n**Implementation Steps:**\n1. Add a \"Learned Routes\" section to `.claude/commands/cub.md`:\n2. Place this section after the \"Execution Rules\" section and before \"Examples\"\n3. The `@` prefix ensures Claude Code injects the file content into context\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["complexity:low", "epic:cub-a3r", "model:haiku", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495168Z", "updated_at": "2026-01-29T11:46:55.684676-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-a3r.1", "title": "Add route observation to cub-hook.sh", "status": "open", "priority": "P1", "type": "task", "description": "The existing `cub-hook.sh` fast-path filter fires on every Bash tool use. It already detects `cub` commands for the symbiotic workflow. Extend it to log command usage to `.cub/route-log.jsonl`. This is 4 lines of shell \u2014 minimal latency impact.\n\n**Implementation Steps:**\n1. In `.cub/scripts/hooks/cub-hook.sh`, in the PostToolUse/Bash handler where `cub ` commands are detected:\n2. Add `.cub/route-log.jsonl` to `.gitignore` (raw log is local-only)\n3. Ensure the logging doesn't interfere with existing hook behavior (the line is additive)\n4. Test manually: run a `cub task ready` in Claude Code, verify log entry appears\n\n**Files:** .cub/scripts/hooks/cub-hook.sh, .gitignore", "assignee": null, "labels": ["complexity:low", "epic:cub-a3r", "model:haiku", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495150Z", "updated_at": "2026-01-29T11:46:55.684328-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-a3r.2", "title": "Build route compiler and cub routes CLI", "status": "open", "priority": "P1", "type": "task", "description": "The route compiler reads the raw log, normalizes commands (strips task IDs, file paths), aggregates by frequency, filters noise (count < 3), and writes a markdown table to `.cub/learned-routes.md`. This compiled file is git-tracked and shared with the team. The compiler is triggered by the Stop hook at session end.\n\n**Implementation Steps:**\n1. Create `src/cub/core/routes/compiler.py`:\n2. Create `src/cub/core/routes/__init__.py`\n3. Create `src/cub/cli/routes.py`:\n4. Register routes app in `src/cub/cli/__init__.py`\n5. Add Stop hook trigger in `cub-hook.sh`:\n6. Write tests for `normalize_command` with edge cases (various command patterns)\n7. Write tests for `compile_routes` with sample JSONL input\n8. Write tests for `render_learned_routes` output format\n\n**Files:** src/cub/core/routes/__init__.py, src/cub/core/routes/compiler.py, src/cub/cli/routes.py, src/cub/cli/__init__.py, .cub/scripts/hooks/cub-hook.sh, tests/test_route_compiler.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-a3r", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495159Z", "updated_at": "2026-01-29T11:46:55.684499-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-a2s.1", "title": "Update passthrough skills and router to use --agent", "status": "open", "priority": "P1", "type": "task", "description": "Seven passthrough skills exist and the router skill maps intent to CLI commands. Update all command invocations to include `--agent` so Claude always gets structured output when routing through skills. The router skill needs `--agent` on all CLI command mappings.\n\n**Implementation Steps:**\n1. Update `.claude/commands/cub:tasks.md`:\n2. Update `.claude/commands/cub:status.md`:\n3. Update `.claude/commands/cub:suggest.md`:\n4. Update `.claude/commands/cub:ledger.md`:\n5. Update `.claude/commands/cub:doctor.md`:\n6. Update `.claude/commands/cub.md` (router):\n7. Add instruction in router skill about how Claude should treat `--agent` output:\n\n**Files:** .claude/commands/cub.md, .claude/commands/cub:tasks.md, .claude/commands/cub:status.md, .claude/commands/cub:suggest.md, .claude/commands/cub:ledger.md, .claude/commands/cub:doctor.md", "assignee": null, "labels": ["complexity:low", "epic:cub-a2s", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495139Z", "updated_at": "2026-01-29T11:46:55.684146-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-a3r", "title": "agent-output #3: Route Learning", "status": "open", "priority": "P1", "type": "epic", "description": "Build the hook-based route learning system: observe cub command usage via hooks, compile frequency data at session end, surface compiled routes to the router skill via file reference.", "assignee": null, "labels": ["complexity:medium", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:24.447509Z", "updated_at": "2026-01-29T11:46:29.682930-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-a2s", "title": "agent-output #2: Skill Updates & Router Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Update all passthrough skill files and the router skill to use `--agent` flag in their CLI invocations. This closes the loop: `/cub` \u2192 router \u2192 `cub task ready --agent` \u2192 structured markdown \u2192 Claude interprets.", "assignee": null, "labels": ["complexity:low", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:24.447498Z", "updated_at": "2026-01-29T11:46:29.682667-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.4", "title": "Enhance existing cub task list, ready, create, update commands", "status": "open", "priority": "P1", "type": "task", "description": "Existing commands need additional filters and flags to reach parity. `list` and `ready` need `--epic` and `--assignee` filters. `create` needs full flag exposure. `update` needs `--title`, `--priority`, `--notes`.\n\n**Implementation Steps:**\n1. `cub task list`: add `--epic` (filter by parent), `--assignee` (filter by assignee) options\n2. `cub task ready`: add `--epic` filter, add `--by impact|priority` ordering option (impact uses DependencyGraph)\n3. `cub task create`: ensure CLI exposes `--type`, `--priority`, `--epic` (as `--parent`), `--description`, `--depends-on` (comma-separated list)\n4. `cub task update`: add `--title`, `--priority`, `--notes` flags alongside existing `--description`, `--assignee`, `--status`\n5. For `ready --by impact`: build DependencyGraph, sort tasks by `transitive_unblocks` count descending\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p2c", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094200Z", "updated_at": "2026-01-29T11:45:15.286499-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p3s.1", "title": "Update router skill and passthrough skills", "status": "open", "priority": "P1", "type": "task", "description": "The router skill (`.claude/commands/cub.md`) currently maps \"what's blocked\" to `bd blocked`. Passthrough skills reference `bd` commands. Update all to use `cub task` equivalents with `--agent` flag.\n\n**Implementation Steps:**\n1. In `.claude/commands/cub.md`:\n2. In `.claude/commands/cub:tasks.md`:\n3. Review other skill files for any remaining `bd` references\n\n**Files:** .claude/commands/cub.md, .claude/commands/cub:tasks.md", "assignee": null, "labels": ["complexity:low", "epic:cub-p3s", "model:haiku", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094216Z", "updated_at": "2026-01-29T11:45:15.286843-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.3", "title": "Add cub task reopen and cub task delete commands", "status": "open", "priority": "P1", "type": "task", "description": "Lifecycle management commands. Reopen is straightforward. Delete is destructive and needs a confirmation prompt (skippable with `--force`).\n\n**Implementation Steps:**\n1. Add `reopen` command \u2014 calls `reopen_task()`, prints confirmation with task title\n2. Add `delete` command \u2014 prompts \"Delete task {id} '{title}'? [y/N]\" unless `--force` is passed\n3. Both support `--json` for machine output\n4. Error handling: task not found, task not in correct state (e.g., reopen a non-closed task)\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["complexity:low", "epic:cub-p2c", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094193Z", "updated_at": "2026-01-29T11:45:15.286309-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.2", "title": "Add cub task dep add/remove and cub task label add/remove/list commands", "status": "open", "priority": "P1", "type": "task", "description": "Dependency and label management subcommands. These are simple CRUD wrappers around protocol methods with confirmation output.\n\n**Implementation Steps:**\n1. Create `dep` sub-app with `add` and `remove` commands\n2. `cub task dep add <task> <depends-on>` \u2014 calls `add_dependency()`, prints confirmation\n3. `cub task dep remove <task> <depends-on>` \u2014 calls `remove_dependency()`, prints confirmation\n4. Enhance existing `dep list` to show both directions (what this task depends on AND what depends on it)\n5. Create `label` sub-app with `add`, `remove`, `list` commands\n6. `cub task label add <task> <label>` \u2014 calls `add_label()`, prints confirmation\n7. `cub task label remove <task> <label>` \u2014 calls `remove_label()`, prints confirmation\n8. `cub task label list <task>` \u2014 calls `get_task()`, displays labels\n9. All commands support `--json` for machine output\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p2c", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094184Z", "updated_at": "2026-01-29T11:45:15.286106-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.1", "title": "Add cub task blocked command", "status": "in_progress", "priority": "P1", "type": "task", "description": "The most common gap \u2014 the router currently maps \"what's blocked\" to `bd blocked`. This command shows blocked tasks with optional epic filter. With `--agent`, it includes root blocker analysis and chain lengths from DependencyGraph.\n\n**Implementation Steps:**\n1. Add `blocked` command to task app in `cli/task.py`\n2. Parameters: `--epic` (filter), `--json`, `--agent`\n3. Rich output: table with ID, Priority, Title, Blocked By columns\n4. JSON output: task model dumps\n5. Agent output: call `AgentFormatter.format_blocked()` if available, otherwise fall back to a simple markdown table\n6. Build DependencyGraph from all tasks for analysis hints\n7. Show root blockers and chain summary in agent output\n\n**Files:** src/cub/cli/task.py", "assignee": "cub-20260129-124742", "labels": ["complexity:medium", "epic:cub-p2c", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094176Z", "updated_at": "2026-01-29T12:48:25.480755-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-p3s", "title": "cub-task-parity #3: Skill & Documentation Updates", "status": "open", "priority": "P1", "type": "epic", "description": "Update all skills, router, and documentation to reference `cub task` exclusively. Remove `bd` from user-facing content.", "assignee": null, "labels": ["complexity:low", "model:haiku", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:44:49.314043Z", "updated_at": "2026-01-29T11:44:54.567497-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c", "title": "cub-task-parity #2: CLI Subcommands", "status": "open", "priority": "P1", "type": "epic", "description": "Add CLI commands for all new protocol operations. Each command supports three output modes: Rich (default), `--json`, `--agent`.", "assignee": null, "labels": ["complexity:medium", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:44:49.314028Z", "updated_at": "2026-01-29T11:44:54.567280-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "open", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["core", "feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707904Z", "updated_at": "2026-01-28T17:54:43.877594Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "open", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["architecture", "core", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707895Z", "updated_at": "2026-01-28T17:54:43.876987Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "open", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["cleanup", "core", "phase-2", "refactor"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707880Z", "updated_at": "2026-01-28T17:54:43.876551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-v8n", "title": "symbiotic-workflow #2: Session Ledger Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Connect hook events to the ledger system so direct session work produces real ledger entries. Decouple ledger integration from the run loop so it works from either path.", "assignee": null, "labels": ["integration", "ledger", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008234Z", "updated_at": "2026-01-28T03:37:44.169647Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1c", "title": "context-restructure #3: Project Map", "status": "open", "priority": "P1", "type": "epic", "description": "Build the `cub map` command with structural analysis and tree-sitter code", "assignee": null, "labels": ["feature", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014090Z", "updated_at": "2026-01-28T03:34:52.132664Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r1d", "title": "context-restructure #4: Task Prompt Enrichment", "status": "open", "priority": "P1", "type": "epic", "description": "Add epic context, sibling awareness, and retry injection to task prompts.", "assignee": null, "labels": ["feature", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:34:52.014099Z", "updated_at": "2026-01-28T03:34:52.133261Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r6s.6", "title": "Manual testing: direct session workflow", "status": "open", "priority": "P1", "type": "task", "description": "The ultimate validation: Marc runs Claude Code directly and verifies the ledger captures work naturally.\n\n**Implementation Steps:**\n1. Create test protocol in `plans/reliability-phase/e6-manual-tests.md`\n2. Scenarios: start direct session, claim task with `cub wip`, do work, complete with `cub done`\n3. Verify: ledger entry created, task status updated, session log captured\n4. Test friction: is the workflow natural? What's awkward?\n5. Document findings and iterate\n\n**Files:** plans/reliability-phase/e6-manual-tests.md", "assignee": null, "labels": ["checkpoint", "complexity:low", "epic:cub-r6s", "model:haiku", "phase-3", "test"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923692Z", "updated_at": "2026-01-26T16:32:00.160048-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-r6s.4", "title": "Research Claude Code hooks", "status": "open", "priority": "P1", "type": "task", "description": "Understand what hooks Claude Code exposes for artifact capture. This informs whether we can auto-capture or must rely on instructions.\n\n**Implementation Steps:**\n1. Review Claude Code documentation for hooks system\n2. Test available hook events: PreToolUse, PostToolUse, Stop, PermissionRequest\n3. Document payload structure for each relevant event\n4. Identify: can we detect session start/end? Can we capture plan content?\n5. Write findings to `.cub/docs/claude-code-hooks.md`\n\n**Files:** .cub/docs/claude-code-hooks.md", "assignee": null, "labels": ["complexity:medium", "epic:cub-r6s", "model:sonnet", "phase-3", "research"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923670Z", "updated_at": "2026-01-26T16:32:00.159524-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-r6s.3", "title": "Update cub init for AGENTS.md", "status": "open", "priority": "P1", "type": "task", "description": "`cub init` should create AGENTS.md at project root for cross-harness compatibility.\n\n**Implementation Steps:**\n1. Update `src/cub/cli/init_cmd.py` to call InstructionGenerator\n2. Generate AGENTS.md at project root (not in .cub/)\n3. Generate/update CLAUDE.md at project root\n4. Don't overwrite if files exist (or prompt user)\n5. Add success message mentioning the files created\n\n**Files:** src/cub/cli/init_cmd.py", "assignee": null, "labels": ["cli", "complexity:low", "epic:cub-r6s", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923654Z", "updated_at": "2026-01-26T16:32:00.159256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-r6s.2", "title": "Implement InstructionGenerator", "status": "open", "priority": "P1", "type": "task", "description": "Generate CLAUDE.md and AGENTS.md with workflow instructions that guide agents to use cub commands.\n\n**Implementation Steps:**\n1. Create `src/cub/core/instructions.py`\n2. Implement `generate_agents_md(project_dir, config)` - harness-agnostic instructions\n3. Implement `generate_claude_md(project_dir, config)` - Claude-specific additions\n4. Include sections: finding tasks (`cub status`), claiming work (`cub wip`), completing (`cub done`), logging (`cub log`)\n5. Include escape hatch language from E5\n6. Make output customizable via config (future: templates)\n\n**Files:** src/cub/core/instructions.py, tests/unit/test_instructions.py", "assignee": null, "labels": ["complexity:medium", "core", "epic:cub-r6s", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923641Z", "updated_at": "2026-01-26T16:32:00.159055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-r5c.5", "title": "Add \"giving up\" escape hatch to prompts", "status": "open", "priority": "P1", "type": "task", "description": "Complement time-based detection with agent self-awareness. Add instruction letting agents signal when they're stuck.\n\n**Implementation Steps:**\n1. Update `templates/PROMPT.md` with escape hatch section\n2. Add instruction: \"If you are stuck and cannot make progress, output: <stuck>REASON</stuck>\"\n3. Document that this complements (doesn't replace) circuit breaker\n4. Consider: should run.py detect this signal? (Future enhancement, document but don't implement)\n\n**Files:** templates/PROMPT.md", "assignee": null, "labels": ["checkpoint", "complexity:low", "epic:cub-r5c", "model:haiku", "phase-2", "prompt"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923617Z", "updated_at": "2026-01-26T16:32:00.158649-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-r5c.4", "title": "Add --no-circuit-breaker CLI flag", "status": "open", "priority": "P1", "type": "task", "description": "Users need ability to disable circuit breaker for legitimately long operations.\n\n**Implementation Steps:**\n1. Add `--no-circuit-breaker` flag to `cub run` command\n2. Flag sets `config.circuit_breaker.enabled = False`\n3. Document flag in `cub run --help`\n4. Add example to README showing when to use it\n\n**Files:** src/cub/cli/run.py, README.md", "assignee": null, "labels": ["cli", "complexity:low", "epic:cub-r5c", "model:haiku", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923605Z", "updated_at": "2026-01-26T16:32:00.158452-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-r4h.4", "title": "Manual testing protocol for E4", "status": "open", "priority": "P1", "type": "task", "description": "Automated tests can't catch everything. Create a checklist for Marc to manually validate exit behavior.\n\n**Implementation Steps:**\n1. Create manual test checklist in `plans/reliability-phase/e4-manual-tests.md`\n2. Include scenarios: overnight run, Ctrl+C at various points, kill -9, budget warning then exhaustion\n3. Document expected behavior and what to check (files created, messages shown)\n4. Include recovery steps if something goes wrong\n\n**Files:** plans/reliability-phase/e4-manual-tests.md", "assignee": null, "labels": ["checkpoint", "complexity:low", "docs", "epic:cub-r4h", "model:haiku", "phase-1"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923553Z", "updated_at": "2026-01-26T16:32:00.157500-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-r6s", "title": "reliability-phase #3: Symbiotic Workflow", "status": "open", "priority": "P1", "type": "epic", "description": "Unified audit trail for direct harness sessions. When users run Claude Code/Codex directly, CLAUDE.md/AGENTS.md instructions + hooks ensure ledger captures equivalent records to `cub run`.", "assignee": null, "labels": ["e6", "phase-3", "symbiotic"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:34.004222Z", "updated_at": "2026-01-26T16:31:39.276695-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-jm48", "title": "Fix bootstrap: detect ID collisions before import", "status": "open", "priority": "P1", "type": "task", "description": "When bootstrap imports tasks, it silently fails if IDs already exist in the database. The import reports '0 created, 0 updated, N unchanged' with no warning about the collision.\n\n**Root cause**: cmd_bootstrap() in cmd_prep.sh calls bd import without checking for existing IDs first.\n\n**Fix**: Before import, query existing IDs and compare against plan.jsonl. If collisions found, either:\n1. Error with a clear message listing conflicting IDs\n2. Offer --force flag to overwrite\n3. Offer --rename-on-import to use fresh IDs\n\n**Files**: src/cub/bash/lib/cmd_prep.sh (lines 1194-1387)", "assignee": null, "labels": ["bootstrap-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T22:08:19.917655-05:00", "updated_at": "2026-01-18T22:12:51.503055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-k5sk", "title": "Create contract tests for harness CLIs", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:50.349806-05:00", "updated_at": "2026-01-18T21:55:50.349806-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-b305", "title": "Add tests for core/harness/codex.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:45.154242-05:00", "updated_at": "2026-01-18T21:55:45.154242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-l6fi", "title": "Add tests for core/pr/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:39.963466-05:00", "updated_at": "2026-01-18T21:55:39.963466-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-4laj", "title": "Add tests for core/tasks/service.py", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-6jpc"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:34.770810-05:00", "updated_at": "2026-01-18T21:55:34.770810-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-CAP", "title": "Feature: Capture - Idea Collection System", "status": "open", "priority": "P1", "type": "epic", "description": "# Epic: Capture - Idea Collection System\n\n## Overview\n\n`cub capture` provides low-friction idea collection\u2014a scratchpad for thoughts, links, observations, and inspiration that feeds into the vision-to-tasks pipeline.\n\n## Goals\n\n- Zero friction: Capture an idea in seconds\n- Human-editable: Markdown files that can be manually created/edited\n- Searchable: Find captures by tag, content, or time\n- Progressive: Ideas can be refined through interactive sessions\n- Portable: Global captures for ideas not yet tied to a project\n\n## Success Criteria\n\n- `cub capture \"text\"` creates a file in `captures/` in < 1 second\n- `cub captures` lists captures with readable Rich table output\n- `cub capture -i` / `/cub:capture` guides user through structured capture session\n- Manually-created .md files are recognized and normalized by `organize-captures`\n- Global captures work when outside any git repository\n- `cub captures import` brings global captures into a project", "assignee": null, "labels": ["feature:capture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T14:40:04.949006-05:00", "updated_at": "2026-01-16T14:40:04.949006-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-a4e.3", "title": "Add --agent support for doctor command (requires refactor)", "status": "open", "priority": "P2", "type": "task", "description": "The doctor command currently prints directly via Rich console. To support `--agent`, it needs to return structured diagnostic results instead. This is a refactor of the existing doctor command internals, not just adding a flag.\n\n**Implementation Steps:**\n1. Define `DiagnosticResult` model (or use existing if one exists):\n2. Refactor doctor command to collect `list[DiagnosticResult]` before rendering\n3. Add `format_doctor(checks: list[DiagnosticResult])` to AgentFormatter:\n4. Add `--agent` flag to `cub doctor` command\n5. If agent: call `AgentFormatter.format_doctor(checks)`, print\n6. Ensure existing Rich output is unchanged when `--agent` is not passed\n7. Update `cub:doctor.md` skill to use `--agent`\n8. Write tests for both the refactored data collection and agent formatting\n\n**Files:** src/cub/cli/doctor.py, src/cub/core/services/agent_format.py, .claude/commands/cub:doctor.md, tests/test_agent_format.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-a4e", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495194Z", "updated_at": "2026-01-29T11:46:55.685189-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-a4e.2", "title": "Wire --agent flag into blocked, list, and ledger CLI commands", "status": "open", "priority": "P2", "type": "task", "description": "Add `--agent` flag to `cub task blocked`, `cub task list`, and `cub ledger show`. These commands should already exist from the task parity spec. Wire in the AgentFormatter methods.\n\n**Implementation Steps:**\n1. In `cub task blocked` (cli/task.py):\n2. In `cub task list` (cli/task.py):\n3. In `cub ledger show` (cli/ledger.py):\n4. Update corresponding skill files to use `--agent`\n5. Write CLI tests\n\n**Files:** src/cub/cli/task.py, src/cub/cli/ledger.py, .claude/commands/cub:tasks.md, .claude/commands/cub:ledger.md", "assignee": null, "labels": ["complexity:medium", "epic:cub-a4e", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495183Z", "updated_at": "2026-01-29T11:46:55.685013-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-a4e.1", "title": "Add AgentFormatter methods for blocked, list, and ledger", "status": "open", "priority": "P2", "type": "task", "description": "Three more commands get `--agent` support. `format_blocked` uses DependencyGraph heavily (root blockers, chain visualization). `format_list` is a general-purpose task table. `format_ledger` shows recent completions with cost summary. These depend on the task parity spec having landed `cub task blocked` and `cub task list` enhancements.\n\n**Implementation Steps:**\n1. Add `format_blocked(tasks, graph=None)` to AgentFormatter:\n2. Add `format_list(tasks)` to AgentFormatter:\n3. Add `format_ledger(entries, stats=None)` to AgentFormatter:\n4. Write snapshot tests for each method\n5. Write token budget tests\n\n**Files:** src/cub/core/services/agent_format.py, tests/test_agent_format.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-a4e", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495175Z", "updated_at": "2026-01-29T11:46:55.684841-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-a4e", "title": "agent-output #4: Extended Commands", "status": "open", "priority": "P2", "type": "epic", "description": "Add `--agent` support to Phase 2 and Phase 3 commands. These depend on task parity (cub-task-parity) landing for `blocked` and `list`, and doctor refactor for `doctor`.", "assignee": null, "labels": ["complexity:medium", "model:sonnet", "phase-4"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:24.447519Z", "updated_at": "2026-01-29T11:46:29.683108-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-p3s.2", "title": "Update CLAUDE.md and PROMPT.md documentation", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md (agent instructions) and `.cub/PROMPT.md` (runloop instructions) reference `bd` commands in examples. Update all examples to use `cub task` equivalents. Keep `bd` mentioned only in the \"Pre-approved Commands\" section (bd is still available for power users).\n\n**Implementation Steps:**\n1. In CLAUDE.md:\n2. In `.cub/PROMPT.md`:\n3. Audit all `.md` files in `.cub/` directory for stale `bd` references\n\n**Files:** CLAUDE.md, .cub/PROMPT.md", "assignee": null, "labels": ["complexity:low", "epic:cub-p3s", "model:haiku", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094223Z", "updated_at": "2026-01-29T11:45:15.287011-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-p2c.5", "title": "Add cub task search command", "status": "open", "priority": "P2", "type": "task", "description": "Full-text search across task titles and descriptions. BeadsBackend wraps `bd search`. JsonlBackend does substring match on title + description in memory. This is P2 but included since we're not excluding anything.\n\n**Implementation Steps:**\n1. Add `search_tasks(query: str) -> list[Task]` to `TaskBackend` protocol\n2. Implement in BeadsBackend: run `bd search <query> --json`, parse results\n3. Implement in JsonlBackend: case-insensitive substring match on title and description\n4. Add `search` command to task CLI: `cub task search <query>`\n5. Support `--json` and `--agent` output modes\n6. Show match count and results table\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/beads.py, src/cub/core/tasks/jsonl.py, src/cub/cli/task.py", "assignee": null, "labels": ["complexity:medium", "epic:cub-p2c", "model:sonnet", "phase-2"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:45:10.094208Z", "updated_at": "2026-01-29T11:45:15.286678-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-ezpv", "title": "Add newlines between streamed messages in cub run", "status": "open", "priority": "P2", "type": "task", "description": "When `cub run --stream` is enabled, consecutive messages from the AI harness are concatenated without visual separation, making output difficult to read. Each message should be followed by a newline for clarity.\n\n**Current behavior:**\n```\nRunning claude...\nI'll help you implement...Good! Now let me check...Perfect! Now let me explore...\n```\n\n**Expected behavior:**\n```\nRunning claude...\nI'll help you implement...\n\nGood! Now let me check...\n\nPerfect! Now let me explore...\n```\n\n**Acceptance Criteria:**\n- Each streamed message is followed by a newline character\n- Output remains readable and properly formatted\n- Does not affect non-stream output\n- Works with all harness backends (claude, codex, gemini, etc.)", "assignee": null, "labels": ["epic:cub-8av0", "punchlist"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T19:49:00.029599-05:00", "updated_at": "2026-01-28T19:49:05.319793-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-wz1m", "title": "Add harness and model info to task headline", "status": "open", "priority": "P2", "type": "task", "description": "When starting a task iteration, the headline box should display the harness backend, model, and any other explicitly configured specs alongside the existing task metadata.\n\n**Current behavior:**\nThe headline box shows: Task ID, Title, Priority, Type, Iteration\n\n**Desired behavior:**\nInclude additional configuration details in the headline, such as:\n- Harness backend (e.g., \"claude\", \"gemini\")\n- Model (e.g., \"claude-opus-4.5\", \"gemini-2.0\")\n- Any other explicit specs from the task config or run context\n\n**Acceptance criteria:**\n- [ ] Headline box displays harness backend when available\n- [ ] Headline box displays model name when available\n- [ ] Other explicit specs are included if applicable\n- [ ] Layout remains readable (no excessive line wrapping)\n- [ ] Specs are omitted gracefully if not configured (no \"None\" values displayed)\n- [ ] Changes apply to both `cub run` and direct session contexts", "assignee": null, "labels": ["epic:cub-8av0", "punchlist"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T19:48:39.101778-05:00", "updated_at": "2026-01-28T19:48:44.355712-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-n57z", "title": "Remove deprecated cub:triage and cub:plan commands", "status": "open", "priority": "P2", "type": "task", "description": "Remove the `cub:triage` and `cub:plan` skill commands from the codebase. These commands are no longer needed and don't require backward compatibility maintenance.\n\n**Changes needed:**\n1. Remove `cub:triage` and `cub:plan` from skill/command templates\n2. Remove these commands from `.claude/commands` configuration\n3. Remove any references or registrations in the codebase that support these skills\n\n**Acceptance criteria:**\n- `cub:triage` and `cub:plan` no longer appear in any templates or configuration files\n- No skill registration or command routing code supports these commands\n- Remaining skills and commands continue to function correctly\n- No broken references to removed commands", "assignee": null, "labels": ["epic:cub-8av0", "punchlist"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T19:48:18.010514-05:00", "updated_at": "2026-01-28T19:48:23.298384-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-rcei", "title": "Ensure plan.json is created at pipeline start, not after orient begins", "status": "open", "priority": "P2", "type": "task", "description": "plan.json is currently first written during the orient stage (after start_stage() is called), rather than when the plan context is initially created. This means if orient fails before that point, there's no plan.json to recover from.\n\n**Current behavior:**\n- PlanContext.create() initializes a Plan object in memory\n- Pipeline runs orient stage, which calls ctx.save_plan() at line 484\n- plan.json is written at that point\n\n**Proposed improvement:**\n- Call ctx.save_plan() immediately after creating or loading the plan context in PipelineConfig.run()\n- Ensures plan.json exists before any stage runs\n- Improves fault tolerance and allows resuming even if orient fails early\n\n**Acceptance criteria:**\n- plan.json is created when plan context is first created\n- plan.json exists before orient stage runs\n- Existing pipeline behavior unchanged (all tests pass)\n- Plan data is accessible for recovery/resumption even if stages fail early", "assignee": null, "labels": ["epic:cub-8av0", "punchlist"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T19:47:56.958004-05:00", "updated_at": "2026-01-28T19:48:02.229409-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-tmrm", "title": "Add build failure detection and retry logic to cub pr", "status": "open", "priority": "P2", "type": "task", "description": "The `cub pr` command should monitor PR checks (CI messages, build failures) and automatically retry or re-trigger them after a configurable timeout when failures are detected.\n\n**Context:**\nCurrently, `cub pr` creates a pull request but doesn't actively monitor the status of CI checks and build results. This means failures that could be transient (flaky tests, rate limits, temporary service issues) require manual intervention to retry.\n\n**Requirements:**\n- Monitor PR checks via `gh pr checks` after creating a PR\n- Detect build failures, CI errors, and other check failures\n- When failures are detected, start a 10-minute timer (configurable via flag or config)\n- After timer expires, automatically retry failed checks or re-trigger CI\n- Continue monitoring until checks pass or max retries reached\n- Log all check statuses and retry attempts to session ledger\n- Gracefully handle network errors and API rate limiting\n\n**Acceptance Criteria:**\n- [ ] `cub pr` detects and logs PR check failures\n- [ ] Automatic 10-minute retry timer kicks off when failures detected\n- [ ] `--retry-timeout` flag allows customization (e.g., `--retry-timeout 5m`)\n- [ ] `--no-retry` flag disables auto-retry behavior\n- [ ] Checks are re-triggered via `gh pr checks --rerun` or similar\n- [ ] Session ledger captures retry history with timestamps\n- [ ] Max retries (default 3) prevents infinite loops\n- [ ] Works with both draft and regular PRs", "assignee": null, "labels": ["epic:cub-8av0", "punchlist"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T19:47:35.895643-05:00", "updated_at": "2026-01-28T19:47:41.163960-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-zpxr", "title": "Check completed steps before launching architect in plan run exit", "status": "open", "priority": "P2", "type": "task", "description": "When exiting `cub plan run`, the system should inspect which steps have already been completed in the prep pipeline (triage, architect, plan, bootstrap) instead of automatically launching into architect mode.\n\n**Context:**\nCurrently, when a user exits the plan command, the tool assumes the next step should be architect mode. This breaks the workflow when:\n- Some steps have already been completed\n- The user wants to re-run or skip a particular step\n- Multiple iterations through the pipeline are needed\n\n**Acceptance Criteria:**\n- [ ] Detect which prep steps have been completed (check for artifacts: triage output, architect output, plan.jsonl, beads state)\n- [ ] Display a summary of completed steps before prompting next action\n- [ ] Offer user a choice: continue from next incomplete step, re-run a specific step, or exit\n- [ ] Don't automatically jump to architect if earlier steps are incomplete\n- [ ] Handle partial completion gracefully (e.g., architect started but not finished)", "assignee": null, "labels": ["epic:cub-8av0", "punchlist"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T19:47:14.625064-05:00", "updated_at": "2026-01-28T19:47:19.970371-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-i4x9", "title": "Ensure build-plan sets git upstream on push", "status": "open", "priority": "P2", "type": "task", "description": "When creating a feature branch during build-plan, the upstream tracking should be automatically configured so subsequent `git push` commands work without requiring `--set-upstream`.\n\n**Context:**\nAfter running build-plan and creating a feature branch, users encounter: \"fatal: The current branch has no upstream branch\" when attempting to push. This requires manual intervention with `git push --set-upstream origin <branch>`.\n\n**Acceptance Criteria:**\n- Build-plan creates feature branches with upstream tracking configured (equivalent to `git push -u origin <branch>` on first push)\n- Subsequent `git push` commands work without additional flags\n- Works with both initial branch creation and when pushing existing local branches\n- Alternative: Configure `push.autoSetupRemote = true` in git config as part of `cub init`", "assignee": null, "labels": ["epic:cub-8av0", "punchlist"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T19:46:53.533575-05:00", "updated_at": "2026-01-28T19:46:58.822413-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-zlfs", "title": "Add post-command guidance messages to cub workflow", "status": "open", "priority": "P2", "type": "task", "description": "Improve user experience by providing contextual next-step guidance after key cub commands execute.\n\n**Context:**\nUsers new to cub need clear direction on what to do after running commands. Currently, commands complete silently or with minimal output, leaving users uncertain about the next workflow step.\n\n**Acceptance Criteria:**\n\n1. **`cub init` command**\n   - After successful initialization, display a bulleted list of suggested next steps\n   - Include: creating first capture, running interview, starting first task\n   - Link to relevant documentation or show example commands\n\n2. **`cub capture` command**\n   - After successfully creating a capture, suggest next steps\n   - Recommend: review capture, start interview, organize into spec\n\n3. **`cub spec` command** (if creating new spec)\n   - After spec creation, guide user to next phase\n   - Suggest: detailed requirements, link to parent epic, schedule for planning\n\n4. **General pattern**\n   - Guidance should be concise (3-5 bullet points max)\n   - Include actual command examples users can copy/paste\n   - Use Rich formatting for readability\n   - Respect `--quiet` flag if present (suppress guidance)\n\n**Out of scope:**\n- Changes to existing command behavior\n- New commands beyond what's listed\n- Modifying beads (`bd`) output (it's separate tool)", "assignee": null, "labels": ["epic:cub-8av0", "punchlist"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T19:46:32.528118-05:00", "updated_at": "2026-01-28T19:46:37.797062-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bets", "title": "Fix monitor command to work with beads backend", "status": "open", "priority": "P2", "type": "task", "description": "The `cub monitor` command currently fails with \"No active session found\" error. This appears to be due to changes in the codebase that have shifted from session-based monitoring to task-based execution using the beads backend.\n\n**Context:**\n- `cub monitor` is designed to provide a live dashboard during task execution\n- The error suggests it's looking for an \"active session\" concept that may no longer exist or is stored differently\n- The project now uses beads as the primary task backend\n\n**Acceptance Criteria:**\n- `cub monitor` command executes without error\n- It displays task progress in real-time (or shows appropriate status if no tasks are running)\n- It works with the current beads backend task management system\n- Help text accurately describes what the command does\n\n**Investigation needed:**\n- Check how session state is tracked with beads backend\n- Review what \"active session\" means in current architecture\n- Determine if monitor should show beads task progress or if it needs refactoring for the new task model", "assignee": null, "labels": ["epic:cub-8av0", "punchlist"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T19:46:11.486911-05:00", "updated_at": "2026-01-28T19:46:16.761131-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-nejt", "title": "Fix label order comparison in backend divergence checks", "status": "open", "priority": "P2", "type": "task", "description": "The backend divergence detection is comparing task labels as ordered lists, causing false positives when the same labels appear in different orders. This occurs in `close_task()` and `get_task()` operations where the beads backend returns labels in a different order than the in-memory state.\n\n**Context:**\nLabels are semantically unordered and should be compared as sets, not lists. The current list comparison fails when:\n- Beads sorts labels alphabetically: `['complexity:medium', 'core', 'epic:cub-b1a', ...]`\n- In-memory state has different sort order: `['phase-1', 'core', 'refactor', ...]`\n\n**Acceptance Criteria:**\n1. Backend divergence checks compare labels as sets (order-independent)\n2. False positives from label reordering are eliminated\n3. Real divergences (actual label additions/removals) are still detected\n4. No warnings logged when only label order differs\n5. Tests verify set-based comparison with various label orderings", "assignee": null, "labels": ["epic:cub-8av0", "punchlist"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T19:45:50.519188-05:00", "updated_at": "2026-01-28T19:45:55.771109-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-8av0", "title": "2026-01-28-assorted Bug Fixes", "status": "open", "priority": "P2", "type": "epic", "description": "Punchlist tasks from: 2026-01-28-assorted-bugs.md\n\nSource: plans/_punchlists/2026-01-28-assorted-bugs.md", "assignee": null, "labels": ["punchlist", "punchlist:2026-01-28-assorted-bugs"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T19:45:29.422306-05:00", "updated_at": "2026-01-28T19:45:34.782723-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "open", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["docs", "feature", "phase-6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:43.707920Z", "updated_at": "2026-01-28T17:54:43.878976Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-q2j", "title": "symbiotic-workflow #3: Task Backend and Instructions", "status": "open", "priority": "P2", "type": "epic", "description": "JSON backend reaches full parity with beads. `cub task` CLI provides task management from any context. Instructions guide direct session workflow.", "assignee": null, "labels": ["instructions", "phase-3", "tasks"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008249Z", "updated_at": "2026-01-28T03:37:44.168551Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-r6s.5", "title": "Implement hook handlers for artifact capture", "status": "open", "priority": "P2", "type": "task", "description": "Based on hook research, implement handlers to auto-capture artifacts when possible.\n\n**Implementation Steps:**\n1. Create `src/cub/core/harness/hooks.py`\n2. Implement `handle_hook_event(event_type, payload)` dispatcher\n3. For PostToolUse/Write: detect writes to plans/, log to ledger\n4. For Stop: capture session end, finalize any open ledger entries\n5. Parse payloads defensively (malformed \u2192 skip, don't crash)\n6. Create hook scripts for `.cub/hooks/` that call these handlers\n\n**Files:** src/cub/core/harness/hooks.py, .cub/hooks/", "assignee": null, "labels": ["complexity:medium", "epic:cub-r6s", "hooks", "model:sonnet", "phase-3"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923682Z", "updated_at": "2026-01-26T16:32:00.159779-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-sylz", "title": "Split CI workflow into separate jobs", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-ck1z"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:44.333093-05:00", "updated_at": "2026-01-18T21:57:44.333093-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-qrnl", "title": "Add pytest-testmon for smart test selection", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-e2h9"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:52.516256-05:00", "updated_at": "2026-01-18T21:56:52.516256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-3bx", "title": "can remove curb reference in CHANGELOG.md", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": ["quick-fix"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-16T21:25:17.751722-05:00", "updated_at": "2026-01-16T21:25:17.751722-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ht4", "title": "Add cub upgrade command for pipx-based updates", "status": "open", "priority": "P2", "type": "task", "description": "## Context\nWith the hybrid CLI installed via pipx, users need an easy way to upgrade to new releases.\n\n## Implementation\nAdd `cub upgrade` command that:\n1. Detects installation method (pipx, pip --user, editable)\n2. For pipx: runs `pipx upgrade cub` or reinstall from tag\n3. Shows current vs available version\n4. Supports `--version X.Y.Z` to install specific version\n\n## Example Usage\n```bash\ncub upgrade              # Upgrade to latest release\ncub upgrade --version 0.23.2  # Install specific version\ncub upgrade --check      # Just show if update available\n```\n\n## Files\n- src/cub/cli/upgrade.py (new)\n- src/cub/cli/__init__.py (register command)", "assignee": null, "labels": ["complexity:low", "enhancement"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-15T10:44:33.816090-05:00", "updated_at": "2026-01-15T10:44:33.816090-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-r9d", "title": "symbiotic-workflow #4: Reconciliation and Polish", "status": "open", "priority": "P3", "type": "epic", "description": "Handle edge cases, provide manual recovery paths, and validate end-to-end parity between `cub run` and direct sessions.", "assignee": null, "labels": ["phase-4", "polish", "validation"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T03:37:44.008258Z", "updated_at": "2026-01-28T03:37:44.169214Z", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-rr7p", "title": "Add Docker integration tests for sandbox", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:41.422467-05:00", "updated_at": "2026-01-18T21:58:41.422467-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-jwm1", "title": "Add Hypothesis property-based tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": ["epic:cub-i8b6"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:36.212716-05:00", "updated_at": "2026-01-18T21:58:36.212716-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": [{"id": "cub-b1a", "title": "bare-cub #1: Core Run Extraction", "status": "closed", "priority": "P0", "type": "epic", "description": "Extract ~2500 lines of business logic from `cli/run.py` into a new `core/run/` package. This is the highest-risk, highest-impact phase \u2014 it establishes the pattern that every subsequent phase follows. All existing tests must continue passing after each extraction step.", "assignee": null, "labels": ["phase-1", "core", "refactor", "risk:high"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407838", "updated_at": "2026-01-28T18:57:22.732005", "closed_at": "2026-01-28T18:57:22.732002", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T18:57:22.732007] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1b", "title": "bare-cub #2: Rich Boundary Cleanup", "status": "closed", "priority": "P1", "type": "epic", "description": "Remove all Rich imports from `cub.core` modules. Core returns structured data; CLI renders it. This establishes the architectural rule that enables non-CLI interfaces.", "assignee": null, "labels": ["phase-2", "core", "refactor", "cleanup"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.407983", "updated_at": "2026-01-28T19:20:21.672421", "closed_at": "2026-01-28T19:20:21.672417", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:20:21.672422] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c", "title": "bare-cub #3: Service Layer", "status": "closed", "priority": "P1", "type": "epic", "description": "Introduce `cub.core.services` as the public API surface. Services are thin orchestrators that compose domain operations. CLI modules are refactored to call services.", "assignee": null, "labels": ["phase-3", "core", "architecture"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408044", "updated_at": "2026-01-28T19:59:09.455587", "closed_at": "2026-01-28T19:59:09.455581", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T19:59:09.455589] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d", "title": "bare-cub #4: Suggestion Engine", "status": "closed", "priority": "P1", "type": "epic", "description": "Build the smart recommendation system that analyzes project state and produces ranked, opinionated suggestions for what to do next.", "assignee": null, "labels": ["phase-4", "core", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408089", "updated_at": "2026-01-28T20:22:42.124609", "closed_at": "2026-01-28T20:22:42.124605", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T20:22:42.124610] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e", "title": "bare-cub #5: Bare Cub Command", "status": "closed", "priority": "P0", "type": "epic", "description": "Implement the default command handler \u2014 the user-facing deliverable. When someone types `cub` with no subcommand, it launches the default harness with an opinionated welcome.", "assignee": null, "labels": ["phase-5", "cli", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408186", "updated_at": "2026-01-28T20:46:13.750875", "closed_at": "2026-01-28T20:46:13.750871", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T20:46:13.750876] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1f", "title": "bare-cub #6: Skill Discovery & Documentation", "status": "closed", "priority": "P2", "type": "epic", "description": "Make cub capabilities discoverable from within a harness session and document the new architecture.", "assignee": null, "labels": ["phase-6", "docs", "feature"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-28T17:54:44.408236", "updated_at": "2026-01-28T21:05:14.566952", "closed_at": "2026-01-28T21:05:14.566948", "acceptance_criteria": [], "notes": "[Closed: 2026-01-28T21:05:14.566953] All tasks completed", "complexity_label": null, "model_label": null, "is_ready": false, "priority_numeric": 2}, {"id": "cub-b1a.1", "title": "Create core/run package with prompt builder extraction", "status": "closed", "priority": "P0", "type": "task", "description": "The prompt builder (system prompt generation, task context injection, AGENT.md reading) is the most self-contained piece of `cli/run.py` and the safest to extract first. It establishes the `core/run/` package structure.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/__init__.py` package\n2. Create `src/cub/core/run/prompt_builder.py` \u2014 extract `generate_system_prompt()`, `_build_task_context()`, `_read_agent_md()`, and related functions from `cli/run.py`\n3. Define `PromptConfig` and `TaskPrompt` data models for inputs/outputs\n4. Update `cli/run.py` to import from `core/run/prompt_builder` instead of using local functions\n5. Ensure all existing run tests pass unchanged\n6. Add unit tests for prompt builder in isolation\n\n**Files:** src/cub/core/run/__init__.py, src/cub/core/run/prompt_builder.py, src/cub/cli/run.py, tests/test_run_prompt_builder.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1a.2", "cub-b1a.3", "cub-b1a.4", "cub-b1a.5"], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169146", "updated_at": "2026-01-28T18:04:02.242112", "closed_at": "2026-01-28T18:04:02.242086", "acceptance_criteria": ["`core/run/prompt_builder.py` exists with all prompt generation logic", "`cli/run.py` calls prompt builder from core, no local prompt logic remains", "`pytest tests/` passes with no regressions", "`mypy src/cub` passes clean", "No Rich imports in `core/run/`"], "notes": "[Closed: 2026-01-28T18:04:02.242114] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.2", "title": "Extract budget tracking to core/run/budget.py", "status": "closed", "priority": "P0", "type": "task", "description": "Budget tracking (token counting, cost accounting, limit enforcement) is business logic embedded in the run loop. It needs to be accessible to any interface that runs tasks.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/budget.py` with `BudgetManager` class\n2. Extract token tracking, cost accumulation, and limit checking from `cli/run.py`\n3. Define `BudgetConfig` (limits) and `BudgetState` (current usage) models\n4. Add `check_limit()` method that returns whether to continue or stop\n5. Update `cli/run.py` to use `BudgetManager` instead of inline tracking\n6. Write tests for budget limit enforcement\n\n**Files:** src/cub/core/run/budget.py, src/cub/cli/run.py, tests/test_run_budget.py", "assignee": "cub-20260128-175601", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169250", "updated_at": "2026-01-28T18:09:17.082589", "closed_at": "2026-01-28T18:09:17.082585", "acceptance_criteria": ["`BudgetManager` handles all token/cost tracking", "Budget limits trigger clean stops with clear reasons", "`cli/run.py` has no inline budget math", "Tests cover: under budget, at budget, over budget, no budget set"], "notes": "[Closed: 2026-01-28T18:09:17.082592] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.3", "title": "Extract loop state machine to core/run/loop.py", "status": "closed", "priority": "P0", "type": "task", "description": "The run loop state machine (pick task \u2192 execute \u2192 record \u2192 next) is the core of cub. Extracting it cleanly is the hardest part of this phase \u2014 it touches task selection, harness invocation, result recording, and error handling.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/loop.py` with `RunLoop` class\n2. Define `RunConfig` model (all loop configuration: once, epic, harness, etc.)\n3. Define `RunEvent` enum/model for loop events (task_start, task_end, budget_update, error, complete)\n4. Implement `execute()` as a generator that yields `RunEvent` objects\n5. Move task selection, harness invocation coordination, and result recording into `RunLoop`\n6. Keep signal handling and Rich rendering in `cli/run.py`\n7. `cli/run.py` becomes: parse args \u2192 create `RunConfig` \u2192 iterate `RunLoop.execute()` \u2192 render events\n\n**Files:** src/cub/core/run/loop.py, src/cub/core/run/models.py, src/cub/cli/run.py, tests/test_run_loop.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:opus", "complexity:high", "risk:high"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169288", "updated_at": "2026-01-28T18:41:42.743657", "closed_at": "2026-01-28T18:41:42.743618", "acceptance_criteria": ["`RunLoop.execute()` yields `RunEvent` stream, no print/console output", "`cli/run.py` reduced to <500 lines (arg parsing + event rendering)", "`cub run --once` works end-to-end through the new architecture", "`cub run` (multi-task) works end-to-end", "All existing run tests pass", "`mypy` passes clean"], "notes": "[Closed: 2026-01-28T18:41:42.743661] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1a.4", "title": "Extract interrupt handling to core/run/interrupt.py", "status": "closed", "priority": "P1", "type": "task", "description": "Signal handling (SIGINT/SIGTERM) for clean shutdown needs to work regardless of which interface is driving the run loop. The interrupt handler should coordinate with the loop state machine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/interrupt.py` with `InterruptHandler` class\n2. Extract signal registration and `_interrupted` flag logic from `cli/run.py`\n3. Implement cooperative interruption: handler sets flag, loop checks flag between tasks\n4. Add `on_interrupt` callback for cleanup (artifact finalization, ledger entry)\n5. Update `RunLoop` to check interrupt state between iterations\n\n**Files:** src/cub/core/run/interrupt.py, src/cub/core/run/loop.py, src/cub/cli/run.py, tests/test_run_interrupt.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169329", "updated_at": "2026-01-28T18:47:30.640522", "closed_at": "2026-01-28T18:47:30.640516", "acceptance_criteria": ["`InterruptHandler` manages SIGINT/SIGTERM registration", "Interrupts cause clean shutdown between tasks (not mid-task)", "Artifacts and ledger entries are finalized on interrupt", "Works when called from CLI or programmatically"], "notes": "[Closed: 2026-01-28T18:47:30.640526] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1a.5", "title": "Extract git operations to core/run/git_ops.py", "status": "closed", "priority": "P1", "type": "task", "description": "Branch creation, commit tracking, and other git operations during `cub run` are business logic that should be accessible from any interface.\n\n**Implementation Steps:**\n1. Create `src/cub/core/run/git_ops.py` with run-specific git functions\n2. Extract `_create_branch_from_base()`, `_get_gh_issue_title()`, `_get_epic_title()` from `cli/run.py`\n3. Define clear interfaces: `create_run_branch(config) -> str`, `get_epic_context(epic_id) -> EpicContext`\n4. Update `RunLoop` to call git_ops functions instead of inline logic\n5. Write tests with mocked git operations\n\n**Files:** src/cub/core/run/git_ops.py, src/cub/cli/run.py, tests/test_run_git_ops.py", "assignee": "cub-20260128-183943", "labels": ["phase-1", "core", "refactor", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1a", "created_at": "2026-01-28T17:54:46.169369", "updated_at": "2026-01-28T18:57:10.834668", "closed_at": "2026-01-28T18:57:10.834664", "acceptance_criteria": ["All git operations during run extracted to `core/run/git_ops.py`", "No git subprocess calls remain in `cli/run.py`", "Branch naming convention preserved", "Tests cover branch creation, epic title resolution"], "notes": "[Closed: 2026-01-28T18:57:10.834670] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.1", "title": "Move review reporter rendering to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/review/reporter.py` is the heaviest Rich violator \u2014 it's ~90% Rich rendering. The data models already exist in `core/review/models.py`. We need to split data preparation from rendering.\n\n**Implementation Steps:**\n1. Audit `core/review/reporter.py` to identify data preparation vs rendering\n2. Keep any data transformation logic in core; move to `core/review/formatter.py` if needed (returns structured data)\n3. Create `cli/review/display.py` with all Rich rendering (Panel, Table, Text)\n4. Update `cli/review.py` to call display functions instead of core reporter\n5. Remove Rich imports from `core/review/reporter.py` (or delete if fully moved)\n6. Update tests to verify data output, not rendered output\n\n**Files:** src/cub/core/review/reporter.py, src/cub/cli/review/display.py, src/cub/cli/review.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169408", "updated_at": "2026-01-28T19:02:20.690087", "closed_at": "2026-01-28T19:02:20.690062", "acceptance_criteria": ["Zero Rich imports in `core/review/`", "`cli/review/display.py` handles all review rendering", "`cub review` command output unchanged from user's perspective", "Tests pass"], "notes": "[Closed: 2026-01-28T19:02:20.690089] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.2", "title": "Remove Rich from core/pr/service.py and core/worktree/parallel.py", "status": "closed", "priority": "P1", "type": "task", "description": "Both modules use Rich Console for progress/status output. They should emit events or return data, letting the CLI layer handle display.\n\n**Implementation Steps:**\n1. In `core/pr/service.py`: replace `Console` usage with return values or Python logging\n2. In `core/worktree/parallel.py`: replace progress output with callback/event pattern\n3. Define callback protocols: `on_worker_start(task_id)`, `on_worker_complete(task_id, result)`\n4. Update `cli/pr.py` and `cli/worktree.py` to provide Rich-based callbacks\n5. Verify all PR and worktree commands work unchanged\n\n**Files:** src/cub/core/pr/service.py, src/cub/core/worktree/parallel.py, src/cub/cli/pr.py, src/cub/cli/worktree.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-b1b.5"], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169430", "updated_at": "2026-01-28T19:12:49.833208", "closed_at": "2026-01-28T19:12:49.833201", "acceptance_criteria": ["Zero Rich imports in `core/pr/` and `core/worktree/`", "PR and worktree commands produce identical output", "Core modules use callbacks or return data for progress"], "notes": "[Closed: 2026-01-28T19:12:49.833211] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.3", "title": "Move bash_delegate to CLI layer", "status": "closed", "priority": "P1", "type": "task", "description": "`core/bash_delegate.py` imports Rich Console and calls `sys.exit()`. It's purely a CLI concern \u2014 delegating commands to the bash version of cub.\n\n**Implementation Steps:**\n1. Move `core/bash_delegate.py` to `cli/delegated/runner.py`\n2. Update imports in `cli/delegated.py` and `cli/__init__.py`\n3. Remove `core/bash_delegate.py`\n4. Verify delegated commands (prep, branch, etc.) still work\n\n**Files:** src/cub/core/bash_delegate.py, src/cub/cli/delegated/runner.py, src/cub/cli/delegated.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:sonnet", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169447", "updated_at": "2026-01-28T19:16:59.892654", "closed_at": "2026-01-28T19:16:59.892650", "acceptance_criteria": ["`core/bash_delegate.py` no longer exists", "Delegated commands work unchanged", "No Rich or sys.exit in any `core/` module"], "notes": "[Closed: 2026-01-28T19:16:59.892655] Completed by autonomous execution", "complexity_label": "low", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.4", "title": "Replace Rich logging in core/harness/hooks.py", "status": "closed", "priority": "P1", "type": "task", "description": "`core/harness/hooks.py` uses Rich for logging. It should use Python's standard `logging` module \u2014 hooks run in subprocess contexts where Rich may not be appropriate.\n\n**Implementation Steps:**\n1. Replace `from rich.console import Console` with `import logging`\n2. Replace `console.print()` calls with `logger.info()`, `logger.debug()`, etc.\n3. Configure logging format in hook entry point\n4. Verify hook forensics still work correctly\n\n**Files:** src/cub/core/harness/hooks.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169467", "updated_at": "2026-01-28T19:18:27.819752", "closed_at": "2026-01-28T19:18:27.819748", "acceptance_criteria": ["Zero Rich imports in `core/harness/hooks.py`", "Hook logging works in subprocess contexts", "Forensics JSONL output unchanged"], "notes": "[Closed: 2026-01-28T19:18:27.819754] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1b.5", "title": "Verify zero Rich imports in core and add CI gate", "status": "closed", "priority": "P1", "type": "task", "description": "Final verification that the boundary is clean, plus a CI check to prevent regression.\n\n**Implementation Steps:**\n1. Run `grep -r \"from rich\" src/cub/core/` and verify zero results\n2. Run `grep -r \"import rich\" src/cub/core/` and verify zero results\n3. Add a test that programmatically checks no Rich imports in core\n4. Verify `mypy src/cub` passes clean\n\n**Files:** tests/test_architecture.py", "assignee": "cub-20260128-185726", "labels": ["phase-2", "core", "cleanup", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-b1b", "created_at": "2026-01-28T17:54:46.169492", "updated_at": "2026-01-28T19:20:10.863075", "closed_at": "2026-01-28T19:20:10.863070", "acceptance_criteria": ["`grep -r \"from rich\\|import rich\" src/cub/core/` returns nothing", "Automated test enforces the boundary", "All commands work unchanged from user's perspective"], "notes": "[Closed: 2026-01-28T19:20:10.863078] Completed by autonomous execution", "complexity_label": "low", "model_label": "haiku", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.1", "title": "Create service layer foundation and RunService", "status": "closed", "priority": "P1", "type": "task", "description": "RunService wraps the newly-extracted `core/run/` package, providing the clean API that CLI and future interfaces call. This establishes the service layer pattern.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/__init__.py` package\n2. Create `src/cub/core/services/run.py` with `RunService` class\n3. `RunService.from_config(config)` factory method\n4. `RunService.execute(run_config) -> Iterator[RunEvent]` delegates to `core/run/loop.py`\n5. `RunService.run_once(task_id) -> RunResult` convenience method\n6. Refactor `cli/run.py` to use `RunService` instead of calling `core/run/` directly\n7. Write service-level integration tests\n\n**Files:** src/cub/core/services/__init__.py, src/cub/core/services/run.py, src/cub/cli/run.py, tests/test_service_run.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1c.2", "cub-b1c.3", "cub-b1c.4"], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169509", "updated_at": "2026-01-28T19:30:32.960816", "closed_at": "2026-01-28T19:30:32.960778", "acceptance_criteria": ["`RunService` provides the complete API for task execution", "`cli/run.py` only calls `RunService`, not domain modules directly", "Service is stateless \u2014 configuration passed in, no globals", "Tests verify service orchestration"], "notes": "[Closed: 2026-01-28T19:30:32.960820] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.2", "title": "Create StatusService and LedgerService", "status": "closed", "priority": "P1", "type": "task", "description": "StatusService aggregates project state from multiple sources. LedgerService wraps ledger reader/writer. Both are needed by the suggestion engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/status.py` with `StatusService`\n2. `summary() -> ProjectStats` \u2014 aggregate from tasks, ledger, git\n3. `progress(epic_id) -> EpicProgress` \u2014 epic-level progress\n4. Create `src/cub/core/services/ledger.py` with `LedgerService`\n5. `query(filters) -> list[LedgerEntry]`, `recent(n) -> list[LedgerEntry]`, `stats(period) -> LedgerStats`\n6. Define `ProjectStats`, `EpicProgress`, `LedgerStats` models\n7. Refactor `cli/status.py` and `cli/ledger.py` to use services\n\n**Files:** src/cub/core/services/status.py, src/cub/core/services/ledger.py, src/cub/core/services/models.py, src/cub/cli/status.py, src/cub/cli/ledger.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169529", "updated_at": "2026-01-28T19:43:16.990826", "closed_at": "2026-01-28T19:43:16.990819", "acceptance_criteria": ["`StatusService.summary()` returns structured project stats", "`LedgerService` wraps all ledger operations", "`cub status` and `cub ledger` commands work via services", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T19:43:16.990832] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.3", "title": "Create LaunchService for environment detection and harness launch", "status": "closed", "priority": "P1", "type": "task", "description": "LaunchService handles the core logic for bare `cub`: detect environment, determine if nested, launch harness with context. This is the service that `cli/default.py` will call.\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/__init__.py` package\n2. Create `src/cub/core/launch/detector.py` with `detect_environment() -> EnvironmentInfo`\n3. Check `CUB_SESSION_ACTIVE`, `CLAUDE_CODE`, `CLAUDE_PROJECT_DIR` env vars\n4. Create `src/cub/core/launch/launcher.py` with `launch_harness(config, context)`\n5. Implement harness binary resolution, flag assembly, `exec` call\n6. Create `src/cub/core/launch/models.py` with `EnvironmentInfo`, `LaunchConfig`\n7. Create `src/cub/core/services/launch.py` with `LaunchService` wrapper\n8. Write tests with mocked environment variables\n\n**Files:** src/cub/core/launch/detector.py, src/cub/core/launch/launcher.py, src/cub/core/launch/models.py, src/cub/core/services/launch.py, tests/test_launch.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169545", "updated_at": "2026-01-28T19:49:58.382182", "closed_at": "2026-01-28T19:49:58.382177", "acceptance_criteria": ["`detect_environment()` correctly identifies terminal, harness, and nested contexts", "`launch_harness()` assembles correct `claude` CLI invocation", "`--resume` and `--continue` flags pass through correctly", "`CUB_SESSION_ACTIVE` and `CUB_SESSION_ID` set in child environment", "Tests cover all three environment contexts"], "notes": "[Closed: 2026-01-28T19:49:58.382184] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1c.4", "title": "Enhance TaskService with ready(), stale_epics(), and claims", "status": "closed", "priority": "P1", "type": "task", "description": "TaskService already exists but needs additional methods for the suggestion engine and welcome message. `ready()` and `stale_epics()` are key data sources for suggestions.\n\n**Implementation Steps:**\n1. Add `ready() -> list[Task]` to TaskService \u2014 tasks with no blockers, ordered by priority\n2. Add `stale_epics() -> list[Epic]` \u2014 epics where all child tasks are closed but epic is open\n3. Add `claim(task_id, session_id) -> Task` \u2014 mark task as in-progress for a session\n4. Add `close(task_id, reason) -> Task` \u2014 close task with reason\n5. Ensure methods work with both beads and JSONL backends\n6. Write tests for each method with both backends\n\n**Files:** src/cub/core/tasks/service.py, tests/test_task_service.py", "assignee": "cub-20260128-192025", "labels": ["phase-3", "core", "architecture", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1c", "created_at": "2026-01-28T17:54:46.169561", "updated_at": "2026-01-28T19:58:57.828806", "closed_at": "2026-01-28T19:58:57.828802", "acceptance_criteria": ["`TaskService.ready()` returns correctly filtered and ordered tasks", "`TaskService.stale_epics()` detects epics ready to close", "Works with beads and JSONL backends", "Tests cover edge cases (no tasks, all blocked, mixed states)"], "notes": "[Closed: 2026-01-28T19:58:57.828808] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.1", "title": "Create suggestion models and data sources", "status": "closed", "priority": "P1", "type": "task", "description": "Define the data models for suggestions and implement the four data source adapters (tasks, git, ledger, milestones) that feed the ranking engine.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/__init__.py` package\n2. Create `src/cub/core/suggestions/models.py` with `Suggestion`, `ProjectSnapshot`, `SuggestionCategory` enum\n3. Create `src/cub/core/suggestions/sources.py` with source protocol and implementations:\n4. Each source implements `get_suggestions() -> list[Suggestion]`\n5. Write tests with fixture data mirroring current cub project state\n\n**Files:** src/cub/core/suggestions/models.py, src/cub/core/suggestions/sources.py, tests/test_suggestions_sources.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium", "blocking"], "depends_on": [], "blocks": ["cub-b1d.2", "cub-b1d.3"], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169582", "updated_at": "2026-01-28T20:09:46.523423", "closed_at": "2026-01-28T20:09:46.523370", "acceptance_criteria": ["All four sources produce relevant suggestions from real project data", "`TaskSource` detects the 9 stale epics in current project", "`GitSource` detects unpushed work and stale branches", "`MilestoneSource` infers 0.30 alpha target from sketches/CHANGELOG", "Models are Pydantic, serializable"], "notes": "[Closed: 2026-01-28T20:09:46.523427] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.2", "title": "Implement ranking algorithm and engine", "status": "closed", "priority": "P1", "type": "task", "description": "The ranking algorithm scores and orders suggestions from all sources. The engine composes sources, applies ranking, and provides the public API.\n\n**Implementation Steps:**\n1. Create `src/cub/core/suggestions/ranking.py` with `rank_suggestions(suggestions) -> list[Suggestion]`\n2. Implement scoring: `base_priority \u00d7 urgency_multiplier \u00d7 recency_decay`\n3. Create `src/cub/core/suggestions/engine.py` with `SuggestionEngine` class\n4. `get_suggestions(limit) -> list[Suggestion]` \u2014 ranked list\n5. `get_welcome() -> WelcomeMessage` \u2014 stats + top suggestions + skills\n6. `get_next_action() -> Suggestion` \u2014 single best recommendation\n7. Write tests with deterministic fixture data to verify ranking order\n\n**Files:** src/cub/core/suggestions/ranking.py, src/cub/core/suggestions/engine.py, tests/test_suggestions_engine.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169599", "updated_at": "2026-01-28T20:15:09.194747", "closed_at": "2026-01-28T20:15:09.194743", "acceptance_criteria": ["Stale epic closure ranks above low-priority ready tasks", "P0 tasks rank above P2 tasks", "Milestone blockers rank high when release target detected", "`get_welcome()` produces a complete `WelcomeMessage` with stats", "Ranking is deterministic for same input"], "notes": "[Closed: 2026-01-28T20:15:09.194749] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1d.3", "title": "Wire SuggestionEngine into services and dogfood", "status": "closed", "priority": "P1", "type": "task", "description": "Connect the engine to real project data via services and validate it produces useful suggestions for the cub project itself.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/suggestions.py` as the service wrapper\n2. Wire `SuggestionEngine` to use `TaskService`, `LedgerService`, `StatusService`\n3. Add a CLI command for testing: `cub suggest` (or add to `cub status`)\n4. Run against the current cub project and verify suggestions are sensible\n5. Iterate on ranking weights based on dogfooding results\n6. Document the suggestion categories and their use cases\n\n**Files:** src/cub/core/services/suggestions.py, src/cub/cli/suggest.py, tests/test_suggestions_integration.py", "assignee": "cub-20260128-195914", "labels": ["phase-4", "core", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1d", "created_at": "2026-01-28T17:54:46.169615", "updated_at": "2026-01-28T20:22:32.062910", "closed_at": "2026-01-28T20:22:32.062906", "acceptance_criteria": ["`cub suggest` (or equivalent) produces useful output for cub project", "Suggestions include stale epics, ready tasks, and milestone awareness", "Output is human-readable and actionable", "Engine handles empty projects gracefully (new project with no tasks)"], "notes": "[Closed: 2026-01-28T20:22:32.062912] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.1", "title": "Implement bare cub default command handler", "status": "closed", "priority": "P0", "type": "task", "description": "This is the primary user-facing deliverable. Bare `cub` detects the environment, generates a welcome message with suggestions, and either launches the harness (terminal) or shows inline status (nested/harness).\n\n**Implementation Steps:**\n1. Create `src/cub/cli/default.py` with the default command function\n2. Wire into `cli/__init__.py`: replace `no_args_is_help=True` with callback that invokes default\n3. Accept `--resume` and `--continue` flags\n4. Call `LaunchService.detect_environment()` to determine context\n5. If nested/harness: call `SuggestionEngine.get_welcome()`, render with Rich, exit\n6. If terminal: generate welcome, resolve harness, launch with `LaunchService.launch_harness()`\n7. Set `CUB_SESSION_ACTIVE=1` and `CUB_SESSION_ID` in launched harness environment\n8. Handle edge cases: no harness available, no project initialized, help flag\n\n**Files:** src/cub/cli/default.py, src/cub/cli/__init__.py, tests/test_default_command.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:opus", "complexity:high", "blocking"], "depends_on": [], "blocks": ["cub-b1e.2", "cub-b1e.3"], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169633", "updated_at": "2026-01-28T20:31:26.493282", "closed_at": "2026-01-28T20:31:26.493257", "acceptance_criteria": ["`cub` (no args) launches Claude Code with welcome context", "`cub --resume` passes `--resume` to Claude Code", "`cub --continue` passes `--continue` to Claude Code", "`cub` inside Claude Code shows inline status + suggestions (no nesting)", "`cub` with no harness available shows helpful error", "`cub --help` still works (shows help, not default action)", "Welcome message includes project stats and top suggestion"], "notes": "[Closed: 2026-01-28T20:31:26.493284] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-b1e.2", "title": "Design and implement welcome message format", "status": "closed", "priority": "P1", "type": "task", "description": "The welcome message is the first thing users see. It needs to be concise, opinionated, and immediately useful. It renders differently in terminal (Rich formatting) vs inline (plain text for harness context).\n\n**Implementation Steps:**\n1. Create `src/cub/core/launch/welcome.py` with `generate_welcome(snapshot) -> WelcomeMessage`\n2. Design terminal format (Rich):\n3. Design harness context format (plain text for system prompt injection)\n4. Create Rich renderer in `cli/default.py` for terminal output\n5. Test with current cub project state\n\n**Files:** src/cub/core/launch/welcome.py, src/cub/cli/default.py, tests/test_welcome.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169652", "updated_at": "2026-01-28T20:37:11.972618", "closed_at": "2026-01-28T20:37:11.972614", "acceptance_criteria": ["Welcome message shows version, task counts, and last activity", "Top suggestion is opinionated with rationale and command", "Available skills listed for discoverability", "Terminal and harness formats both look good", "Handles empty project gracefully (no tasks, no history)"], "notes": "[Closed: 2026-01-28T20:37:11.972622] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1e.3", "title": "Integration testing and edge cases", "status": "closed", "priority": "P1", "type": "task", "description": "The bare cub command has many edge cases that need testing: no project, no harness, nested sessions, resume/continue, different backends.\n\n**Implementation Steps:**\n1. Write integration test: bare cub in fresh directory (no `.cub/`)\n2. Write integration test: bare cub with JSONL backend\n3. Write integration test: bare cub with beads backend\n4. Write integration test: bare cub with `CUB_SESSION_ACTIVE=1` set\n5. Write integration test: bare cub with `--resume`\n6. Write integration test: bare cub when no harness available\n7. Test that `cub --help` still shows help text\n8. Test that `cub <subcommand>` still routes to subcommands normally\n\n**Files:** tests/test_default_command_integration.py", "assignee": "cub-20260128-202245", "labels": ["phase-5", "cli", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1e", "created_at": "2026-01-28T17:54:46.169673", "updated_at": "2026-01-28T20:46:03.745287", "closed_at": "2026-01-28T20:46:03.745282", "acceptance_criteria": ["All integration tests pass", "No regressions in existing subcommand routing", "Edge cases produce helpful error messages, not crashes", "`--help` behavior preserved"], "notes": "[Closed: 2026-01-28T20:46:03.745289] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-b1f.1", "title": "Create /cub meta-skill for in-session discovery", "status": "closed", "priority": "P2", "type": "task", "description": "Users inside a harness session need to discover what cub skills are available. A `/cub` meta-skill lists available skills, common commands, and current project status.\n\n**Implementation Steps:**\n1. Create `.claude/commands/cub.md` as the meta-skill\n2. Include: list of available `/cub:*` skills with one-line descriptions\n3. Include: common `cub` CLI commands runnable via Bash (task ready, status, run)\n4. Include: brief explanation of modes (conversational, structured, supervised, autonomous)\n5. Include: dynamic project state (injected via template variables or by running `cub status`)\n\n**Files:** .claude/commands/cub.md", "assignee": "cub-20260128-204617", "labels": ["phase-6", "docs", "feature", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169693", "updated_at": "2026-01-28T20:54:38.292608", "closed_at": "2026-01-28T20:54:38.292604", "acceptance_criteria": ["`/cub` skill exists and is invocable from Claude Code", "Lists all available `/cub:*` skills", "Lists common CLI commands", "Provides enough context for a user to navigate cub's capabilities"], "notes": "[Closed: 2026-01-28T20:54:38.292610] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, {"id": "cub-b1f.2", "title": "Update CLAUDE.md with service architecture and skill reference", "status": "closed", "priority": "P2", "type": "task", "description": "CLAUDE.md needs to reflect the new core/interface architecture so that harness sessions (and agents) understand cub's structure. Also document available skills.\n\n**Implementation Steps:**\n1. Update CLAUDE.md architecture section to reflect service layer\n2. Add \"Available Skills\" section listing all `/cub:*` skills\n3. Add \"Cub Commands\" section with commonly-used CLI commands\n4. Update project structure diagram to show `core/services/`, `core/run/`, `core/suggestions/`, `core/launch/`\n5. Add note about bare `cub` behavior and nesting detection\n6. Remove any outdated references to old architecture\n\n**Files:** CLAUDE.md", "assignee": "cub-20260128-204617", "labels": ["phase-6", "docs", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169709", "updated_at": "2026-01-28T21:05:03.067296", "closed_at": "2026-01-28T21:05:03.067292", "acceptance_criteria": ["CLAUDE.md reflects current service layer architecture", "Skills section lists all available skills with descriptions", "Project structure diagram is accurate", "A harness session loading CLAUDE.md gets accurate information"], "notes": "[Closed: 2026-01-28T21:05:03.067297] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 2}, {"id": "cub-b1f.3", "title": "End-to-end validation of full flow", "status": "closed", "priority": "P1", "type": "task", "description": "Final validation that the entire flow works: bare `cub` \u2192 harness \u2192 use skills \u2192 run tasks \u2192 exit. This is the acceptance test for the whole feature.\n\n**Implementation Steps:**\n1. Manual test: run `cub` from terminal, verify welcome + harness launch\n2. Manual test: inside harness, run `/cub` to see available skills\n3. Manual test: inside harness, run `/cub:spec` to start a spec\n4. Manual test: inside harness, run `cub task ready` to see tasks\n5. Manual test: inside harness, run `cub run --once` for foreground task\n6. Manual test: run `cub` inside the harness (verify nesting prevention)\n7. Document any issues found, create follow-up tasks if needed\n\n**Files:** (manual testing, no code changes expected)", "assignee": "cub-20260128-204617", "labels": ["phase-6", "test", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-b1f", "created_at": "2026-01-28T17:54:46.169724", "updated_at": "2026-01-28T20:52:34.691040", "closed_at": "2026-01-28T20:52:34.691014", "acceptance_criteria": ["Full flow works without crashes or confusing behavior", "Mode transitions feel natural", "Nesting prevention works correctly", "Any issues found are documented as follow-up tasks"], "notes": "[Closed: 2026-01-28T20:52:34.691043] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-p1t", "title": "cub-task-parity #1: Protocol Extensions & DependencyGraph", "status": "closed", "priority": "P0", "type": "epic", "description": "Extend the TaskBackend protocol with 7 new methods, implement them in BeadsBackend and JsonlBackend, extend `update_task` signature, and build the DependencyGraph class. This is the foundation that everything else depends on.", "assignee": null, "labels": ["phase-1", "complexity:high", "model:sonnet"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T11:45:10.091591", "updated_at": "2026-01-29T12:47:24.167150", "closed_at": "2026-01-29T12:47:24.167133", "acceptance_criteria": [], "notes": "[Closed: 2026-01-29T12:47:24.167151] All tasks completed", "complexity_label": "high", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-p2c", "title": "cub-task-parity #2: CLI Subcommands", "status": "open", "priority": "P1", "type": "epic", "description": "Add CLI commands for all new protocol operations. Each command supports three output modes: Rich (default), `--json`, `--agent`.", "assignee": null, "labels": ["phase-2", "complexity:medium", "model:sonnet"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T11:45:10.092044", "updated_at": "2026-01-29T11:45:10.092045", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p3s", "title": "cub-task-parity #3: Skill & Documentation Updates", "status": "open", "priority": "P1", "type": "epic", "description": "Update all skills, router, and documentation to reference `cub task` exclusively. Remove `bd` from user-facing content.", "assignee": null, "labels": ["phase-3", "complexity:low", "model:haiku"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T11:45:10.092066", "updated_at": "2026-01-29T11:45:10.092067", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p1t.1", "title": "Extend TaskBackend protocol with 7 new methods", "status": "closed", "priority": "P0", "type": "task", "description": "The protocol needs 7 new methods for full lifecycle coverage. Also extend `update_task` to accept `title`, `priority`, and `notes` parameters. Create a `TaskBackendDefaults` mixin with default implementations for methods that can be derived from existing operations.\n\n**Implementation Steps:**\n1. Add 7 new method signatures to `TaskBackend` protocol in `backend.py`: `add_dependency`, `remove_dependency`, `list_blocked_tasks`, `reopen_task`, `delete_task`, `add_label`, `remove_label`\n2. Extend `update_task` signature with optional `title: str | None`, `priority: int | None`, `notes: str | None` parameters\n3. Create `TaskBackendDefaults` mixin class with default implementations:\n4. Add `blocked: int = 0` field to `TaskCounts` model\n5. Update type annotations and docstrings for all new methods\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/models.py", "assignee": "cub-20260129-115503", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.2", "cub-p1t.3", "cub-p1t.4"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463297", "updated_at": "2026-01-29T12:04:59.972632", "closed_at": "2026-01-29T12:04:59.972586", "acceptance_criteria": ["`TaskBackend` protocol has 19 methods (12 existing + 7 new)", "`update_task` accepts `title`, `priority`, `notes` optional params", "`TaskBackendDefaults` mixin has working default implementations", "`TaskCounts.blocked` field exists", "mypy passes with strict mode", "All new methods have complete docstrings"], "notes": "[Closed: 2026-01-29T12:04:59.972635] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-p1t.2", "title": "Implement new protocol methods in BeadsBackend", "status": "closed", "priority": "P0", "type": "task", "description": "BeadsBackend wraps the `bd` CLI. Each new protocol method needs a corresponding `bd` command wrapper. Follow the existing `_run_bd` pattern \u2014 bd commands that don't return JSON need a follow-up `get_task()` call.\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 run `bd dep add <task_id> <depends_on>`, then `get_task(task_id)`\n2. `remove_dependency(task_id, depends_on)` \u2014 run `bd dep remove <task_id> <depends_on>`, then `get_task(task_id)`\n3. `list_blocked_tasks(parent?)` \u2014 run `bd blocked --json` (or `bd list --status open --json` and filter), parse JSON output\n4. `reopen_task(task_id)` \u2014 run `bd update <id> --status open`, then `get_task(task_id)`\n5. `delete_task(task_id)` \u2014 run `bd delete <id>`, return True on success\n6. `add_label(task_id, label)` \u2014 run `bd label add <id> <label>`, then `get_task(task_id)`\n7. `remove_label(task_id, label)` \u2014 run `bd label remove <id> <label>`, then `get_task(task_id)`\n8. Extend `update_task` to pass `--title`, `--priority`, `--notes` flags when provided\n9. Update `get_task_counts` to include blocked count\n\n**Files:** src/cub/core/tasks/beads.py, tests/test_beads_backend.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463498", "updated_at": "2026-01-29T12:26:32.401999", "closed_at": "2026-01-29T12:26:32.401959", "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Error handling follows existing pattern (ValueError on not found)", "Unit tests pass for all new methods (mocked bd subprocess)"], "notes": "[Closed: 2026-01-29T12:26:32.402002] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-p1t.3", "title": "Implement new protocol methods in JsonlBackend", "status": "closed", "priority": "P0", "type": "task", "description": "JsonlBackend operates on an in-memory task list with atomic file writes. New methods manipulate task fields directly using existing Task model methods (`add_label()`, `remove_label()`, `reopen()`).\n\n**Implementation Steps:**\n1. `add_dependency(task_id, depends_on)` \u2014 find task, append to `depends_on` list, save\n2. `remove_dependency(task_id, depends_on)` \u2014 find task, remove from `depends_on` list, save\n3. `list_blocked_tasks(parent?)` \u2014 filter: status=OPEN, has depends_on, not all deps closed\n4. `reopen_task(task_id)` \u2014 find task, call `task.reopen()`, save\n5. `delete_task(task_id)` \u2014 remove task from list, save, return True\n6. `add_label(task_id, label)` \u2014 find task, call `task.add_label(label)`, save\n7. `remove_label(task_id, label)` \u2014 find task, call `task.remove_label(label)`, save\n8. Extend `update_task` to handle title, priority, notes field updates\n9. Update `get_task_counts` to include blocked count\n10. All mutations use existing atomic write pattern (temp file \u2192 rename)\n\n**Files:** src/cub/core/tasks/jsonl.py, tests/test_jsonl_backend.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463520", "updated_at": "2026-01-29T12:32:41.078321", "closed_at": "2026-01-29T12:32:41.078307", "acceptance_criteria": ["All 7 new methods implemented and callable", "`update_task` supports title, priority, notes parameters", "`get_task_counts` includes blocked count", "Atomic writes for all mutations (no partial state)", "Unit tests pass for all new methods"], "notes": "[Closed: 2026-01-29T12:32:41.078323] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 0}, {"id": "cub-p1t.4", "title": "Build DependencyGraph class", "status": "closed", "priority": "P0", "type": "task", "description": "Pure query object for dependency analysis. Built from a task list snapshot, immutable after construction. Used by AgentFormatter (agent-output spec) and `cub task blocked --agent` for impact analysis and recommendations. This is the critical piece that unblocks the agent-output spec.\n\n**Implementation Steps:**\n1. Create `src/cub/core/tasks/graph.py` with `DependencyGraph` class\n2. Constructor takes `list[Task]`, builds:\n3. `direct_unblocks(task_id) -> list[str]` \u2014 reverse edge lookup\n4. `transitive_unblocks(task_id) -> set[str]` \u2014 BFS from task through reverse edges\n5. `root_blockers(limit=5) -> list[tuple[str, int]]` \u2014 compute transitive_unblocks for all open tasks, sort by count descending\n6. `chains(limit=5) -> list[list[str]]` \u2014 DFS to find longest paths in forward graph\n7. `would_become_ready(task_id) -> list[str]` \u2014 for each task in `direct_unblocks()`, check if ALL other deps are in `_closed`\n8. `has_cycle() -> bool` \u2014 DFS with three-color marking (white/gray/black)\n9. `stats` property \u2014 return dict with node count, edge count, max chain depth\n10. Write comprehensive tests with topologies: empty, single task, linear chain, diamond, forest, cycle, mixed open/closed\n\n**Files:** src/cub/core/tasks/graph.py, tests/test_dependency_graph.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:opus", "complexity:high"], "depends_on": [], "blocks": ["cub-p1t.5"], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463535", "updated_at": "2026-01-29T12:36:55.279963", "closed_at": "2026-01-29T12:36:55.279948", "acceptance_criteria": ["All 6 query methods return correct results for test topologies", "Cycle detection works and doesn't cause infinite loops in other methods", "Closed tasks are correctly excluded from graph (treated as resolved)", "`would_become_ready` checks ALL deps, not just the given task", "`root_blockers` correctly ranks by transitive impact", "`chains` returns paths sorted by length descending", "mypy passes with strict mode", "Tests cover: empty graph, single node, linear chain (5 deep), diamond dependency, forest (disconnected), cycle, mixed open/closed states"], "notes": "[Closed: 2026-01-29T12:36:55.279966] Completed by autonomous execution", "complexity_label": "high", "model_label": "opus", "is_ready": false, "priority_numeric": 0}, {"id": "cub-p1t.5", "title": "Update BothBackend and write cross-backend tests", "status": "closed", "priority": "P1", "type": "task", "description": "BothBackend delegates to primary and secondary backends. It needs to delegate all 7 new methods and log divergences. Also write parametrized tests that verify the same operations work identically across both backends.\n\n**Implementation Steps:**\n1. Update `BothBackend` to delegate all 7 new methods (follow existing delegation pattern)\n2. Inherit from `TaskBackendDefaults` as fallback\n3. Add divergence logging for new methods\n4. Write parametrized pytest tests that run the same test cases against BeadsBackend (mocked) and JsonlBackend (temp files)\n5. Test scenarios: add/remove dependency, list blocked, reopen, delete, add/remove label\n6. Verify `DependencyGraph` produces consistent results from both backend outputs\n\n**Files:** src/cub/core/tasks/both.py, tests/test_task_backends.py", "assignee": "cub-20260129-122038", "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p1t", "created_at": "2026-01-29T11:46:17.463550", "updated_at": "2026-01-29T12:46:37.958238", "closed_at": "2026-01-29T12:46:37.958218", "acceptance_criteria": ["BothBackend delegates all 7 new methods", "Divergence logging works for new methods", "Parametrized tests pass against both backends", "DependencyGraph produces same results regardless of backend", "mypy passes"], "notes": "[Closed: 2026-01-29T12:46:37.958240] Completed by autonomous execution", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-p2c.1", "title": "Add cub task blocked command", "status": "in_progress", "priority": "P1", "type": "task", "description": "The most common gap \u2014 the router currently maps \"what's blocked\" to `bd blocked`. This command shows blocked tasks with optional epic filter. With `--agent`, it includes root blocker analysis and chain lengths from DependencyGraph.\n\n**Implementation Steps:**\n1. Add `blocked` command to task app in `cli/task.py`\n2. Parameters: `--epic` (filter), `--json`, `--agent`\n3. Rich output: table with ID, Priority, Title, Blocked By columns\n4. JSON output: task model dumps\n5. Agent output: call `AgentFormatter.format_blocked()` if available, otherwise fall back to a simple markdown table\n6. Build DependencyGraph from all tasks for analysis hints\n7. Show root blockers and chain summary in agent output\n\n**Files:** src/cub/cli/task.py", "assignee": "cub-20260129-124742", "labels": ["phase-2", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T11:46:17.463571", "updated_at": "2026-01-29T12:48:13.522238", "closed_at": null, "acceptance_criteria": ["`cub task blocked` shows blocked tasks in Rich table", "`--epic` filter works", "`--json` outputs task list as JSON", "`--agent` outputs structured markdown with analysis", "Empty result shows helpful message (\"No blocked tasks\")", "CLI test covers all three output modes"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": false, "priority_numeric": 1}, {"id": "cub-p2c.2", "title": "Add cub task dep add/remove and cub task label add/remove/list commands", "status": "open", "priority": "P1", "type": "task", "description": "Dependency and label management subcommands. These are simple CRUD wrappers around protocol methods with confirmation output.\n\n**Implementation Steps:**\n1. Create `dep` sub-app with `add` and `remove` commands\n2. `cub task dep add <task> <depends-on>` \u2014 calls `add_dependency()`, prints confirmation\n3. `cub task dep remove <task> <depends-on>` \u2014 calls `remove_dependency()`, prints confirmation\n4. Enhance existing `dep list` to show both directions (what this task depends on AND what depends on it)\n5. Create `label` sub-app with `add`, `remove`, `list` commands\n6. `cub task label add <task> <label>` \u2014 calls `add_label()`, prints confirmation\n7. `cub task label remove <task> <label>` \u2014 calls `remove_label()`, prints confirmation\n8. `cub task label list <task>` \u2014 calls `get_task()`, displays labels\n9. All commands support `--json` for machine output\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["phase-2", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T11:46:17.463585", "updated_at": "2026-01-29T11:46:17.463586", "closed_at": null, "acceptance_criteria": ["`cub task dep add/remove` work and confirm the operation", "`cub task dep list <id>` shows both directions", "`cub task label add/remove/list` work and confirm operations", "`--json` output works for all commands", "Error handling for invalid task IDs", "CLI tests for each command"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.3", "title": "Add cub task reopen and cub task delete commands", "status": "open", "priority": "P1", "type": "task", "description": "Lifecycle management commands. Reopen is straightforward. Delete is destructive and needs a confirmation prompt (skippable with `--force`).\n\n**Implementation Steps:**\n1. Add `reopen` command \u2014 calls `reopen_task()`, prints confirmation with task title\n2. Add `delete` command \u2014 prompts \"Delete task {id} '{title}'? [y/N]\" unless `--force` is passed\n3. Both support `--json` for machine output\n4. Error handling: task not found, task not in correct state (e.g., reopen a non-closed task)\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["phase-2", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T11:46:17.463596", "updated_at": "2026-01-29T11:46:17.463597", "closed_at": null, "acceptance_criteria": ["`cub task reopen <id>` reopens a closed task", "`cub task delete <id>` prompts for confirmation", "`cub task delete <id> --force` skips confirmation", "Error messages for invalid states (reopen non-closed, delete non-existent)", "CLI tests"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.4", "title": "Enhance existing cub task list, ready, create, update commands", "status": "open", "priority": "P1", "type": "task", "description": "Existing commands need additional filters and flags to reach parity. `list` and `ready` need `--epic` and `--assignee` filters. `create` needs full flag exposure. `update` needs `--title`, `--priority`, `--notes`.\n\n**Implementation Steps:**\n1. `cub task list`: add `--epic` (filter by parent), `--assignee` (filter by assignee) options\n2. `cub task ready`: add `--epic` filter, add `--by impact|priority` ordering option (impact uses DependencyGraph)\n3. `cub task create`: ensure CLI exposes `--type`, `--priority`, `--epic` (as `--parent`), `--description`, `--depends-on` (comma-separated list)\n4. `cub task update`: add `--title`, `--priority`, `--notes` flags alongside existing `--description`, `--assignee`, `--status`\n5. For `ready --by impact`: build DependencyGraph, sort tasks by `transitive_unblocks` count descending\n\n**Files:** src/cub/cli/task.py", "assignee": null, "labels": ["phase-2", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T11:46:17.463607", "updated_at": "2026-01-29T11:46:17.463607", "closed_at": null, "acceptance_criteria": ["`cub task list --epic <id>` filters correctly", "`cub task list --assignee <name>` filters correctly", "`cub task ready --epic <id>` filters correctly", "`cub task ready --by impact` sorts by unblock count", "`cub task create` exposes all flags", "`cub task update` supports title, priority, notes", "CLI tests for new filters and flags"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p2c.5", "title": "Add cub task search command", "status": "open", "priority": "P2", "type": "task", "description": "Full-text search across task titles and descriptions. BeadsBackend wraps `bd search`. JsonlBackend does substring match on title + description in memory. This is P2 but included since we're not excluding anything.\n\n**Implementation Steps:**\n1. Add `search_tasks(query: str) -> list[Task]` to `TaskBackend` protocol\n2. Implement in BeadsBackend: run `bd search <query> --json`, parse results\n3. Implement in JsonlBackend: case-insensitive substring match on title and description\n4. Add `search` command to task CLI: `cub task search <query>`\n5. Support `--json` and `--agent` output modes\n6. Show match count and results table\n\n**Files:** src/cub/core/tasks/backend.py, src/cub/core/tasks/beads.py, src/cub/core/tasks/jsonl.py, src/cub/cli/task.py", "assignee": null, "labels": ["phase-2", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-p2c", "created_at": "2026-01-29T11:46:17.463618", "updated_at": "2026-01-29T11:46:17.463619", "closed_at": null, "acceptance_criteria": ["`cub task search \"auth\"` finds tasks with \"auth\" in title or description", "Works with both backends", "`--json` and Rich output modes work", "Empty results show helpful message", "Tests for both backends"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-p3s.1", "title": "Update router skill and passthrough skills", "status": "open", "priority": "P1", "type": "task", "description": "The router skill (`.claude/commands/cub.md`) currently maps \"what's blocked\" to `bd blocked`. Passthrough skills reference `bd` commands. Update all to use `cub task` equivalents with `--agent` flag.\n\n**Implementation Steps:**\n1. In `.claude/commands/cub.md`:\n2. In `.claude/commands/cub:tasks.md`:\n3. Review other skill files for any remaining `bd` references\n\n**Files:** .claude/commands/cub.md, .claude/commands/cub:tasks.md", "assignee": null, "labels": ["phase-3", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-p3s", "created_at": "2026-01-29T11:46:17.463629", "updated_at": "2026-01-29T11:46:17.463629", "closed_at": null, "acceptance_criteria": ["Router skill has no `bd` references (except in \"power user\" context if desired)", "All task intent patterns route to `cub task` commands", "New subcommands (blocked, dep, label, reopen, delete, search) are in routing table", "`--agent` flag used in all command invocations within skills"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-p3s.2", "title": "Update CLAUDE.md and PROMPT.md documentation", "status": "open", "priority": "P2", "type": "task", "description": "CLAUDE.md (agent instructions) and `.cub/PROMPT.md` (runloop instructions) reference `bd` commands in examples. Update all examples to use `cub task` equivalents. Keep `bd` mentioned only in the \"Pre-approved Commands\" section (bd is still available for power users).\n\n**Implementation Steps:**\n1. In CLAUDE.md:\n2. In `.cub/PROMPT.md`:\n3. Audit all `.md` files in `.cub/` directory for stale `bd` references\n\n**Files:** CLAUDE.md, .cub/PROMPT.md", "assignee": null, "labels": ["phase-3", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-p3s", "created_at": "2026-01-29T11:46:17.463639", "updated_at": "2026-01-29T11:46:17.463640", "closed_at": null, "acceptance_criteria": ["CLAUDE.md examples use `cub task` not `bd` (except Pre-approved section)", "PROMPT.md task instructions use `cub task`", "No stale `bd` references in user-facing documentation", "`bd` still listed as pre-approved for power users"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 2}, {"id": "cub-a1f", "title": "agent-output #1: AgentFormatter & --agent Flag", "status": "open", "priority": "P0", "type": "epic", "description": "Build the AgentFormatter module and wire `--agent` flags into Phase 1 CLI commands (task ready, task show, status, suggest). This is the core value \u2014 Claude gets structured, compact markdown with pre-computed analysis hints instead of raw Rich output.", "assignee": null, "labels": ["phase-1", "complexity:high", "model:sonnet"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T11:46:50.492408", "updated_at": "2026-01-29T11:46:50.492428", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "high", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-a2s", "title": "agent-output #2: Skill Updates & Router Integration", "status": "open", "priority": "P1", "type": "epic", "description": "Update all passthrough skill files and the router skill to use `--agent` flag in their CLI invocations. This closes the loop: `/cub` \u2192 router \u2192 `cub task ready --agent` \u2192 structured markdown \u2192 Claude interprets.", "assignee": null, "labels": ["phase-2", "complexity:low", "model:haiku"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T11:46:50.492616", "updated_at": "2026-01-29T11:46:50.492617", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-a3r", "title": "agent-output #3: Route Learning", "status": "open", "priority": "P1", "type": "epic", "description": "Build the hook-based route learning system: observe cub command usage via hooks, compile frequency data at session end, surface compiled routes to the router skill via file reference.", "assignee": null, "labels": ["phase-3", "complexity:medium", "model:sonnet"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T11:46:50.492636", "updated_at": "2026-01-29T11:46:50.492636", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-a4e", "title": "agent-output #4: Extended Commands", "status": "open", "priority": "P2", "type": "epic", "description": "Add `--agent` support to Phase 2 and Phase 3 commands. These depend on task parity (cub-task-parity) landing for `blocked` and `list`, and doctor refactor for `doctor`.", "assignee": null, "labels": ["phase-4", "complexity:medium", "model:sonnet"], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T11:46:50.492652", "updated_at": "2026-01-29T11:46:50.492653", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-a1f.1", "title": "Build AgentFormatter module with Phase 1 format methods", "status": "open", "priority": "P0", "type": "task", "description": "The AgentFormatter is a collection of static methods that transform service-layer data into structured markdown for LLM consumption. Each method follows the envelope template: heading, summary line, data tables, truncation notice, analysis section. The formatter returns plain strings \u2014 no Rich, no console. DependencyGraph is an optional parameter; when None, analysis hints that require graph queries are omitted.\n\n**Implementation Steps:**\n1. Create `src/cub/core/services/agent_format.py` with `AgentFormatter` class\n2. Implement shared helpers:\n3. Implement `format_ready(tasks, graph=None)`:\n4. Implement `format_task_detail(task, graph=None, epic_progress=None)`:\n5. Implement `format_status(stats, epic_progress=None)`:\n6. Implement `format_suggestions(suggestions)`:\n7. Write snapshot tests for each method with representative inputs (0, 1, 10, 20 items)\n8. Write token budget test: assert output character count < 2000 for representative inputs\n\n**Files:** src/cub/core/services/agent_format.py, tests/test_agent_format.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:high"], "depends_on": [], "blocks": ["cub-a1f.2"], "parent": "cub-a1f", "created_at": "2026-01-29T11:47:42.431379", "updated_at": "2026-01-29T11:47:42.431403", "closed_at": null, "acceptance_criteria": ["All 4 format methods return valid markdown strings", "Output follows the envelope template (heading, summary, tables, truncation, analysis)", "Truncation works: shows all if \u2264 15 items, truncates to 10 with notice if > 15", "Analysis section omits graph-dependent hints when graph is None", "Analysis section includes graph-dependent hints when graph is provided", "No Rich or console dependencies \u2014 pure string operations", "Token budget: all representative outputs < 2000 characters", "mypy passes with strict mode", "Snapshot tests pass for each method"], "notes": "", "complexity_label": "high", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-a1f.2", "title": "Wire --agent flag into Phase 1 CLI commands", "status": "open", "priority": "P0", "type": "task", "description": "Add `--agent` flag to `cub task ready`, `cub task show`, `cub status`, and `cub suggest`. Follow the existing `--json` pattern. When `--agent` is passed, call the corresponding AgentFormatter method and print the result. `--agent` wins silently over `--json` if both are passed. Include `_try_build_graph` helper that attempts to import DependencyGraph (returns None if not available yet).\n\n**Implementation Steps:**\n1. Create `_try_build_graph(backend)` helper function in `cli/task.py`:\n2. In `cub task ready`:\n3. In `cub task show`:\n4. In `cub status` (status.py):\n5. In `cub suggest` (suggest.py):\n6. Write CLI integration tests for each command with `--agent` flag\n\n**Files:** src/cub/cli/task.py, src/cub/cli/status.py, src/cub/cli/suggest.py", "assignee": null, "labels": ["phase-1", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-a1f", "created_at": "2026-01-29T11:47:42.431536", "updated_at": "2026-01-29T11:47:42.431537", "closed_at": null, "acceptance_criteria": ["`cub task ready --agent` outputs structured markdown", "`cub task show <id> --agent` outputs structured markdown", "`cub status --agent` outputs structured markdown", "`cub suggest --agent` outputs structured markdown", "`--agent` takes precedence over `--json` silently", "`_try_build_graph` returns None gracefully when DependencyGraph not available", "`_try_build_graph` returns working graph when DependencyGraph is available", "CLI tests pass for all four commands"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 0}, {"id": "cub-a2s.1", "title": "Update passthrough skills and router to use --agent", "status": "open", "priority": "P1", "type": "task", "description": "Seven passthrough skills exist and the router skill maps intent to CLI commands. Update all command invocations to include `--agent` so Claude always gets structured output when routing through skills. The router skill needs `--agent` on all CLI command mappings.\n\n**Implementation Steps:**\n1. Update `.claude/commands/cub:tasks.md`:\n2. Update `.claude/commands/cub:status.md`:\n3. Update `.claude/commands/cub:suggest.md`:\n4. Update `.claude/commands/cub:ledger.md`:\n5. Update `.claude/commands/cub:doctor.md`:\n6. Update `.claude/commands/cub.md` (router):\n7. Add instruction in router skill about how Claude should treat `--agent` output:\n\n**Files:** .claude/commands/cub.md, .claude/commands/cub:tasks.md, .claude/commands/cub:status.md, .claude/commands/cub:suggest.md, .claude/commands/cub:ledger.md, .claude/commands/cub:doctor.md", "assignee": null, "labels": ["phase-2", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-a2s", "created_at": "2026-01-29T11:47:42.431554", "updated_at": "2026-01-29T11:47:42.431555", "closed_at": null, "acceptance_criteria": ["All Phase 1 commands in skill files use `--agent`", "Router skill intent table uses `--agent` for all supported commands", "Router skill includes instruction on treating analysis hints", "Skills for commands without `--agent` support are left unchanged", "No broken command invocations"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-a3r.1", "title": "Add route observation to cub-hook.sh", "status": "open", "priority": "P1", "type": "task", "description": "The existing `cub-hook.sh` fast-path filter fires on every Bash tool use. It already detects `cub` commands for the symbiotic workflow. Extend it to log command usage to `.cub/route-log.jsonl`. This is 4 lines of shell \u2014 minimal latency impact.\n\n**Implementation Steps:**\n1. In `.cub/scripts/hooks/cub-hook.sh`, in the PostToolUse/Bash handler where `cub ` commands are detected:\n2. Add `.cub/route-log.jsonl` to `.gitignore` (raw log is local-only)\n3. Ensure the logging doesn't interfere with existing hook behavior (the line is additive)\n4. Test manually: run a `cub task ready` in Claude Code, verify log entry appears\n\n**Files:** .cub/scripts/hooks/cub-hook.sh, .gitignore", "assignee": null, "labels": ["phase-3", "model:haiku", "complexity:low"], "depends_on": [], "blocks": ["cub-a3r.2"], "parent": "cub-a3r", "created_at": "2026-01-29T11:47:42.431572", "updated_at": "2026-01-29T11:47:42.431572", "closed_at": null, "acceptance_criteria": ["Every `cub *` command executed via Bash tool use is logged to `.cub/route-log.jsonl`", "Log entries have ISO timestamp and full command string", "`.cub/route-log.jsonl` is in `.gitignore`", "Existing hook behavior is unchanged", "No measurable latency impact (shell echo + redirect)"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-a3r.2", "title": "Build route compiler and cub routes CLI", "status": "open", "priority": "P1", "type": "task", "description": "The route compiler reads the raw log, normalizes commands (strips task IDs, file paths), aggregates by frequency, filters noise (count < 3), and writes a markdown table to `.cub/learned-routes.md`. This compiled file is git-tracked and shared with the team. The compiler is triggered by the Stop hook at session end.\n\n**Implementation Steps:**\n1. Create `src/cub/core/routes/compiler.py`:\n2. Create `src/cub/core/routes/__init__.py`\n3. Create `src/cub/cli/routes.py`:\n4. Register routes app in `src/cub/cli/__init__.py`\n5. Add Stop hook trigger in `cub-hook.sh`:\n6. Write tests for `normalize_command` with edge cases (various command patterns)\n7. Write tests for `compile_routes` with sample JSONL input\n8. Write tests for `render_learned_routes` output format\n\n**Files:** src/cub/core/routes/__init__.py, src/cub/core/routes/compiler.py, src/cub/cli/routes.py, src/cub/cli/__init__.py, .cub/scripts/hooks/cub-hook.sh, tests/test_route_compiler.py", "assignee": null, "labels": ["phase-3", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-a3r.3"], "parent": "cub-a3r", "created_at": "2026-01-29T11:47:42.431583", "updated_at": "2026-01-29T11:47:42.431584", "closed_at": null, "acceptance_criteria": ["`normalize_command` correctly strips IDs and values from 10+ command patterns", "`compile_routes` aggregates correctly, filters count < 3, sorts by frequency", "`compile_routes` handles max_entries truncation for large logs", "`render_learned_routes` produces valid markdown table", "`cub routes compile` writes `.cub/learned-routes.md`", "`cub routes show` displays the compiled routes", "`cub routes clear` deletes both files", "Stop hook triggers compilation in background", "mypy passes", "Tests pass for normalizer, compiler, and renderer"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 1}, {"id": "cub-a3r.3", "title": "Add learned routes section to router skill", "status": "open", "priority": "P1", "type": "task", "description": "The router skill needs to reference the compiled routes file so Claude can use frequency data as a tiebreaker for ambiguous intent. This is the only point where LLM judgment enters the route learning system.\n\n**Implementation Steps:**\n1. Add a \"Learned Routes\" section to `.claude/commands/cub.md`:\n2. Place this section after the \"Execution Rules\" section and before \"Examples\"\n3. The `@` prefix ensures Claude Code injects the file content into context\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": ["phase-3", "model:haiku", "complexity:low"], "depends_on": [], "blocks": [], "parent": "cub-a3r", "created_at": "2026-01-29T11:47:42.431594", "updated_at": "2026-01-29T11:47:42.431595", "closed_at": null, "acceptance_criteria": ["Router skill references `@.cub/learned-routes.md`", "Instructions tell Claude to use learned routes as tiebreaker, not override", "Section is positioned logically in the skill file", "Skill still works correctly when learned-routes.md doesn't exist yet"], "notes": "", "complexity_label": "low", "model_label": "haiku", "is_ready": true, "priority_numeric": 1}, {"id": "cub-a4e.1", "title": "Add AgentFormatter methods for blocked, list, and ledger", "status": "open", "priority": "P2", "type": "task", "description": "Three more commands get `--agent` support. `format_blocked` uses DependencyGraph heavily (root blockers, chain visualization). `format_list` is a general-purpose task table. `format_ledger` shows recent completions with cost summary. These depend on the task parity spec having landed `cub task blocked` and `cub task list` enhancements.\n\n**Implementation Steps:**\n1. Add `format_blocked(tasks, graph=None)` to AgentFormatter:\n2. Add `format_list(tasks)` to AgentFormatter:\n3. Add `format_ledger(entries, stats=None)` to AgentFormatter:\n4. Write snapshot tests for each method\n5. Write token budget tests\n\n**Files:** src/cub/core/services/agent_format.py, tests/test_agent_format.py", "assignee": null, "labels": ["phase-4", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": ["cub-a4e.2"], "parent": "cub-a4e", "created_at": "2026-01-29T11:47:42.431604", "updated_at": "2026-01-29T11:47:42.431605", "closed_at": null, "acceptance_criteria": ["`format_blocked` produces correct output with and without graph", "`format_blocked` with graph shows root blockers and chains", "`format_list` produces correct output with truncation", "`format_ledger` produces correct output with cost summary", "All outputs < 2000 characters for representative inputs", "Snapshot tests pass"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-a4e.2", "title": "Wire --agent flag into blocked, list, and ledger CLI commands", "status": "open", "priority": "P2", "type": "task", "description": "Add `--agent` flag to `cub task blocked`, `cub task list`, and `cub ledger show`. These commands should already exist from the task parity spec. Wire in the AgentFormatter methods.\n\n**Implementation Steps:**\n1. In `cub task blocked` (cli/task.py):\n2. In `cub task list` (cli/task.py):\n3. In `cub ledger show` (cli/ledger.py):\n4. Update corresponding skill files to use `--agent`\n5. Write CLI tests\n\n**Files:** src/cub/cli/task.py, src/cub/cli/ledger.py, .claude/commands/cub:tasks.md, .claude/commands/cub:ledger.md", "assignee": null, "labels": ["phase-4", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-a4e", "created_at": "2026-01-29T11:47:42.431614", "updated_at": "2026-01-29T11:47:42.431615", "closed_at": null, "acceptance_criteria": ["`cub task blocked --agent` outputs structured markdown", "`cub task list --agent` outputs structured markdown", "`cub ledger show --agent` outputs structured markdown", "Skill files updated to use `--agent` for these commands", "CLI tests pass"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}, {"id": "cub-a4e.3", "title": "Add --agent support for doctor command (requires refactor)", "status": "open", "priority": "P2", "type": "task", "description": "The doctor command currently prints directly via Rich console. To support `--agent`, it needs to return structured diagnostic results instead. This is a refactor of the existing doctor command internals, not just adding a flag.\n\n**Implementation Steps:**\n1. Define `DiagnosticResult` model (or use existing if one exists):\n2. Refactor doctor command to collect `list[DiagnosticResult]` before rendering\n3. Add `format_doctor(checks: list[DiagnosticResult])` to AgentFormatter:\n4. Add `--agent` flag to `cub doctor` command\n5. If agent: call `AgentFormatter.format_doctor(checks)`, print\n6. Ensure existing Rich output is unchanged when `--agent` is not passed\n7. Update `cub:doctor.md` skill to use `--agent`\n8. Write tests for both the refactored data collection and agent formatting\n\n**Files:** src/cub/cli/doctor.py, src/cub/core/services/agent_format.py, .claude/commands/cub:doctor.md, tests/test_agent_format.py", "assignee": null, "labels": ["phase-4", "model:sonnet", "complexity:medium"], "depends_on": [], "blocks": [], "parent": "cub-a4e", "created_at": "2026-01-29T11:47:42.431624", "updated_at": "2026-01-29T11:47:42.431625", "closed_at": null, "acceptance_criteria": ["Doctor command collects structured `DiagnosticResult` list before rendering", "Existing Rich output is unchanged (no regression)", "`cub doctor --agent` outputs structured markdown", "`format_doctor` produces correct output", "Skill file updated", "Tests pass for both output modes"], "notes": "", "complexity_label": "medium", "model_label": "sonnet", "is_ready": true, "priority_numeric": 2}], "difference_summary": "List length mismatch: 88 != 57"}
{"timestamp": "2026-01-29T12:50:42.620989", "operation": "list_blocked_tasks", "task_id": null, "primary_result": [{"id": "cub-a1f.2", "title": "Wire --agent flag into Phase 1 CLI commands", "status": "open", "priority": "P0", "type": "task", "description": "Add `--agent` flag to `cub task ready`, `cub task show`, `cub status`, and `cub suggest`. Follow the existing `--json` pattern. When `--agent` is passed, call the corresponding AgentFormatter method and print the result. `--agent` wins silently over `--json` if both are passed. Include `_try_build_graph` helper that attempts to import DependencyGraph (returns None if not available yet).\n\n**Implementation Steps:**\n1. Create `_try_build_graph(backend)` helper function in `cli/task.py`:\n2. In `cub task ready`:\n3. In `cub task show`:\n4. In `cub status` (status.py):\n5. In `cub suggest` (suggest.py):\n6. Write CLI integration tests for each command with `--agent` flag\n\n**Files:** src/cub/cli/task.py, src/cub/cli/status.py, src/cub/cli/suggest.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495119Z", "updated_at": "2026-01-29T11:46:55.683939-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r4h.2", "title": "Integration tests for exit scenarios", "status": "open", "priority": "P0", "type": "task", "description": "We need automated tests that verify clean exits on all paths. These tests ensure regressions are caught early.\n\n**Implementation Steps:**\n1. Add `pytest-timeout` to dev dependencies if not present\n2. Create `tests/integration/test_run_exits.py`\n3. Write tests for: Ctrl+C (SIGINT), SIGTERM, budget exhaustion, iteration limit reached, task failure\n4. Each test should verify: clean exit (no crash), status.json updated, run artifact created\n5. Use subprocess to run `cub run` and send signals\n\n**Files:** tests/integration/test_run_exits.py, pyproject.toml", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923515Z", "updated_at": "2026-01-26T16:32:00.156994-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r4h.3", "title": "Ensure artifacts on all exits", "status": "open", "priority": "P0", "type": "task", "description": "Based on audit findings, fix any exit paths that don't preserve artifacts. This is the core deliverable of E4.\n\n**Implementation Steps:**\n1. Review gaps identified in cub-r4h.1 audit\n2. Add try/finally blocks where needed to ensure `write_run_artifact()` is called\n3. Ensure `StatusWriter.write()` is called before any exit\n4. Handle edge cases: exceptions during artifact write, partial state\n5. Run integration tests to verify fixes\n\n**Files:** src/cub/cli/run.py, src/cub/core/status/writer.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923537Z", "updated_at": "2026-01-26T16:32:00.157257-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r5c.2", "title": "Implement CircuitBreaker class", "status": "open", "priority": "P0", "type": "task", "description": "The core circuit breaker logic. Uses asyncio timeout to detect hung harness execution.\n\n**Implementation Steps:**\n1. Create `src/cub/core/circuit_breaker.py`\n2. Implement `CircuitBreaker` class with:\n3. On timeout: raise `CircuitBreakerTripped` exception with clear message\n4. Handle graceful cancellation of the wrapped coroutine\n5. Write unit tests\n\n**Files:** src/cub/core/circuit_breaker.py, tests/unit/test_circuit_breaker.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923575Z", "updated_at": "2026-01-26T16:32:00.158012-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-r5c.3", "title": "Integrate circuit breaker into run.py", "status": "open", "priority": "P0", "type": "task", "description": "Wire the circuit breaker into the run loop so harness invocations are timeout-protected.\n\n**Implementation Steps:**\n1. Import CircuitBreaker in `src/cub/cli/run.py`\n2. Create CircuitBreaker instance from config in run initialization\n3. Wrap `_invoke_harness()` call with `circuit_breaker.execute()`\n4. Handle `CircuitBreakerTripped` exception: log, update status, exit cleanly with artifacts\n5. Add circuit breaker status to run summary output\n\n**Files:** src/cub/cli/run.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923591Z", "updated_at": "2026-01-26T16:32:00.158242-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 0}, {"id": "cub-4wwm", "title": "Enable parallel test execution with pytest-xdist", "status": "open", "priority": "P1", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:55.544262-05:00", "updated_at": "2026-01-18T21:55:55.544262-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-6jpc", "title": "Phase 2: Coverage Expansion", "status": "open", "priority": "P1", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:55:24.407514-05:00", "updated_at": "2026-01-18T21:55:24.407514-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-a3r.2", "title": "Build route compiler and cub routes CLI", "status": "open", "priority": "P1", "type": "task", "description": "The route compiler reads the raw log, normalizes commands (strips task IDs, file paths), aggregates by frequency, filters noise (count < 3), and writes a markdown table to `.cub/learned-routes.md`. This compiled file is git-tracked and shared with the team. The compiler is triggered by the Stop hook at session end.\n\n**Implementation Steps:**\n1. Create `src/cub/core/routes/compiler.py`:\n2. Create `src/cub/core/routes/__init__.py`\n3. Create `src/cub/cli/routes.py`:\n4. Register routes app in `src/cub/cli/__init__.py`\n5. Add Stop hook trigger in `cub-hook.sh`:\n6. Write tests for `normalize_command` with edge cases (various command patterns)\n7. Write tests for `compile_routes` with sample JSONL input\n8. Write tests for `render_learned_routes` output format\n\n**Files:** src/cub/core/routes/__init__.py, src/cub/core/routes/compiler.py, src/cub/cli/routes.py, src/cub/cli/__init__.py, .cub/scripts/hooks/cub-hook.sh, tests/test_route_compiler.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495159Z", "updated_at": "2026-01-29T11:46:55.684499-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-a3r.3", "title": "Add learned routes section to router skill", "status": "open", "priority": "P1", "type": "task", "description": "The router skill needs to reference the compiled routes file so Claude can use frequency data as a tiebreaker for ambiguous intent. This is the only point where LLM judgment enters the route learning system.\n\n**Implementation Steps:**\n1. Add a \"Learned Routes\" section to `.claude/commands/cub.md`:\n2. Place this section after the \"Execution Rules\" section and before \"Examples\"\n3. The `@` prefix ensures Claude Code injects the file content into context\n\n**Files:** .claude/commands/cub.md", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495168Z", "updated_at": "2026-01-29T11:46:55.684676-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r6s.2", "title": "Implement InstructionGenerator", "status": "open", "priority": "P1", "type": "task", "description": "Generate CLAUDE.md and AGENTS.md with workflow instructions that guide agents to use cub commands.\n\n**Implementation Steps:**\n1. Create `src/cub/core/instructions.py`\n2. Implement `generate_agents_md(project_dir, config)` - harness-agnostic instructions\n3. Implement `generate_claude_md(project_dir, config)` - Claude-specific additions\n4. Include sections: finding tasks (`cub status`), claiming work (`cub wip`), completing (`cub done`), logging (`cub log`)\n5. Include escape hatch language from E5\n6. Make output customizable via config (future: templates)\n\n**Files:** src/cub/core/instructions.py, tests/unit/test_instructions.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923641Z", "updated_at": "2026-01-26T16:32:00.159055-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r6s.3", "title": "Update cub init for AGENTS.md", "status": "open", "priority": "P1", "type": "task", "description": "`cub init` should create AGENTS.md at project root for cross-harness compatibility.\n\n**Implementation Steps:**\n1. Update `src/cub/cli/init_cmd.py` to call InstructionGenerator\n2. Generate AGENTS.md at project root (not in .cub/)\n3. Generate/update CLAUDE.md at project root\n4. Don't overwrite if files exist (or prompt user)\n5. Add success message mentioning the files created\n\n**Files:** src/cub/cli/init_cmd.py", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923654Z", "updated_at": "2026-01-26T16:32:00.159256-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-r6s.6", "title": "Manual testing: direct session workflow", "status": "open", "priority": "P1", "type": "task", "description": "The ultimate validation: Marc runs Claude Code directly and verifies the ledger captures work naturally.\n\n**Implementation Steps:**\n1. Create test protocol in `plans/reliability-phase/e6-manual-tests.md`\n2. Scenarios: start direct session, claim task with `cub wip`, do work, complete with `cub done`\n3. Verify: ledger entry created, task status updated, session log captured\n4. Test friction: is the workflow natural? What's awkward?\n5. Document findings and iterate\n\n**Files:** plans/reliability-phase/e6-manual-tests.md", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923692Z", "updated_at": "2026-01-26T16:32:00.160048-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 1}, {"id": "cub-a4e.2", "title": "Wire --agent flag into blocked, list, and ledger CLI commands", "status": "open", "priority": "P2", "type": "task", "description": "Add `--agent` flag to `cub task blocked`, `cub task list`, and `cub ledger show`. These commands should already exist from the task parity spec. Wire in the AgentFormatter methods.\n\n**Implementation Steps:**\n1. In `cub task blocked` (cli/task.py):\n2. In `cub task list` (cli/task.py):\n3. In `cub ledger show` (cli/ledger.py):\n4. Update corresponding skill files to use `--agent`\n5. Write CLI tests\n\n**Files:** src/cub/cli/task.py, src/cub/cli/ledger.py, .claude/commands/cub:tasks.md, .claude/commands/cub:ledger.md", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-29T16:46:50.495183Z", "updated_at": "2026-01-29T11:46:55.685013-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-bg5k", "title": "Create pre-commit hook for affected tests", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:57.715668-05:00", "updated_at": "2026-01-18T21:56:57.715668-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-ck1z", "title": "Phase 4: CI Hardening", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:33.956036-05:00", "updated_at": "2026-01-18T21:57:33.956036-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-dsl4", "title": "Add coverage trend gate to CI", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:49.523611-05:00", "updated_at": "2026-01-18T21:57:49.523611-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-e2h9", "title": "Phase 3: Smart Local Testing", "status": "open", "priority": "P2", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:56:42.144734-05:00", "updated_at": "2026-01-18T21:56:42.144734-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-gah6", "title": "Add make test-fast target", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:02.898015-05:00", "updated_at": "2026-01-18T21:57:02.898015-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-r6s.5", "title": "Implement hook handlers for artifact capture", "status": "open", "priority": "P2", "type": "task", "description": "Based on hook research, implement handlers to auto-capture artifacts when possible.\n\n**Implementation Steps:**\n1. Create `src/cub/core/harness/hooks.py`\n2. Implement `handle_hook_event(event_type, payload)` dispatcher\n3. For PostToolUse/Write: detect writes to plans/, log to ledger\n4. For Stop: capture session end, finalize any open ledger entries\n5. Parse payloads defensively (malformed \u2192 skip, don't crash)\n6. Create hook scripts for `.cub/hooks/` that call these handlers\n\n**Files:** src/cub/core/harness/hooks.py, .cub/hooks/", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-26T21:31:54.923682Z", "updated_at": "2026-01-26T16:32:00.159779-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-vxg3", "title": "Add test status badge to README", "status": "open", "priority": "P2", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:57:54.738546-05:00", "updated_at": "2026-01-18T21:57:54.738546-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 2}, {"id": "cub-d0z5", "title": "Add performance regression tests", "status": "open", "priority": "P3", "type": "task", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:46.612153-05:00", "updated_at": "2026-01-18T21:58:46.612153-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}, {"id": "cub-i8b6", "title": "Phase 5: Refinement", "status": "open", "priority": "P3", "type": "epic", "description": "", "assignee": null, "labels": [], "depends_on": [], "blocks": [], "parent": null, "created_at": "2026-01-18T21:58:25.819537-05:00", "updated_at": "2026-01-18T21:58:25.819537-05:00", "closed_at": null, "acceptance_criteria": [], "notes": "", "complexity_label": null, "model_label": null, "is_ready": true, "priority_numeric": 3}], "secondary_result": "[]", "difference_summary": "List length mismatch: 22 != 0"}
