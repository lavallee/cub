diff --git a/.beads/issues.jsonl b/.beads/issues.jsonl
index 13d02cb..97f5789 100644
--- a/.beads/issues.jsonl
+++ b/.beads/issues.jsonl
@@ -50,40 +50,40 @@
 {"id":"cub-050","title":"Integrate beads assignee with session name","description":"## Context\nSetting beads assignee to session name enables tracking which curb instance claimed each task.\n\n## Implementation Hints\n\n**Recommended Model:** haiku\n**Estimated Duration:** 20m\n**Approach:** Call bd update --assignee when claiming tasks.\n\n## Implementation Steps\n1. In tasks.sh task_claim function, check if using beads backend\n2. If beads, call: bd update \u003ctask-id\u003e --assignee \u003csession-name\u003e\n3. Get session name from session_get_name()\n4. Handle beads not available gracefully\n5. Log assignee setting\n\n## Acceptance Criteria\n- [ ] Beads tasks get assignee set to session name\n- [ ] Works only when using beads backend\n- [ ] Graceful handling if beads unavailable\n- [ ] Assignee visible in bd show output\n\n## Files Likely Involved\n- lib/tasks.sh\n- lib/beads.sh\n- lib/session.sh\n\n## Notes\nOnly applies to beads backend, not prd.json.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-10T10:15:02.633149-05:00","updated_at":"2026-01-11T11:35:07.566419-05:00","closed_at":"2026-01-11T11:35:07.566419-05:00","close_reason":"Closed","labels":["complexity:low","logic","model:haiku","phase-6"],"dependencies":[{"issue_id":"cub-050","depends_on_id":"cub-E06","type":"parent-child","created_at":"2026-01-10T10:17:12.176412-05:00","created_by":"lavallee"}]}
 {"id":"cub-051","title":"Final integration test pass","description":"## Context\nFull end-to-end testing before 1.0 release.\n\n## Implementation Hints\n\n**Recommended Model:** sonnet\n**Estimated Duration:** 30m\n**Approach:** Run all tests, manual E2E testing, verify all features.\n\n## Implementation Steps\n1. Run full BATS test suite\n2. Run E2E tests in tests/e2e/\n3. Manual test: curb init → curb run → curb status → curb explain\n4. Verify artifacts generated correctly\n5. Verify git workflow (branch, commits)\n6. Verify guardrails work\n7. Verify failure handling\n8. Test with both beads and prd.json backends\n\n## Acceptance Criteria\n- [ ] All automated tests pass\n- [ ] E2E workflow completes successfully\n- [ ] All new features work correctly\n- [ ] No regressions from previous version\n- [ ] Documentation matches behavior\n\n## Files Likely Involved\n- All project files\n\n## Notes\nThis is the pre-release validation pass.","status":"closed","priority":1,"issue_type":"task","assignee":"uakari","created_at":"2026-01-10T10:15:02.633149-05:00","updated_at":"2026-01-11T12:04:54.33975-05:00","closed_at":"2026-01-11T12:04:54.33975-05:00","close_reason":"All integration tests pass: 730/732 BATS tests, E2E tests, manual testing complete. Fixed test isolation bug (CURB_PROJECT_DIR not unset). All features verified working.","labels":["complexity:medium","model:sonnet","phase-6","test"],"dependencies":[{"issue_id":"cub-051","depends_on_id":"cub-E06","type":"parent-child","created_at":"2026-01-10T10:17:12.211713-05:00","created_by":"lavallee"}]}
 {"id":"cub-052","title":"CHECKPOINT: 1.0 release validation","description":"## Context\nFinal checkpoint before declaring 1.0 release ready.\n\n## Implementation Hints\n\n**Recommended Model:** sonnet\n**Estimated Duration:** 25m\n**Approach:** Final review of all requirements and quality.\n\n## Implementation Steps\n1. Review triage requirements - all P0 complete?\n2. Review architecture - all components implemented?\n3. All checkpoints passed?\n4. Documentation complete and accurate?\n5. UPGRADING.md ready for existing users?\n6. Version number updated to 1.0.0?\n7. Create release notes\n8. Tag release\n\n## Acceptance Criteria\n- [ ] All P0 requirements implemented\n- [ ] All P1 requirements implemented (or documented as deferred)\n- [ ] All tests pass\n- [ ] Documentation complete\n- [ ] Ready for public release\n\n## Files Likely Involved\n- All project files\n\n## Notes\nFinal 1.0 checkpoint. Congratulations on reaching this milestone!","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-10T10:15:02.633149-05:00","updated_at":"2026-01-10T18:25:26.507837-05:00","closed_at":"2026-01-10T18:25:26.507837-05:00","close_reason":"1.0 release validation complete. All P0 requirements implemented and tested. P1 requirements documented as deferred to post-1.0 releases. Tests passing (341+), documentation complete (2275+ lines), version set to 1.0.0, release notes created.","labels":["checkpoint","complexity:medium","model:sonnet","phase-6"],"dependencies":[{"issue_id":"cub-052","depends_on_id":"cub-E06","type":"parent-child","created_at":"2026-01-10T10:17:12.246655-05:00","created_by":"lavallee"}]}
-{"id":"cub-053","title":"Initialize Python project with uv","description":"## Context\nSet up the Python project structure using uv for fast dependency management. This is the foundation for all Python code.\n\n## Implementation Hints\n**Recommended Model:** haiku\n**Estimated Duration:** 1h\n**Approach:** Use uv init, configure pyproject.toml with project metadata and dependencies.\n\n## Implementation Steps\n1. Run `uv init` in project root\n2. Configure pyproject.toml with:\n   - Project name: cub\n   - Python version: \u003e=3.10\n   - Dependencies: typer, pydantic, rich, GitPython, pytest\n   - Entry point: cub = \"cub.cli:app\"\n3. Create src/cub/ directory structure\n4. Add __init__.py and __main__.py\n5. Verify `uv run python -m cub --help` works\n\n## Acceptance Criteria\n- [ ] pyproject.toml exists with correct metadata\n- [ ] uv.lock generated\n- [ ] `uv run python -m cub --help` shows Typer help\n- [ ] Project installable with `uv pip install -e .`\n\n## Files Likely Involved\n- pyproject.toml (new)\n- src/cub/__init__.py (new)\n- src/cub/__main__.py (new)\n- src/cub/cli/__init__.py (new)\n\n## Notes\n- Use src layout for proper packaging\n- Include dev dependencies: pytest, ruff, mypy","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:low","model:haiku","phase-1","release:v0.21","setup"]}
-{"id":"cub-054","title":"Create Task and Config Pydantic models","description":"## Context\nDefine the core data models using Pydantic v2. These models replace the ad-hoc JSON parsing in Bash and provide validation, serialization, and IDE support.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Study existing Bash code for field names and types. Use Pydantic v2 features (model_validator, computed fields).\n\n## Implementation Steps\n1. Create src/cub/core/tasks/models.py with:\n   - TaskStatus enum (open, in_progress, closed)\n   - TaskPriority enum (P0-P4)\n   - Task model with all fields from current prd.json/beads\n   - Add model_label computed property for model:X labels\n2. Create src/cub/core/config/models.py with:\n   - GuardrailsConfig\n   - BudgetConfig\n   - HarnessConfig\n   - HooksConfig\n   - CubConfig (top-level)\n3. Create src/cub/core/status/models.py with:\n   - RunStatus model for dashboard\n   - Include current_task, iteration, budget, events\n4. Add unit tests for model validation\n\n## Acceptance Criteria\n- [ ] Task model can parse existing prd.json tasks\n- [ ] CubConfig model can parse existing .cub.json\n- [ ] All enums have correct values matching existing code\n- [ ] Pydantic validation catches invalid data\n- [ ] Tests pass for happy path and error cases\n\n## Files Likely Involved\n- src/cub/core/__init__.py (new)\n- src/cub/core/tasks/__init__.py (new)\n- src/cub/core/tasks/models.py (new)\n- src/cub/core/config/__init__.py (new)\n- src/cub/core/config/models.py (new)\n- tests/test_models.py (new)\n\n## Notes\n- Reference lib/tasks.sh and lib/config.sh for field names\n- Use Field() for defaults and descriptions\n- Include examples in docstrings","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","model","model:sonnet","phase-1","release:v0.21"]}
-{"id":"cub-055","title":"Implement TaskBackend protocol and registry","description":"## Context\nDefine the TaskBackend protocol that all task backends must implement. This enables the pluggable architecture where beads and JSON backends are interchangeable.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1h\n**Approach:** Use typing.Protocol with @runtime_checkable. Create a registry pattern for backend discovery.\n\n## Implementation Steps\n1. Create src/cub/core/tasks/backend.py with:\n   - TaskBackend Protocol class\n   - Methods: list_tasks, get_task, get_ready_tasks, update_task, close_task\n   - Backend registry dict\n   - register_backend decorator\n   - get_backend factory function\n   - detect_backend function (auto-detect beads vs json)\n2. Add type hints for all parameters and returns\n3. Document expected behavior in docstrings\n\n## Acceptance Criteria\n- [ ] TaskBackend protocol defined with all required methods\n- [ ] @register_backend decorator works\n- [ ] get_backend('beads') and get_backend('json') work\n- [ ] detect_backend auto-selects based on .beads/ presence\n- [ ] Protocol is @runtime_checkable\n\n## Files Likely Involved\n- src/cub/core/tasks/backend.py (new)\n- src/cub/core/tasks/__init__.py (update exports)\n\n## Notes\n- Reference lib/tasks.sh detect_backend() for auto-detection logic\n- Use Protocol from typing, not ABC\n- Include capability query method if needed","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-1","release:v0.21"]}
-{"id":"cub-056","title":"Implement BeadsBackend for task management","description":"## Context\nImplement the beads backend that wraps the `bd` CLI tool. This is the primary task backend when beads is available.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 2h\n**Approach:** Use subprocess to call bd CLI, parse JSON output with Pydantic models. Reference lib/beads.sh for command patterns.\n\n## Implementation Steps\n1. Create src/cub/core/tasks/beads.py with:\n   - BeadsBackend class implementing TaskBackend\n   - Helper for running bd commands with subprocess\n   - Parse bd JSON output into Task models\n   - Handle bd errors gracefully\n2. Implement all TaskBackend methods:\n   - list_tasks: `bd list --json [--status X] [--label X]`\n   - get_task: `bd show \u003cid\u003e --json`\n   - get_ready_tasks: `bd ready --json`\n   - update_task: `bd update \u003cid\u003e --status X`\n   - close_task: `bd close \u003cid\u003e -r \"reason\"`\n3. Add @register_backend('beads') decorator\n4. Handle case when bd is not installed\n\n## Acceptance Criteria\n- [ ] Can list tasks from beads\n- [ ] Can get single task by ID\n- [ ] Can find ready (unblocked) tasks\n- [ ] Can update task status\n- [ ] Can close task with reason\n- [ ] Graceful error when bd not installed\n- [ ] JSON parsing produces valid Task models\n\n## Files Likely Involved\n- src/cub/core/tasks/beads.py (new)\n- src/cub/core/tasks/__init__.py (update)\n\n## Notes\n- Reference lib/beads.sh for exact bd command patterns\n- Use subprocess.run with capture_output=True\n- Parse stderr for error messages","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-1","release:v0.21"]}
-{"id":"cub-057","title":"Implement JsonBackend for task management","description":"## Context\nImplement the JSON file backend for projects not using beads. Reads/writes prd.json directly.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Load prd.json, parse with Pydantic, implement CRUD operations. Reference lib/tasks.sh json_* functions.\n\n## Implementation Steps\n1. Create src/cub/core/tasks/json.py with:\n   - JsonBackend class implementing TaskBackend\n   - Load/save prd.json file\n   - Parse tasks into Task models\n   - Implement dependency resolution for ready tasks\n2. Implement all TaskBackend methods:\n   - list_tasks: filter in-memory\n   - get_task: lookup by id\n   - get_ready_tasks: check depends_on resolution\n   - update_task: modify and save\n   - close_task: set status=closed, add notes\n3. Add @register_backend('json') decorator\n4. Handle missing prd.json gracefully\n\n## Acceptance Criteria\n- [ ] Can load tasks from prd.json\n- [ ] Can filter by status and label\n- [ ] Dependency resolution works correctly\n- [ ] Can update and save changes\n- [ ] File not corrupted on write errors\n- [ ] Creates empty task list if prd.json missing\n\n## Files Likely Involved\n- src/cub/core/tasks/json.py (new)\n- src/cub/core/tasks/__init__.py (update)\n\n## Notes\n- Use atomic write (write to temp, then rename)\n- Reference lib/tasks.sh json_* functions\n- Preserve unknown fields in prd.json","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-1","release:v0.21"]}
-{"id":"cub-058","title":"Implement config loader with multi-layer merging","description":"## Context\nImplement configuration loading that merges defaults \u003c user config \u003c project config \u003c env vars, matching the existing Bash behavior.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Load JSON files, deep merge dicts, apply env var overrides, validate with Pydantic.\n\n## Implementation Steps\n1. Create src/cub/core/config/loader.py with:\n   - load_config() function returning CubConfig\n   - get_user_config_path() using XDG\n   - get_project_config_path()\n   - deep_merge() helper for dict merging\n   - apply_env_overrides() for CUB_* vars\n2. Implement precedence:\n   - Start with hardcoded defaults\n   - Merge ~/.config/cub/config.json\n   - Merge ./.cub.json\n   - Apply CUB_BUDGET, CUB_REVIEW_STRICT, etc.\n3. Validate final result with Pydantic\n4. Cache loaded config for session\n\n## Acceptance Criteria\n- [ ] Loads defaults when no config files exist\n- [ ] User config overrides defaults\n- [ ] Project config overrides user config\n- [ ] Env vars override all config files\n- [ ] Invalid config produces helpful error\n- [ ] Config is cached after first load\n\n## Files Likely Involved\n- src/cub/core/config/loader.py (new)\n- src/cub/core/config/__init__.py (update exports)\n\n## Notes\n- Reference lib/config.sh for exact merge behavior\n- Use pathlib for paths\n- XDG: ~/.config/cub/ on Linux, ~/Library/Application Support/cub/ on macOS","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-1","release:v0.21"]}
-{"id":"cub-059","title":"Implement HarnessBackend protocol and registry","description":"## Context\nDefine the HarnessBackend protocol for AI coding assistant abstraction. Supports capability detection and pluggable harness implementations.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1h\n**Approach:** Mirror TaskBackend pattern. Include capabilities model for feature detection.\n\n## Implementation Steps\n1. Create src/cub/core/harness/models.py with:\n   - HarnessCapabilities model (streaming, token_reporting, etc.)\n   - HarnessResult model (output, tokens, duration)\n2. Create src/cub/core/harness/backend.py with:\n   - HarnessBackend Protocol class\n   - Properties: name, capabilities\n   - Methods: invoke, invoke_streaming, is_available\n   - Registry and factory functions\n   - detect_harness function (auto-detect available)\n3. Define capability constants matching existing code\n\n## Acceptance Criteria\n- [ ] HarnessBackend protocol with all methods\n- [ ] HarnessCapabilities correctly typed\n- [ ] HarnessResult captures all needed data\n- [ ] detect_harness finds available harness\n- [ ] Registry pattern works\n\n## Files Likely Involved\n- src/cub/core/harness/__init__.py (new)\n- src/cub/core/harness/models.py (new)\n- src/cub/core/harness/backend.py (new)\n\n## Notes\n- Reference lib/harness.sh _harness_get_capabilities()\n- Include model_selection capability\n- Support both blocking and streaming invocation","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-1","release:v0.21"]}
-{"id":"cub-060","title":"Implement Claude harness backend","description":"## Context\nImplement the Claude Code harness - the primary AI backend. Supports streaming, token reporting, system prompts, and model selection.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 2h\n**Approach:** Wrap claude CLI with subprocess. Parse stream-json output for tokens. Reference lib/harness.sh claude_invoke().\n\n## Implementation Steps\n1. Create src/cub/core/harness/claude.py with:\n   - ClaudeBackend class implementing HarnessBackend\n   - is_available() checks for claude command\n   - Build command with flags:\n     - --print (non-interactive)\n     - --dangerously-skip-permissions (auto mode)\n     - --append-system-prompt (system prompt)\n     - --model (model selection)\n     - --output-format stream-json (streaming)\n2. Implement invoke():\n   - Run subprocess, capture output\n   - Parse JSON for result and token usage\n3. Implement invoke_streaming():\n   - Yield lines as they arrive\n   - Parse final token counts\n4. Set capabilities correctly\n\n## Acceptance Criteria\n- [ ] Can invoke Claude with prompt\n- [ ] System prompt passed correctly\n- [ ] Model selection works\n- [ ] Streaming yields output incrementally\n- [ ] Token usage reported accurately\n- [ ] Graceful handling when claude not installed\n\n## Files Likely Involved\n- src/cub/core/harness/claude.py (new)\n- src/cub/core/harness/__init__.py (update)\n\n## Notes\n- Reference lib/harness.sh claude_invoke() and claude_invoke_streaming()\n- Parse .usage from JSON output\n- Use subprocess.PIPE with line buffering for streaming","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-1","release:v0.21"]}
-{"id":"cub-061","title":"Implement Codex harness backend","description":"## Context\nImplement the OpenAI Codex CLI harness. Supports auto mode and streaming but no separate system prompt.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Wrap codex CLI. Combine system and task prompts since no --system-prompt flag.\n\n## Implementation Steps\n1. Create src/cub/core/harness/codex.py with:\n   - CodexBackend class implementing HarnessBackend\n   - is_available() checks for codex command\n   - Build command with flags:\n     - --full-auto (autonomous mode)\n     - --json (JSONL output)\n     - -m (model selection)\n2. Implement invoke():\n   - Combine system_prompt + prompt into single message\n   - Parse JSONL output\n3. Implement invoke_streaming():\n   - Parse JSONL events as they arrive\n4. Set capabilities (no system_prompt, no token_reporting)\n\n## Acceptance Criteria\n- [ ] Can invoke Codex with prompt\n- [ ] System prompt combined correctly\n- [ ] Model selection works (-m flag)\n- [ ] Streaming parses JSONL events\n- [ ] Graceful handling when codex not installed\n\n## Files Likely Involved\n- src/cub/core/harness/codex.py (new)\n- src/cub/core/harness/__init__.py (update)\n\n## Notes\n- Reference lib/harness.sh codex_invoke()\n- Codex uses --json not --output-format\n- Token reporting is estimated, not from CLI","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-1","release:v0.21"]}
-{"id":"cub-062","title":"Create Typer CLI structure with core commands","description":"## Context\nSet up the Typer CLI with the main command structure. This is the entry point for all cub commands.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Create main app with subcommands. Use Typer's callback for global options.\n\n## Implementation Steps\n1. Create src/cub/cli/__init__.py with:\n   - Main Typer app\n   - Global options callback (--debug, --version)\n   - Import and register subcommand modules\n2. Create stub commands:\n   - src/cub/cli/run.py - cub run\n   - src/cub/cli/status.py - cub status\n   - src/cub/cli/init_cmd.py - cub init (avoid init.py conflict)\n3. Wire up __main__.py to call app()\n4. Add shell completion setup\n\n## Acceptance Criteria\n- [ ] `cub --help` shows all commands\n- [ ] `cub --version` shows version\n- [ ] `cub run --help` shows run options\n- [ ] Shell completion installable\n- [ ] Exit codes correct (0 success, 1 error)\n\n## Files Likely Involved\n- src/cub/cli/__init__.py (new/update)\n- src/cub/cli/run.py (new)\n- src/cub/cli/status.py (new)\n- src/cub/cli/init_cmd.py (new)\n- src/cub/__main__.py (update)\n\n## Notes\n- Use app.command() decorator\n- Include rich_help_panel for organization\n- Add typer.Exit() for proper exit codes","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","model:sonnet","phase-1","release:v0.21","setup"]}
-{"id":"cub-063","title":"Implement cub run command with main loop","description":"## Context\nImplement the main run command that executes the autonomous loop. This is the core of cub - picking tasks and invoking harnesses.\n\n## Implementation Hints\n**Recommended Model:** opus\n**Estimated Duration:** 2h\n**Approach:** Port main loop logic from cmd_run.sh. Use task backend for task selection, harness for execution.\n\n## Implementation Steps\n1. Update src/cub/cli/run.py with:\n   - run command with all flags (--once, --epic, --label, --harness, etc.)\n   - Main loop: while tasks remain and budget not exceeded\n   - Task selection using get_ready_tasks()\n   - Prompt generation\n   - Harness invocation\n   - Status updates\n   - Hook execution points\n2. Implement status.json writing:\n   - Write after each iteration\n   - Include all RunStatus fields\n3. Handle interrupts gracefully (SIGINT)\n4. Log events to JSONL\n\n## Acceptance Criteria\n- [ ] `cub run` picks next ready task\n- [ ] Invokes correct harness\n- [ ] Updates task status on completion\n- [ ] Respects --once flag\n- [ ] Respects --epic and --label filters\n- [ ] Writes status.json each iteration\n- [ ] Stops on budget exhaustion\n- [ ] Handles Ctrl+C gracefully\n\n## Files Likely Involved\n- src/cub/cli/run.py (major update)\n- src/cub/core/status/writer.py (new)\n- src/cub/utils/hooks.py (new)\n\n## Notes\n- Reference lib/cmd_run.sh for loop logic\n- This is complex - ensure good test coverage\n- Status.json location: .cub/runs/{session}/status.json","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:high","logic","model:opus","phase-1","release:v0.21"]}
-{"id":"cub-064","title":"Implement cub status command","description":"## Context\nImplement the status command that shows task progress summary.\n\n## Implementation Hints\n**Recommended Model:** haiku\n**Estimated Duration:** 1h\n**Approach:** Query task backend, format with Rich tables.\n\n## Implementation Steps\n1. Update src/cub/cli/status.py with:\n   - status command with --json flag\n   - Query task backend for all tasks\n   - Calculate statistics (open, in_progress, closed)\n   - Display with Rich table\n   - JSON output option\n2. Show:\n   - Task counts by status\n   - Current task (if any in_progress)\n   - Ready tasks count\n   - Blocked tasks count\n\n## Acceptance Criteria\n- [ ] Shows task summary\n- [ ] Correct counts for each status\n- [ ] Shows ready vs blocked tasks\n- [ ] --json outputs machine-readable format\n- [ ] Works with both backends\n\n## Files Likely Involved\n- src/cub/cli/status.py (update)\n\n## Notes\n- Reference lib/cmd_status.sh\n- Use Rich Table for nice formatting\n- Include progress bar for completion %","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:low","model:haiku","phase-1","release:v0.21","ui"]}
-{"id":"cub-065","title":"Implement hook execution from Python","description":"## Context\nImplement hook execution that calls Bash hook scripts from Python. Hooks remain Bash for user extensibility.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1h\n**Approach:** Find and execute scripts in hook directories. Pass context via environment variables.\n\n## Implementation Steps\n1. Create src/cub/utils/hooks.py with:\n   - run_hooks(hook_name, context) function\n   - Find scripts in ~/.config/cub/hooks/{name}.d/\n   - Find scripts in .cub/hooks/{name}.d/\n   - Execute in sorted order\n   - Pass context as env vars (CUB_TASK_ID, etc.)\n2. Support hook points:\n   - pre-loop, post-loop\n   - pre-task, post-task\n   - on-error\n3. Handle hook failures based on config\n\n## Acceptance Criteria\n- [ ] Finds hooks in both directories\n- [ ] Executes in sorted order\n- [ ] Context passed as env vars\n- [ ] Hook failures logged\n- [ ] fail_fast config respected\n\n## Files Likely Involved\n- src/cub/utils/hooks.py (new)\n\n## Notes\n- Reference lib/hooks.sh\n- Scripts must be executable\n- Use subprocess.run with shell=False","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-1","release:v0.21"]}
-{"id":"cub-066","title":"Implement structured JSONL logging","description":"## Context\nImplement structured logging that writes JSONL events for debugging and analytics.\n\n## Implementation Hints\n**Recommended Model:** haiku\n**Estimated Duration:** 1h\n**Approach:** Create logger class that writes timestamped JSON lines.\n\n## Implementation Steps\n1. Create src/cub/utils/logging.py with:\n   - CubLogger class\n   - log_event(event_type, data) method\n   - Write to ~/.local/share/cub/logs/{project}/{session}.jsonl\n   - Include timestamp, event_type, data fields\n2. Event types:\n   - task_start, task_end\n   - loop_start, loop_end\n   - budget_warning\n   - error\n3. Ensure log directory created\n\n## Acceptance Criteria\n- [ ] Creates log file in correct location\n- [ ] Each line is valid JSON\n- [ ] Timestamps in ISO format\n- [ ] Events queryable with jq\n- [ ] Handles write errors gracefully\n\n## Files Likely Involved\n- src/cub/utils/logging.py (new)\n\n## Notes\n- Reference lib/logger.sh\n- Use XDG data directory\n- Append mode, don't overwrite","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:low","logic","model:haiku","phase-1","release:v0.21"]}
-{"id":"cub-067","title":"Add pytest test suite for core modules","description":"## Context\nCreate comprehensive pytest tests for core modules. Replace/supplement BATS tests.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 2h\n**Approach:** Test each module in isolation with fixtures. Mock subprocess calls for harness tests.\n\n## Implementation Steps\n1. Create tests/conftest.py with:\n   - Fixtures for temp directories\n   - Fixtures for sample tasks/config\n   - Mock bd CLI responses\n2. Create test files:\n   - tests/test_tasks/test_models.py\n   - tests/test_tasks/test_beads.py\n   - tests/test_tasks/test_json.py\n   - tests/test_config/test_loader.py\n   - tests/test_harness/test_claude.py\n3. Test happy paths and error cases\n4. Add GitHub Actions workflow\n\n## Acceptance Criteria\n- [ ] \u003e80% coverage on core modules\n- [ ] Tests run in \u003c30 seconds\n- [ ] No external dependencies in tests (all mocked)\n- [ ] CI workflow runs on push\n- [ ] Tests documented\n\n## Files Likely Involved\n- tests/conftest.py (new)\n- tests/test_tasks/*.py (new)\n- tests/test_config/*.py (new)\n- tests/test_harness/*.py (new)\n- .github/workflows/test.yml (new)\n\n## Notes\n- Use pytest-mock for subprocess mocking\n- Reference tests/*.bats for test cases\n- Include integration tests that run actual commands","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","model:sonnet","phase-1","release:v0.21","test"]}
-{"id":"cub-068","title":"Update installation and migration docs","description":"## Context\nUpdate documentation for the Python CLI. Include migration guide from Bash version.\n\n## Implementation Hints\n**Recommended Model:** haiku\n**Estimated Duration:** 1h\n**Approach:** Update README, add UPGRADING notes.\n\n## Implementation Steps\n1. Update README.md:\n   - New installation instructions (uv/pip)\n   - Updated prerequisites (Python 3.10+)\n   - Updated command examples\n2. Update UPGRADING.md:\n   - v0.21 migration notes\n   - Breaking changes (if any)\n   - New features\n3. Update CLAUDE.md:\n   - New project structure\n   - Python commands\n\n## Acceptance Criteria\n- [ ] README shows Python install\n- [ ] UPGRADING documents v0.21 changes\n- [ ] All code examples work\n- [ ] Prerequisites accurate\n\n## Files Likely Involved\n- README.md (update)\n- UPGRADING.md (update)\n- CLAUDE.md (update)\n\n## Notes\n- Keep old Bash info in legacy section\n- Test installation instructions work","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:low","docs","model:haiku","phase-1","release:v0.21"]}
-{"id":"cub-069","title":"Implement dead code detection for Python","description":"## Context\nDetect unused functions, classes, and variables in Python code using AST analysis.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 2h\n**Approach:** Use ast module to find definitions, then find references. Report unreferenced definitions.\n\n## Implementation Steps\n1. Create src/cub/audit/dead_code.py with:\n   - find_python_definitions() - parse AST for functions, classes\n   - find_python_references() - find all name references\n   - detect_unused() - compare definitions vs references\n   - DeadCodeReport model\n2. Handle:\n   - Unused imports\n   - Unused functions/methods\n   - Unused classes\n   - Unused variables\n3. Support exclude patterns (test files, __all__)\n\n## Acceptance Criteria\n- [ ] Finds unused imports\n- [ ] Finds unused functions\n- [ ] Respects exclude patterns\n- [ ] Reports file and line number\n- [ ] No false positives for __all__ exports\n\n## Files Likely Involved\n- src/cub/audit/__init__.py (new)\n- src/cub/audit/dead_code.py (new)\n- src/cub/audit/models.py (new)\n\n## Notes\n- Consider using vulture as alternative/supplement\n- Handle dynamic imports gracefully","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-2","release:v0.22"]}
-{"id":"cub-070","title":"Implement dead code detection for Bash","description":"## Context\nDetect unused functions and variables in remaining Bash code (hooks, legacy).\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Use shellcheck and/or regex parsing to find definitions and references.\n\n## Implementation Steps\n1. Add to src/cub/audit/dead_code.py:\n   - find_bash_functions() - regex for function definitions\n   - find_bash_calls() - regex for function calls\n   - run_shellcheck() - get shellcheck warnings\n2. Parse shellcheck JSON output\n3. Handle sourced files\n\n## Acceptance Criteria\n- [ ] Finds unused Bash functions\n- [ ] Integrates shellcheck warnings\n- [ ] Reports file and line number\n- [ ] Handles source/. includes\n\n## Files Likely Involved\n- src/cub/audit/dead_code.py (update)\n\n## Notes\n- shellcheck is optional dependency\n- Graceful fallback if shellcheck not installed","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-2","release:v0.22"]}
-{"id":"cub-071","title":"Implement documentation validation","description":"## Context\nValidate README and docs for broken links, outdated code examples, and stale content.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Parse markdown, extract links and code blocks, validate each.\n\n## Implementation Steps\n1. Create src/cub/audit/docs.py with:\n   - extract_links() - find all URLs in markdown\n   - check_links() - verify URLs are valid (HEAD request)\n   - extract_code_blocks() - find fenced code\n   - validate_code() - syntax check code blocks\n   - DocsReport model\n2. Check:\n   - Broken links (404s)\n   - Invalid internal references\n   - Syntax errors in code blocks\n   - Outdated version references\n\n## Acceptance Criteria\n- [ ] Finds broken links\n- [ ] Validates code block syntax\n- [ ] Reports specific line numbers\n- [ ] Handles relative links\n- [ ] Network timeouts handled gracefully\n\n## Files Likely Involved\n- src/cub/audit/docs.py (new)\n\n## Notes\n- Use requests for HTTP checks\n- Consider markdown-link-check integration\n- Rate limit external requests","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-2","release:v0.22"]}
-{"id":"cub-072","title":"Implement test coverage reporting","description":"## Context\nReport test coverage and identify files with insufficient coverage.\n\n## Implementation Hints\n**Recommended Model:** haiku\n**Estimated Duration:** 1h\n**Approach:** Run pytest with coverage, parse coverage.py output.\n\n## Implementation Steps\n1. Create src/cub/audit/coverage.py with:\n   - run_coverage() - execute pytest --cov\n   - parse_coverage_report() - parse JSON output\n   - identify_low_coverage() - find files below threshold\n   - CoverageReport model\n2. Report:\n   - Overall coverage percentage\n   - Per-file coverage\n   - Files below threshold\n   - Uncovered lines\n\n## Acceptance Criteria\n- [ ] Runs pytest with coverage\n- [ ] Parses coverage report\n- [ ] Identifies low-coverage files\n- [ ] Reports specific uncovered lines\n- [ ] Handles missing coverage.py gracefully\n\n## Files Likely Involved\n- src/cub/audit/coverage.py (new)\n\n## Notes\n- coverage.py is dev dependency\n- Support configurable threshold","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:low","logic","model:haiku","phase-2","release:v0.22"]}
-{"id":"cub-073","title":"Implement cub audit command","description":"## Context\nCreate the CLI command that runs all audit checks and produces a unified report.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Orchestrate audit modules, combine reports, format output.\n\n## Implementation Steps\n1. Create src/cub/cli/audit.py with:\n   - audit command with flags (--dead-code, --docs, --coverage, --ci)\n   - Run selected audits\n   - Combine into AuditReport\n   - Format with Rich (summary view)\n   - JSON output option\n   - CI mode (exit codes based on thresholds)\n2. Output:\n   - Summary scores per category\n   - Detailed findings\n   - Recommendations\n\n## Acceptance Criteria\n- [ ] `cub audit` runs all checks\n- [ ] `cub audit --ci` exits non-zero on failure\n- [ ] `cub audit --json` outputs machine-readable\n- [ ] Summary shows scores per category\n- [ ] Detailed findings actionable\n\n## Files Likely Involved\n- src/cub/cli/audit.py (new)\n- src/cub/cli/__init__.py (register command)\n\n## Notes\n- Reference specs/roadmap/codebase-health-audit.md for output format\n- Include grading (A-F) for quick assessment","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","model:sonnet","phase-2","release:v0.22","ui"]}
-{"id":"cub-074","title":"Implement Rich-based dashboard renderer","description":"## Context\nCreate the dashboard rendering component using Rich library for terminal UI.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 2h\n**Approach:** Use Rich Live display with Layout for multi-pane dashboard.\n\n## Implementation Steps\n1. Create src/cub/dashboard/renderer.py with:\n   - DashboardRenderer class\n   - render() method creating Rich Layout\n   - Panels for: status, progress, activity, budget\n   - Color coding for status\n2. Layout:\n   - Header: session name, status\n   - Left: current task, iteration\n   - Right: budget progress bar\n   - Bottom: recent activity log\n3. Use Rich components:\n   - Panel, Table, Progress\n   - Live for auto-refresh\n\n## Acceptance Criteria\n- [ ] Renders multi-pane dashboard\n- [ ] Shows current task prominently\n- [ ] Progress bars for budget and tasks\n- [ ] Activity log scrolls\n- [ ] Color indicates status\n\n## Files Likely Involved\n- src/cub/dashboard/__init__.py (new)\n- src/cub/dashboard/renderer.py (new)\n\n## Notes\n- Reference specs/roadmap/live-dashboard.md for layout\n- Test in different terminal sizes","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","model:sonnet","phase-3","release:v0.23","ui"]}
-{"id":"cub-075","title":"Implement status file polling","description":"## Context\nCreate the status file reader that polls status.json and updates dashboard.\n\n## Implementation Hints\n**Recommended Model:** haiku\n**Estimated Duration:** 1h\n**Approach:** Watch file for changes, parse into RunStatus model, notify renderer.\n\n## Implementation Steps\n1. Create src/cub/dashboard/status.py with:\n   - StatusWatcher class\n   - poll() method reading status.json\n   - Parse into RunStatus model\n   - Detect changes\n   - Callback on update\n2. Handle:\n   - File not existing yet\n   - Invalid JSON\n   - File being written\n\n## Acceptance Criteria\n- [ ] Polls status.json at configured interval\n- [ ] Parses into RunStatus model\n- [ ] Detects changes efficiently\n- [ ] Handles missing file gracefully\n- [ ] Handles partial writes\n\n## Files Likely Involved\n- src/cub/dashboard/status.py (new)\n\n## Notes\n- Use file mtime for change detection\n- Default 1s poll interval\n- Consider watchdog for efficiency","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:low","logic","model:haiku","phase-3","release:v0.23"]}
-{"id":"cub-076","title":"Implement tmux integration for --monitor","description":"## Context\nIntegrate with tmux to launch dashboard alongside main run.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Create tmux session with split panes - main run and dashboard.\n\n## Implementation Steps\n1. Create src/cub/dashboard/tmux.py with:\n   - launch_with_dashboard() function\n   - Create tmux session\n   - Split panes (main left, dashboard right)\n   - Start main run in left pane\n   - Start monitor in right pane\n2. Handle:\n   - tmux not installed\n   - Already in tmux session\n   - Session naming\n\n## Acceptance Criteria\n- [ ] `cub run --monitor` creates tmux session\n- [ ] Main run in left pane\n- [ ] Dashboard in right pane\n- [ ] Graceful fallback if no tmux\n- [ ] Clean exit when run completes\n\n## Files Likely Involved\n- src/cub/dashboard/tmux.py (new)\n- src/cub/cli/run.py (add --monitor flag)\n\n## Notes\n- Reference specs/roadmap/live-dashboard.md\n- Use tmux split-window -h\n- Consider pane size configuration","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-3","release:v0.23"]}
-{"id":"cub-077","title":"Implement cub monitor command","description":"## Context\nCreate command to attach dashboard to an existing run session.\n\n## Implementation Hints\n**Recommended Model:** haiku\n**Estimated Duration:** 1h\n**Approach:** Find running session, start dashboard pointed at its status.json.\n\n## Implementation Steps\n1. Create src/cub/cli/monitor.py with:\n   - monitor command\n   - Find session by ID or auto-detect\n   - Locate status.json\n   - Start dashboard renderer\n2. Options:\n   - Session ID argument\n   - --list to show running sessions\n\n## Acceptance Criteria\n- [ ] `cub monitor` attaches to running session\n- [ ] `cub monitor \u003csession-id\u003e` attaches to specific session\n- [ ] `cub monitor --list` shows running sessions\n- [ ] Clear error if no running session\n\n## Files Likely Involved\n- src/cub/cli/monitor.py (new)\n- src/cub/cli/__init__.py (register command)\n\n## Notes\n- Look in .cub/runs/ for recent sessions\n- Check status.json exists and is recent","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:low","model:haiku","phase-3","release:v0.23","ui"]}
-{"id":"cub-078","title":"Implement WorktreeManager class","description":"## Context\nCreate the core worktree management class wrapping git worktree commands.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 2h\n**Approach:** Wrap git worktree commands with subprocess or GitPython.\n\n## Implementation Steps\n1. Create src/cub/core/worktree/__init__.py\n2. Create src/cub/core/worktree/manager.py with:\n   - WorktreeManager class\n   - create(branch, path) - create worktree\n   - list() - list all worktrees\n   - remove(path) - remove worktree\n   - get_for_task(task_id) - get/create worktree for task\n   - cleanup_merged() - remove worktrees for merged branches\n3. Handle:\n   - Worktree naming conventions\n   - Branch creation if needed\n   - Lock file issues\n\n## Acceptance Criteria\n- [ ] Can create worktree for task\n- [ ] Can list all worktrees\n- [ ] Can remove worktree\n- [ ] Handles branch not existing\n- [ ] Cleanup removes merged branches\n\n## Files Likely Involved\n- src/cub/core/worktree/__init__.py (new)\n- src/cub/core/worktree/manager.py (new)\n\n## Notes\n- Worktree path: .cub/worktrees/{task-id}/\n- Consider using GitPython for cleaner API","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-4","release:v0.24"]}
-{"id":"cub-079","title":"Add --worktree flag to cub run","description":"## Context\nAdd flag to run cub in an isolated worktree.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Create worktree, cd into it, run main loop.\n\n## Implementation Steps\n1. Update src/cub/cli/run.py:\n   - Add --worktree flag\n   - If set, create worktree via WorktreeManager\n   - Change working directory to worktree\n   - Run main loop\n   - Optionally cleanup on exit\n2. Handle:\n   - Worktree already exists\n   - Cleanup on error\n   - Status.json in worktree\n\n## Acceptance Criteria\n- [ ] `cub run --worktree` creates worktree\n- [ ] Run executes in worktree directory\n- [ ] Changes isolated to worktree\n- [ ] Clean exit removes worktree (optional)\n\n## Files Likely Involved\n- src/cub/cli/run.py (update)\n\n## Notes\n- Consider --worktree-keep flag to preserve","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-4","release:v0.24"]}
-{"id":"cub-080","title":"Implement --parallel N for concurrent tasks","description":"## Context\nProcess multiple independent tasks concurrently, each in its own worktree.\n\n## Implementation Hints\n**Recommended Model:** opus\n**Estimated Duration:** 2h\n**Approach:** Find independent tasks, spawn workers in separate worktrees, coordinate results.\n\n## Implementation Steps\n1. Update src/cub/cli/run.py:\n   - Add --parallel N flag\n   - Find N independent tasks (no mutual dependencies)\n   - Create worktree per task\n   - Spawn subprocess per worktree\n   - Wait for completion\n   - Merge results\n2. Create src/cub/core/worktree/parallel.py:\n   - ParallelRunner class\n   - spawn_worker(task, worktree)\n   - wait_all()\n   - collect_results()\n3. Handle:\n   - Task dependencies\n   - Worker failures\n   - Result merging\n\n## Acceptance Criteria\n- [ ] `cub run --parallel 3` processes 3 tasks at once\n- [ ] Only independent tasks run in parallel\n- [ ] Each task in own worktree\n- [ ] Results merged correctly\n- [ ] Failures handled gracefully\n\n## Files Likely Involved\n- src/cub/cli/run.py (update)\n- src/cub/core/worktree/parallel.py (new)\n\n## Notes\n- Complex coordination logic\n- Consider asyncio or concurrent.futures\n- Ensure logging from all workers captured","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:high","logic","model:opus","phase-4","release:v0.24"]}
-{"id":"cub-081","title":"Implement cub worktree subcommands","description":"## Context\nCreate CLI commands for worktree management.\n\n## Implementation Hints\n**Recommended Model:** haiku\n**Estimated Duration:** 1h\n**Approach:** Wrap WorktreeManager methods in CLI commands.\n\n## Implementation Steps\n1. Create src/cub/cli/worktree.py with:\n   - worktree list - show all worktrees\n   - worktree clean - remove merged worktrees\n   - worktree create \u003cbranch\u003e - manually create\n   - worktree remove \u003cpath\u003e - manually remove\n2. Format output with Rich tables\n\n## Acceptance Criteria\n- [ ] `cub worktree list` shows worktrees\n- [ ] `cub worktree clean` removes merged\n- [ ] `cub worktree create` works\n- [ ] `cub worktree remove` works\n\n## Files Likely Involved\n- src/cub/cli/worktree.py (new)\n- src/cub/cli/__init__.py (register)\n\n## Notes\n- Show task association in list","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:low","model:haiku","phase-4","release:v0.24","ui"]}
-{"id":"cub-082","title":"Implement SandboxProvider protocol and registry","description":"## Context\nDefine the provider protocol for sandbox execution. Enables future providers (Sprites, Firecracker).\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Mirror TaskBackend pattern with capabilities model.\n\n## Implementation Steps\n1. Create src/cub/core/sandbox/__init__.py\n2. Create src/cub/core/sandbox/models.py with:\n   - SandboxCapabilities model\n   - SandboxStatus model\n3. Create src/cub/core/sandbox/provider.py with:\n   - SandboxProvider Protocol\n   - Methods: start, stop, status, logs, diff, export, cleanup\n   - Properties: name, capabilities\n   - Registry and factory functions\n\n## Acceptance Criteria\n- [ ] SandboxProvider protocol complete\n- [ ] SandboxCapabilities defines all features\n- [ ] SandboxStatus captures runtime state\n- [ ] Registry pattern works\n\n## Files Likely Involved\n- src/cub/core/sandbox/__init__.py (new)\n- src/cub/core/sandbox/models.py (new)\n- src/cub/core/sandbox/provider.py (new)\n\n## Notes\n- Reference specs/roadmap/sandbox-mode.md for interface","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-5","release:v0.25"]}
-{"id":"cub-083","title":"Implement DockerProvider for sandbox","description":"## Context\nImplement Docker-based sandbox provider - the primary sandbox backend.\n\n## Implementation Hints\n**Recommended Model:** opus\n**Estimated Duration:** 2h\n**Approach:** Use Docker CLI via subprocess. Copy project to volume, run cub in container.\n\n## Implementation Steps\n1. Create src/cub/core/sandbox/docker.py with:\n   - DockerProvider class implementing SandboxProvider\n   - start(): create volume, copy project, start container\n   - stop(): stop container\n   - status(): docker inspect\n   - logs(): docker logs\n   - diff(): git diff in container\n   - export(): copy changed files out\n   - cleanup(): remove container and volume\n2. Docker configuration:\n   - Memory/CPU limits\n   - Network isolation option\n   - Security options\n3. Register as 'docker' provider\n\n## Acceptance Criteria\n- [ ] Can start sandbox container\n- [ ] Project copied to container\n- [ ] Can stream logs\n- [ ] Can get diff of changes\n- [ ] Can export changes\n- [ ] Cleanup removes all resources\n- [ ] Resource limits enforced\n\n## Files Likely Involved\n- src/cub/core/sandbox/docker.py (new)\n\n## Notes\n- Reference specs/roadmap/sandbox-mode.md for Docker commands\n- Use docker run --rm for cleanup\n- Consider cub:latest image","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:high","logic","model:opus","phase-5","release:v0.25"]}
-{"id":"cub-084","title":"Add --sandbox flag to cub run","description":"## Context\nAdd flag to run cub in sandboxed Docker environment.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Start sandbox, run cub inside, stream output.\n\n## Implementation Steps\n1. Update src/cub/cli/run.py:\n   - Add --sandbox flag\n   - Add --no-network flag\n   - If --sandbox, use DockerProvider\n   - Start sandbox\n   - Stream logs to terminal\n   - On completion, show diff summary\n2. Handle:\n   - Docker not available\n   - Container failures\n   - Interrupt (Ctrl+C)\n\n## Acceptance Criteria\n- [ ] `cub run --sandbox` runs in Docker\n- [ ] Output streamed to terminal\n- [ ] Diff shown on completion\n- [ ] Network isolation with --no-network\n- [ ] Clean error if Docker not available\n\n## Files Likely Involved\n- src/cub/cli/run.py (update)\n\n## Notes\n- Consider --sandbox-keep to preserve container","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-5","release:v0.25"]}
-{"id":"cub-085","title":"Implement cub sandbox subcommands","description":"## Context\nCreate CLI commands for sandbox management.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Wrap SandboxProvider methods in CLI commands.\n\n## Implementation Steps\n1. Create src/cub/cli/sandbox.py with:\n   - sandbox logs - stream container logs\n   - sandbox status - show sandbox state\n   - sandbox diff - show changes made\n   - sandbox export \u003cpath\u003e - export changes\n   - sandbox apply - apply changes to project\n   - sandbox clean - remove sandbox\n2. Format output appropriately\n\n## Acceptance Criteria\n- [ ] `cub sandbox logs` streams logs\n- [ ] `cub sandbox diff` shows changes\n- [ ] `cub sandbox apply` applies changes\n- [ ] `cub sandbox clean` removes sandbox\n- [ ] Clear error if no sandbox running\n\n## Files Likely Involved\n- src/cub/cli/sandbox.py (new)\n- src/cub/cli/__init__.py (register)\n\n## Notes\n- apply copies files from sandbox to project\n- Consider confirmation prompt for apply","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","model:sonnet","phase-5","release:v0.25","ui"]}
-{"id":"cub-086","title":"Create Docker image for cub sandbox","description":"## Context\nCreate the Docker image used for sandbox execution.\n\n## Implementation Hints\n**Recommended Model:** haiku\n**Estimated Duration:** 1h\n**Approach:** Dockerfile with cub and dependencies pre-installed.\n\n## Implementation Steps\n1. Create docker/Dockerfile with:\n   - Base image (python:3.11-slim)\n   - Install system deps (git, jq)\n   - Install cub (pip install)\n   - Install harness CLIs (claude, codex)\n   - Set working directory\n   - Entry point\n2. Create docker-compose.yml for testing\n3. Add to CI for building/pushing image\n\n## Acceptance Criteria\n- [ ] Dockerfile builds successfully\n- [ ] Image contains cub and deps\n- [ ] Can run cub inside container\n- [ ] Image size reasonable (\u003c500MB)\n- [ ] CI builds and pushes image\n\n## Files Likely Involved\n- docker/Dockerfile (new)\n- docker/docker-compose.yml (new)\n- .github/workflows/docker.yml (new)\n\n## Notes\n- Consider multi-stage build for size\n- Tag as cub:latest and cub:v0.25","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:low","model:haiku","phase-5","release:v0.25","setup"]}
+{"id":"cub-053","title":"Initialize Python project with uv","description":"## Context\nSet up the Python project structure using uv for fast dependency management. This is the foundation for all Python code.\n\n## Implementation Hints\n**Recommended Model:** haiku\n**Estimated Duration:** 1h\n**Approach:** Use uv init, configure pyproject.toml with project metadata and dependencies.\n\n## Implementation Steps\n1. Run `uv init` in project root\n2. Configure pyproject.toml with:\n   - Project name: cub\n   - Python version: \u003e=3.10\n   - Dependencies: typer, pydantic, rich, GitPython, pytest\n   - Entry point: cub = \"cub.cli:app\"\n3. Create src/cub/ directory structure\n4. Add __init__.py and __main__.py\n5. Verify `uv run python -m cub --help` works\n\n## Acceptance Criteria\n- [ ] pyproject.toml exists with correct metadata\n- [ ] uv.lock generated\n- [ ] `uv run python -m cub --help` shows Typer help\n- [ ] Project installable with `uv pip install -e .`\n\n## Files Likely Involved\n- pyproject.toml (new)\n- src/cub/__init__.py (new)\n- src/cub/__main__.py (new)\n- src/cub/cli/__init__.py (new)\n\n## Notes\n- Use src layout for proper packaging\n- Include dev dependencies: pytest, ruff, mypy","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:low","model:haiku","phase-1","release:v0.21","setup"],"dependencies":[{"issue_id":"cub-053","depends_on_id":"cub-E07","type":"parent-child","created_at":"2026-01-14T22:58:30.596114-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-054","title":"Create Task and Config Pydantic models","description":"## Context\nDefine the core data models using Pydantic v2. These models replace the ad-hoc JSON parsing in Bash and provide validation, serialization, and IDE support.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Study existing Bash code for field names and types. Use Pydantic v2 features (model_validator, computed fields).\n\n## Implementation Steps\n1. Create src/cub/core/tasks/models.py with:\n   - TaskStatus enum (open, in_progress, closed)\n   - TaskPriority enum (P0-P4)\n   - Task model with all fields from current prd.json/beads\n   - Add model_label computed property for model:X labels\n2. Create src/cub/core/config/models.py with:\n   - GuardrailsConfig\n   - BudgetConfig\n   - HarnessConfig\n   - HooksConfig\n   - CubConfig (top-level)\n3. Create src/cub/core/status/models.py with:\n   - RunStatus model for dashboard\n   - Include current_task, iteration, budget, events\n4. Add unit tests for model validation\n\n## Acceptance Criteria\n- [ ] Task model can parse existing prd.json tasks\n- [ ] CubConfig model can parse existing .cub.json\n- [ ] All enums have correct values matching existing code\n- [ ] Pydantic validation catches invalid data\n- [ ] Tests pass for happy path and error cases\n\n## Files Likely Involved\n- src/cub/core/__init__.py (new)\n- src/cub/core/tasks/__init__.py (new)\n- src/cub/core/tasks/models.py (new)\n- src/cub/core/config/__init__.py (new)\n- src/cub/core/config/models.py (new)\n- tests/test_models.py (new)\n\n## Notes\n- Reference lib/tasks.sh and lib/config.sh for field names\n- Use Field() for defaults and descriptions\n- Include examples in docstrings","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","model","model:sonnet","phase-1","release:v0.21"],"dependencies":[{"issue_id":"cub-054","depends_on_id":"cub-E07","type":"parent-child","created_at":"2026-01-14T22:58:30.649227-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-054","depends_on_id":"cub-053","type":"blocks","created_at":"2026-01-14T22:58:39.878722-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-055","title":"Implement TaskBackend protocol and registry","description":"## Context\nDefine the TaskBackend protocol that all task backends must implement. This enables the pluggable architecture where beads and JSON backends are interchangeable.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1h\n**Approach:** Use typing.Protocol with @runtime_checkable. Create a registry pattern for backend discovery.\n\n## Implementation Steps\n1. Create src/cub/core/tasks/backend.py with:\n   - TaskBackend Protocol class\n   - Methods: list_tasks, get_task, get_ready_tasks, update_task, close_task\n   - Backend registry dict\n   - register_backend decorator\n   - get_backend factory function\n   - detect_backend function (auto-detect beads vs json)\n2. Add type hints for all parameters and returns\n3. Document expected behavior in docstrings\n\n## Acceptance Criteria\n- [ ] TaskBackend protocol defined with all required methods\n- [ ] @register_backend decorator works\n- [ ] get_backend('beads') and get_backend('json') work\n- [ ] detect_backend auto-selects based on .beads/ presence\n- [ ] Protocol is @runtime_checkable\n\n## Files Likely Involved\n- src/cub/core/tasks/backend.py (new)\n- src/cub/core/tasks/__init__.py (update exports)\n\n## Notes\n- Reference lib/tasks.sh detect_backend() for auto-detection logic\n- Use Protocol from typing, not ABC\n- Include capability query method if needed","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-1","release:v0.21"],"dependencies":[{"issue_id":"cub-055","depends_on_id":"cub-E07","type":"parent-child","created_at":"2026-01-14T22:58:30.702432-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-055","depends_on_id":"cub-054","type":"blocks","created_at":"2026-01-14T22:58:39.9318-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-056","title":"Implement BeadsBackend for task management","description":"## Context\nImplement the beads backend that wraps the `bd` CLI tool. This is the primary task backend when beads is available.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 2h\n**Approach:** Use subprocess to call bd CLI, parse JSON output with Pydantic models. Reference lib/beads.sh for command patterns.\n\n## Implementation Steps\n1. Create src/cub/core/tasks/beads.py with:\n   - BeadsBackend class implementing TaskBackend\n   - Helper for running bd commands with subprocess\n   - Parse bd JSON output into Task models\n   - Handle bd errors gracefully\n2. Implement all TaskBackend methods:\n   - list_tasks: `bd list --json [--status X] [--label X]`\n   - get_task: `bd show \u003cid\u003e --json`\n   - get_ready_tasks: `bd ready --json`\n   - update_task: `bd update \u003cid\u003e --status X`\n   - close_task: `bd close \u003cid\u003e -r \"reason\"`\n3. Add @register_backend('beads') decorator\n4. Handle case when bd is not installed\n\n## Acceptance Criteria\n- [ ] Can list tasks from beads\n- [ ] Can get single task by ID\n- [ ] Can find ready (unblocked) tasks\n- [ ] Can update task status\n- [ ] Can close task with reason\n- [ ] Graceful error when bd not installed\n- [ ] JSON parsing produces valid Task models\n\n## Files Likely Involved\n- src/cub/core/tasks/beads.py (new)\n- src/cub/core/tasks/__init__.py (update)\n\n## Notes\n- Reference lib/beads.sh for exact bd command patterns\n- Use subprocess.run with capture_output=True\n- Parse stderr for error messages","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-1","release:v0.21"],"dependencies":[{"issue_id":"cub-056","depends_on_id":"cub-E07","type":"parent-child","created_at":"2026-01-14T22:58:30.761848-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-056","depends_on_id":"cub-055","type":"blocks","created_at":"2026-01-14T22:58:39.988096-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-057","title":"Implement JsonBackend for task management","description":"## Context\nImplement the JSON file backend for projects not using beads. Reads/writes prd.json directly.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Load prd.json, parse with Pydantic, implement CRUD operations. Reference lib/tasks.sh json_* functions.\n\n## Implementation Steps\n1. Create src/cub/core/tasks/json.py with:\n   - JsonBackend class implementing TaskBackend\n   - Load/save prd.json file\n   - Parse tasks into Task models\n   - Implement dependency resolution for ready tasks\n2. Implement all TaskBackend methods:\n   - list_tasks: filter in-memory\n   - get_task: lookup by id\n   - get_ready_tasks: check depends_on resolution\n   - update_task: modify and save\n   - close_task: set status=closed, add notes\n3. Add @register_backend('json') decorator\n4. Handle missing prd.json gracefully\n\n## Acceptance Criteria\n- [ ] Can load tasks from prd.json\n- [ ] Can filter by status and label\n- [ ] Dependency resolution works correctly\n- [ ] Can update and save changes\n- [ ] File not corrupted on write errors\n- [ ] Creates empty task list if prd.json missing\n\n## Files Likely Involved\n- src/cub/core/tasks/json.py (new)\n- src/cub/core/tasks/__init__.py (update)\n\n## Notes\n- Use atomic write (write to temp, then rename)\n- Reference lib/tasks.sh json_* functions\n- Preserve unknown fields in prd.json","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-1","release:v0.21"],"dependencies":[{"issue_id":"cub-057","depends_on_id":"cub-E07","type":"parent-child","created_at":"2026-01-14T22:58:30.813545-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-057","depends_on_id":"cub-055","type":"blocks","created_at":"2026-01-14T22:58:40.043713-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-058","title":"Implement config loader with multi-layer merging","description":"## Context\nImplement configuration loading that merges defaults \u003c user config \u003c project config \u003c env vars, matching the existing Bash behavior.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Load JSON files, deep merge dicts, apply env var overrides, validate with Pydantic.\n\n## Implementation Steps\n1. Create src/cub/core/config/loader.py with:\n   - load_config() function returning CubConfig\n   - get_user_config_path() using XDG\n   - get_project_config_path()\n   - deep_merge() helper for dict merging\n   - apply_env_overrides() for CUB_* vars\n2. Implement precedence:\n   - Start with hardcoded defaults\n   - Merge ~/.config/cub/config.json\n   - Merge ./.cub.json\n   - Apply CUB_BUDGET, CUB_REVIEW_STRICT, etc.\n3. Validate final result with Pydantic\n4. Cache loaded config for session\n\n## Acceptance Criteria\n- [ ] Loads defaults when no config files exist\n- [ ] User config overrides defaults\n- [ ] Project config overrides user config\n- [ ] Env vars override all config files\n- [ ] Invalid config produces helpful error\n- [ ] Config is cached after first load\n\n## Files Likely Involved\n- src/cub/core/config/loader.py (new)\n- src/cub/core/config/__init__.py (update exports)\n\n## Notes\n- Reference lib/config.sh for exact merge behavior\n- Use pathlib for paths\n- XDG: ~/.config/cub/ on Linux, ~/Library/Application Support/cub/ on macOS","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-1","release:v0.21"],"dependencies":[{"issue_id":"cub-058","depends_on_id":"cub-E07","type":"parent-child","created_at":"2026-01-14T22:58:30.867418-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-058","depends_on_id":"cub-054","type":"blocks","created_at":"2026-01-14T22:58:40.0987-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-059","title":"Implement HarnessBackend protocol and registry","description":"## Context\nDefine the HarnessBackend protocol for AI coding assistant abstraction. Supports capability detection and pluggable harness implementations.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1h\n**Approach:** Mirror TaskBackend pattern. Include capabilities model for feature detection.\n\n## Implementation Steps\n1. Create src/cub/core/harness/models.py with:\n   - HarnessCapabilities model (streaming, token_reporting, etc.)\n   - HarnessResult model (output, tokens, duration)\n2. Create src/cub/core/harness/backend.py with:\n   - HarnessBackend Protocol class\n   - Properties: name, capabilities\n   - Methods: invoke, invoke_streaming, is_available\n   - Registry and factory functions\n   - detect_harness function (auto-detect available)\n3. Define capability constants matching existing code\n\n## Acceptance Criteria\n- [ ] HarnessBackend protocol with all methods\n- [ ] HarnessCapabilities correctly typed\n- [ ] HarnessResult captures all needed data\n- [ ] detect_harness finds available harness\n- [ ] Registry pattern works\n\n## Files Likely Involved\n- src/cub/core/harness/__init__.py (new)\n- src/cub/core/harness/models.py (new)\n- src/cub/core/harness/backend.py (new)\n\n## Notes\n- Reference lib/harness.sh _harness_get_capabilities()\n- Include model_selection capability\n- Support both blocking and streaming invocation","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-1","release:v0.21"],"dependencies":[{"issue_id":"cub-059","depends_on_id":"cub-E07","type":"parent-child","created_at":"2026-01-14T22:58:30.919848-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-059","depends_on_id":"cub-053","type":"blocks","created_at":"2026-01-14T22:58:40.15276-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-060","title":"Implement Claude harness backend","description":"## Context\nImplement the Claude Code harness - the primary AI backend. Supports streaming, token reporting, system prompts, and model selection.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 2h\n**Approach:** Wrap claude CLI with subprocess. Parse stream-json output for tokens. Reference lib/harness.sh claude_invoke().\n\n## Implementation Steps\n1. Create src/cub/core/harness/claude.py with:\n   - ClaudeBackend class implementing HarnessBackend\n   - is_available() checks for claude command\n   - Build command with flags:\n     - --print (non-interactive)\n     - --dangerously-skip-permissions (auto mode)\n     - --append-system-prompt (system prompt)\n     - --model (model selection)\n     - --output-format stream-json (streaming)\n2. Implement invoke():\n   - Run subprocess, capture output\n   - Parse JSON for result and token usage\n3. Implement invoke_streaming():\n   - Yield lines as they arrive\n   - Parse final token counts\n4. Set capabilities correctly\n\n## Acceptance Criteria\n- [ ] Can invoke Claude with prompt\n- [ ] System prompt passed correctly\n- [ ] Model selection works\n- [ ] Streaming yields output incrementally\n- [ ] Token usage reported accurately\n- [ ] Graceful handling when claude not installed\n\n## Files Likely Involved\n- src/cub/core/harness/claude.py (new)\n- src/cub/core/harness/__init__.py (update)\n\n## Notes\n- Reference lib/harness.sh claude_invoke() and claude_invoke_streaming()\n- Parse .usage from JSON output\n- Use subprocess.PIPE with line buffering for streaming","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-1","release:v0.21"],"dependencies":[{"issue_id":"cub-060","depends_on_id":"cub-E07","type":"parent-child","created_at":"2026-01-14T22:58:30.973006-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-060","depends_on_id":"cub-059","type":"blocks","created_at":"2026-01-14T22:58:40.206409-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-061","title":"Implement Codex harness backend","description":"## Context\nImplement the OpenAI Codex CLI harness. Supports auto mode and streaming but no separate system prompt.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Wrap codex CLI. Combine system and task prompts since no --system-prompt flag.\n\n## Implementation Steps\n1. Create src/cub/core/harness/codex.py with:\n   - CodexBackend class implementing HarnessBackend\n   - is_available() checks for codex command\n   - Build command with flags:\n     - --full-auto (autonomous mode)\n     - --json (JSONL output)\n     - -m (model selection)\n2. Implement invoke():\n   - Combine system_prompt + prompt into single message\n   - Parse JSONL output\n3. Implement invoke_streaming():\n   - Parse JSONL events as they arrive\n4. Set capabilities (no system_prompt, no token_reporting)\n\n## Acceptance Criteria\n- [ ] Can invoke Codex with prompt\n- [ ] System prompt combined correctly\n- [ ] Model selection works (-m flag)\n- [ ] Streaming parses JSONL events\n- [ ] Graceful handling when codex not installed\n\n## Files Likely Involved\n- src/cub/core/harness/codex.py (new)\n- src/cub/core/harness/__init__.py (update)\n\n## Notes\n- Reference lib/harness.sh codex_invoke()\n- Codex uses --json not --output-format\n- Token reporting is estimated, not from CLI","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-1","release:v0.21"],"dependencies":[{"issue_id":"cub-061","depends_on_id":"cub-E07","type":"parent-child","created_at":"2026-01-14T22:58:31.0251-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-061","depends_on_id":"cub-059","type":"blocks","created_at":"2026-01-14T22:58:40.26044-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-062","title":"Create Typer CLI structure with core commands","description":"## Context\nSet up the Typer CLI with the main command structure. This is the entry point for all cub commands.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Create main app with subcommands. Use Typer's callback for global options.\n\n## Implementation Steps\n1. Create src/cub/cli/__init__.py with:\n   - Main Typer app\n   - Global options callback (--debug, --version)\n   - Import and register subcommand modules\n2. Create stub commands:\n   - src/cub/cli/run.py - cub run\n   - src/cub/cli/status.py - cub status\n   - src/cub/cli/init_cmd.py - cub init (avoid init.py conflict)\n3. Wire up __main__.py to call app()\n4. Add shell completion setup\n\n## Acceptance Criteria\n- [ ] `cub --help` shows all commands\n- [ ] `cub --version` shows version\n- [ ] `cub run --help` shows run options\n- [ ] Shell completion installable\n- [ ] Exit codes correct (0 success, 1 error)\n\n## Files Likely Involved\n- src/cub/cli/__init__.py (new/update)\n- src/cub/cli/run.py (new)\n- src/cub/cli/status.py (new)\n- src/cub/cli/init_cmd.py (new)\n- src/cub/__main__.py (update)\n\n## Notes\n- Use app.command() decorator\n- Include rich_help_panel for organization\n- Add typer.Exit() for proper exit codes","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","model:sonnet","phase-1","release:v0.21","setup"],"dependencies":[{"issue_id":"cub-062","depends_on_id":"cub-E07","type":"parent-child","created_at":"2026-01-14T22:58:31.07827-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-062","depends_on_id":"cub-053","type":"blocks","created_at":"2026-01-14T22:58:40.314013-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-063","title":"Implement cub run command with main loop","description":"## Context\nImplement the main run command that executes the autonomous loop. This is the core of cub - picking tasks and invoking harnesses.\n\n## Implementation Hints\n**Recommended Model:** opus\n**Estimated Duration:** 2h\n**Approach:** Port main loop logic from cmd_run.sh. Use task backend for task selection, harness for execution.\n\n## Implementation Steps\n1. Update src/cub/cli/run.py with:\n   - run command with all flags (--once, --epic, --label, --harness, etc.)\n   - Main loop: while tasks remain and budget not exceeded\n   - Task selection using get_ready_tasks()\n   - Prompt generation\n   - Harness invocation\n   - Status updates\n   - Hook execution points\n2. Implement status.json writing:\n   - Write after each iteration\n   - Include all RunStatus fields\n3. Handle interrupts gracefully (SIGINT)\n4. Log events to JSONL\n\n## Acceptance Criteria\n- [ ] `cub run` picks next ready task\n- [ ] Invokes correct harness\n- [ ] Updates task status on completion\n- [ ] Respects --once flag\n- [ ] Respects --epic and --label filters\n- [ ] Writes status.json each iteration\n- [ ] Stops on budget exhaustion\n- [ ] Handles Ctrl+C gracefully\n\n## Files Likely Involved\n- src/cub/cli/run.py (major update)\n- src/cub/core/status/writer.py (new)\n- src/cub/utils/hooks.py (new)\n\n## Notes\n- Reference lib/cmd_run.sh for loop logic\n- This is complex - ensure good test coverage\n- Status.json location: .cub/runs/{session}/status.json","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:high","logic","model:opus","phase-1","release:v0.21"],"dependencies":[{"issue_id":"cub-063","depends_on_id":"cub-E07","type":"parent-child","created_at":"2026-01-14T22:58:31.131958-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-063","depends_on_id":"cub-056","type":"blocks","created_at":"2026-01-14T22:58:40.366794-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-063","depends_on_id":"cub-057","type":"blocks","created_at":"2026-01-14T22:58:40.41998-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-063","depends_on_id":"cub-058","type":"blocks","created_at":"2026-01-14T22:58:40.474902-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-063","depends_on_id":"cub-060","type":"blocks","created_at":"2026-01-14T22:58:40.526462-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-063","depends_on_id":"cub-062","type":"blocks","created_at":"2026-01-14T22:58:40.581051-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-064","title":"Implement cub status command","description":"## Context\nImplement the status command that shows task progress summary.\n\n## Implementation Hints\n**Recommended Model:** haiku\n**Estimated Duration:** 1h\n**Approach:** Query task backend, format with Rich tables.\n\n## Implementation Steps\n1. Update src/cub/cli/status.py with:\n   - status command with --json flag\n   - Query task backend for all tasks\n   - Calculate statistics (open, in_progress, closed)\n   - Display with Rich table\n   - JSON output option\n2. Show:\n   - Task counts by status\n   - Current task (if any in_progress)\n   - Ready tasks count\n   - Blocked tasks count\n\n## Acceptance Criteria\n- [ ] Shows task summary\n- [ ] Correct counts for each status\n- [ ] Shows ready vs blocked tasks\n- [ ] --json outputs machine-readable format\n- [ ] Works with both backends\n\n## Files Likely Involved\n- src/cub/cli/status.py (update)\n\n## Notes\n- Reference lib/cmd_status.sh\n- Use Rich Table for nice formatting\n- Include progress bar for completion %","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:low","model:haiku","phase-1","release:v0.21","ui"],"dependencies":[{"issue_id":"cub-064","depends_on_id":"cub-E07","type":"parent-child","created_at":"2026-01-14T22:58:31.186406-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-064","depends_on_id":"cub-056","type":"blocks","created_at":"2026-01-14T22:58:40.633897-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-064","depends_on_id":"cub-057","type":"blocks","created_at":"2026-01-14T22:58:40.688627-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-064","depends_on_id":"cub-062","type":"blocks","created_at":"2026-01-14T22:58:40.741004-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-065","title":"Implement hook execution from Python","description":"## Context\nImplement hook execution that calls Bash hook scripts from Python. Hooks remain Bash for user extensibility.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1h\n**Approach:** Find and execute scripts in hook directories. Pass context via environment variables.\n\n## Implementation Steps\n1. Create src/cub/utils/hooks.py with:\n   - run_hooks(hook_name, context) function\n   - Find scripts in ~/.config/cub/hooks/{name}.d/\n   - Find scripts in .cub/hooks/{name}.d/\n   - Execute in sorted order\n   - Pass context as env vars (CUB_TASK_ID, etc.)\n2. Support hook points:\n   - pre-loop, post-loop\n   - pre-task, post-task\n   - on-error\n3. Handle hook failures based on config\n\n## Acceptance Criteria\n- [ ] Finds hooks in both directories\n- [ ] Executes in sorted order\n- [ ] Context passed as env vars\n- [ ] Hook failures logged\n- [ ] fail_fast config respected\n\n## Files Likely Involved\n- src/cub/utils/hooks.py (new)\n\n## Notes\n- Reference lib/hooks.sh\n- Scripts must be executable\n- Use subprocess.run with shell=False","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-1","release:v0.21"],"dependencies":[{"issue_id":"cub-065","depends_on_id":"cub-E07","type":"parent-child","created_at":"2026-01-14T22:58:31.238398-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-065","depends_on_id":"cub-053","type":"blocks","created_at":"2026-01-14T22:58:40.795723-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-066","title":"Implement structured JSONL logging","description":"## Context\nImplement structured logging that writes JSONL events for debugging and analytics.\n\n## Implementation Hints\n**Recommended Model:** haiku\n**Estimated Duration:** 1h\n**Approach:** Create logger class that writes timestamped JSON lines.\n\n## Implementation Steps\n1. Create src/cub/utils/logging.py with:\n   - CubLogger class\n   - log_event(event_type, data) method\n   - Write to ~/.local/share/cub/logs/{project}/{session}.jsonl\n   - Include timestamp, event_type, data fields\n2. Event types:\n   - task_start, task_end\n   - loop_start, loop_end\n   - budget_warning\n   - error\n3. Ensure log directory created\n\n## Acceptance Criteria\n- [ ] Creates log file in correct location\n- [ ] Each line is valid JSON\n- [ ] Timestamps in ISO format\n- [ ] Events queryable with jq\n- [ ] Handles write errors gracefully\n\n## Files Likely Involved\n- src/cub/utils/logging.py (new)\n\n## Notes\n- Reference lib/logger.sh\n- Use XDG data directory\n- Append mode, don't overwrite","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:low","logic","model:haiku","phase-1","release:v0.21"],"dependencies":[{"issue_id":"cub-066","depends_on_id":"cub-E07","type":"parent-child","created_at":"2026-01-14T22:58:31.291276-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-066","depends_on_id":"cub-053","type":"blocks","created_at":"2026-01-14T22:58:40.851194-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-067","title":"Add pytest test suite for core modules","description":"## Context\nCreate comprehensive pytest tests for core modules. Replace/supplement BATS tests.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 2h\n**Approach:** Test each module in isolation with fixtures. Mock subprocess calls for harness tests.\n\n## Implementation Steps\n1. Create tests/conftest.py with:\n   - Fixtures for temp directories\n   - Fixtures for sample tasks/config\n   - Mock bd CLI responses\n2. Create test files:\n   - tests/test_tasks/test_models.py\n   - tests/test_tasks/test_beads.py\n   - tests/test_tasks/test_json.py\n   - tests/test_config/test_loader.py\n   - tests/test_harness/test_claude.py\n3. Test happy paths and error cases\n4. Add GitHub Actions workflow\n\n## Acceptance Criteria\n- [ ] \u003e80% coverage on core modules\n- [ ] Tests run in \u003c30 seconds\n- [ ] No external dependencies in tests (all mocked)\n- [ ] CI workflow runs on push\n- [ ] Tests documented\n\n## Files Likely Involved\n- tests/conftest.py (new)\n- tests/test_tasks/*.py (new)\n- tests/test_config/*.py (new)\n- tests/test_harness/*.py (new)\n- .github/workflows/test.yml (new)\n\n## Notes\n- Use pytest-mock for subprocess mocking\n- Reference tests/*.bats for test cases\n- Include integration tests that run actual commands","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","model:sonnet","phase-1","release:v0.21","test"],"dependencies":[{"issue_id":"cub-067","depends_on_id":"cub-E07","type":"parent-child","created_at":"2026-01-14T22:58:31.343571-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-067","depends_on_id":"cub-056","type":"blocks","created_at":"2026-01-14T22:58:40.904851-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-067","depends_on_id":"cub-057","type":"blocks","created_at":"2026-01-14T22:58:40.960711-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-067","depends_on_id":"cub-058","type":"blocks","created_at":"2026-01-14T22:58:41.013905-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-067","depends_on_id":"cub-060","type":"blocks","created_at":"2026-01-14T22:58:41.068208-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-068","title":"Update installation and migration docs","description":"## Context\nUpdate documentation for the Python CLI. Include migration guide from Bash version.\n\n## Implementation Hints\n**Recommended Model:** haiku\n**Estimated Duration:** 1h\n**Approach:** Update README, add UPGRADING notes.\n\n## Implementation Steps\n1. Update README.md:\n   - New installation instructions (uv/pip)\n   - Updated prerequisites (Python 3.10+)\n   - Updated command examples\n2. Update UPGRADING.md:\n   - v0.21 migration notes\n   - Breaking changes (if any)\n   - New features\n3. Update CLAUDE.md:\n   - New project structure\n   - Python commands\n\n## Acceptance Criteria\n- [ ] README shows Python install\n- [ ] UPGRADING documents v0.21 changes\n- [ ] All code examples work\n- [ ] Prerequisites accurate\n\n## Files Likely Involved\n- README.md (update)\n- UPGRADING.md (update)\n- CLAUDE.md (update)\n\n## Notes\n- Keep old Bash info in legacy section\n- Test installation instructions work","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:low","docs","model:haiku","phase-1","release:v0.21"],"dependencies":[{"issue_id":"cub-068","depends_on_id":"cub-E07","type":"parent-child","created_at":"2026-01-14T22:58:31.395934-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-068","depends_on_id":"cub-063","type":"blocks","created_at":"2026-01-14T22:58:41.120035-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-069","title":"Implement dead code detection for Python","description":"## Context\nDetect unused functions, classes, and variables in Python code using AST analysis.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 2h\n**Approach:** Use ast module to find definitions, then find references. Report unreferenced definitions.\n\n## Implementation Steps\n1. Create src/cub/audit/dead_code.py with:\n   - find_python_definitions() - parse AST for functions, classes\n   - find_python_references() - find all name references\n   - detect_unused() - compare definitions vs references\n   - DeadCodeReport model\n2. Handle:\n   - Unused imports\n   - Unused functions/methods\n   - Unused classes\n   - Unused variables\n3. Support exclude patterns (test files, __all__)\n\n## Acceptance Criteria\n- [ ] Finds unused imports\n- [ ] Finds unused functions\n- [ ] Respects exclude patterns\n- [ ] Reports file and line number\n- [ ] No false positives for __all__ exports\n\n## Files Likely Involved\n- src/cub/audit/__init__.py (new)\n- src/cub/audit/dead_code.py (new)\n- src/cub/audit/models.py (new)\n\n## Notes\n- Consider using vulture as alternative/supplement\n- Handle dynamic imports gracefully","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-2","release:v0.22"],"dependencies":[{"issue_id":"cub-069","depends_on_id":"cub-E08","type":"parent-child","created_at":"2026-01-14T22:58:31.450761-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-069","depends_on_id":"cub-E07","type":"blocks","created_at":"2026-01-14T22:58:41.177099-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-070","title":"Implement dead code detection for Bash","description":"## Context\nDetect unused functions and variables in remaining Bash code (hooks, legacy).\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Use shellcheck and/or regex parsing to find definitions and references.\n\n## Implementation Steps\n1. Add to src/cub/audit/dead_code.py:\n   - find_bash_functions() - regex for function definitions\n   - find_bash_calls() - regex for function calls\n   - run_shellcheck() - get shellcheck warnings\n2. Parse shellcheck JSON output\n3. Handle sourced files\n\n## Acceptance Criteria\n- [ ] Finds unused Bash functions\n- [ ] Integrates shellcheck warnings\n- [ ] Reports file and line number\n- [ ] Handles source/. includes\n\n## Files Likely Involved\n- src/cub/audit/dead_code.py (update)\n\n## Notes\n- shellcheck is optional dependency\n- Graceful fallback if shellcheck not installed","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-2","release:v0.22"],"dependencies":[{"issue_id":"cub-070","depends_on_id":"cub-E08","type":"parent-child","created_at":"2026-01-14T22:58:31.50256-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-070","depends_on_id":"cub-069","type":"blocks","created_at":"2026-01-14T22:58:41.233738-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-071","title":"Implement documentation validation","description":"## Context\nValidate README and docs for broken links, outdated code examples, and stale content.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Parse markdown, extract links and code blocks, validate each.\n\n## Implementation Steps\n1. Create src/cub/audit/docs.py with:\n   - extract_links() - find all URLs in markdown\n   - check_links() - verify URLs are valid (HEAD request)\n   - extract_code_blocks() - find fenced code\n   - validate_code() - syntax check code blocks\n   - DocsReport model\n2. Check:\n   - Broken links (404s)\n   - Invalid internal references\n   - Syntax errors in code blocks\n   - Outdated version references\n\n## Acceptance Criteria\n- [ ] Finds broken links\n- [ ] Validates code block syntax\n- [ ] Reports specific line numbers\n- [ ] Handles relative links\n- [ ] Network timeouts handled gracefully\n\n## Files Likely Involved\n- src/cub/audit/docs.py (new)\n\n## Notes\n- Use requests for HTTP checks\n- Consider markdown-link-check integration\n- Rate limit external requests","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-2","release:v0.22"],"dependencies":[{"issue_id":"cub-071","depends_on_id":"cub-E08","type":"parent-child","created_at":"2026-01-14T22:58:31.554956-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-071","depends_on_id":"cub-E07","type":"blocks","created_at":"2026-01-14T22:58:41.287278-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-072","title":"Implement test coverage reporting","description":"## Context\nReport test coverage and identify files with insufficient coverage.\n\n## Implementation Hints\n**Recommended Model:** haiku\n**Estimated Duration:** 1h\n**Approach:** Run pytest with coverage, parse coverage.py output.\n\n## Implementation Steps\n1. Create src/cub/audit/coverage.py with:\n   - run_coverage() - execute pytest --cov\n   - parse_coverage_report() - parse JSON output\n   - identify_low_coverage() - find files below threshold\n   - CoverageReport model\n2. Report:\n   - Overall coverage percentage\n   - Per-file coverage\n   - Files below threshold\n   - Uncovered lines\n\n## Acceptance Criteria\n- [ ] Runs pytest with coverage\n- [ ] Parses coverage report\n- [ ] Identifies low-coverage files\n- [ ] Reports specific uncovered lines\n- [ ] Handles missing coverage.py gracefully\n\n## Files Likely Involved\n- src/cub/audit/coverage.py (new)\n\n## Notes\n- coverage.py is dev dependency\n- Support configurable threshold","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:low","logic","model:haiku","phase-2","release:v0.22"],"dependencies":[{"issue_id":"cub-072","depends_on_id":"cub-E08","type":"parent-child","created_at":"2026-01-14T22:58:31.606888-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-072","depends_on_id":"cub-067","type":"blocks","created_at":"2026-01-14T22:58:41.340902-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-073","title":"Implement cub audit command","description":"## Context\nCreate the CLI command that runs all audit checks and produces a unified report.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Orchestrate audit modules, combine reports, format output.\n\n## Implementation Steps\n1. Create src/cub/cli/audit.py with:\n   - audit command with flags (--dead-code, --docs, --coverage, --ci)\n   - Run selected audits\n   - Combine into AuditReport\n   - Format with Rich (summary view)\n   - JSON output option\n   - CI mode (exit codes based on thresholds)\n2. Output:\n   - Summary scores per category\n   - Detailed findings\n   - Recommendations\n\n## Acceptance Criteria\n- [ ] `cub audit` runs all checks\n- [ ] `cub audit --ci` exits non-zero on failure\n- [ ] `cub audit --json` outputs machine-readable\n- [ ] Summary shows scores per category\n- [ ] Detailed findings actionable\n\n## Files Likely Involved\n- src/cub/cli/audit.py (new)\n- src/cub/cli/__init__.py (register command)\n\n## Notes\n- Reference specs/roadmap/codebase-health-audit.md for output format\n- Include grading (A-F) for quick assessment","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","model:sonnet","phase-2","release:v0.22","ui"],"dependencies":[{"issue_id":"cub-073","depends_on_id":"cub-E08","type":"parent-child","created_at":"2026-01-14T22:58:31.667249-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-073","depends_on_id":"cub-069","type":"blocks","created_at":"2026-01-14T22:58:41.393647-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-073","depends_on_id":"cub-070","type":"blocks","created_at":"2026-01-14T22:58:41.450313-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-073","depends_on_id":"cub-071","type":"blocks","created_at":"2026-01-14T22:58:41.503676-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-073","depends_on_id":"cub-072","type":"blocks","created_at":"2026-01-14T22:58:41.564943-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-074","title":"Implement Rich-based dashboard renderer","description":"## Context\nCreate the dashboard rendering component using Rich library for terminal UI.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 2h\n**Approach:** Use Rich Live display with Layout for multi-pane dashboard.\n\n## Implementation Steps\n1. Create src/cub/dashboard/renderer.py with:\n   - DashboardRenderer class\n   - render() method creating Rich Layout\n   - Panels for: status, progress, activity, budget\n   - Color coding for status\n2. Layout:\n   - Header: session name, status\n   - Left: current task, iteration\n   - Right: budget progress bar\n   - Bottom: recent activity log\n3. Use Rich components:\n   - Panel, Table, Progress\n   - Live for auto-refresh\n\n## Acceptance Criteria\n- [ ] Renders multi-pane dashboard\n- [ ] Shows current task prominently\n- [ ] Progress bars for budget and tasks\n- [ ] Activity log scrolls\n- [ ] Color indicates status\n\n## Files Likely Involved\n- src/cub/dashboard/__init__.py (new)\n- src/cub/dashboard/renderer.py (new)\n\n## Notes\n- Reference specs/roadmap/live-dashboard.md for layout\n- Test in different terminal sizes","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","model:sonnet","phase-3","release:v0.23","ui"],"dependencies":[{"issue_id":"cub-074","depends_on_id":"cub-E09","type":"parent-child","created_at":"2026-01-14T22:58:31.722694-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-074","depends_on_id":"cub-E07","type":"blocks","created_at":"2026-01-14T22:58:41.619757-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-075","title":"Implement status file polling","description":"## Context\nCreate the status file reader that polls status.json and updates dashboard.\n\n## Implementation Hints\n**Recommended Model:** haiku\n**Estimated Duration:** 1h\n**Approach:** Watch file for changes, parse into RunStatus model, notify renderer.\n\n## Implementation Steps\n1. Create src/cub/dashboard/status.py with:\n   - StatusWatcher class\n   - poll() method reading status.json\n   - Parse into RunStatus model\n   - Detect changes\n   - Callback on update\n2. Handle:\n   - File not existing yet\n   - Invalid JSON\n   - File being written\n\n## Acceptance Criteria\n- [ ] Polls status.json at configured interval\n- [ ] Parses into RunStatus model\n- [ ] Detects changes efficiently\n- [ ] Handles missing file gracefully\n- [ ] Handles partial writes\n\n## Files Likely Involved\n- src/cub/dashboard/status.py (new)\n\n## Notes\n- Use file mtime for change detection\n- Default 1s poll interval\n- Consider watchdog for efficiency","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:low","logic","model:haiku","phase-3","release:v0.23"],"dependencies":[{"issue_id":"cub-075","depends_on_id":"cub-E09","type":"parent-child","created_at":"2026-01-14T22:58:31.775136-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-075","depends_on_id":"cub-074","type":"blocks","created_at":"2026-01-14T22:58:41.675669-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-076","title":"Implement tmux integration for --monitor","description":"## Context\nIntegrate with tmux to launch dashboard alongside main run.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Create tmux session with split panes - main run and dashboard.\n\n## Implementation Steps\n1. Create src/cub/dashboard/tmux.py with:\n   - launch_with_dashboard() function\n   - Create tmux session\n   - Split panes (main left, dashboard right)\n   - Start main run in left pane\n   - Start monitor in right pane\n2. Handle:\n   - tmux not installed\n   - Already in tmux session\n   - Session naming\n\n## Acceptance Criteria\n- [ ] `cub run --monitor` creates tmux session\n- [ ] Main run in left pane\n- [ ] Dashboard in right pane\n- [ ] Graceful fallback if no tmux\n- [ ] Clean exit when run completes\n\n## Files Likely Involved\n- src/cub/dashboard/tmux.py (new)\n- src/cub/cli/run.py (add --monitor flag)\n\n## Notes\n- Reference specs/roadmap/live-dashboard.md\n- Use tmux split-window -h\n- Consider pane size configuration","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-3","release:v0.23"],"dependencies":[{"issue_id":"cub-076","depends_on_id":"cub-E09","type":"parent-child","created_at":"2026-01-14T22:58:31.827643-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-076","depends_on_id":"cub-074","type":"blocks","created_at":"2026-01-14T22:58:41.732129-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-076","depends_on_id":"cub-075","type":"blocks","created_at":"2026-01-14T22:58:41.784247-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-077","title":"Implement cub monitor command","description":"## Context\nCreate command to attach dashboard to an existing run session.\n\n## Implementation Hints\n**Recommended Model:** haiku\n**Estimated Duration:** 1h\n**Approach:** Find running session, start dashboard pointed at its status.json.\n\n## Implementation Steps\n1. Create src/cub/cli/monitor.py with:\n   - monitor command\n   - Find session by ID or auto-detect\n   - Locate status.json\n   - Start dashboard renderer\n2. Options:\n   - Session ID argument\n   - --list to show running sessions\n\n## Acceptance Criteria\n- [ ] `cub monitor` attaches to running session\n- [ ] `cub monitor \u003csession-id\u003e` attaches to specific session\n- [ ] `cub monitor --list` shows running sessions\n- [ ] Clear error if no running session\n\n## Files Likely Involved\n- src/cub/cli/monitor.py (new)\n- src/cub/cli/__init__.py (register command)\n\n## Notes\n- Look in .cub/runs/ for recent sessions\n- Check status.json exists and is recent","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:low","model:haiku","phase-3","release:v0.23","ui"],"dependencies":[{"issue_id":"cub-077","depends_on_id":"cub-E09","type":"parent-child","created_at":"2026-01-14T22:58:31.878799-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-077","depends_on_id":"cub-074","type":"blocks","created_at":"2026-01-14T22:58:41.839507-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-077","depends_on_id":"cub-075","type":"blocks","created_at":"2026-01-14T22:58:41.894034-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-078","title":"Implement WorktreeManager class","description":"## Context\nCreate the core worktree management class wrapping git worktree commands.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 2h\n**Approach:** Wrap git worktree commands with subprocess or GitPython.\n\n## Implementation Steps\n1. Create src/cub/core/worktree/__init__.py\n2. Create src/cub/core/worktree/manager.py with:\n   - WorktreeManager class\n   - create(branch, path) - create worktree\n   - list() - list all worktrees\n   - remove(path) - remove worktree\n   - get_for_task(task_id) - get/create worktree for task\n   - cleanup_merged() - remove worktrees for merged branches\n3. Handle:\n   - Worktree naming conventions\n   - Branch creation if needed\n   - Lock file issues\n\n## Acceptance Criteria\n- [ ] Can create worktree for task\n- [ ] Can list all worktrees\n- [ ] Can remove worktree\n- [ ] Handles branch not existing\n- [ ] Cleanup removes merged branches\n\n## Files Likely Involved\n- src/cub/core/worktree/__init__.py (new)\n- src/cub/core/worktree/manager.py (new)\n\n## Notes\n- Worktree path: .cub/worktrees/{task-id}/\n- Consider using GitPython for cleaner API","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-4","release:v0.24"],"dependencies":[{"issue_id":"cub-078","depends_on_id":"cub-E10","type":"parent-child","created_at":"2026-01-14T22:58:31.93275-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-078","depends_on_id":"cub-E07","type":"blocks","created_at":"2026-01-14T22:58:41.948872-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-079","title":"Add --worktree flag to cub run","description":"## Context\nAdd flag to run cub in an isolated worktree.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Create worktree, cd into it, run main loop.\n\n## Implementation Steps\n1. Update src/cub/cli/run.py:\n   - Add --worktree flag\n   - If set, create worktree via WorktreeManager\n   - Change working directory to worktree\n   - Run main loop\n   - Optionally cleanup on exit\n2. Handle:\n   - Worktree already exists\n   - Cleanup on error\n   - Status.json in worktree\n\n## Acceptance Criteria\n- [ ] `cub run --worktree` creates worktree\n- [ ] Run executes in worktree directory\n- [ ] Changes isolated to worktree\n- [ ] Clean exit removes worktree (optional)\n\n## Files Likely Involved\n- src/cub/cli/run.py (update)\n\n## Notes\n- Consider --worktree-keep flag to preserve","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-4","release:v0.24"],"dependencies":[{"issue_id":"cub-079","depends_on_id":"cub-E10","type":"parent-child","created_at":"2026-01-14T22:58:31.985758-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-079","depends_on_id":"cub-078","type":"blocks","created_at":"2026-01-14T22:58:42.002951-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-080","title":"Implement --parallel N for concurrent tasks","description":"## Context\nProcess multiple independent tasks concurrently, each in its own worktree.\n\n## Implementation Hints\n**Recommended Model:** opus\n**Estimated Duration:** 2h\n**Approach:** Find independent tasks, spawn workers in separate worktrees, coordinate results.\n\n## Implementation Steps\n1. Update src/cub/cli/run.py:\n   - Add --parallel N flag\n   - Find N independent tasks (no mutual dependencies)\n   - Create worktree per task\n   - Spawn subprocess per worktree\n   - Wait for completion\n   - Merge results\n2. Create src/cub/core/worktree/parallel.py:\n   - ParallelRunner class\n   - spawn_worker(task, worktree)\n   - wait_all()\n   - collect_results()\n3. Handle:\n   - Task dependencies\n   - Worker failures\n   - Result merging\n\n## Acceptance Criteria\n- [ ] `cub run --parallel 3` processes 3 tasks at once\n- [ ] Only independent tasks run in parallel\n- [ ] Each task in own worktree\n- [ ] Results merged correctly\n- [ ] Failures handled gracefully\n\n## Files Likely Involved\n- src/cub/cli/run.py (update)\n- src/cub/core/worktree/parallel.py (new)\n\n## Notes\n- Complex coordination logic\n- Consider asyncio or concurrent.futures\n- Ensure logging from all workers captured","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:high","logic","model:opus","phase-4","release:v0.24"],"dependencies":[{"issue_id":"cub-080","depends_on_id":"cub-E10","type":"parent-child","created_at":"2026-01-14T22:58:32.039487-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-080","depends_on_id":"cub-079","type":"blocks","created_at":"2026-01-14T22:58:42.056824-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-081","title":"Implement cub worktree subcommands","description":"## Context\nCreate CLI commands for worktree management.\n\n## Implementation Hints\n**Recommended Model:** haiku\n**Estimated Duration:** 1h\n**Approach:** Wrap WorktreeManager methods in CLI commands.\n\n## Implementation Steps\n1. Create src/cub/cli/worktree.py with:\n   - worktree list - show all worktrees\n   - worktree clean - remove merged worktrees\n   - worktree create \u003cbranch\u003e - manually create\n   - worktree remove \u003cpath\u003e - manually remove\n2. Format output with Rich tables\n\n## Acceptance Criteria\n- [ ] `cub worktree list` shows worktrees\n- [ ] `cub worktree clean` removes merged\n- [ ] `cub worktree create` works\n- [ ] `cub worktree remove` works\n\n## Files Likely Involved\n- src/cub/cli/worktree.py (new)\n- src/cub/cli/__init__.py (register)\n\n## Notes\n- Show task association in list","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:low","model:haiku","phase-4","release:v0.24","ui"],"dependencies":[{"issue_id":"cub-081","depends_on_id":"cub-E10","type":"parent-child","created_at":"2026-01-14T22:58:32.092907-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-081","depends_on_id":"cub-078","type":"blocks","created_at":"2026-01-14T22:58:42.112879-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-082","title":"Implement SandboxProvider protocol and registry","description":"## Context\nDefine the provider protocol for sandbox execution. Enables future providers (Sprites, Firecracker).\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Mirror TaskBackend pattern with capabilities model.\n\n## Implementation Steps\n1. Create src/cub/core/sandbox/__init__.py\n2. Create src/cub/core/sandbox/models.py with:\n   - SandboxCapabilities model\n   - SandboxStatus model\n3. Create src/cub/core/sandbox/provider.py with:\n   - SandboxProvider Protocol\n   - Methods: start, stop, status, logs, diff, export, cleanup\n   - Properties: name, capabilities\n   - Registry and factory functions\n\n## Acceptance Criteria\n- [ ] SandboxProvider protocol complete\n- [ ] SandboxCapabilities defines all features\n- [ ] SandboxStatus captures runtime state\n- [ ] Registry pattern works\n\n## Files Likely Involved\n- src/cub/core/sandbox/__init__.py (new)\n- src/cub/core/sandbox/models.py (new)\n- src/cub/core/sandbox/provider.py (new)\n\n## Notes\n- Reference specs/roadmap/sandbox-mode.md for interface","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-5","release:v0.25"],"dependencies":[{"issue_id":"cub-082","depends_on_id":"cub-E11","type":"parent-child","created_at":"2026-01-14T22:58:32.147203-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-082","depends_on_id":"cub-E07","type":"blocks","created_at":"2026-01-14T22:58:42.168051-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-083","title":"Implement DockerProvider for sandbox","description":"## Context\nImplement Docker-based sandbox provider - the primary sandbox backend.\n\n## Implementation Hints\n**Recommended Model:** opus\n**Estimated Duration:** 2h\n**Approach:** Use Docker CLI via subprocess. Copy project to volume, run cub in container.\n\n## Implementation Steps\n1. Create src/cub/core/sandbox/docker.py with:\n   - DockerProvider class implementing SandboxProvider\n   - start(): create volume, copy project, start container\n   - stop(): stop container\n   - status(): docker inspect\n   - logs(): docker logs\n   - diff(): git diff in container\n   - export(): copy changed files out\n   - cleanup(): remove container and volume\n2. Docker configuration:\n   - Memory/CPU limits\n   - Network isolation option\n   - Security options\n3. Register as 'docker' provider\n\n## Acceptance Criteria\n- [ ] Can start sandbox container\n- [ ] Project copied to container\n- [ ] Can stream logs\n- [ ] Can get diff of changes\n- [ ] Can export changes\n- [ ] Cleanup removes all resources\n- [ ] Resource limits enforced\n\n## Files Likely Involved\n- src/cub/core/sandbox/docker.py (new)\n\n## Notes\n- Reference specs/roadmap/sandbox-mode.md for Docker commands\n- Use docker run --rm for cleanup\n- Consider cub:latest image","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:high","logic","model:opus","phase-5","release:v0.25"],"dependencies":[{"issue_id":"cub-083","depends_on_id":"cub-E11","type":"parent-child","created_at":"2026-01-14T22:58:32.200779-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-083","depends_on_id":"cub-082","type":"blocks","created_at":"2026-01-14T22:58:42.221614-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-084","title":"Add --sandbox flag to cub run","description":"## Context\nAdd flag to run cub in sandboxed Docker environment.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Start sandbox, run cub inside, stream output.\n\n## Implementation Steps\n1. Update src/cub/cli/run.py:\n   - Add --sandbox flag\n   - Add --no-network flag\n   - If --sandbox, use DockerProvider\n   - Start sandbox\n   - Stream logs to terminal\n   - On completion, show diff summary\n2. Handle:\n   - Docker not available\n   - Container failures\n   - Interrupt (Ctrl+C)\n\n## Acceptance Criteria\n- [ ] `cub run --sandbox` runs in Docker\n- [ ] Output streamed to terminal\n- [ ] Diff shown on completion\n- [ ] Network isolation with --no-network\n- [ ] Clean error if Docker not available\n\n## Files Likely Involved\n- src/cub/cli/run.py (update)\n\n## Notes\n- Consider --sandbox-keep to preserve container","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","logic","model:sonnet","phase-5","release:v0.25"],"dependencies":[{"issue_id":"cub-084","depends_on_id":"cub-E11","type":"parent-child","created_at":"2026-01-14T22:58:32.255236-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-084","depends_on_id":"cub-083","type":"blocks","created_at":"2026-01-14T22:58:42.276256-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-085","title":"Implement cub sandbox subcommands","description":"## Context\nCreate CLI commands for sandbox management.\n\n## Implementation Hints\n**Recommended Model:** sonnet\n**Estimated Duration:** 1.5h\n**Approach:** Wrap SandboxProvider methods in CLI commands.\n\n## Implementation Steps\n1. Create src/cub/cli/sandbox.py with:\n   - sandbox logs - stream container logs\n   - sandbox status - show sandbox state\n   - sandbox diff - show changes made\n   - sandbox export \u003cpath\u003e - export changes\n   - sandbox apply - apply changes to project\n   - sandbox clean - remove sandbox\n2. Format output appropriately\n\n## Acceptance Criteria\n- [ ] `cub sandbox logs` streams logs\n- [ ] `cub sandbox diff` shows changes\n- [ ] `cub sandbox apply` applies changes\n- [ ] `cub sandbox clean` removes sandbox\n- [ ] Clear error if no sandbox running\n\n## Files Likely Involved\n- src/cub/cli/sandbox.py (new)\n- src/cub/cli/__init__.py (register)\n\n## Notes\n- apply copies files from sandbox to project\n- Consider confirmation prompt for apply","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:medium","model:sonnet","phase-5","release:v0.25","ui"],"dependencies":[{"issue_id":"cub-085","depends_on_id":"cub-E11","type":"parent-child","created_at":"2026-01-14T22:58:32.308588-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-085","depends_on_id":"cub-083","type":"blocks","created_at":"2026-01-14T22:58:42.330425-05:00","created_by":"Marc Lavallee"}]}
+{"id":"cub-086","title":"Create Docker image for cub sandbox","description":"## Context\nCreate the Docker image used for sandbox execution.\n\n## Implementation Hints\n**Recommended Model:** haiku\n**Estimated Duration:** 1h\n**Approach:** Dockerfile with cub and dependencies pre-installed.\n\n## Implementation Steps\n1. Create docker/Dockerfile with:\n   - Base image (python:3.11-slim)\n   - Install system deps (git, jq)\n   - Install cub (pip install)\n   - Install harness CLIs (claude, codex)\n   - Set working directory\n   - Entry point\n2. Create docker-compose.yml for testing\n3. Add to CI for building/pushing image\n\n## Acceptance Criteria\n- [ ] Dockerfile builds successfully\n- [ ] Image contains cub and deps\n- [ ] Can run cub inside container\n- [ ] Image size reasonable (\u003c500MB)\n- [ ] CI builds and pushes image\n\n## Files Likely Involved\n- docker/Dockerfile (new)\n- docker/docker-compose.yml (new)\n- .github/workflows/docker.yml (new)\n\n## Notes\n- Consider multi-stage build for size\n- Tag as cub:latest and cub:v0.25","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T22:42:11.704031-05:00","updated_at":"2026-01-14T22:42:11.704031-05:00","labels":["complexity:low","model:haiku","phase-5","release:v0.25","setup"],"dependencies":[{"issue_id":"cub-086","depends_on_id":"cub-E11","type":"parent-child","created_at":"2026-01-14T22:58:32.360376-05:00","created_by":"Marc Lavallee"},{"issue_id":"cub-086","depends_on_id":"cub-068","type":"blocks","created_at":"2026-01-14T22:58:42.384094-05:00","created_by":"Marc Lavallee"}]}
 {"id":"cub-09i","title":"Extract explain command to lib/explain.sh","description":"## What to extract\nLines ~743-927 from curb:\n- cmd_explain_help()\n- cmd_explain()\n\n## Size\n~185 lines → lib/explain.sh\n\n## Approach\n1. Create lib/explain.sh with explain-related functions\n2. Add source statement in main curb script\n3. Remove functions from main script\n4. Test: curb explain \u003ctask-id\u003e should work\n\n## Acceptance Criteria\n- [ ] lib/explain.sh created\n- [ ] curb explain \u003ctask-id\u003e works\n- [ ] Shows task details, dependencies, failure info correctly","status":"closed","priority":2,"issue_type":"task","owner":"mlavallee@gmail.com","created_at":"2026-01-13T09:32:42.527448-05:00","created_by":"Marc Lavallee","updated_at":"2026-01-13T21:10:38.775729-05:00","closed_at":"2026-01-13T21:10:38.775729-05:00","close_reason":"Closed","labels":["refactor"]}
 {"id":"cub-0b5","title":"Integrate logger into main loop","description":"## Context\nThe main loop needs to call logging functions at the right points.\n\n## Implementation Hints\n\n**Recommended Model:** sonnet\n**Estimated Duration:** 20m\n**Approach:** Add logger_init at startup, wrap task execution with log_task_start/end.\n\n## Implementation Steps\n1. Source lib/logger.sh in curb\n2. Call logger_init with project name and session ID\n3. Before harness_invoke: call log_task_start\n4. After harness_invoke: call log_task_end with results\n5. On errors: call log_error\n\n## Acceptance Criteria\n- [ ] Running curb creates log file\n- [ ] Each task iteration produces start/end log entries\n- [ ] Log includes harness, task_id, duration\n\n## Files Likely Involved\n- curb (main script)\n- lib/logger.sh\n","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T16:26:29.967578-05:00","created_by":"lavallee","updated_at":"2026-01-09T21:11:56.301123-05:00","closed_at":"2026-01-09T21:11:56.301123-05:00","close_reason":"Integrated logger into main loop with log_task_start, log_task_end, and log_error functions","labels":["complexity:medium","logic","model:sonnet","phase-1"],"dependencies":[{"issue_id":"cub-0b5","depends_on_id":"cub-ohp","type":"blocks","created_at":"2026-01-09T16:26:30.083603-05:00","created_by":"lavallee"},{"issue_id":"cub-0b5","depends_on_id":"cub-13j","type":"blocks","created_at":"2026-01-09T16:26:30.136331-05:00","created_by":"lavallee"},{"issue_id":"cub-0b5","depends_on_id":"cub-1gq","type":"parent-child","created_at":"2026-01-09T19:57:34.213912-05:00","created_by":"lavallee"}]}
 {"id":"cub-0hz","title":"Extract token usage from Claude harness output","description":"## Context\nNeed to get actual token counts from Claude Code to track budget accurately.\n\n## Implementation Hints\n\n**Recommended Model:** opus\n**Estimated Duration:** 45m\n**Approach:** Claude's stream-json output includes usage info. Parse from result event.\n\n## Implementation Steps\n1. Examine Claude Code's stream-json output for token fields\n2. In claude_invoke_streaming, capture and return token usage\n3. Add harness_get_usage() interface that returns tokens\n4. Handle case where usage not available (estimate)\n5. For non-streaming mode, check if --json output has usage\n\n## Acceptance Criteria\n- [ ] Token count extracted from Claude streaming output\n- [ ] Returned in structured format (input_tokens, output_tokens)\n- [ ] Fallback to estimate if not available\n- [ ] Works with both streaming and non-streaming modes\n\n## Files Likely Involved\n- lib/harness.sh\n\n## Notes\nClaude Code result event has cost_usd - may need to calculate tokens from cost.\nThis is a complex task requiring careful parsing of streaming JSON output.\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-09T16:26:46.882399-05:00","created_by":"lavallee","updated_at":"2026-01-09T23:21:36.886671-05:00","closed_at":"2026-01-09T23:21:36.886671-05:00","close_reason":"Implemented token usage extraction from Claude harness output. Added harness_get_usage() interface returning {input_tokens, output_tokens, cache_read_tokens, cache_creation_tokens, cost_usd, estimated}. Supports both streaming (claude_parse_stream) and non-streaming (claude_invoke) modes. Includes fallback estimation from cost_usd when token counts unavailable. Added 14 new tests.","labels":["complexity:high","logic","model:opus","phase-2"],"dependencies":[{"issue_id":"cub-0hz","depends_on_id":"cub-4l8","type":"blocks","created_at":"2026-01-09T16:26:46.995526-05:00","created_by":"lavallee"},{"issue_id":"cub-0hz","depends_on_id":"cub-0pb","type":"parent-child","created_at":"2026-01-09T19:57:34.632587-05:00","created_by":"lavallee"}]}
